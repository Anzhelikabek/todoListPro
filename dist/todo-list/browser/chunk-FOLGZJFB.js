import{b as Dn,c as Mn}from"./chunk-NJGWSNHL.js";import{a as Di}from"./chunk-G567VZAC.js";import{A as Fa,B as Fi,C as z0,D as Dr,E as Da,a as In,b as kr,c as uo,d as kn,e as O0,f as A0,g as dn,h as L0,i as R0,j as Er,k as V0,l as P0,m as gn,n as fo,o as Fr,p as Gi,q as R,r as ea,s as Qe,t as Rt,u as Zn,v as Qn,w as Ea,x as At,y as ai,z as si}from"./chunk-2MMHW37T.js";import{$ as I0,$a as $t,$b as Nt,A as so,Aa as xt,Ab as po,B as ft,Ba as Je,Ca as Ee,Cb as Ta,Da as Fe,E as oo,Ea as vt,Fa as Y,Fb as xl,G as he,Ga as be,H as ht,Ha as He,I as Sr,Ia as dr,J as gl,Ja as tt,Ka as it,La as nt,M as Sn,Ma as ji,N as S,Na as Ue,O as I,Oa as Ot,P as $e,Pa as Le,Q as Xe,Qa as pt,R as S0,Ra as Ci,Rb as Re,S as fe,Sa as pr,Sb as ot,T as yi,Ta as Ir,Tb as Ut,U as Lt,Ua as ur,Ub as Sa,V as Wi,Va as k0,Vb as Ia,Wa as E0,Wb as B0,X as ba,Xa as _s,Xb as vl,Y as ya,Ya as ae,Yb as ho,Z as p,Za as se,Zb as Ki,_ as Z,_a as wa,_b as ka,a as Tt,ac as N0,b as _n,ba as Qt,bc as mo,ca as lo,cc as Ze,db as F0,dc as ct,e as Tr,ea as Qr,eb as St,ec as Yt,f as C0,fa as qe,fb as Q,ga as _t,gb as We,ha as w,hb as gs,hc as rn,ia as V,ic as li,ja as u,jb as D0,ka as Jr,kc as qt,l as _l,la as cn,lb as oi,lc as _o,ma as Ai,mb as at,mc as ri,na as ue,nb as ii,nc as En,oa as g,ob as rt,oc as U0,pa as x,pb as It,pc as Fn,qa as N,qb as bt,qc as H0,r as va,ra as _e,rb as Ca,s as T0,sa as ge,sb as st,ta as ye,tb as ni,ua as le,ub as co,va as G,vb as M0,wa as f,xa as Ni,ya as wi,z as ln,za as ms}from"./chunk-KHXPU5IE.js";var Ma=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[qe,Ue],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1)(3,"path",2)(4,"path",3),x(),g(5,"defs")(6,"clipPath",4),N(7,"rect",5),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(5),u("id",r.pathId))},encapsulation:2})}return t})();var Oa=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["InfoCircleIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Aa=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["TimesCircleIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var W0=["container"],dh=t=>[t,"p-toast-message"],ph=(t,n,e,i)=>({showTransformParams:t,hideTransformParams:n,showTransitionParams:e,hideTransitionParams:i}),uh=t=>({value:"visible",params:t}),fh=(t,n)=>({$implicit:t,closeFn:n}),hh=t=>({$implicit:t});function mh(t,n){t&1&&ye(0)}function _h(t,n){if(t&1&&(_e(0),w(1,mh,1,0,"ng-container",4),ge()),t&2){let e=f();p(),u("ngTemplateOutlet",e.headlessTemplate)("ngTemplateOutletContext",pt(2,fh,e.message,e.onCloseIconClick))}}function gh(t,n){if(t&1&&N(0,"span"),t&2){let e=f(3);ue("p-toast-message-icon pi "+e.message.icon)}}function xh(t,n){t&1&&N(0,"CheckIcon"),t&2&&V("aria-hidden",!0)("data-pc-section","icon")}function vh(t,n){t&1&&N(0,"InfoCircleIcon"),t&2&&V("aria-hidden",!0)("data-pc-section","icon")}function bh(t,n){t&1&&N(0,"TimesCircleIcon"),t&2&&V("aria-hidden",!0)("data-pc-section","icon")}function yh(t,n){t&1&&N(0,"ExclamationTriangleIcon"),t&2&&V("aria-hidden",!0)("data-pc-section","icon")}function wh(t,n){if(t&1&&(g(0,"span",13),_e(1),w(2,xh,1,2,"CheckIcon",6)(3,vh,1,2,"InfoCircleIcon",6)(4,bh,1,2,"TimesCircleIcon",6)(5,yh,1,2,"ExclamationTriangleIcon",6),ge(),x()),t&2){let e=f(3);V("aria-hidden",!0)("data-pc-section","icon"),p(2),u("ngIf",e.message.severity==="success"),p(),u("ngIf",e.message.severity==="info"),p(),u("ngIf",e.message.severity==="error"),p(),u("ngIf",e.message.severity==="warn")}}function Ch(t,n){if(t&1&&(_e(0),w(1,gh,1,2,"span",8)(2,wh,6,6,"span",9),g(3,"div",10)(4,"div",11),Y(5),x(),g(6,"div",12),Y(7),x()(),ge()),t&2){let e=f(2);p(),u("ngIf",e.message.icon),p(),u("ngIf",!e.message.icon),p(),V("data-pc-section","text"),p(),V("data-pc-section","summary"),p(),be(e.message.summary),p(),V("data-pc-section","detail"),p(),be(e.message.detail)}}function Th(t,n){t&1&&ye(0)}function Sh(t,n){if(t&1&&N(0,"span"),t&2){let e=f(3);ue("pt-1 text-base p-toast-message-icon pi "+e.message.closeIcon)}}function Ih(t,n){t&1&&N(0,"TimesIcon",16),t&2&&(u("styleClass","p-toast-icon-close-icon"),V("aria-hidden",!0)("data-pc-section","closeicon"))}function kh(t,n){if(t&1){let e=le();g(0,"button",14),G("click",function(r){S(e);let a=f(2);return I(a.onCloseIconClick(r))})("keydown.enter",function(r){S(e);let a=f(2);return I(a.onCloseIconClick(r))}),w(1,Sh,1,2,"span",8)(2,Ih,1,3,"TimesIcon",15),x()}if(t&2){let e=f(2);V("aria-label",e.closeAriaLabel)("data-pc-section","closebutton"),p(),u("ngIf",e.message.closeIcon),p(),u("ngIf",!e.message.closeIcon)}}function Eh(t,n){if(t&1&&(g(0,"div",5),w(1,Ch,8,7,"ng-container",6)(2,Th,1,0,"ng-container",4)(3,kh,3,4,"button",7),x()),t&2){let e=f();u("ngClass",e.message==null?null:e.message.contentStyleClass),V("data-pc-section","content"),p(),u("ngIf",!e.template),p(),u("ngTemplateOutlet",e.template)("ngTemplateOutletContext",Le(6,hh,e.message)),p(),u("ngIf",(e.message==null?null:e.message.closable)!==!1)}}function Fh(t,n){if(t&1){let e=le();g(0,"p-toastItem",3),G("onClose",function(r){S(e);let a=f();return I(a.onMessageClose(r))})("@toastAnimation.start",function(r){S(e);let a=f();return I(a.onAnimationStart(r))})("@toastAnimation.done",function(r){S(e);let a=f();return I(a.onAnimationEnd(r))}),x()}if(t&2){let e=n.$implicit,i=n.index,r=f();u("message",e)("index",i)("life",r.life)("template",r.template)("headlessTemplate",r.headlessTemplate)("@toastAnimation",void 0)("showTransformOptions",r.showTransformOptions)("hideTransformOptions",r.hideTransformOptions)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions)}}var Dh=(()=>{class t{zone;config;message;index;life;template;headlessTemplate;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new fe;containerViewChild;timeout;constructor(e,i){this.zone=e,this.config=i}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick=e=>{this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),e.preventDefault()};get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(i){return new(i||t)(Z(yi),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-toastItem"]],viewQuery:function(i,r){if(i&1&&Je(W0,5),i&2){let a;Ee(a=Fe())&&(r.containerViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:[2,"index","index",We],life:[2,"life","life",We],template:"template",headlessTemplate:"headlessTemplate",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},features:[_t],decls:5,vars:18,consts:[["container",""],["notHeadless",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(i,r){if(i&1){let a=le();g(0,"div",2,0),G("mouseenter",function(){return S(a),I(r.onMouseEnter())})("mouseleave",function(){return S(a),I(r.onMouseLeave())}),w(2,_h,2,5,"ng-container",3)(3,Eh,4,8,"ng-template",null,1,$t),x()}if(i&2){let a=vt(4);ue(r.message==null?null:r.message.styleClass),u("ngClass",Le(9,dh,"p-toast-message-"+(r.message==null?null:r.message.severity)))("@messageState",Le(16,uh,pr(11,ph,r.showTransformOptions,r.hideTransformOptions,r.showTransitionOptions,r.hideTransitionOptions))),V("id",r.message==null?null:r.message.id)("data-pc-name","toast")("data-pc-section","root"),p(2),u("ngIf",r.headlessTemplate)("ngIfElse",a)}},dependencies:()=>[at,rt,bt,At,Di,Oa,Aa,Ma,Rt],encapsulation:2,data:{animation:[rn("messageState",[_o("visible",qt({transform:"translateY(0)",opacity:1})),ri("void => *",[qt({transform:"{{showTransformParams}}",opacity:0}),li("{{showTransitionParams}}")]),ri("* => void",[li("{{hideTransitionParams}}",qt({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return t})(),La=(()=>{class t{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(e){this._position=e,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new fe;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;headlessTemplate;_position="top-right";constructor(e,i,r,a,s){this.document=e,this.renderer=i,this.messageService=r,this.cd=a,this.config=s}styleElement;id=ot();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e)if(Array.isArray(e)){let i=e.filter(r=>this.canAdd(r));this.add(i)}else this.canAdd(e)&&this.add([e])}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(e){this.messages=this.messages?[...this.messages,...e]:[...e],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...e]:[...e]),this.cd.markForCheck()}canAdd(e){let i=this.key===e.key;return i&&this.preventOpenDuplicates&&(i=!this.containsMessage(this.messages,e)),i&&this.preventDuplicates&&(i=!this.containsMessage(this.messagesArchieve,e)),i}containsMessage(e,i){return e?e.find(r=>r.summary===i.summary&&r.detail==i.detail&&r.severity===i.severity)!=null:!1}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"message":this.template=e.template;break;case"headless":this.headlessTemplate=e.template;break;default:this.template=e.template;break}})}onMessageClose(e){this.messages?.splice(e.index,1),this.onClose.emit({message:e.message}),this.cd.detectChanges()}onAnimationStart(e){e.fromState==="void"&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&this.containerViewChild?.nativeElement.style.zIndex===""&&Ut.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(e){e.toState==="void"&&this.autoZIndex&&Re.isEmpty(this.messages)&&Ut.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",R.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce),this.renderer.appendChild(this.document.head,this.styleElement);let e="";for(let i in this.breakpoints){let r="";for(let a in this.breakpoints[i])r+=a+":"+this.breakpoints[i][a]+" !important;";e+=`
                    @media screen and (max-width: ${i}) {
                        .p-toast[${this.id}] {
                           ${r}
                        }
                    }
                `}this.renderer.setProperty(this.styleElement,"innerHTML",e)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&Ut.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Qt),Z(Ki),Z(St),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-toast"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&Je(W0,5),i&2){let a;Ee(a=Fe())&&(r.containerViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",Q],baseZIndex:[2,"baseZIndex","baseZIndex",We],life:[2,"life","life",We],style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:[2,"preventOpenDuplicates","preventOpenDuplicates",Q],preventDuplicates:[2,"preventDuplicates","preventDuplicates",Q],showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},features:[_t],decls:3,vars:5,consts:[["container",""],[1,"p-toast","p-component",3,"ngClass","ngStyle"],[3,"message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(i,r){i&1&&(g(0,"div",1,0),w(2,Fh,1,10,"p-toastItem",2),x()),i&2&&(ue(r.styleClass),u("ngClass","p-toast-"+r._position)("ngStyle",r.style),p(2),u("ngForOf",r.messages))},dependencies:[at,ii,It,Dh],styles:[`@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}
`],encapsulation:2,data:{animation:[rn("toastAnimation",[ri(":enter, :leave",[H0("@*",U0())])])]},changeDetection:0})}return t})(),Mr=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ai,Di,Oa,Aa,Ma,Rt,ct]})}return t})();var Ra=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["ChevronLeftIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M9.61296 13C9.50997 13.0005 9.40792 12.9804 9.3128 12.9409C9.21767 12.9014 9.13139 12.8433 9.05902 12.7701L3.83313 7.54416C3.68634 7.39718 3.60388 7.19795 3.60388 6.99022C3.60388 6.78249 3.68634 6.58325 3.83313 6.43628L9.05902 1.21039C9.20762 1.07192 9.40416 0.996539 9.60724 1.00012C9.81032 1.00371 10.0041 1.08597 10.1477 1.22959C10.2913 1.37322 10.3736 1.56698 10.3772 1.77005C10.3808 1.97313 10.3054 2.16968 10.1669 2.31827L5.49496 6.99022L10.1669 11.6622C10.3137 11.8091 10.3962 12.0084 10.3962 12.2161C10.3962 12.4238 10.3137 12.6231 10.1669 12.7701C10.0945 12.8433 10.0083 12.9014 9.91313 12.9409C9.81801 12.9804 9.71596 13.0005 9.61296 13Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var Va=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["ChevronRightIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.38708 13C4.28408 13.0005 4.18203 12.9804 4.08691 12.9409C3.99178 12.9014 3.9055 12.8433 3.83313 12.7701C3.68634 12.6231 3.60388 12.4238 3.60388 12.2161C3.60388 12.0084 3.68634 11.8091 3.83313 11.6622L8.50507 6.99022L3.83313 2.31827C3.69467 2.16968 3.61928 1.97313 3.62287 1.77005C3.62645 1.56698 3.70872 1.37322 3.85234 1.22959C3.99596 1.08597 4.18972 1.00371 4.3928 1.00012C4.59588 0.996539 4.79242 1.07192 4.94102 1.21039L10.1669 6.43628C10.3137 6.58325 10.3962 6.78249 10.3962 6.99022C10.3962 7.19795 10.3137 7.39718 10.1669 7.54416L4.94102 12.7701C4.86865 12.8433 4.78237 12.9014 4.68724 12.9409C4.59212 12.9804 4.49007 13.0005 4.38708 13Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var yl=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["ChevronUpIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12.2097 10.4113C12.1057 10.4118 12.0027 10.3915 11.9067 10.3516C11.8107 10.3118 11.7237 10.2532 11.6506 10.1792L6.93602 5.46461L2.22139 10.1476C2.07272 10.244 1.89599 10.2877 1.71953 10.2717C1.54307 10.2556 1.3771 10.1808 1.24822 10.0593C1.11933 9.93766 1.035 9.77633 1.00874 9.6011C0.982477 9.42587 1.0158 9.2469 1.10338 9.09287L6.37701 3.81923C6.52533 3.6711 6.72639 3.58789 6.93602 3.58789C7.14565 3.58789 7.3467 3.6711 7.49502 3.81923L12.7687 9.09287C12.9168 9.24119 13 9.44225 13 9.65187C13 9.8615 12.9168 10.0626 12.7687 10.2109C12.616 10.3487 12.4151 10.4207 12.2097 10.4113Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var Pa=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["ChevronDownIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var wl=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["CalendarIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M10.7838 1.51351H9.83783V0.567568C9.83783 0.417039 9.77804 0.272676 9.6716 0.166237C9.56516 0.0597971 9.42079 0 9.27027 0C9.11974 0 8.97538 0.0597971 8.86894 0.166237C8.7625 0.272676 8.7027 0.417039 8.7027 0.567568V1.51351H5.29729V0.567568C5.29729 0.417039 5.2375 0.272676 5.13106 0.166237C5.02462 0.0597971 4.88025 0 4.72973 0C4.5792 0 4.43484 0.0597971 4.3284 0.166237C4.22196 0.272676 4.16216 0.417039 4.16216 0.567568V1.51351H3.21621C2.66428 1.51351 2.13494 1.73277 1.74467 2.12305C1.35439 2.51333 1.13513 3.04266 1.13513 3.59459V11.9189C1.13513 12.4709 1.35439 13.0002 1.74467 13.3905C2.13494 13.7807 2.66428 14 3.21621 14H10.7838C11.3357 14 11.865 13.7807 12.2553 13.3905C12.6456 13.0002 12.8649 12.4709 12.8649 11.9189V3.59459C12.8649 3.04266 12.6456 2.51333 12.2553 2.12305C11.865 1.73277 11.3357 1.51351 10.7838 1.51351ZM3.21621 2.64865H4.16216V3.59459C4.16216 3.74512 4.22196 3.88949 4.3284 3.99593C4.43484 4.10237 4.5792 4.16216 4.72973 4.16216C4.88025 4.16216 5.02462 4.10237 5.13106 3.99593C5.2375 3.88949 5.29729 3.74512 5.29729 3.59459V2.64865H8.7027V3.59459C8.7027 3.74512 8.7625 3.88949 8.86894 3.99593C8.97538 4.10237 9.11974 4.16216 9.27027 4.16216C9.42079 4.16216 9.56516 4.10237 9.6716 3.99593C9.77804 3.88949 9.83783 3.74512 9.83783 3.59459V2.64865H10.7838C11.0347 2.64865 11.2753 2.74831 11.4527 2.92571C11.6301 3.10311 11.7297 3.34371 11.7297 3.59459V5.67568H2.27027V3.59459C2.27027 3.34371 2.36993 3.10311 2.54733 2.92571C2.72473 2.74831 2.96533 2.64865 3.21621 2.64865ZM10.7838 12.8649H3.21621C2.96533 12.8649 2.72473 12.7652 2.54733 12.5878C2.36993 12.4104 2.27027 12.1698 2.27027 11.9189V6.81081H11.7297V11.9189C11.7297 12.1698 11.6301 12.4104 11.4527 12.5878C11.2753 12.7652 11.0347 12.8649 10.7838 12.8649Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var Mh=["container"],Oh=["inputfield"],Ah=["contentWrapper"],Lh=[[["p-header"]],[["p-footer"]]],Rh=["p-header","p-footer"],Vh=(t,n,e,i,r)=>({"p-calendar":!0,"p-input-icon-right":t,"p-calendar-w-btn":n,"p-calendar-timeonly":e,"p-calendar-disabled":i,"p-focus":r}),Ph=t=>({clickCallBack:t}),Bh=t=>({"p-datepicker-icon":t}),Nh=(t,n,e,i,r,a)=>({"p-datepicker p-component":!0,"p-datepicker-inline":t,"p-disabled":n,"p-datepicker-timeonly":e,"p-datepicker-multiple-month":i,"p-datepicker-monthpicker":r,"p-datepicker-touch-ui":a}),j0=(t,n)=>({showTransitionParams:t,hideTransitionParams:n}),Uh=t=>({value:"visibleTouchUI",params:t}),Hh=t=>({value:"visible",params:t}),Cl=t=>({$implicit:t}),zh=(t,n)=>({"p-datepicker-other-month":t,"p-datepicker-today":n}),Wh=(t,n)=>({"p-highlight p-datepicker-current-day":t,"p-disabled":n}),G0=(t,n)=>({"p-highlight":t,"p-disabled":n}),K0=t=>[t];function jh(t,n){if(t&1){let e=le();g(0,"TimesIcon",11),G("click",function(){S(e);let r=f(3);return I(r.clear())}),x()}t&2&&u("styleClass","p-calendar-clear-icon")}function Kh(t,n){}function Gh(t,n){t&1&&w(0,Kh,0,0,"ng-template")}function $h(t,n){if(t&1){let e=le();g(0,"span",12),G("click",function(){S(e);let r=f(3);return I(r.clear())}),w(1,Gh,1,0,null,13),x()}if(t&2){let e=f(3);p(),u("ngTemplateOutlet",e.clearIconTemplate)}}function Yh(t,n){if(t&1&&(_e(0),w(1,jh,1,1,"TimesIcon",9)(2,$h,2,1,"span",10),ge()),t&2){let e=f(2);p(),u("ngIf",!e.clearIconTemplate),p(),u("ngIf",e.clearIconTemplate)}}function Xh(t,n){if(t&1&&N(0,"span",16),t&2){let e=f(3);u("ngClass",e.icon)}}function qh(t,n){t&1&&N(0,"CalendarIcon")}function Zh(t,n){}function Qh(t,n){t&1&&w(0,Zh,0,0,"ng-template")}function Jh(t,n){if(t&1&&(_e(0),w(1,qh,1,0,"CalendarIcon",7)(2,Qh,1,0,null,13),ge()),t&2){let e=f(3);p(),u("ngIf",!e.triggerIconTemplate),p(),u("ngTemplateOutlet",e.triggerIconTemplate)}}function em(t,n){if(t&1){let e=le();g(0,"button",14),G("click",function(r){S(e),f();let a=vt(1),s=f();return I(s.onButtonClick(r,a))}),w(1,Xh,1,1,"span",15)(2,Jh,3,2,"ng-container",7),x()}if(t&2){let e,i=f(2);u("disabled",i.disabled),V("aria-label",i.iconButtonAriaLabel)("aria-expanded",(e=i.overlayVisible)!==null&&e!==void 0?e:!1)("aria-controls",i.overlayVisible?i.panelId:null),p(),u("ngIf",i.icon),p(),u("ngIf",!i.icon)}}function tm(t,n){if(t&1){let e=le();g(0,"CalendarIcon",19),G("click",function(r){S(e);let a=f(3);return I(a.onButtonClick(r))}),x()}if(t&2){let e=f(3);u("ngClass",Le(1,Bh,e.showOnFocus))}}function im(t,n){t&1&&ye(0)}function nm(t,n){if(t&1&&(_e(0),w(1,tm,1,3,"CalendarIcon",17)(2,im,1,0,"ng-container",18),ge()),t&2){let e=f(2);p(),u("ngIf",!e.inputIconTemplate),p(),u("ngTemplateOutlet",e.inputIconTemplate)("ngTemplateOutletContext",Le(3,Ph,e.onButtonClick.bind(e)))}}function rm(t,n){if(t&1){let e=le();g(0,"input",6,1),G("focus",function(r){S(e);let a=f();return I(a.onInputFocus(r))})("keydown",function(r){S(e);let a=f();return I(a.onInputKeydown(r))})("click",function(){S(e);let r=f();return I(r.onInputClick())})("blur",function(r){S(e);let a=f();return I(a.onInputBlur(r))})("input",function(r){S(e);let a=f();return I(a.onUserInput(r))}),x(),w(2,Yh,3,2,"ng-container",7)(3,em,3,6,"button",8)(4,nm,3,5,"ng-container",7)}if(t&2){let e,i=f();ue(i.inputStyleClass),u("value",i.inputFieldValue)("readonly",i.readonlyInput)("ngStyle",i.inputStyle)("placeholder",i.placeholder||"")("disabled",i.disabled)("ngClass",i.inputClass)("autofocus",i.autofocus),V("id",i.inputId)("name",i.name)("required",i.required)("aria-required",i.required)("aria-expanded",(e=i.overlayVisible)!==null&&e!==void 0?e:!1)("aria-controls",i.overlayVisible?i.panelId:null)("aria-labelledby",i.ariaLabelledBy)("aria-label",i.ariaLabel)("tabindex",i.tabindex)("inputmode",i.touchUI?"off":null),p(2),u("ngIf",i.showClear&&!i.disabled&&i.value!=null),p(),u("ngIf",i.showIcon&&i.iconDisplay==="button"),p(),u("ngIf",i.iconDisplay==="input"&&i.showIcon)}}function am(t,n){t&1&&ye(0)}function sm(t,n){t&1&&N(0,"ChevronLeftIcon",40),t&2&&u("styleClass","p-datepicker-prev-icon")}function om(t,n){}function lm(t,n){t&1&&w(0,om,0,0,"ng-template")}function cm(t,n){if(t&1&&(g(0,"span",41),w(1,lm,1,0,null,13),x()),t&2){let e=f(5);p(),u("ngTemplateOutlet",e.previousIconTemplate)}}function dm(t,n){if(t&1){let e=le();g(0,"button",38),G("keydown",function(r){S(e);let a=f(4);return I(a.onContainerButtonKeydown(r))})("click",function(r){S(e);let a=f(4);return I(a.onPrevButtonClick(r))}),w(1,sm,1,1,"ChevronLeftIcon",35)(2,cm,2,1,"span",39),x()}if(t&2){let e=f(4);V("aria-label",e.prevIconAriaLabel),p(),u("ngIf",!e.previousIconTemplate),p(),u("ngIf",e.previousIconTemplate)}}function pm(t,n){if(t&1){let e=le();g(0,"button",42),G("click",function(r){S(e);let a=f(4);return I(a.switchToMonthView(r))})("keydown",function(r){S(e);let a=f(4);return I(a.onContainerButtonKeydown(r))}),Y(1),x()}if(t&2){let e=f().$implicit,i=f(3);u("disabled",i.switchViewButtonDisabled()),V("aria-label",i.getTranslation("chooseMonth")),p(),He(" ",i.getMonthName(e.month)," ")}}function um(t,n){if(t&1){let e=le();g(0,"button",43),G("click",function(r){S(e);let a=f(4);return I(a.switchToYearView(r))})("keydown",function(r){S(e);let a=f(4);return I(a.onContainerButtonKeydown(r))}),Y(1),x()}if(t&2){let e=f().$implicit,i=f(3);u("disabled",i.switchViewButtonDisabled()),V("aria-label",i.getTranslation("chooseYear")),p(),He(" ",i.getYear(e)," ")}}function fm(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f(5);p(),dr("",e.yearPickerValues()[0]," - ",e.yearPickerValues()[e.yearPickerValues().length-1],"")}}function hm(t,n){t&1&&ye(0)}function mm(t,n){if(t&1&&(g(0,"span",44),w(1,fm,2,2,"ng-container",7)(2,hm,1,0,"ng-container",18),x()),t&2){let e=f(4);p(),u("ngIf",!e.decadeTemplate),p(),u("ngTemplateOutlet",e.decadeTemplate)("ngTemplateOutletContext",Le(3,Cl,e.yearPickerValues))}}function _m(t,n){t&1&&N(0,"ChevronRightIcon",40),t&2&&u("styleClass","p-datepicker-next-icon")}function gm(t,n){}function xm(t,n){t&1&&w(0,gm,0,0,"ng-template")}function vm(t,n){if(t&1&&(g(0,"span",45),w(1,xm,1,0,null,13),x()),t&2){let e=f(4);p(),u("ngTemplateOutlet",e.nextIconTemplate)}}function bm(t,n){if(t&1&&(g(0,"th",51)(1,"span"),Y(2),x()()),t&2){let e=f(5);p(2),be(e.getTranslation("weekHeader"))}}function ym(t,n){if(t&1&&(g(0,"th",52)(1,"span"),Y(2),x()()),t&2){let e=n.$implicit;p(2),be(e)}}function wm(t,n){if(t&1&&(g(0,"td",55)(1,"span",56),Y(2),x()()),t&2){let e=f().index,i=f(2).$implicit;p(2),He(" ",i.weekNumbers[e]," ")}}function Cm(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f(2).$implicit;p(),be(e.day)}}function Tm(t,n){t&1&&ye(0)}function Sm(t,n){if(t&1&&(_e(0),w(1,Tm,1,0,"ng-container",18),ge()),t&2){let e=f(2).$implicit,i=f(6);p(),u("ngTemplateOutlet",i.dateTemplate)("ngTemplateOutletContext",Le(2,Cl,e))}}function Im(t,n){t&1&&ye(0)}function km(t,n){if(t&1&&(_e(0),w(1,Im,1,0,"ng-container",18),ge()),t&2){let e=f(2).$implicit,i=f(6);p(),u("ngTemplateOutlet",i.disabledDateTemplate)("ngTemplateOutletContext",Le(2,Cl,e))}}function Em(t,n){if(t&1&&(g(0,"div",59),Y(1),x()),t&2){let e=f(2).$implicit;p(),He(" ",e.day," ")}}function Fm(t,n){if(t&1){let e=le();_e(0),g(1,"span",57),G("click",function(r){S(e);let a=f().$implicit,s=f(6);return I(s.onDateSelect(r,a))})("keydown",function(r){S(e);let a=f().$implicit,s=f(3).index,o=f(3);return I(o.onDateCellKeydown(r,a,s))}),w(2,Cm,2,1,"ng-container",7)(3,Sm,2,4,"ng-container",7)(4,km,2,4,"ng-container",7),x(),w(5,Em,2,1,"div",58),ge()}if(t&2){let e=f().$implicit,i=f(6);p(),u("ngClass",pt(6,Wh,i.isSelected(e)&&e.selectable,!e.selectable)),V("data-date",i.formatDateKey(i.formatDateMetaToDate(e))),p(),u("ngIf",!i.dateTemplate&&(e.selectable||!i.disabledDateTemplate)),p(),u("ngIf",e.selectable||!i.disabledDateTemplate),p(),u("ngIf",!e.selectable),p(),u("ngIf",i.isSelected(e))}}function Dm(t,n){if(t&1&&(g(0,"td",16),w(1,Fm,6,9,"ng-container",7),x()),t&2){let e=n.$implicit,i=f(6);u("ngClass",pt(3,zh,e.otherMonth,e.today)),V("aria-label",e.day),p(),u("ngIf",e.otherMonth?i.showOtherMonths:!0)}}function Mm(t,n){if(t&1&&(g(0,"tr"),w(1,wm,3,1,"td",53)(2,Dm,2,6,"td",54),x()),t&2){let e=n.$implicit,i=f(5);p(),u("ngIf",i.showWeek),p(),u("ngForOf",e)}}function Om(t,n){if(t&1&&(g(0,"div",46)(1,"table",47)(2,"thead")(3,"tr"),w(4,bm,3,1,"th",48)(5,ym,3,1,"th",49),x()(),g(6,"tbody"),w(7,Mm,3,2,"tr",50),x()()()),t&2){let e=f().$implicit,i=f(3);p(4),u("ngIf",i.showWeek),p(),u("ngForOf",i.weekDays),p(2),u("ngForOf",e.dates)}}function Am(t,n){if(t&1){let e=le();g(0,"div",27)(1,"div",28),w(2,dm,3,3,"button",29),g(3,"div",30),w(4,pm,2,3,"button",31)(5,um,2,3,"button",32)(6,mm,3,5,"span",33),x(),g(7,"button",34),G("keydown",function(r){S(e);let a=f(3);return I(a.onContainerButtonKeydown(r))})("click",function(r){S(e);let a=f(3);return I(a.onNextButtonClick(r))}),w(8,_m,1,1,"ChevronRightIcon",35)(9,vm,2,1,"span",36),x()(),w(10,Om,8,3,"div",37),x()}if(t&2){let e=n.index,i=f(3);p(2),u("ngIf",e===0),p(2),u("ngIf",i.currentView==="date"),p(),u("ngIf",i.currentView!=="year"),p(),u("ngIf",i.currentView==="year"),p(),Jr("display",i.numberOfMonths===1||e===i.numberOfMonths-1?"inline-flex":"none"),V("aria-label",i.nextIconAriaLabel),p(),u("ngIf",!i.nextIconTemplate),p(),u("ngIf",i.nextIconTemplate),p(),u("ngIf",i.currentView==="date")}}function Lm(t,n){if(t&1&&(g(0,"div",59),Y(1),x()),t&2){let e=f().$implicit;p(),He(" ",e," ")}}function Rm(t,n){if(t&1){let e=le();g(0,"span",62),G("click",function(r){let a=S(e).index,s=f(4);return I(s.onMonthSelect(r,a))})("keydown",function(r){let a=S(e).index,s=f(4);return I(s.onMonthCellKeydown(r,a))}),Y(1),w(2,Lm,2,1,"div",58),x()}if(t&2){let e=n.$implicit,i=n.index,r=f(4);u("ngClass",pt(3,G0,r.isMonthSelected(i),r.isMonthDisabled(i))),p(),He(" ",e," "),p(),u("ngIf",r.isMonthSelected(i))}}function Vm(t,n){if(t&1&&(g(0,"div",60),w(1,Rm,3,6,"span",61),x()),t&2){let e=f(3);p(),u("ngForOf",e.monthPickerValues())}}function Pm(t,n){if(t&1&&(g(0,"div",59),Y(1),x()),t&2){let e=f().$implicit;p(),He(" ",e," ")}}function Bm(t,n){if(t&1){let e=le();g(0,"span",65),G("click",function(r){let a=S(e).$implicit,s=f(4);return I(s.onYearSelect(r,a))})("keydown",function(r){let a=S(e).$implicit,s=f(4);return I(s.onYearCellKeydown(r,a))}),Y(1),w(2,Pm,2,1,"div",58),x()}if(t&2){let e=n.$implicit,i=f(4);u("ngClass",pt(3,G0,i.isYearSelected(e),i.isYearDisabled(e))),p(),He(" ",e," "),p(),u("ngIf",i.isYearSelected(e))}}function Nm(t,n){if(t&1&&(g(0,"div",63),w(1,Bm,3,6,"span",64),x()),t&2){let e=f(3);p(),u("ngForOf",e.yearPickerValues())}}function Um(t,n){if(t&1&&(_e(0),g(1,"div",23),w(2,Am,11,10,"div",24),x(),w(3,Vm,2,1,"div",25)(4,Nm,2,1,"div",26),ge()),t&2){let e=f(2);p(2),u("ngForOf",e.months),p(),u("ngIf",e.currentView==="month"),p(),u("ngIf",e.currentView==="year")}}function Hm(t,n){t&1&&N(0,"ChevronUpIcon")}function zm(t,n){}function Wm(t,n){t&1&&w(0,zm,0,0,"ng-template")}function jm(t,n){t&1&&(_e(0),Y(1,"0"),ge())}function Km(t,n){t&1&&N(0,"ChevronDownIcon")}function Gm(t,n){}function $m(t,n){t&1&&w(0,Gm,0,0,"ng-template")}function Ym(t,n){t&1&&N(0,"ChevronUpIcon")}function Xm(t,n){}function qm(t,n){t&1&&w(0,Xm,0,0,"ng-template")}function Zm(t,n){t&1&&(_e(0),Y(1,"0"),ge())}function Qm(t,n){t&1&&N(0,"ChevronDownIcon")}function Jm(t,n){}function e1(t,n){t&1&&w(0,Jm,0,0,"ng-template")}function t1(t,n){if(t&1&&(g(0,"div",69)(1,"span"),Y(2),x()()),t&2){let e=f(3);p(2),be(e.timeSeparator)}}function i1(t,n){t&1&&N(0,"ChevronUpIcon")}function n1(t,n){}function r1(t,n){t&1&&w(0,n1,0,0,"ng-template")}function a1(t,n){t&1&&(_e(0),Y(1,"0"),ge())}function s1(t,n){t&1&&N(0,"ChevronDownIcon")}function o1(t,n){}function l1(t,n){t&1&&w(0,o1,0,0,"ng-template")}function c1(t,n){if(t&1){let e=le();g(0,"div",74)(1,"button",68),G("keydown",function(r){S(e);let a=f(3);return I(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){S(e);let a=f(3);return I(a.incrementSecond(r))})("keydown.space",function(r){S(e);let a=f(3);return I(a.incrementSecond(r))})("mousedown",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseDown(r,2,1))})("mouseup",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){S(e);let r=f(3);return I(r.onTimePickerElementMouseLeave())}),w(2,i1,1,0,"ChevronUpIcon",7)(3,r1,1,0,null,13),x(),g(4,"span"),w(5,a1,2,0,"ng-container",7),Y(6),x(),g(7,"button",68),G("keydown",function(r){S(e);let a=f(3);return I(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){S(e);let a=f(3);return I(a.decrementSecond(r))})("keydown.space",function(r){S(e);let a=f(3);return I(a.decrementSecond(r))})("mousedown",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseDown(r,2,-1))})("mouseup",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){S(e);let a=f(3);return I(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){S(e);let r=f(3);return I(r.onTimePickerElementMouseLeave())}),w(8,s1,1,0,"ChevronDownIcon",7)(9,l1,1,0,null,13),x()()}if(t&2){let e=f(3);p(),V("aria-label",e.getTranslation("nextSecond")),p(),u("ngIf",!e.incrementIconTemplate),p(),u("ngTemplateOutlet",e.incrementIconTemplate),p(2),u("ngIf",e.currentSecond<10),p(),be(e.currentSecond),p(),V("aria-label",e.getTranslation("prevSecond")),p(),u("ngIf",!e.decrementIconTemplate),p(),u("ngTemplateOutlet",e.decrementIconTemplate)}}function d1(t,n){t&1&&N(0,"ChevronUpIcon")}function p1(t,n){}function u1(t,n){t&1&&w(0,p1,0,0,"ng-template")}function f1(t,n){t&1&&N(0,"ChevronDownIcon")}function h1(t,n){}function m1(t,n){t&1&&w(0,h1,0,0,"ng-template")}function _1(t,n){if(t&1){let e=le();g(0,"div",75)(1,"button",76),G("keydown",function(r){S(e);let a=f(3);return I(a.onContainerButtonKeydown(r))})("click",function(r){S(e);let a=f(3);return I(a.toggleAMPM(r))})("keydown.enter",function(r){S(e);let a=f(3);return I(a.toggleAMPM(r))}),w(2,d1,1,0,"ChevronUpIcon",7)(3,u1,1,0,null,13),x(),g(4,"span"),Y(5),x(),g(6,"button",76),G("keydown",function(r){S(e);let a=f(3);return I(a.onContainerButtonKeydown(r))})("click",function(r){S(e);let a=f(3);return I(a.toggleAMPM(r))})("keydown.enter",function(r){S(e);let a=f(3);return I(a.toggleAMPM(r))}),w(7,f1,1,0,"ChevronDownIcon",7)(8,m1,1,0,null,13),x()()}if(t&2){let e=f(3);p(),V("aria-label",e.getTranslation("am")),p(),u("ngIf",!e.incrementIconTemplate),p(),u("ngTemplateOutlet",e.incrementIconTemplate),p(2),be(e.pm?"PM":"AM"),p(),V("aria-label",e.getTranslation("pm")),p(),u("ngIf",!e.decrementIconTemplate),p(),u("ngTemplateOutlet",e.decrementIconTemplate)}}function g1(t,n){if(t&1){let e=le();g(0,"div",66)(1,"div",67)(2,"button",68),G("keydown",function(r){S(e);let a=f(2);return I(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){S(e);let a=f(2);return I(a.incrementHour(r))})("keydown.space",function(r){S(e);let a=f(2);return I(a.incrementHour(r))})("mousedown",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseDown(r,0,1))})("mouseup",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){S(e);let r=f(2);return I(r.onTimePickerElementMouseLeave())}),w(3,Hm,1,0,"ChevronUpIcon",7)(4,Wm,1,0,null,13),x(),g(5,"span"),w(6,jm,2,0,"ng-container",7),Y(7),x(),g(8,"button",68),G("keydown",function(r){S(e);let a=f(2);return I(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){S(e);let a=f(2);return I(a.decrementHour(r))})("keydown.space",function(r){S(e);let a=f(2);return I(a.decrementHour(r))})("mousedown",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseDown(r,0,-1))})("mouseup",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){S(e);let r=f(2);return I(r.onTimePickerElementMouseLeave())}),w(9,Km,1,0,"ChevronDownIcon",7)(10,$m,1,0,null,13),x()(),g(11,"div",69)(12,"span"),Y(13),x()(),g(14,"div",70)(15,"button",68),G("keydown",function(r){S(e);let a=f(2);return I(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){S(e);let a=f(2);return I(a.incrementMinute(r))})("keydown.space",function(r){S(e);let a=f(2);return I(a.incrementMinute(r))})("mousedown",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseDown(r,1,1))})("mouseup",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){S(e);let r=f(2);return I(r.onTimePickerElementMouseLeave())}),w(16,Ym,1,0,"ChevronUpIcon",7)(17,qm,1,0,null,13),x(),g(18,"span"),w(19,Zm,2,0,"ng-container",7),Y(20),x(),g(21,"button",68),G("keydown",function(r){S(e);let a=f(2);return I(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){S(e);let a=f(2);return I(a.decrementMinute(r))})("keydown.space",function(r){S(e);let a=f(2);return I(a.decrementMinute(r))})("mousedown",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseDown(r,1,-1))})("mouseup",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){S(e);let a=f(2);return I(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){S(e);let r=f(2);return I(r.onTimePickerElementMouseLeave())}),w(22,Qm,1,0,"ChevronDownIcon",7)(23,e1,1,0,null,13),x()(),w(24,t1,3,1,"div",71)(25,c1,10,8,"div",72)(26,_1,9,7,"div",73),x()}if(t&2){let e=f(2);p(2),V("aria-label",e.getTranslation("nextHour")),p(),u("ngIf",!e.incrementIconTemplate),p(),u("ngTemplateOutlet",e.incrementIconTemplate),p(2),u("ngIf",e.currentHour<10),p(),be(e.currentHour),p(),V("aria-label",e.getTranslation("prevHour")),p(),u("ngIf",!e.decrementIconTemplate),p(),u("ngTemplateOutlet",e.decrementIconTemplate),p(3),be(e.timeSeparator),p(2),V("aria-label",e.getTranslation("nextMinute")),p(),u("ngIf",!e.incrementIconTemplate),p(),u("ngTemplateOutlet",e.incrementIconTemplate),p(2),u("ngIf",e.currentMinute<10),p(),be(e.currentMinute),p(),V("aria-label",e.getTranslation("prevMinute")),p(),u("ngIf",!e.decrementIconTemplate),p(),u("ngTemplateOutlet",e.decrementIconTemplate),p(),u("ngIf",e.showSeconds),p(),u("ngIf",e.showSeconds),p(),u("ngIf",e.hourFormat=="12")}}function x1(t,n){if(t&1){let e=le();g(0,"div",77)(1,"button",78),G("keydown",function(r){S(e);let a=f(2);return I(a.onContainerButtonKeydown(r))})("click",function(r){S(e);let a=f(2);return I(a.onTodayButtonClick(r))}),x(),g(2,"button",78),G("keydown",function(r){S(e);let a=f(2);return I(a.onContainerButtonKeydown(r))})("click",function(r){S(e);let a=f(2);return I(a.onClearButtonClick(r))}),x()()}if(t&2){let e=f(2);p(),u("label",e.getTranslation("today"))("ngClass",Le(4,K0,e.todayButtonStyleClass)),p(),u("label",e.getTranslation("clear"))("ngClass",Le(6,K0,e.clearButtonStyleClass))}}function v1(t,n){t&1&&ye(0)}function b1(t,n){if(t&1){let e=le();g(0,"div",20,2),G("@overlayAnimation.start",function(r){S(e);let a=f();return I(a.onOverlayAnimationStart(r))})("@overlayAnimation.done",function(r){S(e);let a=f();return I(a.onOverlayAnimationDone(r))})("click",function(r){S(e);let a=f();return I(a.onOverlayClick(r))}),wi(2),w(3,am,1,0,"ng-container",13)(4,Um,5,3,"ng-container",7)(5,g1,27,20,"div",21)(6,x1,3,8,"div",22),wi(7,1),w(8,v1,1,0,"ng-container",13),x()}if(t&2){let e=f();ue(e.panelStyleClass),u("ngStyle",e.panelStyle)("ngClass",ur(15,Nh,e.inline,e.disabled,e.timeOnly,e.numberOfMonths>1,e.view==="month",e.touchUI))("@overlayAnimation",e.touchUI?Le(25,Uh,pt(22,j0,e.showTransitionOptions,e.hideTransitionOptions)):Le(30,Hh,pt(27,j0,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.inline===!0),V("id",e.panelId)("aria-label",e.getTranslation("chooseDate"))("role",e.inline?null:"dialog")("aria-modal",e.inline?null:"true"),p(3),u("ngTemplateOutlet",e.headerTemplate),p(),u("ngIf",!e.timeOnly),p(),u("ngIf",(e.showTime||e.timeOnly)&&e.currentView==="date"),p(),u("ngIf",e.showButtonBar),p(2),u("ngTemplateOutlet",e.footerTemplate)}}var y1={provide:In,useExisting:ln(()=>Tl),multi:!0},Tl=(()=>{class t{document;el;renderer;cd;zone;config;overlayService;iconDisplay="button";style;styleClass;inputStyle;inputId;name;inputStyleClass;placeholder;ariaLabelledBy;ariaLabel;iconAriaLabel;disabled;dateFormat;multipleSeparator=",";rangeSeparator="-";inline=!1;showOtherMonths=!0;selectOtherMonths;showIcon;icon;appendTo;readonlyInput;shortYearCutoff="+10";monthNavigator;yearNavigator;hourFormat="24";timeOnly;stepYearPicker=10;stepHour=1;stepMinute=1;stepSecond=1;showSeconds=!1;required;showOnFocus=!0;showWeek=!1;startWeekFromFirstDayOfYear=!1;showClear=!1;dataType="date";selectionMode="single";maxDateCount;showButtonBar;todayButtonStyleClass="p-button-text";clearButtonStyleClass="p-button-text";autofocus;autoZIndex=!0;baseZIndex=0;panelStyleClass;panelStyle;keepInvalid=!1;hideOnDateTimeSelect=!0;touchUI;timeSeparator=":";focusTrap=!0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";tabindex;variant="outlined";get minDate(){return this._minDate}set minDate(e){this._minDate=e,this.currentMonth!=null&&this.currentMonth!=null&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=e,this.currentMonth!=null&&this.currentMonth!=null&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDates(){return this._disabledDates}set disabledDates(e){this._disabledDates=e,this.currentMonth!=null&&this.currentMonth!=null&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDays(){return this._disabledDays}set disabledDays(e){this._disabledDays=e,this.currentMonth!=null&&this.currentMonth!=null&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get yearRange(){return this._yearRange}set yearRange(e){if(this._yearRange=e,e){let i=e.split(":"),r=parseInt(i[0]),a=parseInt(i[1]);this.populateYearOptions(r,a)}}get showTime(){return this._showTime}set showTime(e){this._showTime=e,this.currentHour===void 0&&this.initTime(this.value||new Date),this.updateInputfield()}get responsiveOptions(){return this._responsiveOptions}set responsiveOptions(e){this._responsiveOptions=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get numberOfMonths(){return this._numberOfMonths}set numberOfMonths(e){this._numberOfMonths=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get firstDayOfWeek(){return this._firstDayOfWeek}set firstDayOfWeek(e){this._firstDayOfWeek=e,this.createWeekDays()}set locale(e){console.warn("Locale property has no effect, use new i18n API instead.")}get view(){return this._view}set view(e){this._view=e,this.currentView=this._view}get defaultDate(){return this._defaultDate}set defaultDate(e){if(this._defaultDate=e,this.initialized){let i=e||new Date;this.currentMonth=i.getMonth(),this.currentYear=i.getFullYear(),this.initTime(i),this.createMonths(this.currentMonth,this.currentYear)}}get inputClass(){return{"p-inputtext p-component":!0,"p-variant-filled":this.variant==="filled"||this.config.inputStyle()==="filled"}}onFocus=new fe;onBlur=new fe;onClose=new fe;onSelect=new fe;onClear=new fe;onInput=new fe;onTodayClick=new fe;onClearClick=new fe;onMonthChange=new fe;onYearChange=new fe;onClickOutside=new fe;onShow=new fe;templates;containerViewChild;inputfieldViewChild;set content(e){this.contentViewChild=e,this.contentViewChild&&(this.isMonthNavigate?(Promise.resolve(null).then(()=>this.updateFocus()),this.isMonthNavigate=!1):!this.focus&&!this.inline&&this.initFocusableCell())}contentViewChild;value;dates;months;weekDays;currentMonth;currentYear;currentHour;currentMinute;currentSecond;pm;mask;maskClickListener;overlay;responsiveStyleElement;overlayVisible;onModelChange=()=>{};onModelTouched=()=>{};calendarElement;timePickerTimer;documentClickListener;animationEndListener;ticksTo1970;yearOptions;focus;isKeydown;filled;inputFieldValue=null;_minDate;_maxDate;_showTime;_yearRange;preventDocumentListener;dateTemplate;headerTemplate;footerTemplate;disabledDateTemplate;decadeTemplate;previousIconTemplate;nextIconTemplate;triggerIconTemplate;clearIconTemplate;decrementIconTemplate;incrementIconTemplate;inputIconTemplate;_disabledDates;_disabledDays;selectElement;todayElement;focusElement;scrollHandler;documentResizeListener;navigationState=null;isMonthNavigate;initialized;translationSubscription;_locale;_responsiveOptions;currentView;attributeSelector;panelId;_numberOfMonths=1;_firstDayOfWeek;_view="date";preventFocus;_defaultDate;_focusKey=null;window;get locale(){return this._locale}get iconButtonAriaLabel(){return this.iconAriaLabel?this.iconAriaLabel:this.getTranslation("chooseDate")}get prevIconAriaLabel(){return this.currentView==="year"?this.getTranslation("prevDecade"):this.currentView==="month"?this.getTranslation("prevYear"):this.getTranslation("prevMonth")}get nextIconAriaLabel(){return this.currentView==="year"?this.getTranslation("nextDecade"):this.currentView==="month"?this.getTranslation("nextYear"):this.getTranslation("nextMonth")}constructor(e,i,r,a,s,o,l){this.document=e,this.el=i,this.renderer=r,this.cd=a,this.zone=s,this.config=o,this.overlayService=l,this.window=this.document.defaultView}ngOnInit(){this.attributeSelector=ot(),this.panelId=this.attributeSelector+"_panel";let e=this.defaultDate||new Date;this.createResponsiveStyle(),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear(),this.yearOptions=[],this.currentView=this.view,this.view==="date"&&(this.createWeekDays(),this.initTime(e),this.createMonths(this.currentMonth,this.currentYear),this.ticksTo1970=(1969*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.createWeekDays(),this.cd.markForCheck()}),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"date":this.dateTemplate=e.template;break;case"decade":this.decadeTemplate=e.template;break;case"disabledDate":this.disabledDateTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"inputicon":this.inputIconTemplate=e.template;break;case"previousicon":this.previousIconTemplate=e.template;break;case"nexticon":this.nextIconTemplate=e.template;break;case"triggericon":this.triggerIconTemplate=e.template;break;case"clearicon":this.clearIconTemplate=e.template;break;case"decrementicon":this.decrementIconTemplate=e.template;break;case"incrementicon":this.incrementIconTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;default:this.dateTemplate=e.template;break}})}ngAfterViewInit(){this.inline&&(this.contentViewChild&&this.contentViewChild.nativeElement.setAttribute(this.attributeSelector,""),!this.disabled&&!this.inline&&(this.initFocusableCell(),this.numberOfMonths===1&&this.contentViewChild&&this.contentViewChild.nativeElement&&(this.contentViewChild.nativeElement.style.width=R.getOuterWidth(this.containerViewChild?.nativeElement)+"px")))}getTranslation(e){return this.config.getTranslation(e)}populateYearOptions(e,i){this.yearOptions=[];for(let r=e;r<=i;r++)this.yearOptions.push(r)}createWeekDays(){this.weekDays=[];let e=this.getFirstDateOfWeek(),i=this.getTranslation(Yt.DAY_NAMES_MIN);for(let r=0;r<7;r++)this.weekDays.push(i[e]),e=e==6?0:++e}monthPickerValues(){let e=[];for(let i=0;i<=11;i++)e.push(this.config.getTranslation("monthNamesShort")[i]);return e}yearPickerValues(){let e=[],i=this.currentYear-this.currentYear%this.stepYearPicker;for(let r=0;r<this.stepYearPicker;r++)e.push(i+r);return e}createMonths(e,i){this.months=this.months=[];for(let r=0;r<this.numberOfMonths;r++){let a=e+r,s=i;a>11&&(a=a%11-1,s=i+1),this.months.push(this.createMonth(a,s))}}getWeekNumber(e){let i=new Date(e.getTime());if(this.startWeekFromFirstDayOfYear){let a=+this.getFirstDateOfWeek();i.setDate(i.getDate()+6+a-i.getDay())}else i.setDate(i.getDate()+4-(i.getDay()||7));let r=i.getTime();return i.setMonth(0),i.setDate(1),Math.floor(Math.round((r-i.getTime())/864e5)/7)+1}createMonth(e,i){let r=[],a=this.getFirstDayOfMonthIndex(e,i),s=this.getDaysCountInMonth(e,i),o=this.getDaysCountInPrevMonth(e,i),l=1,c=new Date,d=[],h=Math.ceil((s+a)/7);for(let _=0;_<h;_++){let v=[];if(_==0){for(let m=o-a+1;m<=o;m++){let y=this.getPreviousMonthAndYear(e,i);v.push({day:m,month:y.month,year:y.year,otherMonth:!0,today:this.isToday(c,m,y.month,y.year),selectable:this.isSelectable(m,y.month,y.year,!0)})}let b=7-v.length;for(let m=0;m<b;m++)v.push({day:l,month:e,year:i,today:this.isToday(c,l,e,i),selectable:this.isSelectable(l,e,i,!1)}),l++}else for(let b=0;b<7;b++){if(l>s){let m=this.getNextMonthAndYear(e,i);v.push({day:l-s,month:m.month,year:m.year,otherMonth:!0,today:this.isToday(c,l-s,m.month,m.year),selectable:this.isSelectable(l-s,m.month,m.year,!0)})}else v.push({day:l,month:e,year:i,today:this.isToday(c,l,e,i),selectable:this.isSelectable(l,e,i,!1)});l++}this.showWeek&&d.push(this.getWeekNumber(new Date(v[0].year,v[0].month,v[0].day))),r.push(v)}return{month:e,year:i,dates:r,weekNumbers:d}}initTime(e){this.pm=e.getHours()>11,this.showTime?(this.currentMinute=e.getMinutes(),this.currentSecond=e.getSeconds(),this.setCurrentHourPM(e.getHours())):this.timeOnly&&(this.currentMinute=0,this.currentHour=0,this.currentSecond=0)}navBackward(e){if(this.disabled){e.preventDefault();return}this.isMonthNavigate=!0,this.currentView==="month"?(this.decrementYear(),setTimeout(()=>{this.updateFocus()},1)):this.currentView==="year"?(this.decrementYearPickerStep(),setTimeout(()=>{this.updateFocus()},1)):(this.currentMonth===0?(this.currentMonth=11,this.decrementYear()):this.currentMonth--,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear))}navForward(e){if(this.disabled){e.preventDefault();return}this.isMonthNavigate=!0,this.currentView==="month"?(this.incrementYear(),setTimeout(()=>{this.updateFocus()},1)):this.currentView==="year"?(this.incrementYearPickerStep(),setTimeout(()=>{this.updateFocus()},1)):(this.currentMonth===11?(this.currentMonth=0,this.incrementYear()):this.currentMonth++,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear))}decrementYear(){this.currentYear--;let e=this.yearOptions;if(this.yearNavigator&&this.currentYear<e[0]){let i=e[e.length-1]-e[0];this.populateYearOptions(e[0]-i,e[e.length-1]-i)}}decrementYearPickerStep(){this.currentYear=this.currentYear-this.stepYearPicker}incrementYearPickerStep(){this.currentYear=this.currentYear+this.stepYearPicker}incrementYear(){this.currentYear++;let e=this.yearOptions;if(this.yearNavigator&&this.currentYear>e[e.length-1]){let i=e[e.length-1]-e[0];this.populateYearOptions(e[0]+i,e[e.length-1]+i)}}switchToMonthView(e){this.setCurrentView("month"),e.preventDefault()}switchToYearView(e){this.setCurrentView("year"),e.preventDefault()}onDateSelect(e,i){if(this.disabled||!i.selectable){e.preventDefault();return}this.isMultipleSelection()&&this.isSelected(i)?(this.value=this.value.filter((r,a)=>!this.isDateEquals(r,i)),this.value.length===0&&(this.value=null),this.updateModel(this.value)):this.shouldSelectDate(i)&&this.selectDate(i),this.hideOnDateTimeSelect&&(this.isSingleSelection()||this.isRangeSelection()&&this.value[1])&&setTimeout(()=>{e.preventDefault(),this.hideOverlay(),this.mask&&this.disableModality(),this.cd.markForCheck()},150),this.updateInputfield(),e.preventDefault()}shouldSelectDate(e){return this.isMultipleSelection()&&this.maxDateCount!=null?this.maxDateCount>(this.value?this.value.length:0):!0}onMonthSelect(e,i){this.view==="month"?this.onDateSelect(e,{year:this.currentYear,month:i,day:1,selectable:!0}):(this.currentMonth=i,this.createMonths(this.currentMonth,this.currentYear),this.setCurrentView("date"),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}))}onYearSelect(e,i){this.view==="year"?this.onDateSelect(e,{year:i,month:0,day:1,selectable:!0}):(this.currentYear=i,this.setCurrentView("month"),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}))}updateInputfield(){let e="";if(this.value){if(this.isSingleSelection())e=this.formatDateTime(this.value);else if(this.isMultipleSelection())for(let i=0;i<this.value.length;i++){let r=this.formatDateTime(this.value[i]);e+=r,i!==this.value.length-1&&(e+=this.multipleSeparator+" ")}else if(this.isRangeSelection()&&this.value&&this.value.length){let i=this.value[0],r=this.value[1];e=this.formatDateTime(i),r&&(e+=" "+this.rangeSeparator+" "+this.formatDateTime(r))}}this.inputFieldValue=e,this.updateFilledState(),this.inputfieldViewChild&&this.inputfieldViewChild.nativeElement&&(this.inputfieldViewChild.nativeElement.value=this.inputFieldValue)}formatDateTime(e){let i=this.keepInvalid?e:null,r=this.isValidDateForTimeConstraints(e);return this.isValidDate(e)?this.timeOnly?i=this.formatTime(e):(i=this.formatDate(e,this.getDateFormat()),this.showTime&&(i+=" "+this.formatTime(e))):this.dataType==="string"&&(i=e),i=r?i:"",i}formatDateMetaToDate(e){return new Date(e.year,e.month,e.day)}formatDateKey(e){return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`}setCurrentHourPM(e){this.hourFormat=="12"?(this.pm=e>11,e>=12?this.currentHour=e==12?12:e-12:this.currentHour=e==0?12:e):this.currentHour=e}setCurrentView(e){this.currentView=e,this.cd.detectChanges(),this.alignOverlay()}selectDate(e){let i=this.formatDateMetaToDate(e);if(this.showTime&&(this.hourFormat=="12"?this.currentHour===12?i.setHours(this.pm?12:0):i.setHours(this.pm?this.currentHour+12:this.currentHour):i.setHours(this.currentHour),i.setMinutes(this.currentMinute),i.setSeconds(this.currentSecond)),this.minDate&&this.minDate>i&&(i=this.minDate,this.setCurrentHourPM(i.getHours()),this.currentMinute=i.getMinutes(),this.currentSecond=i.getSeconds()),this.maxDate&&this.maxDate<i&&(i=this.maxDate,this.setCurrentHourPM(i.getHours()),this.currentMinute=i.getMinutes(),this.currentSecond=i.getSeconds()),this.isSingleSelection())this.updateModel(i);else if(this.isMultipleSelection())this.updateModel(this.value?[...this.value,i]:[i]);else if(this.isRangeSelection())if(this.value&&this.value.length){let r=this.value[0],a=this.value[1];!a&&i.getTime()>=r.getTime()?a=i:(r=i,a=null),this.updateModel([r,a])}else this.updateModel([i,null]);this.onSelect.emit(i)}updateModel(e){if(this.value=e,this.dataType=="date")this.onModelChange(this.value);else if(this.dataType=="string")if(this.isSingleSelection())this.onModelChange(this.formatDateTime(this.value));else{let i=null;Array.isArray(this.value)&&(i=this.value.map(r=>this.formatDateTime(r))),this.onModelChange(i)}}getFirstDayOfMonthIndex(e,i){let r=new Date;r.setDate(1),r.setMonth(e),r.setFullYear(i);let a=r.getDay()+this.getSundayIndex();return a>=7?a-7:a}getDaysCountInMonth(e,i){return 32-this.daylightSavingAdjust(new Date(i,e,32)).getDate()}getDaysCountInPrevMonth(e,i){let r=this.getPreviousMonthAndYear(e,i);return this.getDaysCountInMonth(r.month,r.year)}getPreviousMonthAndYear(e,i){let r,a;return e===0?(r=11,a=i-1):(r=e-1,a=i),{month:r,year:a}}getNextMonthAndYear(e,i){let r,a;return e===11?(r=0,a=i+1):(r=e+1,a=i),{month:r,year:a}}getSundayIndex(){let e=this.getFirstDateOfWeek();return e>0?7-e:0}isSelected(e){if(this.value){if(this.isSingleSelection())return this.isDateEquals(this.value,e);if(this.isMultipleSelection()){let i=!1;for(let r of this.value)if(i=this.isDateEquals(r,e),i)break;return i}else if(this.isRangeSelection())return this.value[1]?this.isDateEquals(this.value[0],e)||this.isDateEquals(this.value[1],e)||this.isDateBetween(this.value[0],this.value[1],e):this.isDateEquals(this.value[0],e)}else return!1}isComparable(){return this.value!=null&&typeof this.value!="string"}isMonthSelected(e){if(this.isComparable()&&!this.isMultipleSelection()){let[i,r]=this.isRangeSelection()?this.value:[this.value,this.value],a=new Date(this.currentYear,e,1);return a>=i&&a<=(r??i)}return!1}isMonthDisabled(e,i){let r=i??this.currentYear;for(let a=1;a<this.getDaysCountInMonth(e,r)+1;a++)if(this.isSelectable(a,e,r,!1))return!1;return!0}isYearDisabled(e){return Array(12).fill(0).every((i,r)=>this.isMonthDisabled(r,e))}isYearSelected(e){if(!this.isComparable()||this.isMultipleSelection())return!1;let i=this.isRangeSelection()?this.value[0]:this.value;return i?i.getFullYear()===e:!1}isDateEquals(e,i){return e&&Re.isDate(e)?e.getDate()===i.day&&e.getMonth()===i.month&&e.getFullYear()===i.year:!1}isDateBetween(e,i,r){let a=!1;if(Re.isDate(e)&&Re.isDate(i)){let s=this.formatDateMetaToDate(r);return e.getTime()<=s.getTime()&&i.getTime()>=s.getTime()}return a}isSingleSelection(){return this.selectionMode==="single"}isRangeSelection(){return this.selectionMode==="range"}isMultipleSelection(){return this.selectionMode==="multiple"}isToday(e,i,r,a){return e.getDate()===i&&e.getMonth()===r&&e.getFullYear()===a}isSelectable(e,i,r,a){let s=!0,o=!0,l=!0,c=!0;return a&&!this.selectOtherMonths?!1:(this.minDate&&(this.minDate.getFullYear()>r||this.minDate.getFullYear()===r&&this.currentView!="year"&&(this.minDate.getMonth()>i||this.minDate.getMonth()===i&&this.minDate.getDate()>e))&&(s=!1),this.maxDate&&(this.maxDate.getFullYear()<r||this.maxDate.getFullYear()===r&&(this.maxDate.getMonth()<i||this.maxDate.getMonth()===i&&this.maxDate.getDate()<e))&&(o=!1),this.disabledDates&&(l=!this.isDateDisabled(e,i,r)),this.disabledDays&&(c=!this.isDayDisabled(e,i,r)),s&&o&&l&&c)}isDateDisabled(e,i,r){if(this.disabledDates){for(let a of this.disabledDates)if(a.getFullYear()===r&&a.getMonth()===i&&a.getDate()===e)return!0}return!1}isDayDisabled(e,i,r){if(this.disabledDays){let s=new Date(r,i,e).getDay();return this.disabledDays.indexOf(s)!==-1}return!1}onInputFocus(e){this.focus=!0,this.showOnFocus&&this.showOverlay(),this.onFocus.emit(e)}onInputClick(){this.showOnFocus&&!this.overlayVisible&&this.showOverlay()}onInputBlur(e){this.focus=!1,this.onBlur.emit(e),this.keepInvalid||this.updateInputfield(),this.onModelTouched()}onButtonClick(e,i=this.inputfieldViewChild?.nativeElement){this.overlayVisible?this.hideOverlay():(i.focus(),this.showOverlay())}clear(){this.inputFieldValue=null,this.value=null,this.onModelChange(this.value),this.onClear.emit()}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}getMonthName(e){return this.config.getTranslation("monthNames")[e]}getYear(e){return this.currentView==="month"?this.currentYear:e.year}switchViewButtonDisabled(){return this.numberOfMonths>1||this.disabled}onPrevButtonClick(e){this.navigationState={backward:!0,button:!0},this.navBackward(e)}onNextButtonClick(e){this.navigationState={backward:!1,button:!0},this.navForward(e)}onContainerButtonKeydown(e){switch(e.which){case 9:if(this.inline||this.trapFocus(e),this.inline){let i=R.findSingle(this.containerViewChild?.nativeElement,".p-datepicker-header"),r=e.target;if(this.timeOnly)return;r==i.children[i?.children?.length-1]&&this.initFocusableCell()}break;case 27:this.inputfieldViewChild?.nativeElement.focus(),this.overlayVisible=!1,e.preventDefault();break;default:break}}onInputKeydown(e){this.isKeydown=!0,e.keyCode===40&&this.contentViewChild?this.trapFocus(e):e.keyCode===27?this.overlayVisible&&(this.inputfieldViewChild?.nativeElement.focus(),this.overlayVisible=!1,e.preventDefault()):e.keyCode===13?this.overlayVisible&&(this.overlayVisible=!1,e.preventDefault()):e.keyCode===9&&this.contentViewChild&&(R.getFocusableElements(this.contentViewChild.nativeElement).forEach(i=>i.tabIndex="-1"),this.overlayVisible&&(this.overlayVisible=!1))}onDateCellKeydown(e,i,r){let a=e.currentTarget,s=a.parentElement,o=this.formatDateMetaToDate(i);switch(e.which){case 40:{a.tabIndex="-1";let b=R.index(s),m=s.parentElement.nextElementSibling;if(m){let y=m.children[b].children[0];R.hasClass(y,"p-disabled")?(this.navigationState={backward:!1},this.navForward(e)):(m.children[b].children[0].tabIndex="0",m.children[b].children[0].focus())}else this.navigationState={backward:!1},this.navForward(e);e.preventDefault();break}case 38:{a.tabIndex="-1";let b=R.index(s),m=s.parentElement.previousElementSibling;if(m){let y=m.children[b].children[0];R.hasClass(y,"p-disabled")?(this.navigationState={backward:!0},this.navBackward(e)):(y.tabIndex="0",y.focus())}else this.navigationState={backward:!0},this.navBackward(e);e.preventDefault();break}case 37:{a.tabIndex="-1";let b=s.previousElementSibling;if(b){let m=b.children[0];R.hasClass(m,"p-disabled")||R.hasClass(m.parentElement,"p-datepicker-weeknumber")?this.navigateToMonth(!0,r):(m.tabIndex="0",m.focus())}else this.navigateToMonth(!0,r);e.preventDefault();break}case 39:{a.tabIndex="-1";let b=s.nextElementSibling;if(b){let m=b.children[0];R.hasClass(m,"p-disabled")?this.navigateToMonth(!1,r):(m.tabIndex="0",m.focus())}else this.navigateToMonth(!1,r);e.preventDefault();break}case 13:case 32:{this.onDateSelect(e,i),e.preventDefault();break}case 27:{this.inputfieldViewChild?.nativeElement.focus(),this.overlayVisible=!1,e.preventDefault();break}case 9:{this.inline||this.trapFocus(e);break}case 33:{a.tabIndex="-1";let b=new Date(o.getFullYear(),o.getMonth()-1,o.getDate()),m=this.formatDateKey(b);this.navigateToMonth(!0,r,`span[data-date='${m}']:not(.p-disabled):not(.p-ink)`),e.preventDefault();break}case 34:{a.tabIndex="-1";let b=new Date(o.getFullYear(),o.getMonth()+1,o.getDate()),m=this.formatDateKey(b);this.navigateToMonth(!1,r,`span[data-date='${m}']:not(.p-disabled):not(.p-ink)`),e.preventDefault();break}case 36:a.tabIndex="-1";let l=new Date(o.getFullYear(),o.getMonth(),1),c=this.formatDateKey(l),d=R.findSingle(a.offsetParent,`span[data-date='${c}']:not(.p-disabled):not(.p-ink)`);d&&(d.tabIndex="0",d.focus()),e.preventDefault();break;case 35:a.tabIndex="-1";let h=new Date(o.getFullYear(),o.getMonth()+1,0),_=this.formatDateKey(h),v=R.findSingle(a.offsetParent,`span[data-date='${_}']:not(.p-disabled):not(.p-ink)`);h&&(v.tabIndex="0",v.focus()),e.preventDefault();break;default:break}}onMonthCellKeydown(e,i){let r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var a=r.parentElement.children,s=R.index(r);let o=a[e.which===40?s+3:s-3];o&&(o.tabIndex="0",o.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let o=r.previousElementSibling;o?(o.tabIndex="0",o.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let o=r.nextElementSibling;o?(o.tabIndex="0",o.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:case 32:{this.onMonthSelect(e,i),e.preventDefault();break}case 27:{this.inputfieldViewChild?.nativeElement.focus(),this.overlayVisible=!1,e.preventDefault();break}case 9:{this.inline||this.trapFocus(e);break}default:break}}onYearCellKeydown(e,i){let r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var a=r.parentElement.children,s=R.index(r);let o=a[e.which===40?s+2:s-2];o&&(o.tabIndex="0",o.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let o=r.previousElementSibling;o?(o.tabIndex="0",o.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let o=r.nextElementSibling;o?(o.tabIndex="0",o.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:case 32:{this.onYearSelect(e,i),e.preventDefault();break}case 27:{this.inputfieldViewChild?.nativeElement.focus(),this.overlayVisible=!1,e.preventDefault();break}case 9:{this.trapFocus(e);break}default:break}}navigateToMonth(e,i,r){if(e)if(this.numberOfMonths===1||i===0)this.navigationState={backward:!0},this._focusKey=r,this.navBackward(event);else{let a=this.contentViewChild.nativeElement.children[i-1];if(r){let s=R.findSingle(a,r);s.tabIndex="0",s.focus()}else{let s=R.find(a,".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),o=s[s.length-1];o.tabIndex="0",o.focus()}}else if(this.numberOfMonths===1||i===this.numberOfMonths-1)this.navigationState={backward:!1},this._focusKey=r,this.navForward(event);else{let a=this.contentViewChild.nativeElement.children[i+1];if(r){let s=R.findSingle(a,r);s.tabIndex="0",s.focus()}else{let s=R.findSingle(a,".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");s.tabIndex="0",s.focus()}}}updateFocus(){let e;if(this.navigationState){if(this.navigationState.button)this.initFocusableCell(),this.navigationState.backward?R.findSingle(this.contentViewChild.nativeElement,".p-datepicker-prev").focus():R.findSingle(this.contentViewChild.nativeElement,".p-datepicker-next").focus();else{if(this.navigationState.backward){let i;this.currentView==="month"?i=R.find(this.contentViewChild.nativeElement,".p-monthpicker .p-monthpicker-month:not(.p-disabled)"):this.currentView==="year"?i=R.find(this.contentViewChild.nativeElement,".p-yearpicker .p-yearpicker-year:not(.p-disabled)"):i=R.find(this.contentViewChild.nativeElement,this._focusKey||".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),i&&i.length>0&&(e=i[i.length-1])}else this.currentView==="month"?e=R.findSingle(this.contentViewChild.nativeElement,".p-monthpicker .p-monthpicker-month:not(.p-disabled)"):this.currentView==="year"?e=R.findSingle(this.contentViewChild.nativeElement,".p-yearpicker .p-yearpicker-year:not(.p-disabled)"):e=R.findSingle(this.contentViewChild.nativeElement,this._focusKey||".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");e&&(e.tabIndex="0",e.focus())}this.navigationState=null,this._focusKey=null}else this.initFocusableCell();this.alignOverlay()}initFocusableCell(){let e=this.contentViewChild?.nativeElement,i;if(this.currentView==="month"){let r=R.find(e,".p-monthpicker .p-monthpicker-month:not(.p-disabled)"),a=R.findSingle(e,".p-monthpicker .p-monthpicker-month.p-highlight");r.forEach(s=>s.tabIndex=-1),i=a||r[0],r.length===0&&R.find(e,'.p-monthpicker .p-monthpicker-month.p-disabled[tabindex = "0"]').forEach(o=>o.tabIndex=-1)}else if(this.currentView==="year"){let r=R.find(e,".p-yearpicker .p-yearpicker-year:not(.p-disabled)"),a=R.findSingle(e,".p-yearpicker .p-yearpicker-year.p-highlight");r.forEach(s=>s.tabIndex=-1),i=a||r[0],r.length===0&&R.find(e,'.p-yearpicker .p-yearpicker-year.p-disabled[tabindex = "0"]').forEach(o=>o.tabIndex=-1)}else if(i=R.findSingle(e,"span.p-highlight"),!i){let r=R.findSingle(e,"td.p-datepicker-today span:not(.p-disabled):not(.p-ink)");r?i=r:i=R.findSingle(e,".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)")}i&&(i.tabIndex="0",!this.preventFocus&&(!this.navigationState||!this.navigationState.button)&&setTimeout(()=>{this.disabled||i.focus()},1),this.preventFocus=!1)}trapFocus(e){let i=R.getFocusableElements(this.contentViewChild.nativeElement);if(i&&i.length>0)if(!i[0].ownerDocument.activeElement)i[0].focus();else{let r=i.indexOf(i[0].ownerDocument.activeElement);if(e.shiftKey)if(r==-1||r===0)if(this.focusTrap)i[i.length-1].focus();else{if(r===-1)return this.hideOverlay();if(r===0)return}else i[r-1].focus();else if(r==-1)if(this.timeOnly)i[0].focus();else{let a=0;for(let s=0;s<i.length;s++)i[s].tagName==="SPAN"&&(a=s);i[a].focus()}else if(r===i.length-1){if(!this.focusTrap&&r!=-1)return this.hideOverlay();i[0].focus()}else i[r+1].focus()}e.preventDefault()}onMonthDropdownChange(e){this.currentMonth=parseInt(e),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}onYearDropdownChange(e){this.currentYear=parseInt(e),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}convertTo24Hour(e,i){return this.hourFormat=="12"?e===12?i?12:0:i?e+12:e:e}constrainTime(e,i,r,a){let s=[e,i,r],o,l=this.value,c=this.convertTo24Hour(e,a),d=this.isRangeSelection(),h=this.isMultipleSelection();(d||h)&&(this.value||(this.value=[new Date,new Date]),d&&(l=this.value[1]||this.value[0]),h&&(l=this.value[this.value.length-1]));let v=l?l.toDateString():null,b=this.minDate&&v&&this.minDate.toDateString()===v,m=this.maxDate&&v&&this.maxDate.toDateString()===v;switch(b&&(o=this.minDate.getHours()>=12),!0){case(b&&o&&this.minDate.getHours()===12&&this.minDate.getHours()>c):s[0]=11;case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()>i):s[1]=this.minDate.getMinutes();case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()===i&&this.minDate.getSeconds()>r):s[2]=this.minDate.getSeconds();break;case(b&&!o&&this.minDate.getHours()-1===c&&this.minDate.getHours()>c):s[0]=11,this.pm=!0;case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()>i):s[1]=this.minDate.getMinutes();case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()===i&&this.minDate.getSeconds()>r):s[2]=this.minDate.getSeconds();break;case(b&&o&&this.minDate.getHours()>c&&c!==12):this.setCurrentHourPM(this.minDate.getHours()),s[0]=this.currentHour;case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()>i):s[1]=this.minDate.getMinutes();case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()===i&&this.minDate.getSeconds()>r):s[2]=this.minDate.getSeconds();break;case(b&&this.minDate.getHours()>c):s[0]=this.minDate.getHours();case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()>i):s[1]=this.minDate.getMinutes();case(b&&this.minDate.getHours()===c&&this.minDate.getMinutes()===i&&this.minDate.getSeconds()>r):s[2]=this.minDate.getSeconds();break;case(m&&this.maxDate.getHours()<c):s[0]=this.maxDate.getHours();case(m&&this.maxDate.getHours()===c&&this.maxDate.getMinutes()<i):s[1]=this.maxDate.getMinutes();case(m&&this.maxDate.getHours()===c&&this.maxDate.getMinutes()===i&&this.maxDate.getSeconds()<r):s[2]=this.maxDate.getSeconds();break}return s}incrementHour(e){let i=this.currentHour??0,r=(this.currentHour??0)+this.stepHour,a=this.pm;this.hourFormat=="24"?r=r>=24?r-24:r:this.hourFormat=="12"&&(i<12&&r>11&&(a=!this.pm),r=r>=13?r-12:r),this.toggleAMPMIfNotMinDate(a),[this.currentHour,this.currentMinute,this.currentSecond]=this.constrainTime(r,this.currentMinute,this.currentSecond,a),e.preventDefault()}toggleAMPMIfNotMinDate(e){let i=this.value;(this.selectionMode=="range"||this.selectionMode=="multiple")&&Array.isArray(i)&&i.length>0&&(i=i[i.length-1]);let r=i?i.toDateString():null;this.minDate&&r&&this.minDate.toDateString()===r&&this.minDate.getHours()>=12?this.pm=!0:this.pm=e}onTimePickerElementMouseDown(e,i,r){this.disabled||(this.repeat(e,null,i,r),e.preventDefault())}onTimePickerElementMouseUp(e){this.disabled||(this.clearTimePickerTimer(),this.updateTime())}onTimePickerElementMouseLeave(){!this.disabled&&this.timePickerTimer&&(this.clearTimePickerTimer(),this.updateTime())}repeat(e,i,r,a){let s=i||500;switch(this.clearTimePickerTimer(),this.timePickerTimer=setTimeout(()=>{this.repeat(e,100,r,a),this.cd.markForCheck()},s),r){case 0:a===1?this.incrementHour(e):this.decrementHour(e);break;case 1:a===1?this.incrementMinute(e):this.decrementMinute(e);break;case 2:a===1?this.incrementSecond(e):this.decrementSecond(e);break}this.updateInputfield()}clearTimePickerTimer(){this.timePickerTimer&&(clearTimeout(this.timePickerTimer),this.timePickerTimer=null)}decrementHour(e){let i=(this.currentHour??0)-this.stepHour,r=this.pm;this.hourFormat=="24"?i=i<0?24+i:i:this.hourFormat=="12"&&(this.currentHour===12&&(r=!this.pm),i=i<=0?12+i:i),this.toggleAMPMIfNotMinDate(r),[this.currentHour,this.currentMinute,this.currentSecond]=this.constrainTime(i,this.currentMinute,this.currentSecond,r),e.preventDefault()}incrementMinute(e){let i=(this.currentMinute??0)+this.stepMinute;i=i>59?i-60:i,[this.currentHour,this.currentMinute,this.currentSecond]=this.constrainTime(this.currentHour,i,this.currentSecond,this.pm),e.preventDefault()}decrementMinute(e){let i=(this.currentMinute??0)-this.stepMinute;i=i<0?60+i:i,[this.currentHour,this.currentMinute,this.currentSecond]=this.constrainTime(this.currentHour,i,this.currentSecond,this.pm),e.preventDefault()}incrementSecond(e){let i=this.currentSecond+this.stepSecond;i=i>59?i-60:i,[this.currentHour,this.currentMinute,this.currentSecond]=this.constrainTime(this.currentHour,this.currentMinute,i,this.pm),e.preventDefault()}decrementSecond(e){let i=this.currentSecond-this.stepSecond;i=i<0?60+i:i,[this.currentHour,this.currentMinute,this.currentSecond]=this.constrainTime(this.currentHour,this.currentMinute,i,this.pm),e.preventDefault()}updateTime(){let e=this.value;this.isRangeSelection()&&(e=this.value[1]||this.value[0]),this.isMultipleSelection()&&(e=this.value[this.value.length-1]),e=e?new Date(e.getTime()):new Date,this.hourFormat=="12"?this.currentHour===12?e.setHours(this.pm?12:0):e.setHours(this.pm?this.currentHour+12:this.currentHour):e.setHours(this.currentHour),e.setMinutes(this.currentMinute),e.setSeconds(this.currentSecond),this.isRangeSelection()&&(this.value[1]?e=[this.value[0],e]:e=[e,null]),this.isMultipleSelection()&&(e=[...this.value.slice(0,-1),e]),this.updateModel(e),this.onSelect.emit(e),this.updateInputfield()}toggleAMPM(e){let i=!this.pm;this.pm=i,[this.currentHour,this.currentMinute,this.currentSecond]=this.constrainTime(this.currentHour,this.currentMinute,this.currentSecond,i),this.updateTime(),e.preventDefault()}onUserInput(e){if(!this.isKeydown)return;this.isKeydown=!1;let i=e.target.value;try{let r=this.parseValueFromString(i);this.isValidSelection(r)?(this.updateModel(r),this.updateUI()):this.keepInvalid&&this.updateModel(r)}catch{let a=this.keepInvalid?i:null;this.updateModel(a)}this.filled=i!=null&&i.length,this.onInput.emit(e)}isValidSelection(e){if(this.isSingleSelection())return this.isSelectable(e.getDate(),e.getMonth(),e.getFullYear(),!1);let i=e.every(r=>this.isSelectable(r.getDate(),r.getMonth(),r.getFullYear(),!1));return i&&this.isRangeSelection()&&(i=e.length===1||e.length>1&&e[1]>=e[0]),i}parseValueFromString(e){if(!e||e.trim().length===0)return null;let i;if(this.isSingleSelection())i=this.parseDateTime(e);else if(this.isMultipleSelection()){let r=e.split(this.multipleSeparator);i=[];for(let a of r)i.push(this.parseDateTime(a.trim()))}else if(this.isRangeSelection()){let r=e.split(" "+this.rangeSeparator+" ");i=[];for(let a=0;a<r.length;a++)i[a]=this.parseDateTime(r[a].trim())}return i}parseDateTime(e){let i,r=e.split(" ");if(this.timeOnly)i=new Date,this.populateTime(i,r[0],r[1]);else{let a=this.getDateFormat();if(this.showTime){let s=this.hourFormat=="12"?r.pop():null,o=r.pop();i=this.parseDate(r.join(" "),a),this.populateTime(i,o,s)}else i=this.parseDate(e,a)}return i}populateTime(e,i,r){if(this.hourFormat=="12"&&!r)throw"Invalid Time";this.pm=r==="PM"||r==="pm";let a=this.parseTime(i);e.setHours(a.hour),e.setMinutes(a.minute),e.setSeconds(a.second)}isValidDate(e){return Re.isDate(e)&&Re.isNotEmpty(e)}updateUI(){let e=this.value;Array.isArray(e)&&(e=e[1]||e[0]);let i=this.defaultDate&&this.isValidDate(this.defaultDate)&&!this.value?this.defaultDate:e&&this.isValidDate(e)?e:new Date;this.currentMonth=i.getMonth(),this.currentYear=i.getFullYear(),this.createMonths(this.currentMonth,this.currentYear),(this.showTime||this.timeOnly)&&(this.setCurrentHourPM(i.getHours()),this.currentMinute=i.getMinutes(),this.currentSecond=i.getSeconds())}showOverlay(){this.overlayVisible||(this.updateUI(),this.touchUI||(this.preventFocus=!0),this.overlayVisible=!0)}hideOverlay(){this.inputfieldViewChild?.nativeElement.focus(),this.overlayVisible=!1,this.clearTimePickerTimer(),this.touchUI&&this.disableModality(),this.cd.markForCheck()}toggle(){this.inline||(this.overlayVisible?this.hideOverlay():(this.showOverlay(),this.inputfieldViewChild?.nativeElement.focus()))}onOverlayAnimationStart(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.overlay=e.element,this.overlay?.setAttribute(this.attributeSelector,""),this.appendOverlay(),this.updateFocus(),this.autoZIndex&&(this.touchUI?Ut.set("modal",this.overlay,this.baseZIndex||this.config.zIndex.modal):Ut.set("overlay",this.overlay,this.baseZIndex||this.config.zIndex.overlay)),this.alignOverlay(),this.onShow.emit(e));break;case"void":this.onOverlayHide(),this.onClose.emit(e);break}}onOverlayAnimationDone(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener());break;case"void":this.autoZIndex&&Ut.clear(e.element);break}}appendOverlay(){this.appendTo&&(this.appendTo==="body"?this.document.body.appendChild(this.overlay):R.appendChild(this.overlay,this.appendTo))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.touchUI?this.enableModality(this.overlay):this.overlay&&(this.appendTo?(this.view==="date"?(this.overlay.style.width||(this.overlay.style.width=R.getOuterWidth(this.overlay)+"px"),this.overlay.style.minWidth||(this.overlay.style.minWidth=R.getOuterWidth(this.inputfieldViewChild?.nativeElement)+"px")):this.overlay.style.width||(this.overlay.style.width=R.getOuterWidth(this.inputfieldViewChild?.nativeElement)+"px"),R.absolutePosition(this.overlay,this.inputfieldViewChild?.nativeElement)):R.relativePosition(this.overlay,this.inputfieldViewChild?.nativeElement))}enableModality(e){!this.mask&&this.touchUI&&(this.mask=this.renderer.createElement("div"),this.renderer.setStyle(this.mask,"zIndex",String(parseInt(e.style.zIndex)-1)),R.addMultipleClasses(this.mask,"p-component-overlay p-datepicker-mask p-datepicker-mask-scrollblocker p-component-overlay p-component-overlay-enter"),this.maskClickListener=this.renderer.listen(this.mask,"click",r=>{this.disableModality(),this.overlayVisible=!1}),this.renderer.appendChild(this.document.body,this.mask),R.blockBodyScroll())}disableModality(){this.mask&&(R.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener||(this.animationEndListener=this.renderer.listen(this.mask,"animationend",this.destroyMask.bind(this))))}destroyMask(){if(!this.mask)return;this.renderer.removeChild(this.document.body,this.mask);let e=this.document.body.children,i;for(let r=0;r<e.length;r++){let a=e[r];if(R.hasClass(a,"p-datepicker-mask-scrollblocker")){i=!0;break}}i||R.unblockBodyScroll(),this.unbindAnimationEndListener(),this.unbindMaskClickListener(),this.mask=null}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}writeValue(e){if(this.value=e,this.value&&typeof this.value=="string")try{this.value=this.parseValueFromString(this.value)}catch{this.keepInvalid&&(this.value=e)}this.updateInputfield(),this.updateUI(),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}getDateFormat(){return this.dateFormat||this.getTranslation("dateFormat")}getFirstDateOfWeek(){return this._firstDayOfWeek||this.getTranslation(Yt.FIRST_DAY_OF_WEEK)}formatDate(e,i){if(!e)return"";let r,a=d=>{let h=r+1<i.length&&i.charAt(r+1)===d;return h&&r++,h},s=(d,h,_)=>{let v=""+h;if(a(d))for(;v.length<_;)v="0"+v;return v},o=(d,h,_,v)=>a(d)?v[h]:_[h],l="",c=!1;if(e)for(r=0;r<i.length;r++)if(c)i.charAt(r)==="'"&&!a("'")?c=!1:l+=i.charAt(r);else switch(i.charAt(r)){case"d":l+=s("d",e.getDate(),2);break;case"D":l+=o("D",e.getDay(),this.getTranslation(Yt.DAY_NAMES_SHORT),this.getTranslation(Yt.DAY_NAMES));break;case"o":l+=s("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":l+=s("m",e.getMonth()+1,2);break;case"M":l+=o("M",e.getMonth(),this.getTranslation(Yt.MONTH_NAMES_SHORT),this.getTranslation(Yt.MONTH_NAMES));break;case"y":l+=a("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":l+=e.getTime();break;case"!":l+=e.getTime()*1e4+this.ticksTo1970;break;case"'":a("'")?l+="'":c=!0;break;default:l+=i.charAt(r)}return l}formatTime(e){if(!e)return"";let i="",r=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return this.hourFormat=="12"&&r>11&&r!=12&&(r-=12),this.hourFormat=="12"?i+=r===0?12:r<10?"0"+r:r:i+=r<10?"0"+r:r,i+=":",i+=a<10?"0"+a:a,this.showSeconds&&(i+=":",i+=s<10?"0"+s:s),this.hourFormat=="12"&&(i+=e.getHours()>11?" PM":" AM"),i}parseTime(e){let i=e.split(":"),r=this.showSeconds?3:2;if(i.length!==r)throw"Invalid time";let a=parseInt(i[0]),s=parseInt(i[1]),o=this.showSeconds?parseInt(i[2]):null;if(isNaN(a)||isNaN(s)||a>23||s>59||this.hourFormat=="12"&&a>12||this.showSeconds&&(isNaN(o)||o>59))throw"Invalid time";return this.hourFormat=="12"&&(a!==12&&this.pm?a+=12:!this.pm&&a===12&&(a-=12)),{hour:a,minute:s,second:o}}parseDate(e,i){if(i==null||e==null)throw"Invalid arguments";if(e=typeof e=="object"?e.toString():e+"",e==="")return null;let r,a,s,o=0,l=typeof this.shortYearCutoff!="string"?this.shortYearCutoff:new Date().getFullYear()%100+parseInt(this.shortYearCutoff,10),c=-1,d=-1,h=-1,_=-1,v=!1,b,m=T=>{let W=r+1<i.length&&i.charAt(r+1)===T;return W&&r++,W},y=T=>{let W=m(T),X=T==="@"?14:T==="!"?20:T==="y"&&W?4:T==="o"?3:2,z=T==="y"?X:1,M=new RegExp("^\\d{"+z+","+X+"}"),K=e.substring(o).match(M);if(!K)throw"Missing number at position "+o;return o+=K[0].length,parseInt(K[0],10)},k=(T,W,X)=>{let z=-1,M=m(T)?X:W,K=[];for(let j=0;j<M.length;j++)K.push([j,M[j]]);K.sort((j,ne)=>-(j[1].length-ne[1].length));for(let j=0;j<K.length;j++){let ne=K[j][1];if(e.substr(o,ne.length).toLowerCase()===ne.toLowerCase()){z=K[j][0],o+=ne.length;break}}if(z!==-1)return z+1;throw"Unknown name at position "+o},F=()=>{if(e.charAt(o)!==i.charAt(r))throw"Unexpected literal at position "+o;o++};for(this.view==="month"&&(h=1),r=0;r<i.length;r++)if(v)i.charAt(r)==="'"&&!m("'")?v=!1:F();else switch(i.charAt(r)){case"d":h=y("d");break;case"D":k("D",this.getTranslation(Yt.DAY_NAMES_SHORT),this.getTranslation(Yt.DAY_NAMES));break;case"o":_=y("o");break;case"m":d=y("m");break;case"M":d=k("M",this.getTranslation(Yt.MONTH_NAMES_SHORT),this.getTranslation(Yt.MONTH_NAMES));break;case"y":c=y("y");break;case"@":b=new Date(y("@")),c=b.getFullYear(),d=b.getMonth()+1,h=b.getDate();break;case"!":b=new Date((y("!")-this.ticksTo1970)/1e4),c=b.getFullYear(),d=b.getMonth()+1,h=b.getDate();break;case"'":m("'")?F():v=!0;break;default:F()}if(o<e.length&&(s=e.substr(o),!/^\s+/.test(s)))throw"Extra/unparsed characters found in date: "+s;if(c===-1?c=new Date().getFullYear():c<100&&(c+=new Date().getFullYear()-new Date().getFullYear()%100+(c<=l?0:-100)),_>-1){d=1,h=_;do{if(a=this.getDaysCountInMonth(c,d-1),h<=a)break;d++,h-=a}while(!0)}if(this.view==="year"&&(d=d===-1?1:d,h=h===-1?1:h),b=this.daylightSavingAdjust(new Date(c,d-1,h)),b.getFullYear()!==c||b.getMonth()+1!==d||b.getDate()!==h)throw"Invalid date";return b}daylightSavingAdjust(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null}updateFilledState(){this.filled=this.inputFieldValue&&this.inputFieldValue!=""}isValidDateForTimeConstraints(e){return this.keepInvalid?!0:(!this.minDate||e>=this.minDate)&&(!this.maxDate||e<=this.maxDate)}onTodayButtonClick(e){let i=new Date,r={day:i.getDate(),month:i.getMonth(),year:i.getFullYear(),otherMonth:i.getMonth()!==this.currentMonth||i.getFullYear()!==this.currentYear,today:!0,selectable:!0};this.createMonths(i.getMonth(),i.getFullYear()),this.onDateSelect(e,r),this.onTodayClick.emit(i)}onClearButtonClick(e){this.updateModel(null),this.updateInputfield(),this.hideOverlay(),this.onClearClick.emit(e)}createResponsiveStyle(){if(this.numberOfMonths>1&&this.responsiveOptions){this.responsiveStyleElement||(this.responsiveStyleElement=this.renderer.createElement("style"),this.responsiveStyleElement.type="text/css",R.setAttribute(this.responsiveStyleElement,"nonce",this.config?.csp()?.nonce),this.renderer.appendChild(this.document.body,this.responsiveStyleElement));let e="";if(this.responsiveOptions){let i=[...this.responsiveOptions].filter(r=>!!(r.breakpoint&&r.numMonths)).sort((r,a)=>-1*r.breakpoint.localeCompare(a.breakpoint,void 0,{numeric:!0}));for(let r=0;r<i.length;r++){let{breakpoint:a,numMonths:s}=i[r],o=`
                        .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${s}) .p-datepicker-next {
                            display: inline-flex !important;
                        }
                    `;for(let l=s;l<this.numberOfMonths;l++)o+=`
                            .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${l+1}) {
                                display: none !important;
                            }
                        `;e+=`
                        @media screen and (max-width: ${a}) {
                            ${o}
                        }
                    `}}this.responsiveStyleElement.innerHTML=e}}destroyResponsiveStyleElement(){this.responsiveStyleElement&&(this.responsiveStyleElement.remove(),this.responsiveStyleElement=null)}bindDocumentClickListener(){this.documentClickListener||this.zone.runOutsideAngular(()=>{let e=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentClickListener=this.renderer.listen(e,"mousedown",i=>{this.isOutsideClicked(i)&&this.overlayVisible&&this.zone.run(()=>{this.hideOverlay(),this.onClickOutside.emit(i),this.cd.markForCheck()})})})}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){!this.documentResizeListener&&!this.touchUI&&(this.documentResizeListener=this.renderer.listen(this.window,"resize",this.onWindowResize.bind(this)))}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new ea(this.containerViewChild?.nativeElement,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}isOutsideClicked(e){return!(this.el.nativeElement.isSameNode(e.target)||this.isNavIconClicked(e)||this.el.nativeElement.contains(e.target)||this.overlay&&this.overlay.contains(e.target))}isNavIconClicked(e){return R.hasClass(e.target,"p-datepicker-prev")||R.hasClass(e.target,"p-datepicker-prev-icon")||R.hasClass(e.target,"p-datepicker-next")||R.hasClass(e.target,"p-datepicker-next-icon")}onWindowResize(){this.overlayVisible&&!R.isTouchDevice()&&this.hideOverlay()}onOverlayHide(){this.currentView=this.view,this.mask&&this.destroyMask(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.overlay&&this.autoZIndex&&Ut.clear(this.overlay),this.destroyResponsiveStyleElement(),this.clearTimePickerTimer(),this.restoreOverlayAppend(),this.onOverlayHide()}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Lt),Z(Qt),Z(St),Z(yi),Z(Nt),Z(ka))};static \u0275cmp=he({type:t,selectors:[["p-calendar"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(Mh,5),Je(Oh,5),Je(Ah,5)),i&2){let a;Ee(a=Fe())&&(r.containerViewChild=a.first),Ee(a=Fe())&&(r.inputfieldViewChild=a.first),Ee(a=Fe())&&(r.content=a.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(i,r){i&2&&cn("p-inputwrapper-filled",r.filled)("p-inputwrapper-focus",r.focus)("p-calendar-clearable",r.showClear&&!r.disabled)},inputs:{iconDisplay:"iconDisplay",style:"style",styleClass:"styleClass",inputStyle:"inputStyle",inputId:"inputId",name:"name",inputStyleClass:"inputStyleClass",placeholder:"placeholder",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",iconAriaLabel:"iconAriaLabel",disabled:[2,"disabled","disabled",Q],dateFormat:"dateFormat",multipleSeparator:"multipleSeparator",rangeSeparator:"rangeSeparator",inline:[2,"inline","inline",Q],showOtherMonths:[2,"showOtherMonths","showOtherMonths",Q],selectOtherMonths:[2,"selectOtherMonths","selectOtherMonths",Q],showIcon:[2,"showIcon","showIcon",Q],icon:"icon",appendTo:"appendTo",readonlyInput:[2,"readonlyInput","readonlyInput",Q],shortYearCutoff:"shortYearCutoff",monthNavigator:[2,"monthNavigator","monthNavigator",Q],yearNavigator:[2,"yearNavigator","yearNavigator",Q],hourFormat:"hourFormat",timeOnly:[2,"timeOnly","timeOnly",Q],stepYearPicker:[2,"stepYearPicker","stepYearPicker",We],stepHour:[2,"stepHour","stepHour",We],stepMinute:[2,"stepMinute","stepMinute",We],stepSecond:[2,"stepSecond","stepSecond",We],showSeconds:[2,"showSeconds","showSeconds",Q],required:[2,"required","required",Q],showOnFocus:[2,"showOnFocus","showOnFocus",Q],showWeek:[2,"showWeek","showWeek",Q],startWeekFromFirstDayOfYear:"startWeekFromFirstDayOfYear",showClear:[2,"showClear","showClear",Q],dataType:"dataType",selectionMode:"selectionMode",maxDateCount:[2,"maxDateCount","maxDateCount",We],showButtonBar:[2,"showButtonBar","showButtonBar",Q],todayButtonStyleClass:"todayButtonStyleClass",clearButtonStyleClass:"clearButtonStyleClass",autofocus:[2,"autofocus","autofocus",Q],autoZIndex:[2,"autoZIndex","autoZIndex",Q],baseZIndex:[2,"baseZIndex","baseZIndex",We],panelStyleClass:"panelStyleClass",panelStyle:"panelStyle",keepInvalid:[2,"keepInvalid","keepInvalid",Q],hideOnDateTimeSelect:[2,"hideOnDateTimeSelect","hideOnDateTimeSelect",Q],touchUI:[2,"touchUI","touchUI",Q],timeSeparator:"timeSeparator",focusTrap:[2,"focusTrap","focusTrap",Q],showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",tabindex:[2,"tabindex","tabindex",We],variant:"variant",minDate:"minDate",maxDate:"maxDate",disabledDates:"disabledDates",disabledDays:"disabledDays",yearRange:"yearRange",showTime:"showTime",responsiveOptions:"responsiveOptions",numberOfMonths:"numberOfMonths",firstDayOfWeek:"firstDayOfWeek",locale:"locale",view:"view",defaultDate:"defaultDate"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClose:"onClose",onSelect:"onSelect",onClear:"onClear",onInput:"onInput",onTodayClick:"onTodayClick",onClearClick:"onClearClick",onMonthChange:"onMonthChange",onYearChange:"onYearChange",onClickOutside:"onClickOutside",onShow:"onShow"},features:[ji([y1]),_t],ngContentSelectors:Rh,decls:4,vars:12,consts:[["container",""],["inputfield",""],["contentWrapper",""],[3,"ngClass","ngStyle"],[3,"ngIf"],[3,"class","ngStyle","ngClass","click",4,"ngIf"],["type","text","role","combobox","aria-autocomplete","none","aria-haspopup","dialog","autocomplete","off","pAutoFocus","",3,"focus","keydown","click","blur","input","value","readonly","ngStyle","placeholder","disabled","ngClass","autofocus"],[4,"ngIf"],["type","button","aria-haspopup","dialog","pButton","","pRipple","","class","p-datepicker-trigger p-button-icon-only","tabindex","0",3,"disabled","click",4,"ngIf"],[3,"styleClass","click",4,"ngIf"],["class","p-calendar-clear-icon",3,"click",4,"ngIf"],[3,"click","styleClass"],[1,"p-calendar-clear-icon",3,"click"],[4,"ngTemplateOutlet"],["type","button","aria-haspopup","dialog","pButton","","pRipple","","tabindex","0",1,"p-datepicker-trigger","p-button-icon-only",3,"click","disabled"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[3,"ngClass","click",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"click","ngClass"],[3,"click","ngStyle","ngClass"],["class","p-timepicker",4,"ngIf"],["class","p-datepicker-buttonbar",4,"ngIf"],[1,"p-datepicker-group-container"],["class","p-datepicker-group",4,"ngFor","ngForOf"],["class","p-monthpicker",4,"ngIf"],["class","p-yearpicker",4,"ngIf"],[1,"p-datepicker-group"],[1,"p-datepicker-header"],["class","p-datepicker-prev p-link","type","button","pRipple","",3,"keydown","click",4,"ngIf"],[1,"p-datepicker-title"],["type","button","class","p-datepicker-month p-link",3,"disabled","click","keydown",4,"ngIf"],["type","button","class","p-datepicker-year p-link",3,"disabled","click","keydown",4,"ngIf"],["class","p-datepicker-decade",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-next","p-link",3,"keydown","click"],[3,"styleClass",4,"ngIf"],["class","p-datepicker-next-icon",4,"ngIf"],["class","p-datepicker-calendar-container",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-prev","p-link",3,"keydown","click"],["class","p-datepicker-prev-icon",4,"ngIf"],[3,"styleClass"],[1,"p-datepicker-prev-icon"],["type","button",1,"p-datepicker-month","p-link",3,"click","keydown","disabled"],["type","button",1,"p-datepicker-year","p-link",3,"click","keydown","disabled"],[1,"p-datepicker-decade"],[1,"p-datepicker-next-icon"],[1,"p-datepicker-calendar-container"],["role","grid",1,"p-datepicker-calendar"],["class","p-datepicker-weekheader p-disabled",4,"ngIf"],["scope","col",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p-datepicker-weekheader","p-disabled"],["scope","col"],["class","p-datepicker-weeknumber",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"p-datepicker-weeknumber"],[1,"p-disabled"],["draggable","false","pRipple","",3,"click","keydown","ngClass"],["class","p-hidden-accessible","aria-live","polite",4,"ngIf"],["aria-live","polite",1,"p-hidden-accessible"],[1,"p-monthpicker"],["class","p-monthpicker-month","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-monthpicker-month",3,"click","keydown","ngClass"],[1,"p-yearpicker"],["class","p-yearpicker-year","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-yearpicker-year",3,"click","keydown","ngClass"],[1,"p-timepicker"],[1,"p-hour-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","keydown.enter","keydown.space","mousedown","mouseup","keyup.enter","keyup.space","mouseleave"],[1,"p-separator"],[1,"p-minute-picker"],["class","p-separator",4,"ngIf"],["class","p-second-picker",4,"ngIf"],["class","p-ampm-picker",4,"ngIf"],[1,"p-second-picker"],[1,"p-ampm-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","click","keydown.enter"],[1,"p-datepicker-buttonbar"],["type","button","pButton","","pRipple","",3,"keydown","click","label","ngClass"]],template:function(i,r){i&1&&(Ni(Lh),g(0,"span",3,0),w(2,rm,5,22,"ng-template",4)(3,b1,9,32,"div",5),x()),i&2&&(ue(r.styleClass),u("ngClass",Ir(6,Vh,r.showIcon&&r.iconDisplay==="input",r.showIcon&&r.iconDisplay==="button",r.timeOnly,r.disabled,r.focus||r.overlayVisible))("ngStyle",r.style),p(2),u("ngIf",!r.inline),p(),u("ngIf",r.inline||r.overlayVisible))},dependencies:()=>[at,ii,rt,bt,It,si,At,Ra,Va,yl,Pa,Rt,wl,Zn],styles:[`@layer primeng{.p-calendar{position:relative;display:inline-flex;max-width:100%}.p-calendar .p-inputtext{flex:1 1 auto;width:1%;text-overflow:ellipsis}.p-calendar-w-btn .p-inputtext{border-top-right-radius:0;border-bottom-right-radius:0}.p-calendar-w-btn .p-datepicker-trigger{border-top-left-radius:0;border-bottom-left-radius:0}.p-fluid .p-calendar{display:flex}.p-fluid .p-calendar .p-inputtext{width:1%}.p-calendar .p-datepicker{min-width:100%}.p-datepicker{width:auto;position:absolute;top:0;left:0}.p-datepicker-inline{display:inline-block;position:static;overflow-x:auto}.p-datepicker-header{display:flex;align-items:center;justify-content:space-between}.p-datepicker-header .p-datepicker-title{margin:0 auto}.p-datepicker-prev,.p-datepicker-next{cursor:pointer;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-datepicker-multiple-month .p-datepicker-group-container .p-datepicker-group{flex:1 1 auto}.p-datepicker-multiple-month .p-datepicker-group-container{display:flex}.p-datepicker table{width:100%;border-collapse:collapse}.p-datepicker td>span{display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0 auto;overflow:hidden;position:relative}.p-monthpicker-month{width:33.3%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-datepicker-buttonbar{display:flex;justify-content:space-between;align-items:center}.p-timepicker{display:flex;justify-content:center;align-items:center}.p-timepicker button{display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-timepicker>div{display:flex;align-items:center;flex-direction:column}.p-datepicker-touch-ui,.p-calendar .p-datepicker-touch-ui{position:fixed;top:50%;left:50%;min-width:80vw;transform:translate(-50%,-50%)}.p-yearpicker-year{width:50%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-calendar-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-datepicker-icon{pointer-events:none}.p-calendar-clearable{position:relative}}
`],encapsulation:2,data:{animation:[rn("overlayAnimation",[_o("visibleTouchUI",qt({transform:"translate(-50%,-50%)",opacity:1})),ri("void => visible",[qt({opacity:0,transform:"scaleY(0.8)"}),li("{{showTransitionParams}}",qt({opacity:1,transform:"*"}))]),ri("visible => void",[li("{{hideTransitionParams}}",qt({opacity:0}))]),ri("void => visibleTouchUI",[qt({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}),li("{{showTransitionParams}}")]),ri("visibleTouchUI => void",[li("{{hideTransitionParams}}",qt({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}))])])]},changeDetection:0})}return t})(),Or=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,Fi,ct,ai,Ra,Va,yl,Pa,Rt,wl,Qn,Fi,ct]})}return t})();var C1=["overlay"],T1=["content"],S1=["*"],I1=(t,n,e,i,r,a,s,o,l,c,d,h,_,v)=>({"p-overlay p-component":!0,"p-overlay-modal p-component-overlay p-component-overlay-enter":t,"p-overlay-center":n,"p-overlay-top":e,"p-overlay-top-start":i,"p-overlay-top-end":r,"p-overlay-bottom":a,"p-overlay-bottom-start":s,"p-overlay-bottom-end":o,"p-overlay-left":l,"p-overlay-left-start":c,"p-overlay-left-end":d,"p-overlay-right":h,"p-overlay-right-start":_,"p-overlay-right-end":v}),k1=(t,n,e)=>({showTransitionParams:t,hideTransitionParams:n,transform:e}),E1=t=>({value:"visible",params:t}),F1=t=>({mode:t}),D1=t=>({$implicit:t});function M1(t,n){t&1&&ye(0)}function O1(t,n){if(t&1){let e=le();g(0,"div",3,1),G("click",function(r){S(e);let a=f(2);return I(a.onOverlayContentClick(r))})("@overlayContentAnimation.start",function(r){S(e);let a=f(2);return I(a.onOverlayContentAnimationStart(r))})("@overlayContentAnimation.done",function(r){S(e);let a=f(2);return I(a.onOverlayContentAnimationDone(r))}),wi(2),w(3,M1,1,0,"ng-container",4),x()}if(t&2){let e=f(2);ue(e.contentStyleClass),u("ngStyle",e.contentStyle)("ngClass","p-overlay-content")("@overlayContentAnimation",Le(11,E1,Ci(7,k1,e.showTransitionOptions,e.hideTransitionOptions,e.transformOptions[e.modal?e.overlayResponsiveDirection:"default"]))),p(3),u("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",Le(15,D1,Le(13,F1,e.overlayMode)))}}function A1(t,n){if(t&1){let e=le();g(0,"div",3,0),G("click",function(){S(e);let r=f();return I(r.onOverlayClick())}),w(2,O1,4,17,"div",2),x()}if(t&2){let e=f();ue(e.styleClass),u("ngStyle",e.style)("ngClass",_s(5,I1,[e.modal,e.modal&&e.overlayResponsiveDirection==="center",e.modal&&e.overlayResponsiveDirection==="top",e.modal&&e.overlayResponsiveDirection==="top-start",e.modal&&e.overlayResponsiveDirection==="top-end",e.modal&&e.overlayResponsiveDirection==="bottom",e.modal&&e.overlayResponsiveDirection==="bottom-start",e.modal&&e.overlayResponsiveDirection==="bottom-end",e.modal&&e.overlayResponsiveDirection==="left",e.modal&&e.overlayResponsiveDirection==="left-start",e.modal&&e.overlayResponsiveDirection==="left-end",e.modal&&e.overlayResponsiveDirection==="right",e.modal&&e.overlayResponsiveDirection==="right-start",e.modal&&e.overlayResponsiveDirection==="right-end"])),p(2),u("ngIf",e.visible)}}var L1={provide:In,useExisting:ln(()=>Sl),multi:!0},R1=En([qt({transform:"{{transform}}",opacity:0}),li("{{showTransitionParams}}")]),V1=En([li("{{hideTransitionParams}}",qt({transform:"{{transform}}",opacity:0}))]),Sl=(()=>{class t{document;platformId;el;renderer;config;overlayService;cd;zone;get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.modalVisible&&(this.modalVisible=!0)}get mode(){return this._mode||this.overlayOptions?.mode}set mode(e){this._mode=e}get style(){return Re.merge(this._style,this.modal?this.overlayResponsiveOptions?.style:this.overlayOptions?.style)}set style(e){this._style=e}get styleClass(){return Re.merge(this._styleClass,this.modal?this.overlayResponsiveOptions?.styleClass:this.overlayOptions?.styleClass)}set styleClass(e){this._styleClass=e}get contentStyle(){return Re.merge(this._contentStyle,this.modal?this.overlayResponsiveOptions?.contentStyle:this.overlayOptions?.contentStyle)}set contentStyle(e){this._contentStyle=e}get contentStyleClass(){return Re.merge(this._contentStyleClass,this.modal?this.overlayResponsiveOptions?.contentStyleClass:this.overlayOptions?.contentStyleClass)}set contentStyleClass(e){this._contentStyleClass=e}get target(){let e=this._target||this.overlayOptions?.target;return e===void 0?"@prev":e}set target(e){this._target=e}get appendTo(){return this._appendTo||this.overlayOptions?.appendTo}set appendTo(e){this._appendTo=e}get autoZIndex(){let e=this._autoZIndex||this.overlayOptions?.autoZIndex;return e===void 0?!0:e}set autoZIndex(e){this._autoZIndex=e}get baseZIndex(){let e=this._baseZIndex||this.overlayOptions?.baseZIndex;return e===void 0?0:e}set baseZIndex(e){this._baseZIndex=e}get showTransitionOptions(){let e=this._showTransitionOptions||this.overlayOptions?.showTransitionOptions;return e===void 0?".12s cubic-bezier(0, 0, 0.2, 1)":e}set showTransitionOptions(e){this._showTransitionOptions=e}get hideTransitionOptions(){let e=this._hideTransitionOptions||this.overlayOptions?.hideTransitionOptions;return e===void 0?".1s linear":e}set hideTransitionOptions(e){this._hideTransitionOptions=e}get listener(){return this._listener||this.overlayOptions?.listener}set listener(e){this._listener=e}get responsive(){return this._responsive||this.overlayOptions?.responsive}set responsive(e){this._responsive=e}get options(){return this._options}set options(e){this._options=e}visibleChange=new fe;onBeforeShow=new fe;onShow=new fe;onBeforeHide=new fe;onHide=new fe;onAnimationStart=new fe;onAnimationDone=new fe;templates;overlayViewChild;contentViewChild;contentTemplate;_visible=!1;_mode;_style;_styleClass;_contentStyle;_contentStyleClass;_target;_appendTo;_autoZIndex;_baseZIndex;_showTransitionOptions;_hideTransitionOptions;_listener;_responsive;_options;modalVisible=!1;isOverlayClicked=!1;isOverlayContentClicked=!1;scrollHandler;documentClickListener;documentResizeListener;documentKeyboardListener;window;transformOptions={default:"scaleY(0.8)",center:"scale(0.7)",top:"translate3d(0px, -100%, 0px)","top-start":"translate3d(0px, -100%, 0px)","top-end":"translate3d(0px, -100%, 0px)",bottom:"translate3d(0px, 100%, 0px)","bottom-start":"translate3d(0px, 100%, 0px)","bottom-end":"translate3d(0px, 100%, 0px)",left:"translate3d(-100%, 0px, 0px)","left-start":"translate3d(-100%, 0px, 0px)","left-end":"translate3d(-100%, 0px, 0px)",right:"translate3d(100%, 0px, 0px)","right-start":"translate3d(100%, 0px, 0px)","right-end":"translate3d(100%, 0px, 0px)"};get modal(){if(ni(this.platformId))return this.mode==="modal"||this.overlayResponsiveOptions&&this.window?.matchMedia(this.overlayResponsiveOptions.media?.replace("@media","")||`(max-width: ${this.overlayResponsiveOptions.breakpoint})`).matches}get overlayMode(){return this.mode||(this.modal?"modal":"overlay")}get overlayOptions(){return Tt(Tt({},this.config?.overlayOptions),this.options)}get overlayResponsiveOptions(){return Tt(Tt({},this.overlayOptions?.responsive),this.responsive)}get overlayResponsiveDirection(){return this.overlayResponsiveOptions?.direction||"center"}get overlayEl(){return this.overlayViewChild?.nativeElement}get contentEl(){return this.contentViewChild?.nativeElement}get targetEl(){return R.getTargetElement(this.target,this.el?.nativeElement)}constructor(e,i,r,a,s,o,l,c){this.document=e,this.platformId=i,this.el=r,this.renderer=a,this.config=s,this.overlayService=o,this.cd=l,this.zone=c,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}show(e,i=!1){this.onVisibleChange(!0),this.handleEvents("onShow",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),i&&R.focus(this.targetEl),this.modal&&R.addClass(this.document?.body,"p-overflow-hidden")}hide(e,i=!1){if(this.visible)this.onVisibleChange(!1),this.handleEvents("onHide",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),i&&R.focus(this.targetEl),this.modal&&R.removeClass(this.document?.body,"p-overflow-hidden");else return}alignOverlay(){!this.modal&&R.alignOverlay(this.overlayEl,this.targetEl,this.appendTo)}onVisibleChange(e){this._visible=e,this.visibleChange.emit(e)}onOverlayClick(){this.isOverlayClicked=!0}onOverlayContentClick(e){this.overlayService.add({originalEvent:e,target:this.targetEl}),this.isOverlayContentClicked=!0}onOverlayContentAnimationStart(e){switch(e.toState){case"visible":this.handleEvents("onBeforeShow",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.autoZIndex&&Ut.set(this.overlayMode,this.overlayEl,this.baseZIndex+this.config?.zIndex[this.overlayMode]),R.appendOverlay(this.overlayEl,this.appendTo==="body"?this.document.body:this.appendTo,this.appendTo),this.alignOverlay();break;case"void":this.handleEvents("onBeforeHide",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.modal&&R.addClass(this.overlayEl,"p-component-overlay-leave");break}this.handleEvents("onAnimationStart",e)}onOverlayContentAnimationDone(e){let i=this.overlayEl||e.element.parentElement;switch(e.toState){case"visible":this.visible&&this.show(i,!0),this.bindListeners();break;case"void":if(!this.visible){this.hide(i,!0),this.modalVisible=!1,this.unbindListeners(),R.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),Ut.clear(i),this.cd.markForCheck();break}}this.handleEvents("onAnimationDone",e)}handleEvents(e,i){this[e].emit(i),this.options&&this.options[e]&&this.options[e](i),this.config?.overlayOptions&&(this.config?.overlayOptions)[e]&&(this.config?.overlayOptions)[e](i)}bindListeners(){this.unbindListeners(),this.bindScrollListener(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindDocumentKeyboardListener()}unbindListeners(){this.unbindScrollListener(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindDocumentKeyboardListener()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new ea(this.targetEl,e=>{(this.listener?this.listener(e,{type:"scroll",mode:this.overlayMode,valid:!0}):!0)&&this.hide(e,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.document,"click",e=>{let r=!(this.targetEl&&(this.targetEl.isSameNode(e.target)||!this.isOverlayClicked&&this.targetEl.contains(e.target)))&&!this.isOverlayContentClicked;(this.listener?this.listener(e,{type:"outside",mode:this.overlayMode,valid:e.which!==3&&r}):r)&&this.hide(e),this.isOverlayClicked=this.isOverlayContentClicked=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener||(this.documentResizeListener=this.renderer.listen(this.window,"resize",e=>{(this.listener?this.listener(e,{type:"resize",mode:this.overlayMode,valid:!R.isTouchDevice()}):!R.isTouchDevice())&&this.hide(e,!0)}))}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindDocumentKeyboardListener(){this.documentKeyboardListener||this.zone.runOutsideAngular(()=>{this.documentKeyboardListener=this.renderer.listen(this.window,"keydown",e=>{if(this.overlayOptions.hideOnEscape===!1||e.code!=="Escape")return;(this.listener?this.listener(e,{type:"keydown",mode:this.overlayMode,valid:!R.isTouchDevice()}):!R.isTouchDevice())&&this.zone.run(()=>{this.hide(e,!0)})})})}unbindDocumentKeyboardListener(){this.documentKeyboardListener&&(this.documentKeyboardListener(),this.documentKeyboardListener=null)}ngOnDestroy(){this.hide(this.overlayEl,!0),this.overlayEl&&(R.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),Ut.clear(this.overlayEl)),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindListeners()}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Wi),Z(Lt),Z(Qt),Z(Nt),Z(ka),Z(St),Z(yi))};static \u0275cmp=he({type:t,selectors:[["p-overlay"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(C1,5),Je(T1,5)),i&2){let a;Ee(a=Fe())&&(r.overlayViewChild=a.first),Ee(a=Fe())&&(r.contentViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{visible:"visible",mode:"mode",style:"style",styleClass:"styleClass",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",target:"target",appendTo:"appendTo",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",listener:"listener",responsive:"responsive",options:"options"},outputs:{visibleChange:"visibleChange",onBeforeShow:"onBeforeShow",onShow:"onShow",onBeforeHide:"onBeforeHide",onHide:"onHide",onAnimationStart:"onAnimationStart",onAnimationDone:"onAnimationDone"},features:[ji([L1])],ngContentSelectors:S1,decls:1,vars:1,consts:[["overlay",""],["content",""],[3,"ngStyle","class","ngClass","click",4,"ngIf"],[3,"click","ngStyle","ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,r){i&1&&(Ni(),w(0,A1,3,20,"div",2)),i&2&&u("ngIf",r.modalVisible)},dependencies:[at,rt,bt,It],styles:[`@layer primeng{.p-overlay{position:absolute;top:0;left:0}.p-overlay-modal{display:flex;align-items:center;justify-content:center;position:fixed;top:0;left:0;width:100%;height:100%}.p-overlay-content{transform-origin:inherit}.p-overlay-modal>.p-overlay-content{z-index:1;width:90%}.p-overlay-top{align-items:flex-start}.p-overlay-top-start{align-items:flex-start;justify-content:flex-start}.p-overlay-top-end{align-items:flex-start;justify-content:flex-end}.p-overlay-bottom{align-items:flex-end}.p-overlay-bottom-start{align-items:flex-end;justify-content:flex-start}.p-overlay-bottom-end{align-items:flex-end;justify-content:flex-end}.p-overlay-left{justify-content:flex-start}.p-overlay-left-start{justify-content:flex-start;align-items:flex-start}.p-overlay-left-end{justify-content:flex-start;align-items:flex-end}.p-overlay-right{justify-content:flex-end}.p-overlay-right-start{justify-content:flex-end;align-items:flex-start}.p-overlay-right-end{justify-content:flex-end;align-items:flex-end}}
`],encapsulation:2,data:{animation:[rn("overlayContentAnimation",[ri(":enter",[Fn(R1)]),ri(":leave",[Fn(V1)])])]},changeDetection:0})}return t})(),Il=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ct,ct]})}return t})();var B1=["element"],N1=["content"],U1=["*"],H1=(t,n,e)=>({"p-scroller":!0,"p-scroller-inline":t,"p-both-scroll":n,"p-horizontal-scroll":e}),kl=(t,n)=>({$implicit:t,options:n}),z1=t=>({"p-scroller-loading":t}),W1=t=>({"p-component-overlay":t}),j1=t=>({numCols:t}),$0=t=>({options:t}),K1=()=>({styleClass:"p-scroller-loading-icon"}),G1=(t,n)=>({rows:t,columns:n});function $1(t,n){t&1&&ye(0)}function Y1(t,n){if(t&1&&(_e(0),w(1,$1,1,0,"ng-container",10),ge()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",pt(2,kl,e.loadedItems,e.getContentOptions()))}}function X1(t,n){t&1&&ye(0)}function q1(t,n){if(t&1&&(_e(0),w(1,X1,1,0,"ng-container",10),ge()),t&2){let e=n.$implicit,i=n.index,r=f(3);p(),u("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",pt(2,kl,e,r.getOptions(i)))}}function Z1(t,n){if(t&1&&(g(0,"div",11,3),w(2,q1,2,5,"ng-container",12),x()),t&2){let e=f(2);u("ngClass",Le(5,z1,e.d_loading))("ngStyle",e.contentStyle),V("data-pc-section","content"),p(2),u("ngForOf",e.loadedItems)("ngForTrackBy",e._trackBy||e.index)}}function Q1(t,n){if(t&1&&N(0,"div",13),t&2){let e=f(2);u("ngStyle",e.spacerStyle),V("data-pc-section","spacer")}}function J1(t,n){t&1&&ye(0)}function e_(t,n){if(t&1&&(_e(0),w(1,J1,1,0,"ng-container",10),ge()),t&2){let e=n.index,i=f(4);p(),u("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",Le(4,$0,i.getLoaderOptions(e,i.both&&Le(2,j1,i._numItemsInViewport.cols))))}}function t_(t,n){if(t&1&&(_e(0),w(1,e_,2,6,"ng-container",15),ge()),t&2){let e=f(3);p(),u("ngForOf",e.loaderArr)}}function i_(t,n){t&1&&ye(0)}function n_(t,n){if(t&1&&(_e(0),w(1,i_,1,0,"ng-container",10),ge()),t&2){let e=f(4);p(),u("ngTemplateOutlet",e.loaderIconTemplate)("ngTemplateOutletContext",Le(3,$0,Ot(2,K1)))}}function r_(t,n){t&1&&N(0,"SpinnerIcon",16),t&2&&(u("styleClass","p-scroller-loading-icon pi-spin"),V("data-pc-section","loadingIcon"))}function a_(t,n){if(t&1&&w(0,n_,2,5,"ng-container",6)(1,r_,1,2,"ng-template",null,5,$t),t&2){let e=vt(2),i=f(3);u("ngIf",i.loaderIconTemplate)("ngIfElse",e)}}function s_(t,n){if(t&1&&(g(0,"div",14),w(1,t_,2,1,"ng-container",6)(2,a_,3,2,"ng-template",null,4,$t),x()),t&2){let e=vt(3),i=f(2);u("ngClass",Le(4,W1,!i.loaderTemplate)),V("data-pc-section","loader"),p(),u("ngIf",i.loaderTemplate)("ngIfElse",e)}}function o_(t,n){if(t&1){let e=le();_e(0),g(1,"div",7,1),G("scroll",function(r){S(e);let a=f();return I(a.onContainerScroll(r))}),w(3,Y1,2,5,"ng-container",6)(4,Z1,3,7,"ng-template",null,2,$t)(6,Q1,1,2,"div",8)(7,s_,4,6,"div",9),x(),ge()}if(t&2){let e=vt(5),i=f();p(),ue(i._styleClass),u("ngStyle",i._style)("ngClass",Ci(12,H1,i.inline,i.both,i.horizontal)),V("id",i._id)("tabindex",i.tabindex)("data-pc-name","scroller")("data-pc-section","root"),p(2),u("ngIf",i.contentTemplate)("ngIfElse",e),p(3),u("ngIf",i._showSpacer),p(),u("ngIf",!i.loaderDisabled&&i._showLoader&&i.d_loading)}}function l_(t,n){t&1&&ye(0)}function c_(t,n){if(t&1&&(_e(0),w(1,l_,1,0,"ng-container",10),ge()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",pt(5,kl,e.items,pt(2,G1,e._items,e.loadedColumns)))}}function d_(t,n){if(t&1&&(wi(0),w(1,c_,2,8,"ng-container",17)),t&2){let e=f();p(),u("ngIf",e.contentTemplate)}}var xo=(()=>{class t{document;platformId;renderer;cd;zone;get id(){return this._id}set id(e){this._id=e}get style(){return this._style}set style(e){this._style=e}get styleClass(){return this._styleClass}set styleClass(e){this._styleClass=e}get tabindex(){return this._tabindex}set tabindex(e){this._tabindex=e}get items(){return this._items}set items(e){this._items=e}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e}get scrollHeight(){return this._scrollHeight}set scrollHeight(e){this._scrollHeight=e}get scrollWidth(){return this._scrollWidth}set scrollWidth(e){this._scrollWidth=e}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get step(){return this._step}set step(e){this._step=e}get delay(){return this._delay}set delay(e){this._delay=e}get resizeDelay(){return this._resizeDelay}set resizeDelay(e){this._resizeDelay=e}get appendOnly(){return this._appendOnly}set appendOnly(e){this._appendOnly=e}get inline(){return this._inline}set inline(e){this._inline=e}get lazy(){return this._lazy}set lazy(e){this._lazy=e}get disabled(){return this._disabled}set disabled(e){this._disabled=e}get loaderDisabled(){return this._loaderDisabled}set loaderDisabled(e){this._loaderDisabled=e}get columns(){return this._columns}set columns(e){this._columns=e}get showSpacer(){return this._showSpacer}set showSpacer(e){this._showSpacer=e}get showLoader(){return this._showLoader}set showLoader(e){this._showLoader=e}get numToleratedItems(){return this._numToleratedItems}set numToleratedItems(e){this._numToleratedItems=e}get loading(){return this._loading}set loading(e){this._loading=e}get autoSize(){return this._autoSize}set autoSize(e){this._autoSize=e}get trackBy(){return this._trackBy}set trackBy(e){this._trackBy=e}get options(){return this._options}set options(e){this._options=e,e&&typeof e=="object"&&Object.entries(e).forEach(([i,r])=>this[`_${i}`]!==r&&(this[`_${i}`]=r))}onLazyLoad=new fe;onScroll=new fe;onScrollIndexChange=new fe;elementViewChild;contentViewChild;templates;_id;_style;_styleClass;_tabindex=0;_items;_itemSize=0;_scrollHeight;_scrollWidth;_orientation="vertical";_step=0;_delay=0;_resizeDelay=10;_appendOnly=!1;_inline=!1;_lazy=!1;_disabled=!1;_loaderDisabled=!1;_columns;_showSpacer=!0;_showLoader=!1;_numToleratedItems;_loading;_autoSize=!1;_trackBy;_options;d_loading=!1;d_numToleratedItems;contentEl;contentTemplate;itemTemplate;loaderTemplate;loaderIconTemplate;first=0;last=0;page=0;isRangeChanged=!1;numItemsInViewport=0;lastScrollPos=0;lazyLoadState={};loaderArr=[];spacerStyle={};contentStyle={};scrollTimeout;resizeTimeout;initialized=!1;resizeObserver;defaultWidth;defaultHeight;defaultContentWidth;defaultContentHeight;get vertical(){return this._orientation==="vertical"}get horizontal(){return this._orientation==="horizontal"}get both(){return this._orientation==="both"}get loadedItems(){return this._items&&!this.d_loading?this.both?this._items.slice(this._appendOnly?0:this.first.rows,this.last.rows).map(e=>this._columns?e:e.slice(this._appendOnly?0:this.first.cols,this.last.cols)):this.horizontal&&this._columns?this._items:this._items.slice(this._appendOnly?0:this.first,this.last):[]}get loadedRows(){return this.d_loading?this._loaderDisabled?this.loaderArr:[]:this.loadedItems}get loadedColumns(){return this._columns&&(this.both||this.horizontal)?this.d_loading&&this._loaderDisabled?this.both?this.loaderArr[0]:this.loaderArr:this._columns.slice(this.both?this.first.cols:this.first,this.both?this.last.cols:this.last):this._columns}constructor(e,i,r,a,s){this.document=e,this.platformId=i,this.renderer=r,this.cd=a,this.zone=s}ngOnInit(){this.setInitialState()}ngOnChanges(e){let i=!1;if(e.loading){let{previousValue:r,currentValue:a}=e.loading;this.lazy&&r!==a&&a!==this.d_loading&&(this.d_loading=a,i=!0)}if(e.orientation&&(this.lastScrollPos=this.both?{top:0,left:0}:0),e.numToleratedItems){let{previousValue:r,currentValue:a}=e.numToleratedItems;r!==a&&a!==this.d_numToleratedItems&&(this.d_numToleratedItems=a)}if(e.options){let{previousValue:r,currentValue:a}=e.options;this.lazy&&r?.loading!==a?.loading&&a?.loading!==this.d_loading&&(this.d_loading=a.loading,i=!0),r?.numToleratedItems!==a?.numToleratedItems&&a?.numToleratedItems!==this.d_numToleratedItems&&(this.d_numToleratedItems=a.numToleratedItems)}this.initialized&&!i&&(e.items?.previousValue?.length!==e.items?.currentValue?.length||e.itemSize||e.scrollHeight||e.scrollWidth)&&(this.init(),this.calculateAutoSize())}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"item":this.itemTemplate=e.template;break;case"loader":this.loaderTemplate=e.template;break;case"loadericon":this.loaderIconTemplate=e.template;break;default:this.itemTemplate=e.template;break}})}ngAfterViewInit(){Promise.resolve().then(()=>{this.viewInit()})}ngAfterViewChecked(){this.initialized||this.viewInit()}ngOnDestroy(){this.unbindResizeListener(),this.contentEl=null,this.initialized=!1}viewInit(){ni(this.platformId)&&!this.initialized&&R.isVisible(this.elementViewChild?.nativeElement)&&(this.setInitialState(),this.setContentEl(this.contentEl),this.init(),this.calculateAutoSize(),this.defaultWidth=R.getWidth(this.elementViewChild?.nativeElement),this.defaultHeight=R.getHeight(this.elementViewChild?.nativeElement),this.defaultContentWidth=R.getWidth(this.contentEl),this.defaultContentHeight=R.getHeight(this.contentEl),this.resizeObserver=new ResizeObserver(()=>this.onResize()),this.resizeObserver.observe(this.elementViewChild?.nativeElement),this.initialized=!0)}init(){this._disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize(),this.cd.detectChanges())}setContentEl(e){this.contentEl=e||this.contentViewChild?.nativeElement||R.findSingle(this.elementViewChild?.nativeElement,".p-scroller-content")}setInitialState(){this.first=this.both?{rows:0,cols:0}:0,this.last=this.both?{rows:0,cols:0}:0,this.numItemsInViewport=this.both?{rows:0,cols:0}:0,this.lastScrollPos=this.both?{top:0,left:0}:0,this.d_loading=this._loading||!1,this.d_numToleratedItems=this._numToleratedItems,this.loaderArr=[],this.spacerStyle={},this.contentStyle={}}getElementRef(){return this.elementViewChild}getPageByFirst(e){return Math.floor(((e??this.first)+this.d_numToleratedItems*4)/(this._step||1))}isPageChanged(e){return this._step?this.page!==this.getPageByFirst(e??this.first):!0}scrollTo(e){this.elementViewChild?.nativeElement?.scrollTo(e)}scrollToIndex(e,i="auto"){if(this.both?e.every(a=>a>-1):e>-1){let a=this.first,{scrollTop:s=0,scrollLeft:o=0}=this.elementViewChild?.nativeElement,{numToleratedItems:l}=this.calculateNumItems(),c=this.getContentPosition(),d=this.itemSize,h=(k=0,F)=>k<=F?0:k,_=(k,F,T)=>k*F+T,v=(k=0,F=0)=>this.scrollTo({left:k,top:F,behavior:i}),b=this.both?{rows:0,cols:0}:0,m=!1,y=!1;this.both?(b={rows:h(e[0],l[0]),cols:h(e[1],l[1])},v(_(b.cols,d[1],c.left),_(b.rows,d[0],c.top)),y=this.lastScrollPos.top!==s||this.lastScrollPos.left!==o,m=b.rows!==a.rows||b.cols!==a.cols):(b=h(e,l),this.horizontal?v(_(b,d,c.left),s):v(o,_(b,d,c.top)),y=this.lastScrollPos!==(this.horizontal?o:s),m=b!==a),this.isRangeChanged=m,y&&(this.first=b)}}scrollInView(e,i,r="auto"){if(i){let{first:a,viewport:s}=this.getRenderedRange(),o=(d=0,h=0)=>this.scrollTo({left:d,top:h,behavior:r}),l=i==="to-start",c=i==="to-end";if(l){if(this.both)s.first.rows-a.rows>e[0]?o(s.first.cols*this._itemSize[1],(s.first.rows-1)*this._itemSize[0]):s.first.cols-a.cols>e[1]&&o((s.first.cols-1)*this._itemSize[1],s.first.rows*this._itemSize[0]);else if(s.first-a>e){let d=(s.first-1)*this._itemSize;this.horizontal?o(d,0):o(0,d)}}else if(c){if(this.both)s.last.rows-a.rows<=e[0]+1?o(s.first.cols*this._itemSize[1],(s.first.rows+1)*this._itemSize[0]):s.last.cols-a.cols<=e[1]+1&&o((s.first.cols+1)*this._itemSize[1],s.first.rows*this._itemSize[0]);else if(s.last-a<=e+1){let d=(s.first+1)*this._itemSize;this.horizontal?o(d,0):o(0,d)}}}else this.scrollToIndex(e,r)}getRenderedRange(){let e=(a,s)=>s||a?Math.floor(a/(s||a)):0,i=this.first,r=0;if(this.elementViewChild?.nativeElement){let{scrollTop:a,scrollLeft:s}=this.elementViewChild.nativeElement;if(this.both)i={rows:e(a,this._itemSize[0]),cols:e(s,this._itemSize[1])},r={rows:i.rows+this.numItemsInViewport.rows,cols:i.cols+this.numItemsInViewport.cols};else{let o=this.horizontal?s:a;i=e(o,this._itemSize),r=i+this.numItemsInViewport}}return{first:this.first,last:this.last,viewport:{first:i,last:r}}}calculateNumItems(){let e=this.getContentPosition(),i=(this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetWidth-e.left:0)||0,r=(this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetHeight-e.top:0)||0,a=(c,d)=>d||c?Math.ceil(c/(d||c)):0,s=c=>Math.ceil(c/2),o=this.both?{rows:a(r,this._itemSize[0]),cols:a(i,this._itemSize[1])}:a(this.horizontal?i:r,this._itemSize),l=this.d_numToleratedItems||(this.both?[s(o.rows),s(o.cols)]:s(o));return{numItemsInViewport:o,numToleratedItems:l}}calculateOptions(){let{numItemsInViewport:e,numToleratedItems:i}=this.calculateNumItems(),r=(o,l,c,d=!1)=>this.getLast(o+l+(o<c?2:3)*c,d),a=this.first,s=this.both?{rows:r(this.first.rows,e.rows,i[0]),cols:r(this.first.cols,e.cols,i[1],!0)}:r(this.first,e,i);this.last=s,this.numItemsInViewport=e,this.d_numToleratedItems=i,this.showLoader&&(this.loaderArr=this.both?Array.from({length:e.rows}).map(()=>Array.from({length:e.cols})):Array.from({length:e})),this._lazy&&Promise.resolve().then(()=>{this.lazyLoadState={first:this._step?this.both?{rows:0,cols:a.cols}:0:a,last:Math.min(this._step?this._step:this.last,this.items.length)},this.handleEvents("onLazyLoad",this.lazyLoadState)})}calculateAutoSize(){this._autoSize&&!this.d_loading&&Promise.resolve().then(()=>{if(this.contentEl){this.contentEl.style.minHeight=this.contentEl.style.minWidth="auto",this.contentEl.style.position="relative",this.elementViewChild.nativeElement.style.contain="none";let[e,i]=[R.getWidth(this.contentEl),R.getHeight(this.contentEl)];e!==this.defaultContentWidth&&(this.elementViewChild.nativeElement.style.width=""),i!==this.defaultContentHeight&&(this.elementViewChild.nativeElement.style.height="");let[r,a]=[R.getWidth(this.elementViewChild.nativeElement),R.getHeight(this.elementViewChild.nativeElement)];this.contentEl.style.minHeight=this.contentEl.style.minWidth="",this.contentEl.style.position="",this.elementViewChild.nativeElement.style.contain="",this.defaultWidth=r,this.defaultHeight=a,this.defaultContentWidth=e,this.defaultContentHeight=i,(this.both||this.horizontal)&&(this.elementViewChild.nativeElement.style.width=r<this.defaultWidth?r+"px":this._scrollWidth||this.defaultWidth+"px"),(this.both||this.vertical)&&(this.elementViewChild.nativeElement.style.height=a<this.defaultHeight?a+"px":this._scrollHeight||this.defaultHeight+"px")}})}getLast(e=0,i=!1){return this._items?Math.min(i?(this._columns||this._items[0]).length:this._items.length,e):0}getContentPosition(){if(this.contentEl){let e=getComputedStyle(this.contentEl),i=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),r=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),a=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),s=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:i,right:r,top:a,bottom:s,x:i+r,y:a+s}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}}setSize(){if(this.elementViewChild?.nativeElement){let e=this.elementViewChild.nativeElement.parentElement.parentElement,i=this._scrollWidth||`${this.elementViewChild.nativeElement.offsetWidth||e.offsetWidth}px`,r=this._scrollHeight||`${this.elementViewChild.nativeElement.offsetHeight||e.offsetHeight}px`,a=(s,o)=>this.elementViewChild.nativeElement.style[s]=o;this.both||this.horizontal?(a("height",r),a("width",i)):a("height",r)}}setSpacerSize(){if(this._items){let e=(r,a,s)=>this.spacerStyle=_n(Tt({},this.spacerStyle),{[`${r}`]:a*s+"px"}),i=this._items.length;this.both?(e("height",i,this._itemSize[0]),e("width",this._columns?.length||this._items[1]?.length,this._itemSize[1])):this.horizontal?e("width",this._columns?.length||this._items.length,this._itemSize):e("height",i,this._itemSize)}}setContentPosition(e){if(this.contentEl&&!this._appendOnly){let i=e?e.first:this.first,r=(s,o)=>s*o,a=(s=0,o=0)=>this.contentStyle=_n(Tt({},this.contentStyle),{transform:`translate3d(${s}px, ${o}px, 0)`});if(this.both)a(r(i.cols,this._itemSize[1]),r(i.rows,this._itemSize[0]));else{let s=r(i,this._itemSize);this.horizontal?a(s,0):a(0,s)}}}onScrollPositionChange(e){let i=e.target,r=this.getContentPosition(),a=(y,k)=>y?y>k?y-k:y:0,s=(y,k)=>k||y?Math.floor(y/(k||y)):0,o=(y,k,F,T,W,X)=>y<=W?W:X?F-T-W:k+W-1,l=(y,k,F,T,W,X,z)=>y<=X?0:Math.max(0,z?y<k?F:y-X:y>k?F:y-2*X),c=(y,k,F,T,W,X=!1)=>{let z=k+T+2*W;return y>=W&&(z+=W+1),this.getLast(z,X)},d=a(i.scrollTop,r.top),h=a(i.scrollLeft,r.left),_=this.both?{rows:0,cols:0}:0,v=this.last,b=!1,m=this.lastScrollPos;if(this.both){let y=this.lastScrollPos.top<=d,k=this.lastScrollPos.left<=h;if(!this._appendOnly||this._appendOnly&&(y||k)){let F={rows:s(d,this._itemSize[0]),cols:s(h,this._itemSize[1])},T={rows:o(F.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],y),cols:o(F.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],k)};_={rows:l(F.rows,T.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],y),cols:l(F.cols,T.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],k)},v={rows:c(F.rows,_.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:c(F.cols,_.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},b=_.rows!==this.first.rows||v.rows!==this.last.rows||_.cols!==this.first.cols||v.cols!==this.last.cols||this.isRangeChanged,m={top:d,left:h}}}else{let y=this.horizontal?h:d,k=this.lastScrollPos<=y;if(!this._appendOnly||this._appendOnly&&k){let F=s(y,this._itemSize),T=o(F,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,k);_=l(F,T,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,k),v=c(F,_,this.last,this.numItemsInViewport,this.d_numToleratedItems),b=_!==this.first||v!==this.last||this.isRangeChanged,m=y}}return{first:_,last:v,isRangeChanged:b,scrollPos:m}}onScrollChange(e){let{first:i,last:r,isRangeChanged:a,scrollPos:s}=this.onScrollPositionChange(e);if(a){let o={first:i,last:r};if(this.setContentPosition(o),this.first=i,this.last=r,this.lastScrollPos=s,this.handleEvents("onScrollIndexChange",o),this._lazy&&this.isPageChanged(i)){let l={first:this._step?Math.min(this.getPageByFirst(i)*this._step,this.items.length-this._step):i,last:Math.min(this._step?(this.getPageByFirst(i)+1)*this._step:r,this.items.length)};(this.lazyLoadState.first!==l.first||this.lazyLoadState.last!==l.last)&&this.handleEvents("onLazyLoad",l),this.lazyLoadState=l}}}onContainerScroll(e){if(this.handleEvents("onScroll",{originalEvent:e}),this._delay&&this.isPageChanged()){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){let{isRangeChanged:i}=this.onScrollPositionChange(e);(i||(this._step?this.isPageChanged():!1))&&(this.d_loading=!0,this.cd.detectChanges())}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(e),this.d_loading&&this.showLoader&&(!this._lazy||this._loading===void 0)&&(this.d_loading=!1,this.page=this.getPageByFirst(),this.cd.detectChanges())},this._delay)}else!this.d_loading&&this.onScrollChange(e)}unbindResizeListener(){this.resizeObserver&&(this.resizeObserver.unobserve(this.elementViewChild?.nativeElement),this.resizeObserver=null)}onResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{if(R.isVisible(this.elementViewChild?.nativeElement)){let[e,i]=[R.getWidth(this.elementViewChild?.nativeElement),R.getHeight(this.elementViewChild?.nativeElement)],[r,a]=[e!==this.defaultWidth,i!==this.defaultHeight];(this.both?r||a:this.horizontal?r:this.vertical?a:!1)&&this.zone.run(()=>{this.d_numToleratedItems=this._numToleratedItems,this.init(),this.calculateAutoSize()})}},this._resizeDelay)}handleEvents(e,i){return this.options&&this.options[e]?this.options[e](i):this[e].emit(i)}getContentOptions(){return{contentStyleClass:`p-scroller-content ${this.d_loading?"p-scroller-loading":""}`,items:this.loadedItems,getItemOptions:e=>this.getOptions(e),loading:this.d_loading,getLoaderOptions:(e,i)=>this.getLoaderOptions(e,i),itemSize:this._itemSize,rows:this.loadedRows,columns:this.loadedColumns,spacerStyle:this.spacerStyle,contentStyle:this.contentStyle,vertical:this.vertical,horizontal:this.horizontal,both:this.both}}getOptions(e){let i=(this._items||[]).length,r=this.both?this.first.rows+e:this.first+e;return{index:r,count:i,first:r===0,last:r===i-1,even:r%2===0,odd:r%2!==0}}getLoaderOptions(e,i){let r=this.loaderArr.length;return Tt({index:e,count:r,first:e===0,last:e===r-1,even:e%2===0,odd:e%2!==0},i)}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Wi),Z(Qt),Z(St),Z(yi))};static \u0275cmp=he({type:t,selectors:[["p-scroller"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(B1,5),Je(N1,5)),i&2){let a;Ee(a=Fe())&&(r.elementViewChild=a.first),Ee(a=Fe())&&(r.contentViewChild=a.first)}},hostAttrs:[1,"p-scroller-viewport","p-element"],inputs:{id:"id",style:"style",styleClass:"styleClass",tabindex:"tabindex",items:"items",itemSize:"itemSize",scrollHeight:"scrollHeight",scrollWidth:"scrollWidth",orientation:"orientation",step:"step",delay:"delay",resizeDelay:"resizeDelay",appendOnly:"appendOnly",inline:"inline",lazy:"lazy",disabled:"disabled",loaderDisabled:"loaderDisabled",columns:"columns",showSpacer:"showSpacer",showLoader:"showLoader",numToleratedItems:"numToleratedItems",loading:"loading",autoSize:"autoSize",trackBy:"trackBy",options:"options"},outputs:{onLazyLoad:"onLazyLoad",onScroll:"onScroll",onScrollIndexChange:"onScrollIndexChange"},features:[Sn],ngContentSelectors:U1,decls:3,vars:2,consts:[["disabledContainer",""],["element",""],["buildInContent",""],["content",""],["buildInLoader",""],["buildInLoaderIcon",""],[4,"ngIf","ngIfElse"],[3,"scroll","ngStyle","ngClass"],["class","p-scroller-spacer",3,"ngStyle",4,"ngIf"],["class","p-scroller-loader",3,"ngClass",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-scroller-content",3,"ngClass","ngStyle"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-scroller-spacer",3,"ngStyle"],[1,"p-scroller-loader",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"styleClass"],[4,"ngIf"]],template:function(i,r){if(i&1&&(Ni(),w(0,o_,8,16,"ng-container",6)(1,d_,2,1,"ng-template",null,0,$t)),i&2){let a=vt(2);u("ngIf",!r._disabled)("ngIfElse",a)}},dependencies:()=>[at,ii,rt,bt,It,Ea],styles:[`@layer primeng{p-scroller{flex:1;outline:0 none}.p-scroller{position:relative;overflow:auto;contain:strict;transform:translateZ(0);will-change:scroll-position;outline:0 none}.p-scroller-content{position:absolute;top:0;left:0;min-height:100%;min-width:100%;will-change:transform}.p-scroller-spacer{position:absolute;top:0;left:0;height:1px;width:1px;transform-origin:0 0;pointer-events:none}.p-scroller-loader{position:sticky;top:0;left:0;width:100%;height:100%}.p-scroller-loader.p-component-overlay{display:flex;align-items:center;justify-content:center}.p-scroller-loading-icon{scale:2}.p-scroller-inline .p-scroller-content{position:static}}
`],encapsulation:2})}return t})(),Na=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ct,Ea,ct]})}return t})();var Ar=(()=>{class t{platformId;el;zone;config;renderer;viewContainer;tooltipPosition;tooltipEvent="hover";appendTo;positionStyle;tooltipStyleClass;tooltipZIndex;escape=!0;showDelay;hideDelay;life;positionTop;positionLeft;autoHide=!0;fitContent=!0;hideOnEscape=!0;content;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.deactivate()}tooltipOptions;_tooltipOptions={tooltipLabel:null,tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",positionStyle:null,tooltipStyleClass:null,tooltipZIndex:"auto",escape:!0,disabled:null,showDelay:null,hideDelay:null,positionTop:null,positionLeft:null,life:null,autoHide:!0,hideOnEscape:!0,id:ot()+"_tooltip"};_disabled;container;styleClass;tooltipText;showTimeout;hideTimeout;active;mouseEnterListener;mouseLeaveListener;containerMouseleaveListener;clickListener;focusListener;blurListener;documentEscapeListener;scrollHandler;resizeListener;interactionInProgress=!1;constructor(e,i,r,a,s,o){this.platformId=e,this.el=i,this.zone=r,this.config=a,this.renderer=s,this.viewContainer=o}ngAfterViewInit(){ni(this.platformId)&&this.zone.runOutsideAngular(()=>{let e=this.getOption("tooltipEvent");if((e==="hover"||e==="both")&&(this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener)),e==="focus"||e==="both"){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let i=this.el.nativeElement.querySelector(".p-component");i||(i=this.getTarget(this.el.nativeElement)),i.addEventListener("focus",this.focusListener),i.addEventListener("blur",this.blurListener)}})}setAriaDescribedBy(){let e=this.getOption("id");e&&this.active&&this.renderer.setAttribute(this.el.nativeElement,"aria-describedby",e)}removeAriaDescribedBy(){this.renderer.removeAttribute(this.el.nativeElement,"aria-describedby")}ngOnChanges(e){e.tooltipPosition&&this.setOption({tooltipPosition:e.tooltipPosition.currentValue}),e.tooltipEvent&&this.setOption({tooltipEvent:e.tooltipEvent.currentValue}),e.appendTo&&this.setOption({appendTo:e.appendTo.currentValue}),e.positionStyle&&this.setOption({positionStyle:e.positionStyle.currentValue}),e.tooltipStyleClass&&this.setOption({tooltipStyleClass:e.tooltipStyleClass.currentValue}),e.tooltipZIndex&&this.setOption({tooltipZIndex:e.tooltipZIndex.currentValue}),e.escape&&this.setOption({escape:e.escape.currentValue}),e.showDelay&&this.setOption({showDelay:e.showDelay.currentValue}),e.hideDelay&&this.setOption({hideDelay:e.hideDelay.currentValue}),e.life&&this.setOption({life:e.life.currentValue}),e.positionTop&&this.setOption({positionTop:e.positionTop.currentValue}),e.positionLeft&&this.setOption({positionLeft:e.positionLeft.currentValue}),e.disabled&&this.setOption({disabled:e.disabled.currentValue}),e.content&&(this.setOption({tooltipLabel:e.content.currentValue}),this.active&&(e.content.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),e.autoHide&&this.setOption({autoHide:e.autoHide.currentValue}),e.id&&this.setOption({id:e.id.currentValue}),e.tooltipOptions&&(this._tooltipOptions=Tt(Tt({},this._tooltipOptions),e.tooltipOptions.currentValue),this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(e){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(e){this.isAutoHide()?this.deactivate():!(R.hasClass(e.relatedTarget,"p-tooltip")||R.hasClass(e.relatedTarget,"p-tooltip-text")||R.hasClass(e.relatedTarget,"p-tooltip-arrow"))&&this.deactivate()}onFocus(e){this.activate()}onBlur(e){this.deactivate()}onInputClick(e){this.deactivate()}activate(){if(!this.interactionInProgress){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let e=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},e)}this.getOption("hideOnEscape")&&(this.documentEscapeListener=this.renderer.listen("document","keydown.escape",()=>{this.deactivate(),this.documentEscapeListener()}))}this.interactionInProgress=!0}deactivate(){this.interactionInProgress=!1,this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide(),this.documentEscapeListener&&this.documentEscapeListener()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div"),this.container.setAttribute("id",this.getOption("id")),this.container.setAttribute("role","tooltip");let e=document.createElement("div");e.className="p-tooltip-arrow",this.container.appendChild(e),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),this.getOption("appendTo")==="body"?document.body.appendChild(this.container):this.getOption("appendTo")==="target"?R.appendChild(this.container,this.el.nativeElement):R.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()?this.container.style.pointerEvents="none":(this.container.style.pointerEvents="unset",this.bindContainerMouseleaveListener()),this.setAriaDescribedBy()}bindContainerMouseleaveListener(){if(!this.containerMouseleaveListener){let e=this.container??this.container.nativeElement;this.containerMouseleaveListener=this.renderer.listen(e,"mouseleave",i=>{this.deactivate()})}}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){if(!this.getOption("tooltipLabel")||this.getOption("disabled"))return;this.create(),this.el.nativeElement.closest("p-dialog")?setTimeout(()=>{this.container&&this.align()},100):this.align(),R.fadeIn(this.container,250),this.getOption("tooltipZIndex")==="auto"?Ut.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener()}hide(){this.getOption("tooltipZIndex")==="auto"&&Ut.clear(this.container),this.remove()}updateText(){let e=this.getOption("tooltipLabel");if(e instanceof I0){let i=this.viewContainer.createEmbeddedView(e);i.detectChanges(),i.rootNodes.forEach(r=>this.tooltipText.appendChild(r))}else this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(e))):this.tooltipText.innerHTML=e}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break}}getHostOffset(){if(this.getOption("appendTo")==="body"||this.getOption("appendTo")==="target"){let e=this.el.nativeElement.getBoundingClientRect(),i=e.left+R.getWindowScrollLeft(),r=e.top+R.getWindowScrollTop();return{left:i,top:r}}else return{left:0,top:0}}alignRight(){this.preAlign("right");let e=this.activeElement,i=this.getHostOffset(),r=i.left+R.getOuterWidth(e),a=i.top+(R.getOuterHeight(e)-R.getOuterHeight(this.container))/2;this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=a+this.getOption("positionTop")+"px"}get activeElement(){return this.el.nativeElement.nodeName.includes("P-")?R.findSingle(this.el.nativeElement,".p-component")||this.el.nativeElement:this.el.nativeElement}alignLeft(){this.preAlign("left");let e=this.getHostOffset(),i=e.left-R.getOuterWidth(this.container),r=e.top+(R.getOuterHeight(this.el.nativeElement)-R.getOuterHeight(this.container))/2;this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let e=this.getHostOffset(),i=e.left+(R.getOuterWidth(this.el.nativeElement)-R.getOuterWidth(this.container))/2,r=e.top-R.getOuterHeight(this.container);this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let e=this.getHostOffset(),i=e.left+(R.getOuterWidth(this.el.nativeElement)-R.getOuterWidth(this.container))/2,r=e.top+R.getOuterHeight(this.el.nativeElement);this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}setOption(e){this._tooltipOptions=Tt(Tt({},this._tooltipOptions),e)}getOption(e){return this._tooltipOptions[e]}getTarget(e){return R.hasClass(e,"p-inputwrapper")?R.findSingle(e,"input"):e}preAlign(e){this.container.style.left="-999px",this.container.style.top="-999px";let i="p-tooltip p-component p-tooltip-"+e;this.container.className=this.getOption("tooltipStyleClass")?i+" "+this.getOption("tooltipStyleClass"):i}isOutOfBounds(){let e=this.container.getBoundingClientRect(),i=e.top,r=e.left,a=R.getOuterWidth(this.container),s=R.getOuterHeight(this.container),o=R.getViewport();return r+a>o.width||r<0||i<0||i+s>o.height}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new ea(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){let e=this.getOption("tooltipEvent");if((e==="hover"||e==="both")&&(this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener)),e==="focus"||e==="both"){let i=this.el.nativeElement.querySelector(".p-component");i||(i=this.getTarget(this.el.nativeElement))}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&(this.getOption("appendTo")==="body"?document.body.removeChild(this.container):this.getOption("appendTo")==="target"?this.el.nativeElement.removeChild(this.container):R.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.removeAriaDescribedBy(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&Ut.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.documentEscapeListener&&this.documentEscapeListener()}static \u0275fac=function(i){return new(i||t)(Z(Wi),Z(Lt),Z(yi),Z(Nt),Z(Qt),Z(lo))};static \u0275dir=Sr({type:t,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:[2,"escape","escape",Q],showDelay:[2,"showDelay","showDelay",We],hideDelay:[2,"hideDelay","hideDelay",We],life:[2,"life","life",We],positionTop:[2,"positionTop","positionTop",We],positionLeft:[2,"positionLeft","positionLeft",We],autoHide:[2,"autoHide","autoHide",Q],fitContent:[2,"fitContent","fitContent",Q],hideOnEscape:[2,"hideOnEscape","hideOnEscape",Q],content:[0,"pTooltip","content"],disabled:[0,"tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[_t,Sn]})}return t})(),zn=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st]})}return t})();var El=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["BlankIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:0,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg","v-bind","pti()"],["width","1","height","1","fill","currentColor","fill-opacity","0"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"rect",1),x())},encapsulation:2})}return t})();var Fl=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["SearchIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M2.67602 11.0265C3.6661 11.688 4.83011 12.0411 6.02086 12.0411C6.81149 12.0411 7.59438 11.8854 8.32483 11.5828C8.87005 11.357 9.37808 11.0526 9.83317 10.6803L12.9769 13.8241C13.0323 13.8801 13.0983 13.9245 13.171 13.9548C13.2438 13.985 13.3219 14.0003 13.4007 14C13.4795 14.0003 13.5575 13.985 13.6303 13.9548C13.7031 13.9245 13.7691 13.8801 13.8244 13.8241C13.9367 13.7116 13.9998 13.5592 13.9998 13.4003C13.9998 13.2414 13.9367 13.089 13.8244 12.9765L10.6807 9.8328C11.053 9.37773 11.3573 8.86972 11.5831 8.32452C11.8857 7.59408 12.0414 6.81119 12.0414 6.02056C12.0414 4.8298 11.6883 3.66579 11.0268 2.67572C10.3652 1.68564 9.42494 0.913972 8.32483 0.45829C7.22472 0.00260857 6.01418 -0.116618 4.84631 0.115686C3.67844 0.34799 2.60568 0.921393 1.76369 1.76338C0.921698 2.60537 0.348296 3.67813 0.115991 4.84601C-0.116313 6.01388 0.00291375 7.22441 0.458595 8.32452C0.914277 9.42464 1.68595 10.3649 2.67602 11.0265ZM3.35565 2.0158C4.14456 1.48867 5.07206 1.20731 6.02086 1.20731C7.29317 1.20731 8.51338 1.71274 9.41304 2.6124C10.3127 3.51206 10.8181 4.73226 10.8181 6.00457C10.8181 6.95337 10.5368 7.88088 10.0096 8.66978C9.48251 9.45868 8.73328 10.0736 7.85669 10.4367C6.98011 10.7997 6.01554 10.8947 5.08496 10.7096C4.15439 10.5245 3.2996 10.0676 2.62869 9.39674C1.95778 8.72583 1.50089 7.87104 1.31579 6.94046C1.13068 6.00989 1.22568 5.04532 1.58878 4.16874C1.95187 3.29215 2.56675 2.54292 3.35565 2.0158Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var xs=t=>({height:t}),p_=(t,n,e)=>({"p-dropdown-item":!0,"p-highlight":t,"p-disabled":n,"p-focus":e}),Dl=t=>({$implicit:t});function u_(t,n){t&1&&N(0,"CheckIcon",4),t&2&&u("styleClass","p-dropdown-check-icon")}function f_(t,n){t&1&&N(0,"BlankIcon",4),t&2&&u("styleClass","p-dropdown-blank-icon")}function h_(t,n){if(t&1&&(_e(0),w(1,u_,1,1,"CheckIcon",3)(2,f_,1,1,"BlankIcon",3),ge()),t&2){let e=f();p(),u("ngIf",e.selected),p(),u("ngIf",!e.selected)}}function m_(t,n){if(t&1&&(g(0,"span"),Y(1),x()),t&2){let e,i=f();p(),be((e=i.label)!==null&&e!==void 0?e:"empty")}}function __(t,n){t&1&&ye(0)}var g_=["container"],x_=["filter"],v_=["focusInput"],b_=["editableInput"],y_=["items"],w_=["scroller"],C_=["overlay"],T_=["firstHiddenFocusableEl"],S_=["lastHiddenFocusableEl"],I_=t=>({"max-height":t}),X0=t=>({options:t}),k_=t=>({"p-variant-filled":t}),q0=(t,n)=>({$implicit:t,options:n}),E_=()=>({});function F_(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f(2);p(),be(e.label()==="p-emptylabel"?"\xA0":e.label())}}function D_(t,n){if(t&1&&ye(0,25),t&2){let e=f(2);u("ngTemplateOutlet",e.selectedItemTemplate)("ngTemplateOutletContext",Le(2,Dl,e.selectedOption))}}function M_(t,n){if(t&1&&(g(0,"span"),Y(1),x()),t&2){let e=f(3);p(),be(e.label()==="p-emptylabel"?"\xA0":e.label())}}function O_(t,n){if(t&1&&w(0,M_,2,1,"span",18),t&2){let e=f(2);u("ngIf",e.isSelectedOptionEmpty())}}function A_(t,n){if(t&1){let e=le();g(0,"span",23,3),G("focus",function(r){S(e);let a=f();return I(a.onInputFocus(r))})("blur",function(r){S(e);let a=f();return I(a.onInputBlur(r))})("keydown",function(r){S(e);let a=f();return I(a.onKeyDown(r))}),w(2,F_,2,1,"ng-container",20)(3,D_,1,4,"ng-container",24)(4,O_,1,1,"ng-template",null,4,$t),x()}if(t&2){let e,i=vt(5),r=f();u("ngClass",r.inputClass)("pTooltip",r.tooltip)("tooltipPosition",r.tooltipPosition)("positionStyle",r.tooltipPositionStyle)("tooltipStyleClass",r.tooltipStyleClass)("autofocus",r.autofocus),V("aria-disabled",r.disabled)("id",r.inputId)("aria-label",r.ariaLabel||(r.label()==="p-emptylabel"?void 0:r.label()))("aria-labelledby",r.ariaLabelledBy)("aria-haspopup","listbox")("aria-expanded",(e=r.overlayVisible)!==null&&e!==void 0?e:!1)("aria-controls",r.overlayVisible?r.id+"_list":null)("tabindex",r.disabled?-1:r.tabindex)("aria-activedescendant",r.focused?r.focusedOptionId:void 0)("aria-required",r.required)("required",r.required),p(2),u("ngIf",!r.selectedItemTemplate)("ngIfElse",i),p(),u("ngIf",r.selectedItemTemplate&&!r.isSelectedOptionEmpty())}}function L_(t,n){if(t&1){let e=le();g(0,"input",26,5),G("input",function(r){S(e);let a=f();return I(a.onEditableInput(r))})("keydown",function(r){S(e);let a=f();return I(a.onKeyDown(r))})("focus",function(r){S(e);let a=f();return I(a.onInputFocus(r))})("blur",function(r){S(e);let a=f();return I(a.onInputBlur(r))}),x()}if(t&2){let e=f();u("ngClass",e.inputClass)("disabled",e.disabled)("autofocus",e.autofocus),V("id",e.inputId)("maxlength",e.maxlength)("placeholder",e.modelValue()===void 0||e.modelValue()===null?e.placeholder():void 0)("aria-label",e.ariaLabel||(e.label()==="p-emptylabel"?void 0:e.label()))("aria-activedescendant",e.focused?e.focusedOptionId:void 0)}}function R_(t,n){if(t&1){let e=le();g(0,"TimesIcon",29),G("click",function(r){S(e);let a=f(2);return I(a.clear(r))}),x()}t&2&&(u("styleClass","p-dropdown-clear-icon"),V("data-pc-section","clearicon"))}function V_(t,n){}function P_(t,n){t&1&&w(0,V_,0,0,"ng-template")}function B_(t,n){if(t&1){let e=le();g(0,"span",30),G("click",function(r){S(e);let a=f(2);return I(a.clear(r))}),w(1,P_,1,0,null,31),x()}if(t&2){let e=f(2);V("data-pc-section","clearicon"),p(),u("ngTemplateOutlet",e.clearIconTemplate)}}function N_(t,n){if(t&1&&(_e(0),w(1,R_,1,2,"TimesIcon",27)(2,B_,2,2,"span",28),ge()),t&2){let e=f();p(),u("ngIf",!e.clearIconTemplate),p(),u("ngIf",e.clearIconTemplate)}}function U_(t,n){t&1&&ye(0)}function H_(t,n){if(t&1&&(_e(0),w(1,U_,1,0,"ng-container",31),ge()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.loadingIconTemplate)}}function z_(t,n){if(t&1&&N(0,"span",34),t&2){let e=f(3);u("ngClass","p-dropdown-trigger-icon pi-spin "+e.loadingIcon)}}function W_(t,n){t&1&&N(0,"span",35),t&2&&ue("p-dropdown-trigger-icon pi pi-spinner pi-spin")}function j_(t,n){if(t&1&&(_e(0),w(1,z_,1,1,"span",32)(2,W_,1,2,"span",33),ge()),t&2){let e=f(2);p(),u("ngIf",e.loadingIcon),p(),u("ngIf",!e.loadingIcon)}}function K_(t,n){if(t&1&&(_e(0),w(1,H_,2,1,"ng-container",18)(2,j_,3,2,"ng-container",18),ge()),t&2){let e=f();p(),u("ngIf",e.loadingIconTemplate),p(),u("ngIf",!e.loadingIconTemplate)}}function G_(t,n){if(t&1&&N(0,"span",39),t&2){let e=f(3);u("ngClass",e.dropdownIcon)}}function $_(t,n){t&1&&N(0,"ChevronDownIcon",40),t&2&&u("styleClass","p-dropdown-trigger-icon")}function Y_(t,n){if(t&1&&(_e(0),w(1,G_,1,1,"span",37)(2,$_,1,1,"ChevronDownIcon",38),ge()),t&2){let e=f(2);p(),u("ngIf",e.dropdownIcon),p(),u("ngIf",!e.dropdownIcon)}}function X_(t,n){}function q_(t,n){t&1&&w(0,X_,0,0,"ng-template")}function Z_(t,n){if(t&1&&(g(0,"span",41),w(1,q_,1,0,null,31),x()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.dropdownIconTemplate)}}function Q_(t,n){if(t&1&&w(0,Y_,3,2,"ng-container",18)(1,Z_,2,1,"span",36),t&2){let e=f();u("ngIf",!e.dropdownIconTemplate),p(),u("ngIf",e.dropdownIconTemplate)}}function J_(t,n){t&1&&ye(0)}function eg(t,n){t&1&&ye(0)}function tg(t,n){if(t&1&&(_e(0),w(1,eg,1,0,"ng-container",48),ge()),t&2){let e=f(3);p(),u("ngTemplateOutlet",e.filterTemplate)("ngTemplateOutletContext",Le(2,X0,e.filterOptions))}}function ig(t,n){t&1&&N(0,"SearchIcon",40),t&2&&u("styleClass","p-dropdown-filter-icon")}function ng(t,n){}function rg(t,n){t&1&&w(0,ng,0,0,"ng-template")}function ag(t,n){if(t&1&&(g(0,"span",52),w(1,rg,1,0,null,31),x()),t&2){let e=f(4);p(),u("ngTemplateOutlet",e.filterIconTemplate)}}function sg(t,n){if(t&1){let e=le();g(0,"div",49)(1,"input",50,10),G("input",function(r){S(e);let a=f(3);return I(a.onFilterInputChange(r))})("keydown",function(r){S(e);let a=f(3);return I(a.onFilterKeyDown(r))})("blur",function(r){S(e);let a=f(3);return I(a.onFilterBlur(r))}),x(),w(3,ig,1,1,"SearchIcon",38)(4,ag,2,1,"span",51),x()}if(t&2){let e=f(3);p(),u("value",e._filterValue()||"")("ngClass",Le(8,k_,e.variant==="filled"||e.config.inputStyle()==="filled")),V("placeholder",e.filterPlaceholder)("aria-owns",e.id+"_list")("aria-label",e.ariaFilterLabel)("aria-activedescendant",e.focusedOptionId),p(2),u("ngIf",!e.filterIconTemplate),p(),u("ngIf",e.filterIconTemplate)}}function og(t,n){if(t&1){let e=le();g(0,"div",47),G("click",function(r){return S(e),I(r.stopPropagation())}),w(1,tg,2,4,"ng-container",20)(2,sg,5,10,"ng-template",null,9,$t),x()}if(t&2){let e=vt(3),i=f(2);p(),u("ngIf",i.filterTemplate)("ngIfElse",e)}}function lg(t,n){t&1&&ye(0)}function cg(t,n){if(t&1&&w(0,lg,1,0,"ng-container",48),t&2){let e=n.$implicit,i=n.options;f(2);let r=vt(9);u("ngTemplateOutlet",r)("ngTemplateOutletContext",pt(2,q0,e,i))}}function dg(t,n){t&1&&ye(0)}function pg(t,n){if(t&1&&w(0,dg,1,0,"ng-container",48),t&2){let e=n.options,i=f(4);u("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",Le(2,X0,e))}}function ug(t,n){t&1&&(_e(0),w(1,pg,1,4,"ng-template",54),ge())}function fg(t,n){if(t&1){let e=le();g(0,"p-scroller",53,11),G("onLazyLoad",function(r){S(e);let a=f(2);return I(a.onLazyLoad.emit(r))}),w(2,cg,1,5,"ng-template",22)(3,ug,2,0,"ng-container",18),x()}if(t&2){let e=f(2);Ai(Le(8,xs,e.scrollHeight)),u("items",e.visibleOptions())("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),p(3),u("ngIf",e.loaderTemplate)}}function hg(t,n){t&1&&ye(0)}function mg(t,n){if(t&1&&(_e(0),w(1,hg,1,0,"ng-container",48),ge()),t&2){f();let e=vt(9),i=f();p(),u("ngTemplateOutlet",e)("ngTemplateOutletContext",pt(3,q0,i.visibleOptions(),Ot(2,E_)))}}function _g(t,n){if(t&1&&(g(0,"span"),Y(1),x()),t&2){let e=f(2).$implicit,i=f(3);p(),be(i.getOptionGroupLabel(e.optionGroup))}}function gg(t,n){t&1&&ye(0)}function xg(t,n){if(t&1&&(_e(0),g(1,"li",58),w(2,_g,2,1,"span",18)(3,gg,1,0,"ng-container",48),x(),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f().options,s=f(2);p(),u("ngStyle",Le(5,xs,a.itemSize+"px")),V("id",s.id+"_"+s.getOptionIndex(r,a)),p(),u("ngIf",!s.groupTemplate),p(),u("ngTemplateOutlet",s.groupTemplate)("ngTemplateOutletContext",Le(7,Dl,i.optionGroup))}}function vg(t,n){if(t&1){let e=le();_e(0),g(1,"p-dropdownItem",59),G("onClick",function(r){S(e);let a=f().$implicit,s=f(3);return I(s.onOptionSelect(r,a))})("onMouseEnter",function(r){S(e);let a=f().index,s=f().options,o=f(2);return I(o.onOptionMouseEnter(r,o.getOptionIndex(a,s)))}),x(),ge()}if(t&2){let e=f(),i=e.$implicit,r=e.index,a=f().options,s=f(2);p(),u("id",s.id+"_"+s.getOptionIndex(r,a))("option",i)("checkmark",s.checkmark)("selected",s.isSelected(i))("label",s.getOptionLabel(i))("disabled",s.isOptionDisabled(i))("template",s.itemTemplate)("focused",s.focusedOptionIndex()===s.getOptionIndex(r,a))("ariaPosInset",s.getAriaPosInset(s.getOptionIndex(r,a)))("ariaSetSize",s.ariaSetSize)}}function bg(t,n){if(t&1&&w(0,xg,4,9,"ng-container",18)(1,vg,2,10,"ng-container",18),t&2){let e=n.$implicit,i=f(3);u("ngIf",i.isOptionGroup(e)),p(),u("ngIf",!i.isOptionGroup(e))}}function yg(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f(4);p(),He(" ",e.emptyFilterMessageLabel," ")}}function wg(t,n){t&1&&ye(0,null,13)}function Cg(t,n){if(t&1&&(g(0,"li",60),w(1,yg,2,1,"ng-container",20)(2,wg,2,0,"ng-container",31),x()),t&2){let e=f().options,i=f(2);u("ngStyle",Le(4,xs,e.itemSize+"px")),p(),u("ngIf",!i.emptyFilterTemplate&&!i.emptyTemplate)("ngIfElse",i.emptyFilter),p(),u("ngTemplateOutlet",i.emptyFilterTemplate||i.emptyTemplate)}}function Tg(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f(4);p(),He(" ",e.emptyMessageLabel," ")}}function Sg(t,n){t&1&&ye(0,null,14)}function Ig(t,n){if(t&1&&(g(0,"li",60),w(1,Tg,2,1,"ng-container",20)(2,Sg,2,0,"ng-container",31),x()),t&2){let e=f().options,i=f(2);u("ngStyle",Le(4,xs,e.itemSize+"px")),p(),u("ngIf",!i.emptyTemplate)("ngIfElse",i.empty),p(),u("ngTemplateOutlet",i.emptyTemplate)}}function kg(t,n){if(t&1&&(g(0,"ul",55,12),w(2,bg,2,2,"ng-template",56)(3,Cg,3,6,"li",57)(4,Ig,3,6,"li",57),x()),t&2){let e=n.$implicit,i=n.options,r=f(2);u("ngClass",i.contentStyleClass)("ngStyle",i.contentStyle),V("id",r.id+"_list")("aria-label",r.listLabel),p(2),u("ngForOf",e),p(),u("ngIf",r.filterValue&&r.isEmpty()),p(),u("ngIf",!r.filterValue&&r.isEmpty())}}function Eg(t,n){t&1&&ye(0)}function Fg(t,n){if(t&1){let e=le();g(0,"div",42)(1,"span",43,6),G("focus",function(r){S(e);let a=f();return I(a.onFirstHiddenFocus(r))}),x(),w(3,J_,1,0,"ng-container",31)(4,og,4,2,"div",44),g(5,"div",45),w(6,fg,4,10,"p-scroller",46)(7,mg,2,6,"ng-container",18)(8,kg,5,7,"ng-template",null,7,$t),x(),w(10,Eg,1,0,"ng-container",31),g(11,"span",43,8),G("focus",function(r){S(e);let a=f();return I(a.onLastHiddenFocus(r))}),x()()}if(t&2){let e=f();ue(e.panelStyleClass),u("ngClass","p-dropdown-panel p-component")("ngStyle",e.panelStyle),p(),V("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0),p(2),u("ngTemplateOutlet",e.headerTemplate),p(),u("ngIf",e.filter),p(),u("ngStyle",Le(16,I_,e.virtualScroll?"auto":e.scrollHeight||"auto")),p(),u("ngIf",e.virtualScroll),p(),u("ngIf",!e.virtualScroll),p(3),u("ngTemplateOutlet",e.footerTemplate),p(),V("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0)}}var Dg={provide:In,useExisting:ln(()=>Wn),multi:!0},Mg=(()=>{class t{id;option;selected;focused;label;disabled;visible;itemSize;ariaPosInset;ariaSetSize;template;checkmark;onClick=new fe;onMouseEnter=new fe;ngOnInit(){}onOptionClick(e){this.onClick.emit(e)}onOptionMouseEnter(e){this.onMouseEnter.emit(e)}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=he({type:t,selectors:[["p-dropdownItem"]],hostAttrs:[1,"p-element"],inputs:{id:"id",option:"option",selected:[2,"selected","selected",Q],focused:[2,"focused","focused",Q],label:"label",disabled:[2,"disabled","disabled",Q],visible:[2,"visible","visible",Q],itemSize:[2,"itemSize","itemSize",We],ariaPosInset:"ariaPosInset",ariaSetSize:"ariaSetSize",template:"template",checkmark:[2,"checkmark","checkmark",Q]},outputs:{onClick:"onClick",onMouseEnter:"onMouseEnter"},features:[_t],decls:4,vars:22,consts:[["role","option","pRipple","",3,"click","mouseenter","id","ngStyle","ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(i,r){i&1&&(g(0,"li",0),G("click",function(s){return r.onOptionClick(s)})("mouseenter",function(s){return r.onOptionMouseEnter(s)}),w(1,h_,3,2,"ng-container",1)(2,m_,2,1,"span",1)(3,__,1,0,"ng-container",2),x()),i&2&&(u("id",r.id)("ngStyle",Le(14,xs,r.itemSize+"px"))("ngClass",Ci(16,p_,r.selected,r.disabled,r.focused)),V("aria-label",r.label)("aria-setsize",r.ariaSetSize)("aria-posinset",r.ariaPosInset)("aria-selected",r.selected)("data-p-focused",r.focused)("data-p-highlight",r.selected)("data-p-disabled",r.disabled),p(),u("ngIf",r.checkmark),p(),u("ngIf",!r.template),p(),u("ngTemplateOutlet",r.template)("ngTemplateOutletContext",Le(20,Dl,r.option)))},dependencies:()=>[at,rt,bt,It,At,El,Di],encapsulation:2})}return t})(),Wn=(()=>{class t{el;renderer;cd;zone;filterService;config;id;scrollHeight="200px";filter;name;style;panelStyle;styleClass;panelStyleClass;readonly;required;editable;appendTo;tabindex=0;set placeholder(e){this._placeholder.set(e)}get placeholder(){return this._placeholder.asReadonly()}loadingIcon;filterPlaceholder;filterLocale;variant="outlined";inputId;dataKey;filterBy;filterFields;autofocus;resetFilterOnHide=!1;checkmark=!1;dropdownIcon;loading=!1;optionLabel;optionValue;optionDisabled;optionGroupLabel="label";optionGroupChildren="items";autoDisplayFirst=!0;group;showClear;emptyFilterMessage="";emptyMessage="";lazy=!1;virtualScroll;virtualScrollItemSize;virtualScrollOptions;overlayOptions;ariaFilterLabel;ariaLabel;ariaLabelledBy;filterMatchMode="contains";maxlength;tooltip="";tooltipPosition="right";tooltipPositionStyle="absolute";tooltipStyleClass;focusOnHover=!1;selectOnFocus=!1;autoOptionFocus=!0;autofocusFilter=!0;autoShowPanelOnPrintableCharacterKeyDown=!0;get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1,this.overlayVisible&&this.hide()),this._disabled=e,this.cd.destroyed||this.cd.detectChanges()}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.warn("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}_itemSize;get autoZIndex(){return this._autoZIndex}set autoZIndex(e){this._autoZIndex=e,console.warn("The autoZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}_autoZIndex;get baseZIndex(){return this._baseZIndex}set baseZIndex(e){this._baseZIndex=e,console.warn("The baseZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}_baseZIndex;get showTransitionOptions(){return this._showTransitionOptions}set showTransitionOptions(e){this._showTransitionOptions=e,console.warn("The showTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}_showTransitionOptions;get hideTransitionOptions(){return this._hideTransitionOptions}set hideTransitionOptions(e){this._hideTransitionOptions=e,console.warn("The hideTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}_hideTransitionOptions;get filterValue(){return this._filterValue()}set filterValue(e){setTimeout(()=>{this._filterValue.set(e)})}get options(){return this._options()}set options(e){Re.deepEquals(e,this._options())||this._options.set(e)}onChange=new fe;onFilter=new fe;onFocus=new fe;onBlur=new fe;onClick=new fe;onShow=new fe;onHide=new fe;onClear=new fe;onLazyLoad=new fe;containerViewChild;filterViewChild;focusInputViewChild;editableInputViewChild;itemsViewChild;scroller;overlayViewChild;firstHiddenFocusableElementOnOverlay;lastHiddenFocusableElementOnOverlay;templates;_disabled;itemsWrapper;itemTemplate;groupTemplate;loaderTemplate;selectedItemTemplate;headerTemplate;filterTemplate;footerTemplate;emptyFilterTemplate;emptyTemplate;dropdownIconTemplate;loadingIconTemplate;clearIconTemplate;filterIconTemplate;filterOptions;_options=Qr(null);_placeholder=Qr(void 0);modelValue=Qr(null);value;onModelChange=()=>{};onModelTouched=()=>{};hover;focused;overlayVisible;optionsChanged;panel;dimensionsUpdated;hoveredItem;selectedOptionUpdated;_filterValue=Qr(null);searchValue;searchIndex;searchTimeout;previousSearchChar;currentSearchChar;preventModelTouched;focusedOptionIndex=Qr(-1);labelId;listId;clicked=Qr(!1);get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(Yt.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(Yt.EMPTY_FILTER_MESSAGE)}get isVisibleClearIcon(){return this.modelValue()!=null&&this.hasSelectedOption()&&this.showClear&&!this.disabled}get listLabel(){return this.config.getTranslation(Yt.ARIA).listLabel}get containerClass(){return{"p-dropdown p-component p-inputwrapper":!0,"p-disabled":this.disabled,"p-dropdown-clearable":this.showClear&&!this.disabled,"p-focus":this.focused,"p-inputwrapper-filled":this.modelValue()!==void 0&&this.modelValue()!==null&&!this.modelValue().length,"p-inputwrapper-focus":this.focused||this.overlayVisible,"p-variant-filled":this.variant==="filled"||this.config.inputStyle()==="filled","p-dropdown-open":this.overlayVisible}}get inputClass(){let e=this.label();return{"p-dropdown-label p-inputtext":!0,"p-placeholder":this.placeholder()&&e===this.placeholder(),"p-dropdown-label-empty":!this.editable&&!this.selectedItemTemplate&&(e==null||e==="p-emptylabel"||e.length===0)}}get panelClass(){return{"p-dropdown-panel p-component":!0,"p-input-filled":this.config.inputStyle()==="filled","p-ripple-disabled":this.config.ripple===!1}}get focusedOptionId(){return this.focusedOptionIndex()!==-1?`${this.id}_${this.focusedOptionIndex()}`:null}visibleOptions=gs(()=>{let e=this.getAllVisibleAndNonVisibleOptions();if(this._filterValue()){let r=!(this.filterBy||this.optionLabel)&&!this.filterFields&&!this.optionValue?this.options.filter(a=>a.label?a.label.toString().toLowerCase().indexOf(this._filterValue().toLowerCase().trim())!==-1:a.toString().toLowerCase().indexOf(this._filterValue().toLowerCase().trim())!==-1):this.filterService.filter(e,this.searchFields(),this._filterValue().trim(),this.filterMatchMode,this.filterLocale);if(this.group){let a=this.options||[],s=[];return a.forEach(o=>{let c=this.getOptionGroupChildren(o).filter(d=>r.includes(d));c.length>0&&s.push(_n(Tt({},o),{[typeof this.optionGroupChildren=="string"?this.optionGroupChildren:"items"]:[...c]}))}),this.flatOptions(s)}return r}return e});label=gs(()=>{let e=this.getAllVisibleAndNonVisibleOptions(),i=e.findIndex(r=>this.isOptionValueEqualsModelValue(r));return i!==-1?this.getOptionLabel(e[i]):this.placeholder()||"p-emptylabel"});filled=gs(()=>{if(typeof this.modelValue()=="string")return!!this.modelValue();let i=this.getAllVisibleAndNonVisibleOptions().findIndex(r=>this.isOptionValueEqualsModelValue(r))!==-1;return this.label()!=="p-emptylabel"&&i});selectedOption;editableInputValue=gs(()=>this.getOptionLabel(this.selectedOption)||this.modelValue()||"");constructor(e,i,r,a,s,o){this.el=e,this.renderer=i,this.cd=r,this.zone=a,this.filterService=s,this.config=o,D0(()=>{let l=this.modelValue(),c=this.visibleOptions();if(c&&Re.isNotEmpty(c)){let d=this.findSelectedOptionIndex();(d!==-1||l===void 0||typeof l=="string"&&l.length===0||this.isModelValueNotSet()||this.editable)&&(this.selectedOption=c[d])}Re.isEmpty(c)&&(l===void 0||this.isModelValueNotSet())&&Re.isNotEmpty(this.selectedOption)&&(this.selectedOption=null),l!==void 0&&this.editable&&this.updateEditableLabel(),this.cd.markForCheck()})}isModelValueNotSet(){return this.modelValue()===null&&!this.isOptionValueEqualsModelValue(this.selectedOption)}getAllVisibleAndNonVisibleOptions(){return this.group?this.flatOptions(this.options):this.options||[]}ngOnInit(){this.id=this.id||ot(),this.autoUpdateModel(),this.filterBy&&(this.filterOptions={filter:e=>this.onFilterInputChange(e),reset:()=>this.resetFilter()})}ngAfterViewChecked(){if(this.optionsChanged&&this.overlayVisible&&(this.optionsChanged=!1,this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1)})),this.selectedOptionUpdated&&this.itemsWrapper){let e=R.findSingle(this.overlayViewChild?.overlayViewChild?.nativeElement,"li.p-highlight");e&&R.scrollInView(this.itemsWrapper,e),this.selectedOptionUpdated=!1}}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this.itemTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"filter":this.filterTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"loader":this.loaderTemplate=e.template;break;case"dropdownicon":this.dropdownIconTemplate=e.template;break;case"loadingicon":this.loadingIconTemplate=e.template;break;case"clearicon":this.clearIconTemplate=e.template;break;case"filtericon":this.filterIconTemplate=e.template;break;default:this.itemTemplate=e.template;break}})}flatOptions(e){return(e||[]).reduce((i,r,a)=>{i.push({optionGroup:r,group:!0,index:a});let s=this.getOptionGroupChildren(r);return s&&s.forEach(o=>i.push(o)),i},[])}autoUpdateModel(){if(this.selectOnFocus&&this.autoOptionFocus&&!this.hasSelectedOption()&&(this.focusedOptionIndex.set(this.findFirstFocusedOptionIndex()),this.onOptionSelect(null,this.visibleOptions()[this.focusedOptionIndex()],!1)),this.autoDisplayFirst&&(this.modelValue()===null||this.modelValue()===void 0)&&!this.placeholder()){let e=this.findFirstOptionIndex();this.onOptionSelect(null,this.visibleOptions()[e],!1,!0)}}onOptionSelect(e,i,r=!0,a=!1){if(!this.isSelected(i)){let s=this.getOptionValue(i);this.updateModel(s,e),this.focusedOptionIndex.set(this.findSelectedOptionIndex()),a===!1&&this.onChange.emit({originalEvent:e,value:s})}r&&this.hide(!0)}onOptionMouseEnter(e,i){this.focusOnHover&&this.changeFocusedOptionIndex(e,i)}updateModel(e,i){this.value=e,this.onModelChange(e),this.modelValue.set(e),this.selectedOptionUpdated=!0}writeValue(e,i=!0){this.filter&&this.resetFilter(),this.value=e,i&&this.allowModelChange()&&this.onModelChange(e),this.modelValue.set(this.value),this.updateEditableLabel(),this.cd.markForCheck()}allowModelChange(){return this.autoDisplayFirst&&!this.placeholder()&&(this.modelValue()===void 0||this.modelValue()===null)&&!this.editable&&this.options&&this.options.length}isSelectedOptionEmpty(){return Re.isEmpty(this.selectedOption)}isSelected(e){return this.isValidOption(e)&&this.isOptionValueEqualsModelValue(e)}isOptionValueEqualsModelValue(e){return Re.equals(this.modelValue(),this.getOptionValue(e),this.equalityKey())}ngAfterViewInit(){this.editable&&this.updateEditableLabel(),this.updatePlaceHolderForFloatingLabel()}updatePlaceHolderForFloatingLabel(){if(this._placeholder()!==null&&this._placeholder()!==void 0)return;let e=this.el.nativeElement.parentElement,i=e?.classList.contains("p-float-label");if(e&&i&&!this.selectedOption){let r=e.querySelector("label");r&&this._placeholder.set(r.textContent)}}updateEditableLabel(){this.editableInputViewChild&&(this.editableInputViewChild.nativeElement.value=this.getOptionLabel(this.selectedOption)||this.modelValue()||"")}clearEditableLabel(){this.editableInputViewChild&&(this.editableInputViewChild.nativeElement.value="")}getOptionIndex(e,i){return this.virtualScrollerDisabled?e:i&&i.getItemOptions(e).index}getOptionLabel(e){return this.optionLabel!==void 0&&this.optionLabel!==null?Re.resolveFieldData(e,this.optionLabel):e&&e.label!==void 0?e.label:e}getOptionValue(e){return this.optionValue&&this.optionValue!==null?Re.resolveFieldData(e,this.optionValue):!this.optionLabel&&e&&e.value!==void 0?e.value:e}isOptionDisabled(e){return this.getOptionValue(this.modelValue())===this.getOptionValue(e)||this.getOptionLabel(this.modelValue()===this.getOptionLabel(e))&&e.disabled===!1?!1:this.optionDisabled?Re.resolveFieldData(e,this.optionDisabled):e&&e.disabled!==void 0?e.disabled:!1}getOptionGroupLabel(e){return this.optionGroupLabel!==void 0&&this.optionGroupLabel!==null?Re.resolveFieldData(e,this.optionGroupLabel):e&&e.label!==void 0?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren!==void 0&&this.optionGroupChildren!==null?Re.resolveFieldData(e,this.optionGroupChildren):e.items}getAriaPosInset(e){return(this.optionGroupLabel?e-this.visibleOptions().slice(0,e).filter(i=>this.isOptionGroup(i)).length:e)+1}get ariaSetSize(){return this.visibleOptions().filter(e=>!this.isOptionGroup(e)).length}resetFilter(){this._filterValue.set(null),this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value="")}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onContainerClick(e){this.disabled||this.readonly||this.loading||(this.focusInputViewChild?.nativeElement.focus({preventScroll:!0}),!(e.target.tagName==="INPUT"||e.target.getAttribute("data-pc-section")==="clearicon"||e.target.closest('[data-pc-section="clearicon"]'))&&((!this.overlayViewChild||!this.overlayViewChild.el.nativeElement.contains(e.target))&&(this.overlayVisible?this.hide(!0):this.show(!0)),this.onClick.emit(e),this.clicked.set(!0),this.cd.detectChanges()))}isEmpty(){return!this._options()||this.visibleOptions()&&this.visibleOptions().length===0}onEditableInput(e){let i=e.target.value;this.searchValue="",!this.searchOptions(e,i)&&this.focusedOptionIndex.set(-1),this.onModelChange(i),this.updateModel(i,e),setTimeout(()=>{this.onChange.emit({originalEvent:e,value:i})},1),!this.overlayVisible&&Re.isNotEmpty(i)&&this.show()}show(e){this.overlayVisible=!0;let i=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex();this.focusedOptionIndex.set(i),e&&R.focus(this.focusInputViewChild?.nativeElement),this.cd.markForCheck()}onOverlayAnimationStart(e){if(e.toState==="visible"){if(this.itemsWrapper=R.findSingle(this.overlayViewChild?.overlayViewChild?.nativeElement,this.virtualScroll?".p-scroller":".p-dropdown-items-wrapper"),this.virtualScroll&&this.scroller?.setContentEl(this.itemsViewChild?.nativeElement),this.options&&this.options.length)if(this.virtualScroll){let i=this.modelValue()?this.focusedOptionIndex():-1;i!==-1&&this.scroller?.scrollToIndex(i)}else{let i=R.findSingle(this.itemsWrapper,".p-dropdown-item.p-highlight");i&&i.scrollIntoView({block:"nearest",inline:"nearest"})}this.filterViewChild&&this.filterViewChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&!this.editable&&this.filterViewChild.nativeElement.focus()),this.onShow.emit(e)}e.toState==="void"&&(this.itemsWrapper=null,this.onModelTouched(),this.onHide.emit(e))}hide(e){this.overlayVisible=!1,this.focusedOptionIndex.set(-1),this.clicked.set(!1),this.searchValue="",this.overlayOptions?.mode==="modal"&&R.unblockBodyScroll(),this.filter&&this.resetFilterOnHide&&this.resetFilter(),e&&(this.focusInputViewChild&&setTimeout(()=>{R.focus(this.focusInputViewChild?.nativeElement)}),this.editable&&this.editableInputViewChild&&setTimeout(()=>{R.focus(this.editableInputViewChild?.nativeElement)})),this.cd.markForCheck()}onInputFocus(e){if(this.disabled)return;this.focused=!0;let i=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(i),this.overlayVisible&&this.scrollInView(this.focusedOptionIndex()),this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onBlur.emit(e),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}onMouseDown(e){e.preventDefault()}onKeyDown(e,i){if(!(this.disabled||this.readonly||this.loading)){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,this.editable);break;case"Delete":this.onDeleteKey(e);break;case"Home":this.onHomeKey(e,this.editable);break;case"End":this.onEndKey(e,this.editable);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Space":this.onSpaceKey(e,i);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!e.metaKey&&Re.isPrintableCharacter(e.key)&&(!this.overlayVisible&&this.autoShowPanelOnPrintableCharacterKeyDown&&this.show(),!this.editable&&this.searchOptions(e,e.key));break}this.clicked.set(!1)}}onFilterKeyDown(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":case"NumpadEnter":this.onEnterKey(e,!0);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e,!0);break;default:break}}onFilterBlur(e){this.focusedOptionIndex.set(-1)}onArrowDownKey(e){if(!this.overlayVisible)this.show(),this.editable&&this.changeFocusedOptionIndex(e,this.findSelectedOptionIndex());else{let i=this.focusedOptionIndex()!==-1?this.findNextOptionIndex(this.focusedOptionIndex()):this.clicked()?this.findFirstOptionIndex():this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,i)}e.preventDefault(),e.stopPropagation()}changeFocusedOptionIndex(e,i){if(this.focusedOptionIndex()!==i&&(this.focusedOptionIndex.set(i),this.scrollInView(),this.selectOnFocus)){let r=this.visibleOptions()[i];this.onOptionSelect(e,r,!1)}}get virtualScrollerDisabled(){return!this.virtualScroll}scrollInView(e=-1){let i=e!==-1?`${this.id}_${e}`:this.focusedOptionId;if(this.itemsViewChild&&this.itemsViewChild.nativeElement){let r=R.findSingle(this.itemsViewChild.nativeElement,`li[id="${i}"]`);r?r.scrollIntoView&&r.scrollIntoView({block:"nearest",inline:"nearest"}):this.virtualScrollerDisabled||setTimeout(()=>{this.virtualScroll&&this.scroller?.scrollToIndex(e!==-1?e:this.focusedOptionIndex())},0)}}hasSelectedOption(){return this.modelValue()!==void 0}isValidSelectedOption(e){return this.isValidOption(e)&&this.isSelected(e)}equalityKey(){return this.optionValue?null:this.dataKey}findFirstFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e}findFirstOptionIndex(){return this.visibleOptions().findIndex(e=>this.isValidOption(e))}findSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(e=>this.isValidSelectedOption(e)):-1}findNextOptionIndex(e){let i=e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(r=>this.isValidOption(r)):-1;return i>-1?i+e+1:e}findPrevOptionIndex(e){let i=e>0?Re.findLastIndex(this.visibleOptions().slice(0,e),r=>this.isValidOption(r)):-1;return i>-1?i:e}findLastOptionIndex(){return Re.findLastIndex(this.visibleOptions(),e=>this.isValidOption(e))}findLastFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e}isValidOption(e){return e!=null&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))}isOptionGroup(e){return this.optionGroupLabel!==void 0&&this.optionGroupLabel!==null&&e.optionGroup!==void 0&&e.optionGroup!==null&&e.group}onArrowUpKey(e,i=!1){if(e.altKey&&!i){if(this.focusedOptionIndex()!==-1){let r=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(e,r)}this.overlayVisible&&this.hide()}else{let r=this.focusedOptionIndex()!==-1?this.findPrevOptionIndex(this.focusedOptionIndex()):this.clicked()?this.findLastOptionIndex():this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,r),!this.overlayVisible&&this.show()}e.preventDefault(),e.stopPropagation()}onArrowLeftKey(e,i=!1){i&&this.focusedOptionIndex.set(-1)}onDeleteKey(e){this.showClear&&(this.clear(e),e.preventDefault())}onHomeKey(e,i=!1){if(i){let r=e.currentTarget;e.shiftKey?r.setSelectionRange(0,r.value.length):(r.setSelectionRange(0,0),this.focusedOptionIndex.set(-1))}else this.changeFocusedOptionIndex(e,this.findFirstOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()}onEndKey(e,i=!1){if(i){let r=e.currentTarget;if(e.shiftKey)r.setSelectionRange(0,r.value.length);else{let a=r.value.length;r.setSelectionRange(a,a),this.focusedOptionIndex.set(-1)}}else this.changeFocusedOptionIndex(e,this.findLastOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()}onPageDownKey(e){this.scrollInView(this.visibleOptions().length-1),e.preventDefault()}onPageUpKey(e){this.scrollInView(0),e.preventDefault()}onSpaceKey(e,i=!1){!this.editable&&!i&&this.onEnterKey(e)}onEnterKey(e,i=!1){if(!this.overlayVisible)this.focusedOptionIndex.set(-1),this.onArrowDownKey(e);else{if(this.focusedOptionIndex()!==-1){let r=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(e,r)}!i&&this.hide()}e.preventDefault()}onEscapeKey(e){this.overlayVisible&&this.hide(!0),e.preventDefault()}onTabKey(e,i=!1){if(!i)if(this.overlayVisible&&this.hasFocusableElements())R.focus(e.shiftKey?this.lastHiddenFocusableElementOnOverlay.nativeElement:this.firstHiddenFocusableElementOnOverlay.nativeElement),e.preventDefault();else{if(this.focusedOptionIndex()!==-1&&this.overlayVisible){let r=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(e,r)}this.overlayVisible&&this.hide(this.filter)}e.stopPropagation()}onFirstHiddenFocus(e){let i=e.relatedTarget===this.focusInputViewChild?.nativeElement?R.getFirstFocusableElement(this.overlayViewChild.el?.nativeElement,":not(.p-hidden-focusable)"):this.focusInputViewChild?.nativeElement;R.focus(i)}onLastHiddenFocus(e){let i=e.relatedTarget===this.focusInputViewChild?.nativeElement?R.getLastFocusableElement(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])'):this.focusInputViewChild?.nativeElement;R.focus(i)}hasFocusableElements(){return R.getFocusableElements(this.overlayViewChild.overlayViewChild.nativeElement,':not([data-p-hidden-focusable="true"]):not([class="p-dropdown-items-wrapper"])').length>0}onBackspaceKey(e,i=!1){i&&!this.overlayVisible&&this.show()}searchFields(){return this.filterBy?.split(",")||this.filterFields||[this.optionLabel]}searchOptions(e,i){this.searchValue=(this.searchValue||"")+i;let r=-1,a=!1;return this.focusedOptionIndex()!==-1?(r=this.visibleOptions().slice(this.focusedOptionIndex()).findIndex(s=>this.isOptionMatched(s)),r=r===-1?this.visibleOptions().slice(0,this.focusedOptionIndex()).findIndex(s=>this.isOptionMatched(s)):r+this.focusedOptionIndex()):r=this.visibleOptions().findIndex(s=>this.isOptionMatched(s)),r!==-1&&(a=!0),r===-1&&this.focusedOptionIndex()===-1&&(r=this.findFirstFocusedOptionIndex()),r!==-1&&this.changeFocusedOptionIndex(e,r),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),a}isOptionMatched(e){return this.isValidOption(e)&&this.getOptionLabel(e).toString().toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))}onFilterInputChange(e){let i=e.target.value;this._filterValue.set(i),this.focusedOptionIndex.set(-1),this.onFilter.emit({originalEvent:e,filter:this._filterValue()}),!this.virtualScrollerDisabled&&this.scroller.scrollToIndex(0),setTimeout(()=>{this.overlayViewChild.alignOverlay()}),this.cd.markForCheck()}applyFocus(){this.editable?R.findSingle(this.el.nativeElement,".p-dropdown-label.p-inputtext").focus():R.focus(this.focusInputViewChild?.nativeElement)}focus(){this.applyFocus()}clear(e){this.updateModel(null,e),this.clearEditableLabel(),this.onModelTouched(),this.onChange.emit({originalEvent:e,value:this.value}),this.onClear.emit(e),this.resetFilter()}static \u0275fac=function(i){return new(i||t)(Z(Lt),Z(Qt),Z(St),Z(yi),Z(ho),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-dropdown"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(g_,5),Je(x_,5),Je(v_,5),Je(b_,5),Je(y_,5),Je(w_,5),Je(C_,5),Je(T_,5),Je(S_,5)),i&2){let a;Ee(a=Fe())&&(r.containerViewChild=a.first),Ee(a=Fe())&&(r.filterViewChild=a.first),Ee(a=Fe())&&(r.focusInputViewChild=a.first),Ee(a=Fe())&&(r.editableInputViewChild=a.first),Ee(a=Fe())&&(r.itemsViewChild=a.first),Ee(a=Fe())&&(r.scroller=a.first),Ee(a=Fe())&&(r.overlayViewChild=a.first),Ee(a=Fe())&&(r.firstHiddenFocusableElementOnOverlay=a.first),Ee(a=Fe())&&(r.lastHiddenFocusableElementOnOverlay=a.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(i,r){i&2&&cn("p-inputwrapper-filled",r.filled())("p-inputwrapper-focus",r.focused||r.overlayVisible)},inputs:{id:"id",scrollHeight:"scrollHeight",filter:[2,"filter","filter",Q],name:"name",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",readonly:[2,"readonly","readonly",Q],required:[2,"required","required",Q],editable:[2,"editable","editable",Q],appendTo:"appendTo",tabindex:[2,"tabindex","tabindex",We],placeholder:"placeholder",loadingIcon:"loadingIcon",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",variant:"variant",inputId:"inputId",dataKey:"dataKey",filterBy:"filterBy",filterFields:"filterFields",autofocus:[2,"autofocus","autofocus",Q],resetFilterOnHide:[2,"resetFilterOnHide","resetFilterOnHide",Q],checkmark:[2,"checkmark","checkmark",Q],dropdownIcon:"dropdownIcon",loading:[2,"loading","loading",Q],optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",autoDisplayFirst:[2,"autoDisplayFirst","autoDisplayFirst",Q],group:[2,"group","group",Q],showClear:[2,"showClear","showClear",Q],emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",lazy:[2,"lazy","lazy",Q],virtualScroll:[2,"virtualScroll","virtualScroll",Q],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",We],virtualScrollOptions:"virtualScrollOptions",overlayOptions:"overlayOptions",ariaFilterLabel:"ariaFilterLabel",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",filterMatchMode:"filterMatchMode",maxlength:[2,"maxlength","maxlength",We],tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",focusOnHover:[2,"focusOnHover","focusOnHover",Q],selectOnFocus:[2,"selectOnFocus","selectOnFocus",Q],autoOptionFocus:[2,"autoOptionFocus","autoOptionFocus",Q],autofocusFilter:[2,"autofocusFilter","autofocusFilter",Q],autoShowPanelOnPrintableCharacterKeyDown:[2,"autoShowPanelOnPrintableCharacterKeyDown","autoShowPanelOnPrintableCharacterKeyDown",Q],disabled:"disabled",itemSize:"itemSize",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",filterValue:"filterValue",options:"options"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onShow:"onShow",onHide:"onHide",onClear:"onClear",onLazyLoad:"onLazyLoad"},features:[ji([Dg]),_t],decls:12,vars:20,consts:[["container",""],["elseBlock",""],["overlay",""],["focusInput",""],["defaultPlaceholder",""],["editableInput",""],["firstHiddenFocusableEl",""],["buildInItems",""],["lastHiddenFocusableEl",""],["builtInFilterElement",""],["filter",""],["scroller",""],["items",""],["emptyFilter",""],["empty",""],[3,"click","ngClass","ngStyle"],["role","combobox","pAutoFocus","",3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","autofocus","focus","blur","keydown",4,"ngIf"],["type","text","aria-haspopup","listbox","pAutoFocus","",3,"ngClass","disabled","autofocus","input","keydown","focus","blur",4,"ngIf"],[4,"ngIf"],["role","button","aria-label","dropdown trigger","aria-haspopup","listbox",1,"p-dropdown-trigger",3,"mousedown"],[4,"ngIf","ngIfElse"],[3,"visibleChange","onAnimationStart","onHide","visible","options","target","appendTo","autoZIndex","baseZIndex","showTransitionOptions","hideTransitionOptions"],["pTemplate","content"],["role","combobox","pAutoFocus","",3,"focus","blur","keydown","ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","autofocus"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["type","text","aria-haspopup","listbox","pAutoFocus","",3,"input","keydown","focus","blur","ngClass","disabled","autofocus"],[3,"styleClass","click",4,"ngIf"],["class","p-dropdown-clear-icon",3,"click",4,"ngIf"],[3,"click","styleClass"],[1,"p-dropdown-clear-icon",3,"click"],[4,"ngTemplateOutlet"],["aria-hidden","true",3,"ngClass",4,"ngIf"],["aria-hidden","true",3,"class",4,"ngIf"],["aria-hidden","true",3,"ngClass"],["aria-hidden","true"],["class","p-dropdown-trigger-icon",4,"ngIf"],["class","p-dropdown-trigger-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-dropdown-trigger-icon",3,"ngClass"],[3,"styleClass"],[1,"p-dropdown-trigger-icon"],[3,"ngClass","ngStyle"],["role","presentation",1,"p-hidden-accessible","p-hidden-focusable",3,"focus"],["class","p-dropdown-header",3,"click",4,"ngIf"],["tabindex","0",1,"p-dropdown-items-wrapper",3,"ngStyle"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],[1,"p-dropdown-header",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-dropdown-filter-container"],["type","text","role","searchbox","autocomplete","off",1,"p-dropdown-filter","p-inputtext","p-component",3,"input","keydown","blur","value","ngClass"],["class","p-dropdown-filter-icon",4,"ngIf"],[1,"p-dropdown-filter-icon"],[3,"onLazyLoad","items","itemSize","autoSize","lazy","options"],["pTemplate","loader"],["role","listbox",1,"p-dropdown-items",3,"ngClass","ngStyle"],["ngFor","",3,"ngForOf"],["class","p-dropdown-empty-message","role","option",3,"ngStyle",4,"ngIf"],["role","option",1,"p-dropdown-item-group",3,"ngStyle"],[3,"onClick","onMouseEnter","id","option","checkmark","selected","label","disabled","template","focused","ariaPosInset","ariaSetSize"],["role","option",1,"p-dropdown-empty-message",3,"ngStyle"]],template:function(i,r){if(i&1){let a=le();g(0,"div",15,0),G("click",function(o){return S(a),I(r.onContainerClick(o))}),w(2,A_,6,20,"span",16)(3,L_,2,8,"input",17)(4,N_,3,2,"ng-container",18),g(5,"div",19),G("mousedown",function(o){return S(a),I(r.onMouseDown(o))}),w(6,K_,3,2,"ng-container",20)(7,Q_,2,2,"ng-template",null,1,$t),x(),g(9,"p-overlay",21,2),nt("visibleChange",function(o){return S(a),it(r.overlayVisible,o)||(r.overlayVisible=o),I(o)}),G("onAnimationStart",function(o){return S(a),I(r.onOverlayAnimationStart(o))})("onHide",function(){return S(a),I(r.hide())}),w(11,Fg,13,18,"ng-template",22),x()()}if(i&2){let a,s=vt(8);ue(r.styleClass),u("ngClass",r.containerClass)("ngStyle",r.style),V("id",r.id),p(2),u("ngIf",!r.editable),p(),u("ngIf",r.editable),p(),u("ngIf",r.isVisibleClearIcon),p(),V("aria-expanded",(a=r.overlayVisible)!==null&&a!==void 0?a:!1)("data-pc-section","trigger"),p(),u("ngIf",r.loading)("ngIfElse",s),p(3),tt("visible",r.overlayVisible),u("options",r.overlayOptions)("target","@parent")("appendTo",r.appendTo)("autoZIndex",r.autoZIndex)("baseZIndex",r.baseZIndex)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions)}},dependencies:()=>[at,ii,rt,bt,It,Sl,Ze,Ar,xo,Zn,Rt,Pa,Fl,Mg],styles:[`@layer primeng{.p-dropdown{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-dropdown-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-dropdown-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-dropdown-label{display:block;white-space:nowrap;overflow:hidden;flex:1 1 auto;width:1%;text-overflow:ellipsis;cursor:pointer}.p-dropdown-label-empty{overflow:hidden;opacity:0}input.p-dropdown-label{cursor:default}.p-dropdown .p-dropdown-panel{min-width:100%}.p-dropdown-items-wrapper{overflow:auto}.p-dropdown-item{cursor:pointer;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-dropdown-item-group{cursor:auto}.p-dropdown-items{margin:0;padding:0;list-style-type:none}.p-dropdown-filter{width:100%}.p-dropdown-filter-container{position:relative}.p-dropdown-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-dropdown{display:flex}.p-fluid .p-dropdown .p-dropdown-label{width:1%}.p-float-label .p-dropdown .p-placeholder{opacity:0}}
`],encapsulation:2,changeDetection:0})}return t})(),xn=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,Il,ct,zn,ai,Na,Qn,Rt,Pa,Fl,El,Di,Il,ct,Na]})}return t})();var Ml=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["ArrowDownIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M6.99994 14C6.91097 14.0004 6.82281 13.983 6.74064 13.9489C6.65843 13.9148 6.58387 13.8646 6.52133 13.8013L1.10198 8.38193C0.982318 8.25351 0.917175 8.08367 0.920272 7.90817C0.923368 7.73267 0.994462 7.56523 1.11858 7.44111C1.24269 7.317 1.41014 7.2459 1.58563 7.2428C1.76113 7.23971 1.93098 7.30485 2.0594 7.42451L6.32263 11.6877V0.677419C6.32263 0.497756 6.394 0.325452 6.52104 0.198411C6.64808 0.0713706 6.82039 0 7.00005 0C7.17971 0 7.35202 0.0713706 7.47906 0.198411C7.6061 0.325452 7.67747 0.497756 7.67747 0.677419V11.6877L11.9407 7.42451C12.0691 7.30485 12.2389 7.23971 12.4144 7.2428C12.5899 7.2459 12.7574 7.317 12.8815 7.44111C13.0056 7.56523 13.0767 7.73267 13.0798 7.90817C13.0829 8.08367 13.0178 8.25351 12.8981 8.38193L7.47875 13.8013C7.41621 13.8646 7.34164 13.9148 7.25944 13.9489C7.17727 13.983 7.08912 14.0004 7.00015 14C7.00012 14 7.00009 14 7.00005 14C7.00001 14 6.99998 14 6.99994 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Ol=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["ArrowUpIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M6.51551 13.799C6.64205 13.9255 6.813 13.9977 6.99193 14C7.17087 13.9977 7.34182 13.9255 7.46835 13.799C7.59489 13.6725 7.66701 13.5015 7.66935 13.3226V2.31233L11.9326 6.57554C11.9951 6.63887 12.0697 6.68907 12.1519 6.72319C12.2341 6.75731 12.3223 6.77467 12.4113 6.77425C12.5003 6.77467 12.5885 6.75731 12.6707 6.72319C12.7529 6.68907 12.8274 6.63887 12.89 6.57554C13.0168 6.44853 13.0881 6.27635 13.0881 6.09683C13.0881 5.91732 13.0168 5.74514 12.89 5.61812L7.48846 0.216594C7.48274 0.210436 7.4769 0.204374 7.47094 0.198411C7.3439 0.0713707 7.1716 0 6.99193 0C6.81227 0 6.63997 0.0713707 6.51293 0.198411C6.50704 0.204296 6.50128 0.210278 6.49563 0.216354L1.09386 5.61812C0.974201 5.74654 0.909057 5.91639 0.912154 6.09189C0.91525 6.26738 0.986345 6.43483 1.11046 6.55894C1.23457 6.68306 1.40202 6.75415 1.57752 6.75725C1.75302 6.76035 1.92286 6.6952 2.05128 6.57554L6.31451 2.31231V13.3226C6.31685 13.5015 6.38898 13.6725 6.51551 13.799Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Z0=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["FilterIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8.64708 14H5.35296C5.18981 13.9979 5.03395 13.9321 4.91858 13.8167C4.8032 13.7014 4.73745 13.5455 4.73531 13.3824V7L0.329431 0.98C0.259794 0.889466 0.217389 0.780968 0.20718 0.667208C0.19697 0.553448 0.219379 0.439133 0.271783 0.337647C0.324282 0.236453 0.403423 0.151519 0.500663 0.0920138C0.597903 0.0325088 0.709548 0.000692754 0.823548 0H13.1765C13.2905 0.000692754 13.4021 0.0325088 13.4994 0.0920138C13.5966 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7826 0.780968 13.7402 0.889466 13.6706 0.98L9.26472 7V13.3824C9.26259 13.5455 9.19683 13.7014 9.08146 13.8167C8.96609 13.9321 8.81022 13.9979 8.64708 14ZM5.97061 12.7647H8.02943V6.79412C8.02878 6.66289 8.07229 6.53527 8.15296 6.43177L11.9412 1.23529H2.05884L5.86355 6.43177C5.94422 6.53527 5.98773 6.66289 5.98708 6.79412L5.97061 12.7647Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Q0=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["FilterSlashIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M13.4994 0.0920138C13.5967 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7827 0.780968 13.7403 0.889466 13.6707 0.98L11.406 4.06823C11.3099 4.19928 11.1656 4.28679 11.005 4.3115C10.8444 4.33621 10.6805 4.2961 10.5495 4.2C10.4184 4.1039 10.3309 3.95967 10.3062 3.79905C10.2815 3.63843 10.3216 3.47458 10.4177 3.34353L11.9412 1.23529H7.41184C7.24803 1.23529 7.09093 1.17022 6.97509 1.05439C6.85926 0.938558 6.79419 0.781457 6.79419 0.617647C6.79419 0.453837 6.85926 0.296736 6.97509 0.180905C7.09093 0.0650733 7.24803 0 7.41184 0H13.1765C13.2905 0.000692754 13.4022 0.0325088 13.4994 0.0920138ZM4.20008 0.181168H4.24126L13.2013 9.03411C13.3169 9.14992 13.3819 9.3069 13.3819 9.47058C13.3819 9.63426 13.3169 9.79124 13.2013 9.90705C13.1445 9.96517 13.0766 10.0112 13.0016 10.0423C12.9266 10.0735 12.846 10.0891 12.7648 10.0882C12.6836 10.0886 12.6032 10.0728 12.5283 10.0417C12.4533 10.0106 12.3853 9.96479 12.3283 9.90705L9.3142 6.92587L9.26479 6.99999V13.3823C9.26265 13.5455 9.19689 13.7014 9.08152 13.8167C8.96615 13.9321 8.81029 13.9979 8.64714 14H5.35302C5.18987 13.9979 5.03401 13.9321 4.91864 13.8167C4.80327 13.7014 4.73751 13.5455 4.73537 13.3823V6.99999L0.329492 1.02117C0.259855 0.930634 0.21745 0.822137 0.207241 0.708376C0.197031 0.594616 0.21944 0.480301 0.271844 0.378815C0.324343 0.277621 0.403484 0.192687 0.500724 0.133182C0.597964 0.073677 0.709609 0.041861 0.823609 0.0411682H3.86243C3.92448 0.0461551 3.9855 0.060022 4.04361 0.0823446C4.10037 0.10735 4.15311 0.140655 4.20008 0.181168ZM8.02949 6.79411C8.02884 6.66289 8.07235 6.53526 8.15302 6.43176L8.42478 6.05293L3.55773 1.23529H2.0589L5.84714 6.43176C5.92781 6.53526 5.97132 6.66289 5.97067 6.79411V12.7647H8.02949V6.79411Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var bs=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["PlusIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M7.67742 6.32258V0.677419C7.67742 0.497757 7.60605 0.325452 7.47901 0.198411C7.35197 0.0713707 7.17966 0 7 0C6.82034 0 6.64803 0.0713707 6.52099 0.198411C6.39395 0.325452 6.32258 0.497757 6.32258 0.677419V6.32258H0.677419C0.497757 6.32258 0.325452 6.39395 0.198411 6.52099C0.0713707 6.64803 0 6.82034 0 7C0 7.17966 0.0713707 7.35197 0.198411 7.47901C0.325452 7.60605 0.497757 7.67742 0.677419 7.67742H6.32258V13.3226C6.32492 13.5015 6.39704 13.6725 6.52358 13.799C6.65012 13.9255 6.82106 13.9977 7 14C7.17966 14 7.35197 13.9286 7.47901 13.8016C7.60605 13.6745 7.67742 13.5022 7.67742 13.3226V7.67742H13.3226C13.5022 7.67742 13.6745 7.60605 13.8016 7.47901C13.9286 7.35197 14 7.17966 14 7C13.9977 6.82106 13.9255 6.65012 13.799 6.52358C13.6725 6.39704 13.5015 6.32492 13.3226 6.32258H7.67742Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Al=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["SortAltIcon"]],standalone:!0,features:[qe,Ue],decls:9,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M5.64515 3.61291C5.47353 3.61291 5.30192 3.54968 5.16644 3.4142L3.38708 1.63484L1.60773 3.4142C1.34579 3.67613 0.912244 3.67613 0.650309 3.4142C0.388374 3.15226 0.388374 2.71871 0.650309 2.45678L2.90837 0.198712C3.17031 -0.0632236 3.60386 -0.0632236 3.86579 0.198712L6.12386 2.45678C6.38579 2.71871 6.38579 3.15226 6.12386 3.4142C5.98837 3.54968 5.81676 3.61291 5.64515 3.61291Z","fill","currentColor"],["d","M3.38714 14C3.01681 14 2.70972 13.6929 2.70972 13.3226V0.677419C2.70972 0.307097 3.01681 0 3.38714 0C3.75746 0 4.06456 0.307097 4.06456 0.677419V13.3226C4.06456 13.6929 3.75746 14 3.38714 14Z","fill","currentColor"],["d","M10.6129 14C10.4413 14 10.2697 13.9368 10.1342 13.8013L7.87611 11.5432C7.61418 11.2813 7.61418 10.8477 7.87611 10.5858C8.13805 10.3239 8.5716 10.3239 8.83353 10.5858L10.6129 12.3652L12.3922 10.5858C12.6542 10.3239 13.0877 10.3239 13.3497 10.5858C13.6116 10.8477 13.6116 11.2813 13.3497 11.5432L11.0916 13.8013C10.9561 13.9368 10.7845 14 10.6129 14Z","fill","currentColor"],["d","M10.6129 14C10.2426 14 9.93552 13.6929 9.93552 13.3226V0.677419C9.93552 0.307097 10.2426 0 10.6129 0C10.9833 0 11.2904 0.307097 11.2904 0.677419V13.3226C11.2904 13.6929 10.9832 14 10.6129 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1)(3,"path",2)(4,"path",3)(5,"path",4),x(),g(6,"defs")(7,"clipPath",5),N(8,"rect",6),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(6),u("id",r.pathId))},encapsulation:2})}return t})();var Ll=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["SortAmountDownIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.93953 10.5858L3.83759 11.6877V0.677419C3.83759 0.307097 3.53049 0 3.16017 0C2.78985 0 2.48275 0.307097 2.48275 0.677419V11.6877L1.38082 10.5858C1.11888 10.3239 0.685331 10.3239 0.423396 10.5858C0.16146 10.8477 0.16146 11.2813 0.423396 11.5432L2.68146 13.8013C2.74469 13.8645 2.81694 13.9097 2.89823 13.9458C2.97952 13.9819 3.06985 14 3.16017 14C3.25049 14 3.33178 13.9819 3.42211 13.9458C3.5034 13.9097 3.57565 13.8645 3.63888 13.8013L5.89694 11.5432C6.15888 11.2813 6.15888 10.8477 5.89694 10.5858C5.63501 10.3239 5.20146 10.3239 4.93953 10.5858ZM13.0957 0H7.22468C6.85436 0 6.54726 0.307097 6.54726 0.677419C6.54726 1.04774 6.85436 1.35484 7.22468 1.35484H13.0957C13.466 1.35484 13.7731 1.04774 13.7731 0.677419C13.7731 0.307097 13.466 0 13.0957 0ZM7.22468 5.41935H9.48275C9.85307 5.41935 10.1602 5.72645 10.1602 6.09677C10.1602 6.4671 9.85307 6.77419 9.48275 6.77419H7.22468C6.85436 6.77419 6.54726 6.4671 6.54726 6.09677C6.54726 5.72645 6.85436 5.41935 7.22468 5.41935ZM7.6763 8.12903H7.22468C6.85436 8.12903 6.54726 8.43613 6.54726 8.80645C6.54726 9.17677 6.85436 9.48387 7.22468 9.48387H7.6763C8.04662 9.48387 8.35372 9.17677 8.35372 8.80645C8.35372 8.43613 8.04662 8.12903 7.6763 8.12903ZM7.22468 2.70968H11.2892C11.6595 2.70968 11.9666 3.01677 11.9666 3.3871C11.9666 3.75742 11.6595 4.06452 11.2892 4.06452H7.22468C6.85436 4.06452 6.54726 3.75742 6.54726 3.3871C6.54726 3.01677 6.85436 2.70968 7.22468 2.70968Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Rl=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["SortAmountUpAltIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M3.63435 0.19871C3.57113 0.135484 3.49887 0.0903226 3.41758 0.0541935C3.255 -0.0180645 3.06532 -0.0180645 2.90274 0.0541935C2.82145 0.0903226 2.74919 0.135484 2.68597 0.19871L0.427901 2.45677C0.165965 2.71871 0.165965 3.15226 0.427901 3.41419C0.689836 3.67613 1.12338 3.67613 1.38532 3.41419L2.48726 2.31226V13.3226C2.48726 13.6929 2.79435 14 3.16467 14C3.535 14 3.84209 13.6929 3.84209 13.3226V2.31226L4.94403 3.41419C5.07951 3.54968 5.25113 3.6129 5.42274 3.6129C5.59435 3.6129 5.76597 3.54968 5.90145 3.41419C6.16338 3.15226 6.16338 2.71871 5.90145 2.45677L3.64338 0.19871H3.63435ZM13.7685 13.3226C13.7685 12.9523 13.4615 12.6452 13.0911 12.6452H7.22016C6.84984 12.6452 6.54274 12.9523 6.54274 13.3226C6.54274 13.6929 6.84984 14 7.22016 14H13.0911C13.4615 14 13.7685 13.6929 13.7685 13.3226ZM7.22016 8.58064C6.84984 8.58064 6.54274 8.27355 6.54274 7.90323C6.54274 7.5329 6.84984 7.22581 7.22016 7.22581H9.47823C9.84855 7.22581 10.1556 7.5329 10.1556 7.90323C10.1556 8.27355 9.84855 8.58064 9.47823 8.58064H7.22016ZM7.22016 5.87097H7.67177C8.0421 5.87097 8.34919 5.56387 8.34919 5.19355C8.34919 4.82323 8.0421 4.51613 7.67177 4.51613H7.22016C6.84984 4.51613 6.54274 4.82323 6.54274 5.19355C6.54274 5.56387 6.84984 5.87097 7.22016 5.87097ZM11.2847 11.2903H7.22016C6.84984 11.2903 6.54274 10.9832 6.54274 10.6129C6.54274 10.2426 6.84984 9.93548 7.22016 9.93548H11.2847C11.655 9.93548 11.9621 10.2426 11.9621 10.6129C11.9621 10.9832 11.655 11.2903 11.2847 11.2903Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var J0=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["TrashIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.44802 13.9955H10.552C10.8056 14.0129 11.06 13.9797 11.3006 13.898C11.5412 13.8163 11.7632 13.6877 11.9537 13.5196C12.1442 13.3515 12.2995 13.1473 12.4104 12.9188C12.5213 12.6903 12.5858 12.442 12.6 12.1884V4.36041H13.4C13.5591 4.36041 13.7117 4.29722 13.8243 4.18476C13.9368 4.07229 14 3.91976 14 3.76071C14 3.60166 13.9368 3.44912 13.8243 3.33666C13.7117 3.22419 13.5591 3.16101 13.4 3.16101H12.0537C12.0203 3.1557 11.9863 3.15299 11.952 3.15299C11.9178 3.15299 11.8838 3.1557 11.8503 3.16101H11.2285C11.2421 3.10893 11.2487 3.05513 11.248 3.00106V1.80966C11.2171 1.30262 10.9871 0.828306 10.608 0.48989C10.229 0.151475 9.73159 -0.0236625 9.22402 0.00257442H4.77602C4.27251 -0.0171866 3.78126 0.160868 3.40746 0.498617C3.03365 0.836366 2.807 1.30697 2.77602 1.80966V3.00106C2.77602 3.0556 2.78346 3.10936 2.79776 3.16101H0.6C0.521207 3.16101 0.443185 3.17652 0.37039 3.20666C0.297595 3.2368 0.231451 3.28097 0.175736 3.33666C0.120021 3.39235 0.0758251 3.45846 0.0456722 3.53121C0.0155194 3.60397 0 3.68196 0 3.76071C0 3.83946 0.0155194 3.91744 0.0456722 3.9902C0.0758251 4.06296 0.120021 4.12907 0.175736 4.18476C0.231451 4.24045 0.297595 4.28462 0.37039 4.31476C0.443185 4.3449 0.521207 4.36041 0.6 4.36041H1.40002V12.1884C1.41426 12.442 1.47871 12.6903 1.58965 12.9188C1.7006 13.1473 1.85582 13.3515 2.04633 13.5196C2.23683 13.6877 2.45882 13.8163 2.69944 13.898C2.94005 13.9797 3.1945 14.0129 3.44802 13.9955ZM2.60002 4.36041H11.304V12.1884C11.304 12.5163 10.952 12.7961 10.504 12.7961H3.40002C2.97602 12.7961 2.60002 12.5163 2.60002 12.1884V4.36041ZM3.95429 3.16101C3.96859 3.10936 3.97602 3.0556 3.97602 3.00106V1.80966C3.97602 1.48183 4.33602 1.20197 4.77602 1.20197H9.24802C9.66403 1.20197 10.048 1.48183 10.048 1.80966V3.00106C10.0473 3.05515 10.054 3.10896 10.0678 3.16101H3.95429ZM5.57571 10.997C5.41731 10.995 5.26597 10.9311 5.15395 10.8191C5.04193 10.7071 4.97808 10.5558 4.97601 10.3973V6.77517C4.97601 6.61612 5.0392 6.46359 5.15166 6.35112C5.26413 6.23866 5.41666 6.17548 5.57571 6.17548C5.73476 6.17548 5.8873 6.23866 5.99976 6.35112C6.11223 6.46359 6.17541 6.61612 6.17541 6.77517V10.3894C6.17647 10.4688 6.16174 10.5476 6.13208 10.6213C6.10241 10.695 6.05841 10.762 6.00261 10.8186C5.94682 10.8751 5.88035 10.92 5.80707 10.9506C5.73378 10.9813 5.65514 10.9971 5.57571 10.997ZM7.99968 10.8214C8.11215 10.9339 8.26468 10.997 8.42373 10.997C8.58351 10.9949 8.73604 10.93 8.84828 10.8163C8.96052 10.7025 9.02345 10.5491 9.02343 10.3894V6.77517C9.02343 6.61612 8.96025 6.46359 8.84778 6.35112C8.73532 6.23866 8.58278 6.17548 8.42373 6.17548C8.26468 6.17548 8.11215 6.23866 7.99968 6.35112C7.88722 6.46359 7.82404 6.61612 7.82404 6.77517V10.3973C7.82404 10.5564 7.88722 10.7089 7.99968 10.8214Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Vl=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["AngleDownIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var Pl=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["AngleUpIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M10.4134 9.49931C10.3148 9.49977 10.2172 9.48055 10.1262 9.44278C10.0352 9.405 9.95263 9.34942 9.88338 9.27931L6.88338 6.27931L3.88338 9.27931C3.73811 9.34946 3.57409 9.3709 3.41567 9.34044C3.25724 9.30999 3.11286 9.22926 3.00395 9.11025C2.89504 8.99124 2.82741 8.84028 2.8111 8.67978C2.79478 8.51928 2.83065 8.35781 2.91338 8.21931L6.41338 4.71931C6.55401 4.57886 6.74463 4.49997 6.94338 4.49997C7.14213 4.49997 7.33276 4.57886 7.47338 4.71931L10.9734 8.21931C11.1138 8.35994 11.1927 8.55056 11.1927 8.74931C11.1927 8.94806 11.1138 9.13868 10.9734 9.27931C10.9007 9.35315 10.8132 9.41089 10.7168 9.44879C10.6203 9.48669 10.5169 9.5039 10.4134 9.49931Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var Og=["input"],Ag=(t,n,e)=>({"p-inputnumber p-component":!0,"p-inputnumber-buttons-stacked":t,"p-inputnumber-buttons-horizontal":n,"p-inputnumber-buttons-vertical":e}),ed=()=>({"p-inputnumber-button p-inputnumber-button-up":!0}),td=()=>({"p-inputnumber-button p-inputnumber-button-down":!0});function Lg(t,n){if(t&1){let e=le();g(0,"TimesIcon",8),G("click",function(){S(e);let r=f(2);return I(r.clear())}),x()}t&2&&(u("ngClass","p-inputnumber-clear-icon"),V("data-pc-section","clearIcon"))}function Rg(t,n){}function Vg(t,n){t&1&&w(0,Rg,0,0,"ng-template")}function Pg(t,n){if(t&1){let e=le();g(0,"span",9),G("click",function(){S(e);let r=f(2);return I(r.clear())}),w(1,Vg,1,0,null,10),x()}if(t&2){let e=f(2);V("data-pc-section","clearIcon"),p(),u("ngTemplateOutlet",e.clearIconTemplate)}}function Bg(t,n){if(t&1&&(_e(0),w(1,Lg,1,2,"TimesIcon",6)(2,Pg,2,2,"span",7),ge()),t&2){let e=f();p(),u("ngIf",!e.clearIconTemplate),p(),u("ngIf",e.clearIconTemplate)}}function Ng(t,n){if(t&1&&N(0,"span",14),t&2){let e=f(2);u("ngClass",e.incrementButtonIcon),V("data-pc-section","incrementbuttonicon")}}function Ug(t,n){t&1&&N(0,"AngleUpIcon"),t&2&&V("data-pc-section","incrementbuttonicon")}function Hg(t,n){}function zg(t,n){t&1&&w(0,Hg,0,0,"ng-template")}function Wg(t,n){if(t&1&&(_e(0),w(1,Ug,1,1,"AngleUpIcon",3)(2,zg,1,0,null,10),ge()),t&2){let e=f(2);p(),u("ngIf",!e.incrementButtonIconTemplate),p(),u("ngTemplateOutlet",e.incrementButtonIconTemplate)}}function jg(t,n){if(t&1&&N(0,"span",14),t&2){let e=f(2);u("ngClass",e.decrementButtonIcon),V("data-pc-section","decrementbuttonicon")}}function Kg(t,n){t&1&&N(0,"AngleDownIcon"),t&2&&V("data-pc-section","decrementbuttonicon")}function Gg(t,n){}function $g(t,n){t&1&&w(0,Gg,0,0,"ng-template")}function Yg(t,n){if(t&1&&(_e(0),w(1,Kg,1,1,"AngleDownIcon",3)(2,$g,1,0,null,10),ge()),t&2){let e=f(2);p(),u("ngIf",!e.decrementButtonIconTemplate),p(),u("ngTemplateOutlet",e.decrementButtonIconTemplate)}}function Xg(t,n){if(t&1){let e=le();g(0,"span",11)(1,"button",12),G("mousedown",function(r){S(e);let a=f();return I(a.onUpButtonMouseDown(r))})("mouseup",function(){S(e);let r=f();return I(r.onUpButtonMouseUp())})("mouseleave",function(){S(e);let r=f();return I(r.onUpButtonMouseLeave())})("keydown",function(r){S(e);let a=f();return I(a.onUpButtonKeyDown(r))})("keyup",function(){S(e);let r=f();return I(r.onUpButtonKeyUp())}),w(2,Ng,1,2,"span",13)(3,Wg,3,2,"ng-container",3),x(),g(4,"button",12),G("mousedown",function(r){S(e);let a=f();return I(a.onDownButtonMouseDown(r))})("mouseup",function(){S(e);let r=f();return I(r.onDownButtonMouseUp())})("mouseleave",function(){S(e);let r=f();return I(r.onDownButtonMouseLeave())})("keydown",function(r){S(e);let a=f();return I(a.onDownButtonKeyDown(r))})("keyup",function(){S(e);let r=f();return I(r.onDownButtonKeyUp())}),w(5,jg,1,2,"span",13)(6,Yg,3,2,"ng-container",3),x()()}if(t&2){let e=f();V("data-pc-section","buttonGroup"),p(),ue(e.incrementButtonClass),u("ngClass",Ot(17,ed))("disabled",e.disabled),V("aria-hidden",!0)("data-pc-section","incrementbutton"),p(),u("ngIf",e.incrementButtonIcon),p(),u("ngIf",!e.incrementButtonIcon),p(),ue(e.decrementButtonClass),u("ngClass",Ot(18,td))("disabled",e.disabled),V("aria-hidden",!0)("data-pc-section",e.decrementbutton),p(),u("ngIf",e.decrementButtonIcon),p(),u("ngIf",!e.decrementButtonIcon)}}function qg(t,n){if(t&1&&N(0,"span",14),t&2){let e=f(2);u("ngClass",e.incrementButtonIcon),V("data-pc-section","incrementbuttonicon")}}function Zg(t,n){t&1&&N(0,"AngleUpIcon"),t&2&&V("data-pc-section","incrementbuttonicon")}function Qg(t,n){}function Jg(t,n){t&1&&w(0,Qg,0,0,"ng-template")}function ex(t,n){if(t&1&&(_e(0),w(1,Zg,1,1,"AngleUpIcon",3)(2,Jg,1,0,null,10),ge()),t&2){let e=f(2);p(),u("ngIf",!e.incrementButtonIconTemplate),p(),u("ngTemplateOutlet",e.incrementButtonIconTemplate)}}function tx(t,n){if(t&1){let e=le();g(0,"button",12),G("mousedown",function(r){S(e);let a=f();return I(a.onUpButtonMouseDown(r))})("mouseup",function(){S(e);let r=f();return I(r.onUpButtonMouseUp())})("mouseleave",function(){S(e);let r=f();return I(r.onUpButtonMouseLeave())})("keydown",function(r){S(e);let a=f();return I(a.onUpButtonKeyDown(r))})("keyup",function(){S(e);let r=f();return I(r.onUpButtonKeyUp())}),w(1,qg,1,2,"span",13)(2,ex,3,2,"ng-container",3),x()}if(t&2){let e=f();ue(e.incrementButtonClass),u("ngClass",Ot(8,ed))("disabled",e.disabled),V("aria-hidden",!0)("data-pc-section","incrementbutton"),p(),u("ngIf",e.incrementButtonIcon),p(),u("ngIf",!e.incrementButtonIcon)}}function ix(t,n){if(t&1&&N(0,"span",14),t&2){let e=f(2);u("ngClass",e.decrementButtonIcon),V("data-pc-section","decrementbuttonicon")}}function nx(t,n){t&1&&N(0,"AngleDownIcon"),t&2&&V("data-pc-section","decrementbuttonicon")}function rx(t,n){}function ax(t,n){t&1&&w(0,rx,0,0,"ng-template")}function sx(t,n){if(t&1&&(_e(0),w(1,nx,1,1,"AngleDownIcon",3)(2,ax,1,0,null,10),ge()),t&2){let e=f(2);p(),u("ngIf",!e.decrementButtonIconTemplate),p(),u("ngTemplateOutlet",e.decrementButtonIconTemplate)}}function ox(t,n){if(t&1){let e=le();g(0,"button",12),G("mousedown",function(r){S(e);let a=f();return I(a.onDownButtonMouseDown(r))})("mouseup",function(){S(e);let r=f();return I(r.onDownButtonMouseUp())})("mouseleave",function(){S(e);let r=f();return I(r.onDownButtonMouseLeave())})("keydown",function(r){S(e);let a=f();return I(a.onDownButtonKeyDown(r))})("keyup",function(){S(e);let r=f();return I(r.onDownButtonKeyUp())}),w(1,ix,1,2,"span",13)(2,sx,3,2,"ng-container",3),x()}if(t&2){let e=f();ue(e.decrementButtonClass),u("ngClass",Ot(8,td))("disabled",e.disabled),V("aria-hidden",!0)("data-pc-section","decrementbutton"),p(),u("ngIf",e.decrementButtonIcon),p(),u("ngIf",!e.decrementButtonIcon)}}var lx={provide:In,useExisting:ln(()=>Nl),multi:!0},Nl=(()=>{class t{document;el;cd;injector;config;showButtons=!1;format=!0;buttonLayout="stacked";inputId;styleClass;style;placeholder;size;maxlength;tabindex;title;ariaLabelledBy;ariaLabel;ariaRequired;name;required;autocomplete;min;max;incrementButtonClass;decrementButtonClass;incrementButtonIcon;decrementButtonIcon;readonly=!1;step=1;allowEmpty=!0;locale;localeMatcher;mode="decimal";currency;currencyDisplay;useGrouping=!0;variant="outlined";minFractionDigits;maxFractionDigits;prefix;suffix;inputStyle;inputStyleClass;showClear=!1;autofocus;get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1),this._disabled=e,this.timer&&this.clearTimer()}onInput=new fe;onFocus=new fe;onBlur=new fe;onKeyDown=new fe;onClear=new fe;input;templates;clearIconTemplate;incrementButtonIconTemplate;decrementButtonIconTemplate;value;onModelChange=()=>{};onModelTouched=()=>{};focused;initialized;groupChar="";prefixChar="";suffixChar="";isSpecialChar;timer;lastValue;_numeral;numberFormat;_decimal;_decimalChar;_group;_minusSign;_currency;_prefix;_suffix;_index;_disabled;ngControl=null;constructor(e,i,r,a,s){this.document=e,this.el=i,this.cd=r,this.injector=a,this.config=s}ngOnChanges(e){["locale","localeMatcher","mode","currency","currencyDisplay","useGrouping","minFractionDigits","maxFractionDigits","prefix","suffix"].some(r=>!!e[r])&&this.updateConstructParser()}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"clearicon":this.clearIconTemplate=e.template;break;case"incrementbuttonicon":this.incrementButtonIconTemplate=e.template;break;case"decrementbuttonicon":this.decrementButtonIconTemplate=e.template;break}})}ngOnInit(){this.ngControl=this.injector.get(uo,null,{optional:!0}),this.constructParser(),this.initialized=!0}getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits??void 0,maximumFractionDigits:this.maxFractionDigits??void 0}}constructParser(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());let e=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),i=new Map(e.map((r,a)=>[r,a]));this._numeral=new RegExp(`[${e.join("")}]`,"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._decimalChar=this.getDecimalChar(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=r=>i.get(r)}updateConstructParser(){this.initialized&&this.constructParser()}escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}getDecimalExpression(){let e=this.getDecimalChar();return new RegExp(`[${e}]`,"g")}getDecimalChar(){return new Intl.NumberFormat(this.locale,_n(Tt({},this.getOptions()),{useGrouping:!1})).format(1.1).replace(this._currency,"").trim().replace(this._numeral,"")}getGroupingExpression(){let e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp(`[${this.groupChar}]`,"g")}getMinusSignExpression(){let e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${e.format(-1).trim().replace(this._numeral,"")}]`,"g")}getCurrencyExpression(){if(this.currency){let e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp(`[${e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")}getPrefixExpression(){if(this.prefix)this.prefixChar=this.prefix;else{let e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp(`${this.escapeRegExp(this.prefixChar||"")}`,"g")}getSuffixExpression(){if(this.suffix)this.suffixChar=this.suffix;else{let e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp(`${this.escapeRegExp(this.suffixChar||"")}`,"g")}get isBlurUpdateOnMode(){return this.ngControl?.control?.updateOn==="blur"}formatValue(e){if(e!=null){if(e==="-")return e;if(this.format){let r=new Intl.NumberFormat(this.locale,this.getOptions()).format(e);return this.prefix&&e!=this.prefix&&(r=this.prefix+r),this.suffix&&e!=this.suffix&&(r=r+this.suffix),r}return e.toString()}return""}parseValue(e){let i=new RegExp(this._suffix,""),r=new RegExp(this._prefix,""),a=new RegExp(this._currency,""),s=e.replace(i,"").replace(r,"").trim().replace(/\s/g,"").replace(a,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(s){if(s==="-")return s;let o=+s;return isNaN(o)?null:o}return null}repeat(e,i,r){if(this.readonly)return;let a=i||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,40,r)},a),this.spin(e,r)}spin(e,i){let r=this.step*i,a=this.parseValue(this.input?.nativeElement.value)||0,s=this.validateValue(a+r);this.maxlength&&this.maxlength<this.formatValue(s).length||(this.updateInput(s,null,"spin",null),this.updateModel(e,s),this.handleOnInput(e,a,s))}clear(){this.value=null,this.onModelChange(this.value),this.onClear.emit()}onUpButtonMouseDown(e){if(e.button===2){this.clearTimer();return}this.disabled||(this.input?.nativeElement.focus(),this.repeat(e,null,1),e.preventDefault())}onUpButtonMouseUp(){this.disabled||this.clearTimer()}onUpButtonMouseLeave(){this.disabled||this.clearTimer()}onUpButtonKeyDown(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,1)}onUpButtonKeyUp(){this.disabled||this.clearTimer()}onDownButtonMouseDown(e){if(e.button===2){this.clearTimer();return}this.disabled||(this.input?.nativeElement.focus(),this.repeat(e,null,-1),e.preventDefault())}onDownButtonMouseUp(){this.disabled||this.clearTimer()}onDownButtonMouseLeave(){this.disabled||this.clearTimer()}onDownButtonKeyUp(){this.disabled||this.clearTimer()}onDownButtonKeyDown(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,-1)}onUserInput(e){this.readonly||(this.isSpecialChar&&(e.target.value=this.lastValue),this.isSpecialChar=!1)}onInputKeyDown(e){if(this.readonly)return;if(this.lastValue=e.target.value,e.shiftKey||e.altKey||e.key==="Dead"){this.isSpecialChar=!0;return}let i=e.target.selectionStart,r=e.target.selectionEnd,a=e.target.value,s=null;switch(e.altKey&&e.preventDefault(),e.key){case"ArrowUp":this.spin(e,1),e.preventDefault();break;case"ArrowDown":this.spin(e,-1),e.preventDefault();break;case"ArrowLeft":for(let o=i;o<=a.length;o++){let l=o===0?0:o-1;if(this.isNumeralChar(a.charAt(l))){this.input.nativeElement.setSelectionRange(o,o);break}}break;case"ArrowRight":for(let o=r;o>=0;o--)if(this.isNumeralChar(a.charAt(o))){this.input.nativeElement.setSelectionRange(o,o);break}break;case"Tab":case"Enter":s=this.validateValue(this.parseValue(this.input.nativeElement.value)),this.input.nativeElement.value=this.formatValue(s),this.input.nativeElement.setAttribute("aria-valuenow",s),this.updateModel(e,s);break;case"Backspace":{if(e.preventDefault(),i===r){if(i==1&&this.prefix||i==a.length&&this.suffix)break;let o=a.charAt(i-1),{decimalCharIndex:l,decimalCharIndexWithoutPrefix:c}=this.getDecimalCharIndexes(a);if(this.isNumeralChar(o)){let d=this.getDecimalLength(a);if(this._group.test(o))this._group.lastIndex=0,s=a.slice(0,i-2)+a.slice(i-1);else if(this._decimal.test(o))this._decimal.lastIndex=0,d?this.input?.nativeElement.setSelectionRange(i-1,i-1):s=a.slice(0,i-1)+a.slice(i);else if(l>0&&i>l){let h=this.isDecimalMode()&&(this.minFractionDigits||0)<d?"":"0";s=a.slice(0,i-1)+h+a.slice(i)}else c===1?(s=a.slice(0,i-1)+"0"+a.slice(i),s=this.parseValue(s)>0?s:""):s=a.slice(0,i-1)+a.slice(i)}else this.mode==="currency"&&o.search(this._currency)!=-1&&(s=a.slice(1));this.updateValue(e,s,null,"delete-single")}else s=this.deleteRange(a,i,r),this.updateValue(e,s,null,"delete-range");break}case"Delete":if(e.preventDefault(),i===r){if(i==0&&this.prefix||i==a.length-1&&this.suffix)break;let o=a.charAt(i),{decimalCharIndex:l,decimalCharIndexWithoutPrefix:c}=this.getDecimalCharIndexes(a);if(this.isNumeralChar(o)){let d=this.getDecimalLength(a);if(this._group.test(o))this._group.lastIndex=0,s=a.slice(0,i)+a.slice(i+2);else if(this._decimal.test(o))this._decimal.lastIndex=0,d?this.input?.nativeElement.setSelectionRange(i+1,i+1):s=a.slice(0,i)+a.slice(i+1);else if(l>0&&i>l){let h=this.isDecimalMode()&&(this.minFractionDigits||0)<d?"":"0";s=a.slice(0,i)+h+a.slice(i+1)}else c===1?(s=a.slice(0,i)+"0"+a.slice(i+1),s=this.parseValue(s)>0?s:""):s=a.slice(0,i)+a.slice(i+1)}this.updateValue(e,s,null,"delete-back-single")}else s=this.deleteRange(a,i,r),this.updateValue(e,s,null,"delete-range");break;case"Home":this.min&&(this.updateModel(e,this.min),e.preventDefault());break;case"End":this.max&&(this.updateModel(e,this.max),e.preventDefault());break;default:break}this.onKeyDown.emit(e)}onInputKeyPress(e){if(this.readonly)return;let i=e.which||e.keyCode,r=String.fromCharCode(i),a=this.isDecimalSign(r),s=this.isMinusSign(r);i!=13&&e.preventDefault(),!a&&e.code==="NumpadDecimal"&&(a=!0,r=this._decimalChar,i=r.charCodeAt(0));let{value:o,selectionStart:l,selectionEnd:c}=this.input.nativeElement,d=this.parseValue(o+r),h=d!=null?d.toString():"",_=o.substring(l,c),v=this.parseValue(_),b=v!=null?v.toString():"";if(l!==c&&b.length>0){this.insert(e,r,{isDecimalSign:a,isMinusSign:s});return}this.maxlength&&h.length>this.maxlength||(48<=i&&i<=57||s||a)&&this.insert(e,r,{isDecimalSign:a,isMinusSign:s})}onPaste(e){if(!this.disabled&&!this.readonly){e.preventDefault();let i=(e.clipboardData||this.document.defaultView.clipboardData).getData("Text");if(i){this.maxlength&&(i=i.toString().substring(0,this.maxlength));let r=this.parseValue(i);r!=null&&this.insert(e,r.toString())}}}allowMinusSign(){return this.min==null||this.min<0}isMinusSign(e){return this._minusSign.test(e)||e==="-"?(this._minusSign.lastIndex=0,!0):!1}isDecimalSign(e){return this._decimal.test(e)?(this._decimal.lastIndex=0,!0):!1}isDecimalMode(){return this.mode==="decimal"}getDecimalCharIndexes(e){let i=e.search(this._decimal);this._decimal.lastIndex=0;let a=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:i,decimalCharIndexWithoutPrefix:a}}getCharIndexes(e){let i=e.search(this._decimal);this._decimal.lastIndex=0;let r=e.search(this._minusSign);this._minusSign.lastIndex=0;let a=e.search(this._suffix);this._suffix.lastIndex=0;let s=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:i,minusCharIndex:r,suffixCharIndex:a,currencyCharIndex:s}}insert(e,i,r={isDecimalSign:!1,isMinusSign:!1}){let a=i.search(this._minusSign);if(this._minusSign.lastIndex=0,!this.allowMinusSign()&&a!==-1)return;let s=this.input?.nativeElement.selectionStart,o=this.input?.nativeElement.selectionEnd,l=this.input?.nativeElement.value.trim(),{decimalCharIndex:c,minusCharIndex:d,suffixCharIndex:h,currencyCharIndex:_}=this.getCharIndexes(l),v;if(r.isMinusSign)s===0&&(v=l,(d===-1||o!==0)&&(v=this.insertText(l,i,0,o)),this.updateValue(e,v,i,"insert"));else if(r.isDecimalSign)c>0&&s===c?this.updateValue(e,l,i,"insert"):c>s&&c<o?(v=this.insertText(l,i,s,o),this.updateValue(e,v,i,"insert")):c===-1&&this.maxFractionDigits&&(v=this.insertText(l,i,s,o),this.updateValue(e,v,i,"insert"));else{let b=this.numberFormat.resolvedOptions().maximumFractionDigits,m=s!==o?"range-insert":"insert";if(c>0&&s>c){if(s+i.length-(c+1)<=b){let y=_>=s?_-1:h>=s?h:l.length;v=l.slice(0,s)+i+l.slice(s+i.length,y)+l.slice(y),this.updateValue(e,v,i,m)}}else v=this.insertText(l,i,s,o),this.updateValue(e,v,i,m)}}insertText(e,i,r,a){if((i==="."?i:i.split(".")).length===2){let o=e.slice(r,a).search(this._decimal);return this._decimal.lastIndex=0,o>0?e.slice(0,r)+this.formatValue(i)+e.slice(a):e||this.formatValue(i)}else return a-r===e.length?this.formatValue(i):r===0?i+e.slice(a):a===e.length?e.slice(0,r)+i:e.slice(0,r)+i+e.slice(a)}deleteRange(e,i,r){let a;return r-i===e.length?a="":i===0?a=e.slice(r):r===e.length?a=e.slice(0,i):a=e.slice(0,i)+e.slice(r),a}initCursor(){let e=this.input?.nativeElement.selectionStart,i=this.input?.nativeElement.selectionEnd,r=this.input?.nativeElement.value,a=r.length,s=null,o=(this.prefixChar||"").length;r=r.replace(this._prefix,""),(e===i||e!==0||i<o)&&(e-=o);let l=r.charAt(e);if(this.isNumeralChar(l))return e+o;let c=e-1;for(;c>=0;)if(l=r.charAt(c),this.isNumeralChar(l)){s=c+o;break}else c--;if(s!==null)this.input?.nativeElement.setSelectionRange(s+1,s+1);else{for(c=e;c<a;)if(l=r.charAt(c),this.isNumeralChar(l)){s=c+o;break}else c++;s!==null&&this.input?.nativeElement.setSelectionRange(s,s)}return s||0}onInputClick(){let e=this.input?.nativeElement.value;!this.readonly&&e!==R.getSelection()&&this.initCursor()}isNumeralChar(e){return e.length===1&&(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))?(this.resetRegex(),!0):!1}resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0}updateValue(e,i,r,a){let s=this.input?.nativeElement.value,o=null;i!=null&&(o=this.parseValue(i),o=!o&&!this.allowEmpty?0:o,this.updateInput(o,r,a,i),this.handleOnInput(e,s,o))}handleOnInput(e,i,r){this.isValueChanged(i,r)&&(this.input.nativeElement.value=this.formatValue(r),this.input?.nativeElement.setAttribute("aria-valuenow",r),!this.isBlurUpdateOnMode&&this.updateModel(e,r),this.onInput.emit({originalEvent:e,value:r,formattedValue:i}))}isValueChanged(e,i){if(i===null&&e!==null)return!0;if(i!=null){let r=typeof e=="string"?this.parseValue(e):e;return i!==r}return!1}validateValue(e){return e==="-"||e==null?null:this.min!=null&&e<this.min?this.min:this.max!=null&&e>this.max?this.max:e}updateInput(e,i,r,a){i=i||"";let s=this.input?.nativeElement.value,o=this.formatValue(e),l=s.length;if(o!==a&&(o=this.concatValues(o,a)),l===0){this.input.nativeElement.value=o,this.input.nativeElement.setSelectionRange(0,0);let d=this.initCursor()+i.length;this.input.nativeElement.setSelectionRange(d,d)}else{let c=this.input.nativeElement.selectionStart,d=this.input.nativeElement.selectionEnd;if(this.maxlength&&o.length>this.maxlength&&(o=o.slice(0,this.maxlength),c=Math.min(c,this.maxlength),d=Math.min(d,this.maxlength)),this.maxlength&&this.maxlength<o.length)return;this.input.nativeElement.value=o;let h=o.length;if(r==="range-insert"){let _=this.parseValue((s||"").slice(0,c)),b=(_!==null?_.toString():"").split("").join(`(${this.groupChar})?`),m=new RegExp(b,"g");m.test(o);let y=i.split("").join(`(${this.groupChar})?`),k=new RegExp(y,"g");k.test(o.slice(m.lastIndex)),d=m.lastIndex+k.lastIndex,this.input.nativeElement.setSelectionRange(d,d)}else if(h===l)r==="insert"||r==="delete-back-single"?this.input.nativeElement.setSelectionRange(d+1,d+1):r==="delete-single"?this.input.nativeElement.setSelectionRange(d-1,d-1):(r==="delete-range"||r==="spin")&&this.input.nativeElement.setSelectionRange(d,d);else if(r==="delete-back-single"){let _=s.charAt(d-1),v=s.charAt(d),b=l-h,m=this._group.test(v);m&&b===1?d+=1:!m&&this.isNumeralChar(_)&&(d+=-1*b+1),this._group.lastIndex=0,this.input.nativeElement.setSelectionRange(d,d)}else if(s==="-"&&r==="insert"){this.input.nativeElement.setSelectionRange(0,0);let v=this.initCursor()+i.length+1;this.input.nativeElement.setSelectionRange(v,v)}else d=d+(h-l),this.input.nativeElement.setSelectionRange(d,d)}this.input.nativeElement.setAttribute("aria-valuenow",e)}concatValues(e,i){if(e&&i){let r=i.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?r!==-1?e:e.replace(this.suffixChar,"").split(this._decimal)[0]+i.replace(this.suffixChar,"").slice(r)+this.suffixChar:r!==-1?e.split(this._decimal)[0]+i.slice(r):e}return e}getDecimalLength(e){if(e){let i=e.split(this._decimal);if(i.length===2)return i[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1;let i=this.validateValue(this.parseValue(this.input.nativeElement.value)),r=i?.toString();this.input.nativeElement.value=this.formatValue(r),this.input.nativeElement.setAttribute("aria-valuenow",r),this.updateModel(e,i),this.onBlur.emit(e)}formattedValue(){let e=!this.value&&!this.allowEmpty?0:this.value;return this.formatValue(e)}updateModel(e,i){this.value!==i&&(this.value=i,this.isBlurUpdateOnMode&&this.focused?this.isBlurUpdateOnMode&&this.onModelChange(i):this.onModelChange(i)),this.onModelTouched()}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}get filled(){return this.value!=null&&this.value.toString().length>0}clearTimer(){this.timer&&clearInterval(this.timer)}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Lt),Z(St),Z(S0),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-inputNumber"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&Je(Og,5),i&2){let a;Ee(a=Fe())&&(r.input=a.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(i,r){i&2&&cn("p-inputwrapper-filled",r.filled)("p-inputwrapper-focus",r.focused)("p-inputnumber-clearable",r.showClear&&r.buttonLayout!="vertical")},inputs:{showButtons:[2,"showButtons","showButtons",Q],format:[2,"format","format",Q],buttonLayout:"buttonLayout",inputId:"inputId",styleClass:"styleClass",style:"style",placeholder:"placeholder",size:[2,"size","size",We],maxlength:[2,"maxlength","maxlength",We],tabindex:[2,"tabindex","tabindex",We],title:"title",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",ariaRequired:[2,"ariaRequired","ariaRequired",Q],name:"name",required:[2,"required","required",Q],autocomplete:"autocomplete",min:[2,"min","min",We],max:[2,"max","max",We],incrementButtonClass:"incrementButtonClass",decrementButtonClass:"decrementButtonClass",incrementButtonIcon:"incrementButtonIcon",decrementButtonIcon:"decrementButtonIcon",readonly:[2,"readonly","readonly",Q],step:[2,"step","step",We],allowEmpty:[2,"allowEmpty","allowEmpty",Q],locale:"locale",localeMatcher:"localeMatcher",mode:"mode",currency:"currency",currencyDisplay:"currencyDisplay",useGrouping:[2,"useGrouping","useGrouping",Q],variant:"variant",minFractionDigits:[2,"minFractionDigits","minFractionDigits",e=>We(e,null)],maxFractionDigits:[2,"maxFractionDigits","maxFractionDigits",e=>We(e,null)],prefix:"prefix",suffix:"suffix",inputStyle:"inputStyle",inputStyleClass:"inputStyleClass",showClear:[2,"showClear","showClear",Q],autofocus:[2,"autofocus","autofocus",Q],disabled:"disabled"},outputs:{onInput:"onInput",onFocus:"onFocus",onBlur:"onBlur",onKeyDown:"onKeyDown",onClear:"onClear"},features:[ji([lx]),_t,Sn],decls:7,vars:43,consts:[["input",""],[3,"ngClass","ngStyle"],["pInputText","","role","spinbutton","inputmode","decimal","pAutoFocus","",3,"input","keydown","keypress","paste","click","focus","blur","ngClass","ngStyle","value","disabled","readonly","autofocus"],[4,"ngIf"],["class","p-inputnumber-button-group",4,"ngIf"],["type","button","pButton","","class","p-button-icon-only","tabindex","0",3,"ngClass","class","disabled","mousedown","mouseup","mouseleave","keydown","keyup",4,"ngIf"],[3,"ngClass","click",4,"ngIf"],["class","p-inputnumber-clear-icon",3,"click",4,"ngIf"],[3,"click","ngClass"],[1,"p-inputnumber-clear-icon",3,"click"],[4,"ngTemplateOutlet"],[1,"p-inputnumber-button-group"],["type","button","pButton","","tabindex","0",1,"p-button-icon-only",3,"mousedown","mouseup","mouseleave","keydown","keyup","ngClass","disabled"],[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function(i,r){if(i&1){let a=le();g(0,"span",1)(1,"input",2,0),G("input",function(o){return S(a),I(r.onUserInput(o))})("keydown",function(o){return S(a),I(r.onInputKeyDown(o))})("keypress",function(o){return S(a),I(r.onInputKeyPress(o))})("paste",function(o){return S(a),I(r.onPaste(o))})("click",function(){return S(a),I(r.onInputClick())})("focus",function(o){return S(a),I(r.onInputFocus(o))})("blur",function(o){return S(a),I(r.onInputBlur(o))}),x(),w(3,Bg,3,2,"ng-container",3)(4,Xg,7,19,"span",4)(5,tx,3,9,"button",5)(6,ox,3,9,"button",5),x()}i&2&&(ue(r.styleClass),u("ngClass",Ci(39,Ag,r.showButtons&&r.buttonLayout==="stacked",r.showButtons&&r.buttonLayout==="horizontal",r.showButtons&&r.buttonLayout==="vertical"))("ngStyle",r.style),V("data-pc-name","inputnumber")("data-pc-section","root"),p(),ue(r.inputStyleClass),cn("p-variant-filled",r.variant==="filled"||r.config.inputStyle()==="filled"),u("ngClass","p-inputnumber-input")("ngStyle",r.inputStyle)("value",r.formattedValue())("disabled",r.disabled)("readonly",r.readonly)("autofocus",r.autofocus),V("id",r.inputId)("variant",r.variant)("aria-valuemin",r.min)("aria-valuemax",r.max)("aria-valuenow",r.value)("placeholder",r.placeholder)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledBy)("title",r.title)("size",r.size)("name",r.name)("autocomplete",r.autocomplete)("maxlength",r.maxlength)("tabindex",r.tabindex)("aria-required",r.ariaRequired)("required",r.required)("min",r.min)("max",r.max)("data-pc-section","input"),p(2),u("ngIf",r.buttonLayout!="vertical"&&r.showClear&&r.value),p(),u("ngIf",r.showButtons&&r.buttonLayout==="stacked"),p(),u("ngIf",r.showButtons&&r.buttonLayout!=="stacked"),p(),u("ngIf",r.showButtons&&r.buttonLayout!=="stacked"))},dependencies:()=>[at,rt,bt,It,Fr,si,Zn,Rt,Pl,Vl],styles:[`@layer primeng{p-inputnumber,.p-inputnumber{display:inline-flex}.p-inputnumber-button{display:flex;align-items:center;justify-content:center;flex:0 0 auto}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label{display:none}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up{border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-input{border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down{border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-button-group{display:flex;flex-direction:column}.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button{flex:1 1 auto}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up{order:3;border-top-left-radius:0;border-bottom-left-radius:0}.p-inputnumber-buttons-horizontal .p-inputnumber-input{order:2;border-radius:0}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down{order:1;border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-vertical{flex-direction:column}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up{order:1;border-bottom-left-radius:0;border-bottom-right-radius:0;width:100%}.p-inputnumber-buttons-vertical .p-inputnumber-input{order:2;border-radius:0;text-align:center}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down{order:3;border-top-left-radius:0;border-top-right-radius:0;width:100%}.p-inputnumber-input{flex:1 1 auto}.p-fluid p-inputnumber,.p-fluid .p-inputnumber{width:100%}.p-fluid .p-inputnumber .p-inputnumber-input{width:1%}.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input{width:100%}.p-inputnumber-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-inputnumber-clearable{position:relative}}
`],encapsulation:2,changeDetection:0})}return t})(),ys=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,Gi,Fi,Qn,Rt,Pl,Vl,ct]})}return t})();var Ul=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["AngleDoubleLeftIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M5.71602 11.164C5.80782 11.2021 5.9063 11.2215 6.00569 11.221C6.20216 11.2301 6.39427 11.1612 6.54025 11.0294C6.68191 10.8875 6.76148 10.6953 6.76148 10.4948C6.76148 10.2943 6.68191 10.1021 6.54025 9.96024L3.51441 6.9344L6.54025 3.90855C6.624 3.76126 6.65587 3.59011 6.63076 3.42254C6.60564 3.25498 6.525 3.10069 6.40175 2.98442C6.2785 2.86815 6.11978 2.79662 5.95104 2.7813C5.78229 2.76598 5.61329 2.80776 5.47112 2.89994L1.97123 6.39983C1.82957 6.54167 1.75 6.73393 1.75 6.9344C1.75 7.13486 1.82957 7.32712 1.97123 7.46896L5.47112 10.9991C5.54096 11.0698 5.62422 11.1259 5.71602 11.164ZM11.0488 10.9689C11.1775 11.1156 11.3585 11.2061 11.5531 11.221C11.7477 11.2061 11.9288 11.1156 12.0574 10.9689C12.1815 10.8302 12.25 10.6506 12.25 10.4645C12.25 10.2785 12.1815 10.0989 12.0574 9.96024L9.03158 6.93439L12.0574 3.90855C12.1248 3.76739 12.1468 3.60881 12.1204 3.45463C12.0939 3.30045 12.0203 3.15826 11.9097 3.04765C11.7991 2.93703 11.6569 2.86343 11.5027 2.83698C11.3486 2.81053 11.19 2.83252 11.0488 2.89994L7.51865 6.36957C7.37699 6.51141 7.29742 6.70367 7.29742 6.90414C7.29742 7.1046 7.37699 7.29686 7.51865 7.4387L11.0488 10.9689Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var Hl=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["AngleDoubleRightIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7.68757 11.1451C7.7791 11.1831 7.8773 11.2024 7.9764 11.2019C8.07769 11.1985 8.17721 11.1745 8.26886 11.1312C8.36052 11.088 8.44238 11.0265 8.50943 10.9505L12.0294 7.49085C12.1707 7.34942 12.25 7.15771 12.25 6.95782C12.25 6.75794 12.1707 6.56622 12.0294 6.42479L8.50943 2.90479C8.37014 2.82159 8.20774 2.78551 8.04633 2.80192C7.88491 2.81833 7.73309 2.88635 7.6134 2.99588C7.4937 3.10541 7.41252 3.25061 7.38189 3.40994C7.35126 3.56927 7.37282 3.73423 7.44337 3.88033L10.4605 6.89748L7.44337 9.91463C7.30212 10.0561 7.22278 10.2478 7.22278 10.4477C7.22278 10.6475 7.30212 10.8393 7.44337 10.9807C7.51301 11.0512 7.59603 11.1071 7.68757 11.1451ZM1.94207 10.9505C2.07037 11.0968 2.25089 11.1871 2.44493 11.2019C2.63898 11.1871 2.81949 11.0968 2.94779 10.9505L6.46779 7.49085C6.60905 7.34942 6.68839 7.15771 6.68839 6.95782C6.68839 6.75793 6.60905 6.56622 6.46779 6.42479L2.94779 2.90479C2.80704 2.83757 2.6489 2.81563 2.49517 2.84201C2.34143 2.86839 2.19965 2.94178 2.08936 3.05207C1.97906 3.16237 1.90567 3.30415 1.8793 3.45788C1.85292 3.61162 1.87485 3.76975 1.94207 3.9105L4.95922 6.92765L1.94207 9.9448C1.81838 10.0831 1.75 10.2621 1.75 10.4477C1.75 10.6332 1.81838 10.8122 1.94207 10.9505Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var zl=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["AngleLeftIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8.75 11.185C8.65146 11.1854 8.55381 11.1662 8.4628 11.1284C8.37179 11.0906 8.28924 11.0351 8.22 10.965L4.72 7.46496C4.57955 7.32433 4.50066 7.13371 4.50066 6.93496C4.50066 6.73621 4.57955 6.54558 4.72 6.40496L8.22 2.93496C8.36095 2.84357 8.52851 2.80215 8.69582 2.81733C8.86312 2.83252 9.02048 2.90344 9.14268 3.01872C9.26487 3.134 9.34483 3.28696 9.36973 3.4531C9.39463 3.61924 9.36303 3.78892 9.28 3.93496L6.28 6.93496L9.28 9.93496C9.42045 10.0756 9.49934 10.2662 9.49934 10.465C9.49934 10.6637 9.42045 10.8543 9.28 10.995C9.13526 11.1257 8.9448 11.1939 8.75 11.185Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var Wl=(()=>{class t extends Qe{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["AngleRightIcon"]],standalone:!0,features:[qe,Ue],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M5.25 11.1728C5.14929 11.1694 5.05033 11.1455 4.9592 11.1025C4.86806 11.0595 4.78666 10.9984 4.72 10.9228C4.57955 10.7822 4.50066 10.5916 4.50066 10.3928C4.50066 10.1941 4.57955 10.0035 4.72 9.86283L7.72 6.86283L4.72 3.86283C4.66067 3.71882 4.64765 3.55991 4.68275 3.40816C4.71785 3.25642 4.79932 3.11936 4.91585 3.01602C5.03238 2.91268 5.17819 2.84819 5.33305 2.83149C5.4879 2.81479 5.64411 2.84671 5.78 2.92283L9.28 6.42283C9.42045 6.56346 9.49934 6.75408 9.49934 6.95283C9.49934 7.15158 9.42045 7.34221 9.28 7.48283L5.78 10.9228C5.71333 10.9984 5.63193 11.0595 5.5408 11.1025C5.44966 11.1455 5.35071 11.1694 5.25 11.1728Z","fill","currentColor"]],template:function(i,r){i&1&&($e(),g(0,"svg",0),N(1,"path",1),x()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return t})();var bo=t=>({"p-disabled":t}),yo=t=>({$implicit:t}),dx=t=>({"p-highlight":t});function px(t,n){t&1&&ye(0)}function ux(t,n){if(t&1&&(g(0,"div",15),w(1,px,1,0,"ng-container",16),x()),t&2){let e=f(2);V("data-pc-section","start"),p(),u("ngTemplateOutlet",e.templateLeft)("ngTemplateOutletContext",Le(3,yo,e.paginatorState))}}function fx(t,n){if(t&1&&(g(0,"span",17),Y(1),x()),t&2){let e=f(2);p(),be(e.currentPageReport)}}function hx(t,n){t&1&&N(0,"AngleDoubleLeftIcon",19),t&2&&u("styleClass","p-paginator-icon")}function mx(t,n){}function _x(t,n){t&1&&w(0,mx,0,0,"ng-template")}function gx(t,n){if(t&1&&(g(0,"span",20),w(1,_x,1,0,null,21),x()),t&2){let e=f(3);p(),u("ngTemplateOutlet",e.firstPageLinkIconTemplate)}}function xx(t,n){if(t&1){let e=le();g(0,"button",18),G("click",function(r){S(e);let a=f(2);return I(a.changePageToFirst(r))}),w(1,hx,1,1,"AngleDoubleLeftIcon",6)(2,gx,2,1,"span",7),x()}if(t&2){let e=f(2);u("disabled",e.isFirstPage()||e.empty())("ngClass",Le(5,bo,e.isFirstPage()||e.empty())),V("aria-label",e.getAriaLabel("firstPageLabel")),p(),u("ngIf",!e.firstPageLinkIconTemplate),p(),u("ngIf",e.firstPageLinkIconTemplate)}}function vx(t,n){t&1&&N(0,"AngleLeftIcon",19),t&2&&u("styleClass","p-paginator-icon")}function bx(t,n){}function yx(t,n){t&1&&w(0,bx,0,0,"ng-template")}function wx(t,n){if(t&1&&(g(0,"span",20),w(1,yx,1,0,null,21),x()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.previousPageLinkIconTemplate)}}function Cx(t,n){if(t&1){let e=le();g(0,"button",24),G("click",function(r){let a=S(e).$implicit,s=f(3);return I(s.onPageLinkClick(r,a-1))}),Y(1),x()}if(t&2){let e=n.$implicit,i=f(3);u("ngClass",Le(4,dx,e-1==i.getPage())),V("aria-label",i.getPageAriaLabel(e))("aria-current",e-1==i.getPage()?"page":void 0),p(),He(" ",i.getLocalization(e)," ")}}function Tx(t,n){if(t&1&&(g(0,"span",22),w(1,Cx,2,6,"button",23),x()),t&2){let e=f(2);p(),u("ngForOf",e.pageLinks)}}function Sx(t,n){if(t&1&&Y(0),t&2){let e=f(3);be(e.currentPageReport)}}function Ix(t,n){t&1&&ye(0)}function kx(t,n){if(t&1&&w(0,Ix,1,0,"ng-container",16),t&2){let e=n.$implicit,i=f(4);u("ngTemplateOutlet",i.jumpToPageItemTemplate)("ngTemplateOutletContext",Le(2,yo,e))}}function Ex(t,n){t&1&&(_e(0),w(1,kx,1,4,"ng-template",28),ge())}function Fx(t,n){t&1&&ye(0)}function Dx(t,n){if(t&1&&w(0,Fx,1,0,"ng-container",21),t&2){let e=f(4);u("ngTemplateOutlet",e.dropdownIconTemplate)}}function Mx(t,n){t&1&&w(0,Dx,1,1,"ng-template",29)}function Ox(t,n){if(t&1){let e=le();g(0,"p-dropdown",25),G("onChange",function(r){S(e);let a=f(2);return I(a.onPageDropdownChange(r))}),w(1,Sx,1,1,"ng-template",26)(2,Ex,2,0,"ng-container",27)(3,Mx,1,0,null,27),x()}if(t&2){let e=f(2);u("options",e.pageItems)("ngModel",e.getPage())("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight),V("aria-label",e.getAriaLabel("jumpToPageDropdownLabel")),p(2),u("ngIf",e.jumpToPageItemTemplate),p(),u("ngIf",e.dropdownIconTemplate)}}function Ax(t,n){t&1&&N(0,"AngleRightIcon",19),t&2&&u("styleClass","p-paginator-icon")}function Lx(t,n){}function Rx(t,n){t&1&&w(0,Lx,0,0,"ng-template")}function Vx(t,n){if(t&1&&(g(0,"span",20),w(1,Rx,1,0,null,21),x()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.nextPageLinkIconTemplate)}}function Px(t,n){t&1&&N(0,"AngleDoubleRightIcon",19),t&2&&u("styleClass","p-paginator-icon")}function Bx(t,n){}function Nx(t,n){t&1&&w(0,Bx,0,0,"ng-template")}function Ux(t,n){if(t&1&&(g(0,"span",20),w(1,Nx,1,0,null,21),x()),t&2){let e=f(3);p(),u("ngTemplateOutlet",e.lastPageLinkIconTemplate)}}function Hx(t,n){if(t&1){let e=le();g(0,"button",30),G("click",function(r){S(e);let a=f(2);return I(a.changePageToLast(r))}),w(1,Px,1,1,"AngleDoubleRightIcon",6)(2,Ux,2,1,"span",7),x()}if(t&2){let e=f(2);u("disabled",e.isLastPage()||e.empty())("ngClass",Le(5,bo,e.isLastPage()||e.empty())),V("aria-label",e.getAriaLabel("lastPageLabel")),p(),u("ngIf",!e.lastPageLinkIconTemplate),p(),u("ngIf",e.lastPageLinkIconTemplate)}}function zx(t,n){if(t&1){let e=le();g(0,"p-inputNumber",31),G("ngModelChange",function(r){S(e);let a=f(2);return I(a.changePage(r-1))}),x()}if(t&2){let e=f(2);u("ngModel",e.currentPage())("disabled",e.empty())}}function Wx(t,n){t&1&&ye(0)}function jx(t,n){if(t&1&&w(0,Wx,1,0,"ng-container",16),t&2){let e=n.$implicit,i=f(4);u("ngTemplateOutlet",i.dropdownItemTemplate)("ngTemplateOutletContext",Le(2,yo,e))}}function Kx(t,n){t&1&&(_e(0),w(1,jx,1,4,"ng-template",28),ge())}function Gx(t,n){t&1&&ye(0)}function $x(t,n){if(t&1&&w(0,Gx,1,0,"ng-container",21),t&2){let e=f(4);u("ngTemplateOutlet",e.dropdownIconTemplate)}}function Yx(t,n){t&1&&w(0,$x,1,1,"ng-template",29)}function Xx(t,n){if(t&1){let e=le();g(0,"p-dropdown",32),nt("ngModelChange",function(r){S(e);let a=f(2);return it(a.rows,r)||(a.rows=r),I(r)}),G("onChange",function(r){S(e);let a=f(2);return I(a.onRppChange(r))}),w(1,Kx,2,0,"ng-container",27)(2,Yx,1,0,null,27),x()}if(t&2){let e=f(2);u("options",e.rowsPerPageItems),tt("ngModel",e.rows),u("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight)("ariaLabel",e.getAriaLabel("rowsPerPageLabel")),p(),u("ngIf",e.dropdownItemTemplate),p(),u("ngIf",e.dropdownIconTemplate)}}function qx(t,n){t&1&&ye(0)}function Zx(t,n){if(t&1&&(g(0,"div",33),w(1,qx,1,0,"ng-container",16),x()),t&2){let e=f(2);V("data-pc-section","end"),p(),u("ngTemplateOutlet",e.templateRight)("ngTemplateOutletContext",Le(3,yo,e.paginatorState))}}function Qx(t,n){if(t&1){let e=le();g(0,"div",1),w(1,ux,2,5,"div",2)(2,fx,2,1,"span",3)(3,xx,3,7,"button",4),g(4,"button",5),G("click",function(r){S(e);let a=f();return I(a.changePageToPrev(r))}),w(5,vx,1,1,"AngleLeftIcon",6)(6,wx,2,1,"span",7),x(),w(7,Tx,2,1,"span",8)(8,Ox,4,8,"p-dropdown",9),g(9,"button",10),G("click",function(r){S(e);let a=f();return I(a.changePageToNext(r))}),w(10,Ax,1,1,"AngleRightIcon",6)(11,Vx,2,1,"span",7),x(),w(12,Hx,3,7,"button",11)(13,zx,1,2,"p-inputNumber",12)(14,Xx,3,8,"p-dropdown",13)(15,Zx,2,5,"div",14),x()}if(t&2){let e=f();ue(e.styleClass),u("ngStyle",e.style)("ngClass","p-paginator p-component"),V("data-pc-section","paginator")("data-pc-section","root"),p(),u("ngIf",e.templateLeft),p(),u("ngIf",e.showCurrentPageReport),p(),u("ngIf",e.showFirstLastIcon),p(),u("disabled",e.isFirstPage()||e.empty())("ngClass",Le(25,bo,e.isFirstPage()||e.empty())),V("aria-label",e.getAriaLabel("prevPageLabel")),p(),u("ngIf",!e.previousPageLinkIconTemplate),p(),u("ngIf",e.previousPageLinkIconTemplate),p(),u("ngIf",e.showPageLinks),p(),u("ngIf",e.showJumpToPageDropdown),p(),u("disabled",e.isLastPage()||e.empty())("ngClass",Le(27,bo,e.isLastPage()||e.empty())),V("aria-label",e.getAriaLabel("nextPageLabel")),p(),u("ngIf",!e.nextPageLinkIconTemplate),p(),u("ngIf",e.nextPageLinkIconTemplate),p(),u("ngIf",e.showFirstLastIcon),p(),u("ngIf",e.showJumpToPageInput),p(),u("ngIf",e.rowsPerPageOptions),p(),u("ngIf",e.templateRight)}}var id=(()=>{class t{cd;config;pageLinkSize=5;style;styleClass;alwaysShow=!0;dropdownAppendTo;templateLeft;templateRight;appendTo;dropdownScrollHeight="200px";currentPageReportTemplate="{currentPage} of {totalPages}";showCurrentPageReport;showFirstLastIcon=!0;totalRecords=0;rows=0;rowsPerPageOptions;showJumpToPageDropdown;showJumpToPageInput;jumpToPageItemTemplate;showPageLinks=!0;locale;dropdownItemTemplate;get first(){return this._first}set first(e){this._first=e}onPageChange=new fe;templates;dropdownIconTemplate;firstPageLinkIconTemplate;previousPageLinkIconTemplate;lastPageLinkIconTemplate;nextPageLinkIconTemplate;pageLinks;pageItems;rowsPerPageItems;paginatorState;_first=0;_page=0;constructor(e,i){this.cd=e,this.config=i}ngOnInit(){this.updatePaginatorState()}getAriaLabel(e){return this.config.translation.aria?this.config.translation.aria[e]:void 0}getPageAriaLabel(e){return this.config.translation.aria?this.config.translation.aria.pageLabel.replace(/{page}/g,`${e}`):void 0}getLocalization(e){let i=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),r=new Map(i.map((a,s)=>[s,a]));return e>9?String(e).split("").map(s=>r.get(Number(s))).join(""):r.get(e)}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"dropdownicon":this.dropdownIconTemplate=e.template;break;case"firstpagelinkicon":this.firstPageLinkIconTemplate=e.template;break;case"previouspagelinkicon":this.previousPageLinkIconTemplate=e.template;break;case"lastpagelinkicon":this.lastPageLinkIconTemplate=e.template;break;case"nextpagelinkicon":this.nextPageLinkIconTemplate=e.template;break}})}ngOnChanges(e){e.totalRecords&&(this.updatePageLinks(),this.updatePaginatorState(),this.updateFirst(),this.updateRowsPerPageOptions()),e.first&&(this._first=e.first.currentValue,this.updatePageLinks(),this.updatePaginatorState()),e.rows&&(this.updatePageLinks(),this.updatePaginatorState()),e.rowsPerPageOptions&&this.updateRowsPerPageOptions(),e.pageLinkSize&&this.updatePageLinks()}updateRowsPerPageOptions(){if(this.rowsPerPageOptions){this.rowsPerPageItems=[];for(let e of this.rowsPerPageOptions)typeof e=="object"&&e.showAll?this.rowsPerPageItems.unshift({label:e.showAll,value:this.totalRecords}):this.rowsPerPageItems.push({label:String(this.getLocalization(e)),value:e})}}isFirstPage(){return this.getPage()===0}isLastPage(){return this.getPage()===this.getPageCount()-1}getPageCount(){return Math.ceil(this.totalRecords/this.rows)}calculatePageLinkBoundaries(){let e=this.getPageCount(),i=Math.min(this.pageLinkSize,e),r=Math.max(0,Math.ceil(this.getPage()-i/2)),a=Math.min(e-1,r+i-1);var s=this.pageLinkSize-(a-r+1);return r=Math.max(0,r-s),[r,a]}updatePageLinks(){this.pageLinks=[];let e=this.calculatePageLinkBoundaries(),i=e[0],r=e[1];for(let a=i;a<=r;a++)this.pageLinks.push(a+1);if(this.showJumpToPageDropdown){this.pageItems=[];for(let a=0;a<this.getPageCount();a++)this.pageItems.push({label:String(a+1),value:a})}}changePage(e){var i=this.getPageCount();if(e>=0&&e<i){this._first=this.rows*e;var r={page:e,first:this.first,rows:this.rows,pageCount:i};this.updatePageLinks(),this.onPageChange.emit(r),this.updatePaginatorState()}}updateFirst(){let e=this.getPage();e>0&&this.totalRecords&&this.first>=this.totalRecords&&Promise.resolve(null).then(()=>this.changePage(e-1))}getPage(){return Math.floor(this.first/this.rows)}changePageToFirst(e){this.isFirstPage()||this.changePage(0),e.preventDefault()}changePageToPrev(e){this.changePage(this.getPage()-1),e.preventDefault()}changePageToNext(e){this.changePage(this.getPage()+1),e.preventDefault()}changePageToLast(e){this.isLastPage()||this.changePage(this.getPageCount()-1),e.preventDefault()}onPageLinkClick(e,i){this.changePage(i),e.preventDefault()}onRppChange(e){this.changePage(this.getPage())}onPageDropdownChange(e){this.changePage(e.value)}updatePaginatorState(){this.paginatorState={page:this.getPage(),pageCount:this.getPageCount(),rows:this.rows,first:this.first,totalRecords:this.totalRecords}}empty(){return this.getPageCount()===0}currentPage(){return this.getPageCount()>0?this.getPage()+1:0}get currentPageReport(){return this.currentPageReportTemplate.replace("{currentPage}",String(this.currentPage())).replace("{totalPages}",String(this.getPageCount())).replace("{first}",String(this.totalRecords>0?this._first+1:0)).replace("{last}",String(Math.min(this._first+this.rows,this.totalRecords))).replace("{rows}",String(this.rows)).replace("{totalRecords}",String(this.totalRecords))}static \u0275fac=function(i){return new(i||t)(Z(St),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-paginator"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},hostAttrs:[1,"p-element"],inputs:{pageLinkSize:[2,"pageLinkSize","pageLinkSize",We],style:"style",styleClass:"styleClass",alwaysShow:[2,"alwaysShow","alwaysShow",Q],dropdownAppendTo:"dropdownAppendTo",templateLeft:"templateLeft",templateRight:"templateRight",appendTo:"appendTo",dropdownScrollHeight:"dropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:[2,"showCurrentPageReport","showCurrentPageReport",Q],showFirstLastIcon:[2,"showFirstLastIcon","showFirstLastIcon",Q],totalRecords:[2,"totalRecords","totalRecords",We],rows:[2,"rows","rows",We],rowsPerPageOptions:"rowsPerPageOptions",showJumpToPageDropdown:[2,"showJumpToPageDropdown","showJumpToPageDropdown",Q],showJumpToPageInput:[2,"showJumpToPageInput","showJumpToPageInput",Q],jumpToPageItemTemplate:"jumpToPageItemTemplate",showPageLinks:[2,"showPageLinks","showPageLinks",Q],locale:"locale",dropdownItemTemplate:"dropdownItemTemplate",first:"first"},outputs:{onPageChange:"onPageChange"},features:[_t,Sn],decls:1,vars:1,consts:[[3,"class","ngStyle","ngClass",4,"ngIf"],[3,"ngStyle","ngClass"],["class","p-paginator-left-content",4,"ngIf"],["class","p-paginator-current",4,"ngIf"],["type","button","pRipple","","class","p-paginator-first p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-prev","p-paginator-element","p-link",3,"click","disabled","ngClass"],[3,"styleClass",4,"ngIf"],["class","p-paginator-icon",4,"ngIf"],["class","p-paginator-pages",4,"ngIf"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-next","p-paginator-element","p-link",3,"click","disabled","ngClass"],["type","button","pRipple","","class","p-paginator-last p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["class","p-paginator-page-input",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ariaLabel","ngModelChange","onChange",4,"ngIf"],["class","p-paginator-right-content",4,"ngIf"],[1,"p-paginator-left-content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-paginator-current"],["type","button","pRipple","",1,"p-paginator-first","p-paginator-element","p-link",3,"click","disabled","ngClass"],[3,"styleClass"],[1,"p-paginator-icon"],[4,"ngTemplateOutlet"],[1,"p-paginator-pages"],["type","button","class","p-paginator-page p-paginator-element p-link","pRipple","",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button","pRipple","",1,"p-paginator-page","p-paginator-element","p-link",3,"click","ngClass"],["styleClass","p-paginator-page-options",3,"onChange","options","ngModel","disabled","appendTo","scrollHeight"],["pTemplate","selectedItem"],[4,"ngIf"],["pTemplate","item"],["pTemplate","dropdownicon"],["type","button","pRipple","",1,"p-paginator-last","p-paginator-element","p-link",3,"click","disabled","ngClass"],[1,"p-paginator-page-input",3,"ngModelChange","ngModel","disabled"],["styleClass","p-paginator-rpp-options",3,"ngModelChange","onChange","options","ngModel","disabled","appendTo","scrollHeight","ariaLabel"],[1,"p-paginator-right-content"]],template:function(i,r){i&1&&w(0,Qx,16,29,"div",0),i&2&&u("ngIf",r.alwaysShow?!0:r.pageLinks&&r.pageLinks.length>1)},dependencies:()=>[at,ii,rt,bt,It,Wn,Ze,Nl,kn,dn,At,Ul,Hl,zl,Wl],styles:[`@layer primeng{.p-paginator{display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.p-paginator-left-content{margin-right:auto}.p-paginator-right-content{margin-left:auto}.p-paginator-page,.p-paginator-next,.p-paginator-last,.p-paginator-first,.p-paginator-prev,.p-paginator-current{cursor:pointer;display:inline-flex;align-items:center;justify-content:center;line-height:1;-webkit-user-select:none;user-select:none;overflow:hidden;position:relative}.p-paginator-element:focus{z-index:1;position:relative}}
`],encapsulation:2,changeDetection:0})}return t})(),wo=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,xn,ys,gn,ct,ai,Ul,Hl,zl,Wl,xn,ys,gn,ct]})}return t})();var e2=["container"],t2=(t,n,e)=>({"p-highlight":t,"p-disabled":n,"p-button-icon-only":e}),i2=(t,n)=>({$implicit:t,index:n});function n2(t,n){if(t&1&&N(0,"span",8),t&2){let e=f(2).$implicit;ue(e.icon),u("ngClass","p-button-icon p-button-icon-left"),V("data-pc-section","icon")}}function r2(t,n){if(t&1&&(_e(0),w(1,n2,1,4,"span",6),g(2,"span",7),Y(3),x(),ge()),t&2){let e=f().$implicit,i=f();p(),u("ngIf",e.icon),p(),V("data-pc-section","label"),p(),be(i.getOptionLabel(e))}}function a2(t,n){t&1&&ye(0)}function s2(t,n){if(t&1&&w(0,a2,1,0,"ng-container",9),t&2){let e=f(),i=e.$implicit,r=e.index,a=f();u("ngTemplateOutlet",a.selectButtonTemplate)("ngTemplateOutletContext",pt(2,i2,i,r))}}function o2(t,n){if(t&1){let e=le();g(0,"div",4),G("click",function(r){let a=S(e),s=a.$implicit,o=a.index,l=f();return I(l.onOptionSelect(r,s,o))})("keydown",function(r){let a=S(e),s=a.$implicit,o=a.index,l=f();return I(l.onKeyDown(r,s,o))})("focus",function(r){let a=S(e).index,s=f();return I(s.onFocus(r,a))})("blur",function(){S(e);let r=f();return I(r.onBlur())}),w(1,r2,4,3,"ng-container",5)(2,s2,1,5,"ng-template",null,1,$t),x()}if(t&2){let e=n.$implicit,i=n.index,r=vt(3),a=f();ue(e.styleClass),u("role",a.multiple?"checkbox":"radio")("ngClass",Ci(14,t2,a.isSelected(e),a.disabled||a.isOptionDisabled(e),e.icon&&!a.getOptionLabel(e)))("autofocus",a.autofocus),V("tabindex",i===a.focusedIndex&&!a.disabled?"0":"-1")("aria-label",e.label)("aria-checked",a.isSelected(e))("aria-disabled",a.optionDisabled)("title",e.title)("aria-labelledby",a.getOptionLabel(e))("data-pc-section","button"),p(),u("ngIf",!a.itemTemplate)("ngIfElse",r)}}var l2={provide:In,useExisting:ln(()=>c2),multi:!0},c2=(()=>{class t{cd;options;optionLabel;optionValue;optionDisabled;unselectable=!1;tabindex=0;multiple;allowEmpty=!0;style;styleClass;ariaLabelledBy;disabled;dataKey;autofocus;onOptionClick=new fe;onChange=new fe;container;itemTemplate;get selectButtonTemplate(){return this.itemTemplate?.template}get equalityKey(){return this.optionValue?null:this.dataKey}value;onModelChange=()=>{};onModelTouched=()=>{};focusedIndex=0;constructor(e){this.cd=e}getOptionLabel(e){return this.optionLabel?Re.resolveFieldData(e,this.optionLabel):e.label!=null?e.label:e}getOptionValue(e){return this.optionValue?Re.resolveFieldData(e,this.optionValue):this.optionLabel||e.value===void 0?e:e.value}isOptionDisabled(e){return this.optionDisabled?Re.resolveFieldData(e,this.optionDisabled):e.disabled!==void 0?e.disabled:!1}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onOptionSelect(e,i,r){if(this.disabled||this.isOptionDisabled(i))return;let a=this.isSelected(i);if(a&&this.unselectable)return;let s=this.getOptionValue(i),o;if(this.multiple)a?o=this.value.filter(l=>!Re.equals(l,s,this.equalityKey)):o=this.value?[...this.value,s]:[s];else{if(a&&!this.allowEmpty)return;o=a?null:s}this.focusedIndex=r,this.value=o,this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}),this.onOptionClick.emit({originalEvent:e,option:i,index:r})}onKeyDown(e,i,r){switch(e.code){case"Space":{this.onOptionSelect(e,i,r),e.preventDefault();break}case"ArrowDown":case"ArrowRight":{this.changeTabIndexes(e,"next"),e.preventDefault();break}case"ArrowUp":case"ArrowLeft":{this.changeTabIndexes(e,"prev"),e.preventDefault();break}default:break}}changeTabIndexes(e,i){let r,a;for(let s=0;s<=this.container.nativeElement.children.length-1;s++)this.container.nativeElement.children[s].getAttribute("tabindex")==="0"&&(r={elem:this.container.nativeElement.children[s],index:s});i==="prev"?r.index===0?a=this.container.nativeElement.children.length-1:a=r.index-1:r.index===this.container.nativeElement.children.length-1?a=0:a=r.index+1,this.focusedIndex=a,this.container.nativeElement.children[a].focus()}onFocus(e,i){this.focusedIndex=i}onBlur(){this.onModelTouched()}removeOption(e){this.value=this.value.filter(i=>!Re.equals(i,this.getOptionValue(e),this.dataKey))}isSelected(e){let i=!1,r=this.getOptionValue(e);if(this.multiple){if(this.value&&Array.isArray(this.value)){for(let a of this.value)if(Re.equals(a,r,this.dataKey)){i=!0;break}}}else i=Re.equals(this.getOptionValue(e),this.value,this.equalityKey);return i}static \u0275fac=function(i){return new(i||t)(Z(St))};static \u0275cmp=he({type:t,selectors:[["p-selectButton"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,5),i&2){let s;Ee(s=Fe())&&(r.itemTemplate=s.first)}},viewQuery:function(i,r){if(i&1&&Je(e2,5),i&2){let a;Ee(a=Fe())&&(r.container=a.first)}},hostAttrs:[1,"p-element"],inputs:{options:"options",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",unselectable:[2,"unselectable","unselectable",Q],tabindex:[2,"tabindex","tabindex",We],multiple:[2,"multiple","multiple",Q],allowEmpty:[2,"allowEmpty","allowEmpty",Q],style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy",disabled:[2,"disabled","disabled",Q],dataKey:"dataKey",autofocus:[2,"autofocus","autofocus",Q]},outputs:{onOptionClick:"onOptionClick",onChange:"onChange"},features:[ji([l2]),_t],decls:3,vars:8,consts:[["container",""],["customcontent",""],["role","group",3,"ngClass","ngStyle"],["pRipple","","class","p-button p-component","pAutoFocus","",3,"role","class","ngClass","autofocus","click","keydown","focus","blur",4,"ngFor","ngForOf"],["pRipple","","pAutoFocus","",1,"p-button","p-component",3,"click","keydown","focus","blur","role","ngClass","autofocus"],[4,"ngIf","ngIfElse"],[3,"ngClass","class",4,"ngIf"],[1,"p-button-label"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,r){i&1&&(g(0,"div",2,0),w(2,o2,4,18,"div",3),x()),i&2&&(ue(r.styleClass),u("ngClass","p-selectbutton p-buttonset p-component")("ngStyle",r.style),V("aria-labelledby",r.ariaLabelledBy)("data-pc-name","selectbutton")("data-pc-section","root"),p(2),u("ngForOf",r.options))},dependencies:[at,ii,rt,bt,It,At,Zn],styles:[`@layer primeng{.p-button{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label{flex:1 1 auto}.p-button-icon-right{order:1}.p-button:disabled{cursor:default;pointer-events:none}.p-button-icon-only{justify-content:center}.p-button-icon-only:after{content:"p";visibility:hidden;clip:rect(0 0 0 0);width:0}.p-button-vertical{flex-direction:column}.p-button-icon-bottom{order:2}.p-button-group .p-button{margin:0}.p-button-group .p-button:focus,.p-button-group p-button:focus .p-button,.p-buttonset .p-button:focus,.p-buttonset p-button:focus .p-button{position:relative;z-index:1}.p-button-group .p-button:not(:last-child),.p-button-group .p-button:not(:last-child):hover,.p-button-group p-button:not(:last-child) .p-button,.p-button-group p-button:not(:last-child) .p-button:hover,.p-buttonset .p-button:not(:last-child),.p-buttonset .p-button:not(:last-child):hover,.p-buttonset p-button:not(:last-child) .p-button,.p-buttonset p-button:not(:last-child) .p-button:hover{border-right:0 none}.p-button-group .p-button:not(:first-of-type):not(:last-of-type),.p-button-group p-button:not(:first-of-type):not(:last-of-type) .p-button,.p-buttonset .p-button:not(:first-of-type):not(:last-of-type),.p-buttonset p-button:not(:first-of-type):not(:last-of-type) .p-button{border-radius:0}.p-button-group .p-button:first-of-type:not(:only-of-type),.p-button-group p-button:first-of-type:not(:only-of-type) .p-button,.p-buttonset .p-button:first-of-type:not(:only-of-type),.p-buttonset p-button:first-of-type:not(:only-of-type) .p-button{border-top-right-radius:0;border-bottom-right-radius:0}.p-button-group .p-button:last-of-type:not(:only-of-type),.p-button-group p-button:last-of-type:not(:only-of-type) .p-button,.p-buttonset .p-button:last-of-type:not(:only-of-type),.p-buttonset p-button:last-of-type:not(:only-of-type) .p-button{border-top-left-radius:0;border-bottom-left-radius:0}p-button[iconpos=right] spinnericon{order:1}}
`],encapsulation:2,changeDetection:0})}return t})(),nd=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ai,ct,Qn,ct]})}return t})();var d2=(t,n,e)=>({"p-checkbox p-component":!0,"p-checkbox-disabled":t,"p-checkbox-focused":n,"p-variant-filled":e}),p2=(t,n,e)=>({"p-highlight":t,"p-disabled":n,"p-focus":e}),u2=(t,n,e)=>({"p-checkbox-label-active":t,"p-disabled":n,"p-checkbox-label-focus":e});function f2(t,n){if(t&1&&N(0,"span",8),t&2){let e=f(2);u("ngClass",e.checkboxTrueIcon),V("data-pc-section","checkIcon")}}function h2(t,n){t&1&&N(0,"CheckIcon",11),t&2&&(u("styleClass","p-checkbox-icon"),V("data-pc-section","checkIcon"))}function m2(t,n){}function _2(t,n){t&1&&w(0,m2,0,0,"ng-template")}function g2(t,n){if(t&1&&(g(0,"span",12),w(1,_2,1,0,null,13),x()),t&2){let e=f(3);V("data-pc-section","checkIcon"),p(),u("ngTemplateOutlet",e.checkIconTemplate)}}function x2(t,n){if(t&1&&(_e(0),w(1,h2,1,2,"CheckIcon",9)(2,g2,2,2,"span",10),ge()),t&2){let e=f(2);p(),u("ngIf",!e.checkIconTemplate),p(),u("ngIf",e.checkIconTemplate)}}function v2(t,n){if(t&1&&(_e(0),w(1,f2,1,2,"span",7)(2,x2,3,2,"ng-container",5),ge()),t&2){let e=f();p(),u("ngIf",e.checkboxTrueIcon),p(),u("ngIf",!e.checkboxTrueIcon)}}function b2(t,n){if(t&1&&N(0,"span",8),t&2){let e=f(2);u("ngClass",e.checkboxFalseIcon),V("data-pc-section","uncheckIcon")}}function y2(t,n){t&1&&N(0,"TimesIcon",11),t&2&&(u("styleClass","p-checkbox-icon"),V("data-pc-section","uncheckIcon"))}function w2(t,n){}function C2(t,n){t&1&&w(0,w2,0,0,"ng-template")}function T2(t,n){if(t&1&&(g(0,"span",12),w(1,C2,1,0,null,13),x()),t&2){let e=f(3);V("data-pc-section","uncheckIcon"),p(),u("ngTemplateOutlet",e.uncheckIconTemplate)}}function S2(t,n){if(t&1&&(_e(0),w(1,y2,1,2,"TimesIcon",9)(2,T2,2,2,"span",10),ge()),t&2){let e=f(2);p(),u("ngIf",!e.uncheckIconTemplate),p(),u("ngIf",e.uncheckIconTemplate)}}function I2(t,n){if(t&1&&(_e(0),w(1,b2,1,2,"span",7)(2,S2,3,2,"ng-container",5),ge()),t&2){let e=f();p(),u("ngIf",e.checkboxFalseIcon),p(),u("ngIf",!e.checkboxFalseIcon)}}function k2(t,n){if(t&1){let e=le();g(0,"label",14),G("click",function(r){S(e);let a=f(),s=vt(3);return I(a.onClick(r,s))}),Y(1),x()}if(t&2){let e=f();u("ngClass",Ci(3,u2,e.value!=null,e.disabled,e.focused)),V("for",e.inputId),p(),be(e.label)}}var E2={provide:In,useExisting:ln(()=>F2),multi:!0},F2=(()=>{class t{cd;config;constructor(e,i){this.cd=e,this.config=i}disabled;name;ariaLabel;ariaLabelledBy;variant="outlined";tabindex;inputId;style;styleClass;label;readonly;checkboxTrueIcon;checkboxFalseIcon;autofocus;onChange=new fe;templates;checkIconTemplate;uncheckIconTemplate;focused;value;onModelChange=()=>{};onModelTouched=()=>{};onClick(e,i){!this.disabled&&!this.readonly&&(this.toggle(e),this.focused=!0,i.focus())}onKeyDown(e){e.key==="Enter"&&(this.toggle(e),e.preventDefault())}toggle(e){this.value==null||this.value==null?this.value=!0:this.value==!0?this.value=!1:this.value==!1&&(this.value=null),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"checkicon":this.checkIconTemplate=e.template;break;case"uncheckicon":this.uncheckIconTemplate=e.template;break}})}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}writeValue(e){this.value=e,this.cd.markForCheck()}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}static \u0275fac=function(i){return new(i||t)(Z(St),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-triStateCheckbox"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},hostAttrs:[1,"p-element"],inputs:{disabled:[2,"disabled","disabled",Q],name:"name",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",variant:"variant",tabindex:[2,"tabindex","tabindex",We],inputId:"inputId",style:"style",styleClass:"styleClass",label:"label",readonly:[2,"readonly","readonly",Q],checkboxTrueIcon:"checkboxTrueIcon",checkboxFalseIcon:"checkboxFalseIcon",autofocus:[2,"autofocus","autofocus",Q]},outputs:{onChange:"onChange"},features:[ji([E2]),_t],decls:8,vars:28,consts:[["input",""],[3,"click","ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox","inputmode","none","pAutoFocus","",3,"keydown","focus","blur","name","readonly","disabled","autofocus"],["role","checkbox",1,"p-checkbox-box",3,"ngClass"],[4,"ngIf"],["class","p-checkbox-label",3,"ngClass","click",4,"ngIf"],["class","p-checkbox-icon",3,"ngClass",4,"ngIf"],[1,"p-checkbox-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet"],[1,"p-checkbox-label",3,"click","ngClass"]],template:function(i,r){if(i&1){let a=le();g(0,"div",1),G("click",function(o){S(a);let l=vt(3);return I(r.onClick(o,l))}),g(1,"div",2)(2,"input",3,0),G("keydown",function(o){return S(a),I(r.onKeyDown(o))})("focus",function(){return S(a),I(r.onFocus())})("blur",function(){return S(a),I(r.onBlur())}),x()(),g(4,"div",4),w(5,v2,3,2,"ng-container",5)(6,I2,3,2,"ng-container",5),x()(),w(7,k2,2,7,"label",6)}i&2&&(ue(r.styleClass),u("ngStyle",r.style)("ngClass",Ci(20,d2,r.disabled,r.focused,r.variant==="filled"||r.config.inputStyle()==="filled")),V("data-pc-name","tristatecheckbox")("data-pc-section","root"),p(2),u("name",r.name)("readonly",r.readonly)("disabled",r.disabled)("autofocus",r.autofocus),V("id",r.inputId)("tabindex",r.tabindex)("aria-labelledby",r.ariaLabelledBy)("aria-label",r.ariaLabel)("data-pc-section","hiddenInput"),p(2),u("ngClass",Ci(24,p2,r.value!=null,r.disabled,r.focused)),V("aria-checked",r.value===!0),p(),u("ngIf",r.value===!0),p(),u("ngIf",r.value===!1),p(),u("ngIf",r.label))},dependencies:()=>[at,rt,bt,It,Zn,Di,Rt],encapsulation:2,changeDetection:0})}return t})(),rd=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ct,Qn,Di,Rt,ct]})}return t})();var M2=["container"],O2=["resizeHelper"],A2=["reorderIndicatorUp"],L2=["reorderIndicatorDown"],R2=["wrapper"],V2=["table"],P2=["thead"],B2=["tfoot"],N2=["scroller"],U2=(t,n,e)=>({"p-datatable p-component":!0,"p-datatable-hoverable-rows":t,"p-datatable-scrollable":n,"p-datatable-flex-scrollable":e}),H2=t=>({maxHeight:t}),ad=t=>({height:t}),sd=(t,n)=>({$implicit:t,options:n}),z2=t=>({columns:t}),W2=(t,n,e)=>({"p-datatable-table":!0,"p-datatable-scrollable-table":t,"p-datatable-resizable-table":n,"p-datatable-resizable-table-fit":e}),Ha=t=>({$implicit:t}),jl=()=>({display:"none"});function j2(t,n){if(t&1&&N(0,"i"),t&2){let e=f(2);ue("p-datatable-loading-icon "+e.loadingIcon)}}function K2(t,n){t&1&&N(0,"SpinnerIcon",25),t&2&&u("spin",!0)("styleClass","p-datatable-loading-icon")}function G2(t,n){}function $2(t,n){t&1&&w(0,G2,0,0,"ng-template")}function Y2(t,n){if(t&1&&(g(0,"span",26),w(1,$2,1,0,null,27),x()),t&2){let e=f(3);p(),u("ngTemplateOutlet",e.loadingIconTemplate)}}function X2(t,n){if(t&1&&(_e(0),w(1,K2,1,2,"SpinnerIcon",23)(2,Y2,2,1,"span",24),ge()),t&2){let e=f(2);p(),u("ngIf",!e.loadingIconTemplate),p(),u("ngIf",e.loadingIconTemplate)}}function q2(t,n){if(t&1&&(g(0,"div",21),w(1,j2,1,2,"i",22)(2,X2,3,2,"ng-container",16),x()),t&2){let e=f();p(),u("ngIf",e.loadingIcon),p(),u("ngIf",!e.loadingIcon)}}function Z2(t,n){t&1&&ye(0)}function Q2(t,n){if(t&1&&(g(0,"div",28),w(1,Z2,1,0,"ng-container",27),x()),t&2){let e=f();p(),u("ngTemplateOutlet",e.captionTemplate)}}function J2(t,n){t&1&&ye(0)}function ev(t,n){if(t&1&&w(0,J2,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorDropdownIconTemplate)}}function tv(t,n){t&1&&w(0,ev,1,1,"ng-template",30)}function iv(t,n){t&1&&ye(0)}function nv(t,n){if(t&1&&w(0,iv,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorFirstPageLinkIconTemplate)}}function rv(t,n){t&1&&w(0,nv,1,1,"ng-template",31)}function av(t,n){t&1&&ye(0)}function sv(t,n){if(t&1&&w(0,av,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorPreviousPageLinkIconTemplate)}}function ov(t,n){t&1&&w(0,sv,1,1,"ng-template",32)}function lv(t,n){t&1&&ye(0)}function cv(t,n){if(t&1&&w(0,lv,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorLastPageLinkIconTemplate)}}function dv(t,n){t&1&&w(0,cv,1,1,"ng-template",33)}function pv(t,n){t&1&&ye(0)}function uv(t,n){if(t&1&&w(0,pv,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorNextPageLinkIconTemplate)}}function fv(t,n){t&1&&w(0,uv,1,1,"ng-template",34)}function hv(t,n){if(t&1){let e=le();g(0,"p-paginator",29),G("onPageChange",function(r){S(e);let a=f();return I(a.onPageChange(r))}),w(1,tv,1,0,null,16)(2,rv,1,0,null,16)(3,ov,1,0,null,16)(4,dv,1,0,null,16)(5,fv,1,0,null,16),x()}if(t&2){let e=f();u("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)("styleClass",e.getPaginatorStyleClasses("p-paginator-top"))("locale",e.paginatorLocale),p(),u("ngIf",e.paginatorDropdownIconTemplate),p(),u("ngIf",e.paginatorFirstPageLinkIconTemplate),p(),u("ngIf",e.paginatorPreviousPageLinkIconTemplate),p(),u("ngIf",e.paginatorLastPageLinkIconTemplate),p(),u("ngIf",e.paginatorNextPageLinkIconTemplate)}}function mv(t,n){t&1&&ye(0)}function _v(t,n){if(t&1&&w(0,mv,1,0,"ng-container",37),t&2){let e=n.$implicit,i=n.options;f(2);let r=vt(10);u("ngTemplateOutlet",r)("ngTemplateOutletContext",pt(2,sd,e,i))}}function gv(t,n){if(t&1){let e=le();g(0,"p-scroller",35,3),G("onLazyLoad",function(r){S(e);let a=f();return I(a.onLazyItemLoad(r))}),w(2,_v,1,5,"ng-template",36),x()}if(t&2){let e=f();Ai(Le(15,ad,e.scrollHeight!=="flex"?e.scrollHeight:void 0)),u("items",e.processedData)("columns",e.columns)("scrollHeight",e.scrollHeight!=="flex"?void 0:"100%")("itemSize",e.virtualScrollItemSize||e._virtualRowHeight)("step",e.rows)("delay",e.lazy?e.virtualScrollDelay:0)("inline",!0)("autoSize",!0)("lazy",e.lazy)("loaderDisabled",!0)("showSpacer",!1)("showLoader",e.loadingBodyTemplate)("options",e.virtualScrollOptions)}}function xv(t,n){t&1&&ye(0)}function vv(t,n){if(t&1&&(_e(0),w(1,xv,1,0,"ng-container",37),ge()),t&2){let e=f(),i=vt(10);p(),u("ngTemplateOutlet",i)("ngTemplateOutletContext",pt(4,sd,e.processedData,Le(2,z2,e.columns)))}}function bv(t,n){t&1&&ye(0)}function yv(t,n){t&1&&ye(0)}function wv(t,n){if(t&1&&N(0,"tbody",44),t&2){let e=f().options,i=f();u("value",i.frozenValue)("frozenRows",!0)("pTableBody",e.columns)("pTableBodyTemplate",i.frozenBodyTemplate)("frozen",!0)}}function Cv(t,n){if(t&1&&N(0,"tbody",45),t&2){let e=f().options;u("ngStyle",Le(1,ad,"calc("+e.spacerStyle.height+" - "+e.rows.length*e.itemSize+"px)"))}}function Tv(t,n){t&1&&ye(0)}function Sv(t,n){if(t&1&&(g(0,"tfoot",46,6),w(2,Tv,1,0,"ng-container",37),x()),t&2){let e=f().options,i=f();p(2),u("ngTemplateOutlet",i.footerGroupedTemplate||i.footerTemplate)("ngTemplateOutletContext",Le(2,Ha,e.columns))}}function Iv(t,n){if(t&1&&(g(0,"table",38,4),w(2,bv,1,0,"ng-container",37),g(3,"thead",39,5),w(5,yv,1,0,"ng-container",37),x(),w(6,wv,1,5,"tbody",40),N(7,"tbody",41),w(8,Cv,1,3,"tbody",42)(9,Sv,3,4,"tfoot",43),x()),t&2){let e=n.options,i=f();ue(i.tableStyleClass),u("ngClass",Ci(18,W2,i.scrollable,i.resizableColumns,i.resizableColumns&&i.columnResizeMode==="fit"))("ngStyle",i.tableStyle),V("id",i.id+"-table"),p(2),u("ngTemplateOutlet",i.colGroupTemplate)("ngTemplateOutletContext",Le(22,Ha,e.columns)),p(3),u("ngTemplateOutlet",i.headerGroupedTemplate||i.headerTemplate)("ngTemplateOutletContext",Le(24,Ha,e.columns)),p(),u("ngIf",i.frozenValue||i.frozenBodyTemplate),p(),u("ngClass",e.contentStyleClass)("ngStyle",e.contentStyle)("value",i.dataToRender(e.rows))("pTableBody",e.columns)("pTableBodyTemplate",i.bodyTemplate)("scrollerOptions",e),p(),u("ngIf",e.spacerStyle),p(),u("ngIf",i.footerGroupedTemplate||i.footerTemplate)}}function kv(t,n){t&1&&ye(0)}function Ev(t,n){if(t&1&&w(0,kv,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorDropdownIconTemplate)}}function Fv(t,n){t&1&&w(0,Ev,1,1,"ng-template",30)}function Dv(t,n){t&1&&ye(0)}function Mv(t,n){if(t&1&&w(0,Dv,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorFirstPageLinkIconTemplate)}}function Ov(t,n){t&1&&w(0,Mv,1,1,"ng-template",31)}function Av(t,n){t&1&&ye(0)}function Lv(t,n){if(t&1&&w(0,Av,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorPreviousPageLinkIconTemplate)}}function Rv(t,n){t&1&&w(0,Lv,1,1,"ng-template",32)}function Vv(t,n){t&1&&ye(0)}function Pv(t,n){if(t&1&&w(0,Vv,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorLastPageLinkIconTemplate)}}function Bv(t,n){t&1&&w(0,Pv,1,1,"ng-template",33)}function Nv(t,n){t&1&&ye(0)}function Uv(t,n){if(t&1&&w(0,Nv,1,0,"ng-container",27),t&2){let e=f(3);u("ngTemplateOutlet",e.paginatorNextPageLinkIconTemplate)}}function Hv(t,n){t&1&&w(0,Uv,1,1,"ng-template",34)}function zv(t,n){if(t&1){let e=le();g(0,"p-paginator",29),G("onPageChange",function(r){S(e);let a=f();return I(a.onPageChange(r))}),w(1,Fv,1,0,null,16)(2,Ov,1,0,null,16)(3,Rv,1,0,null,16)(4,Bv,1,0,null,16)(5,Hv,1,0,null,16),x()}if(t&2){let e=f();u("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)("styleClass",e.getPaginatorStyleClasses("p-paginator-bottom"))("locale",e.paginatorLocale),p(),u("ngIf",e.paginatorDropdownIconTemplate),p(),u("ngIf",e.paginatorFirstPageLinkIconTemplate),p(),u("ngIf",e.paginatorPreviousPageLinkIconTemplate),p(),u("ngIf",e.paginatorLastPageLinkIconTemplate),p(),u("ngIf",e.paginatorNextPageLinkIconTemplate)}}function Wv(t,n){t&1&&ye(0)}function jv(t,n){if(t&1&&(g(0,"div",47),w(1,Wv,1,0,"ng-container",27),x()),t&2){let e=f();p(),u("ngTemplateOutlet",e.summaryTemplate)}}function Kv(t,n){t&1&&N(0,"div",48,7),t&2&&u("ngStyle",Ot(1,jl))}function Gv(t,n){t&1&&N(0,"ArrowDownIcon")}function $v(t,n){}function Yv(t,n){t&1&&w(0,$v,0,0,"ng-template")}function Xv(t,n){if(t&1&&(g(0,"span",49,8),w(2,Gv,1,0,"ArrowDownIcon",16)(3,Yv,1,0,null,27),x()),t&2){let e=f();u("ngStyle",Ot(3,jl)),p(2),u("ngIf",!e.reorderIndicatorUpIconTemplate),p(),u("ngTemplateOutlet",e.reorderIndicatorUpIconTemplate)}}function qv(t,n){t&1&&N(0,"ArrowUpIcon")}function Zv(t,n){}function Qv(t,n){t&1&&w(0,Zv,0,0,"ng-template")}function Jv(t,n){if(t&1&&(g(0,"span",50,9),w(2,qv,1,0,"ArrowUpIcon",16)(3,Qv,1,0,null,27),x()),t&2){let e=f();u("ngStyle",Ot(3,jl)),p(2),u("ngIf",!e.reorderIndicatorDownIconTemplate),p(),u("ngTemplateOutlet",e.reorderIndicatorDownIconTemplate)}}var eb=["pTableBody",""],Kl=(t,n,e,i,r)=>({$implicit:t,rowIndex:n,columns:e,editing:i,frozen:r}),tb=(t,n,e,i,r,a,s)=>({$implicit:t,rowIndex:n,columns:e,editing:i,frozen:r,rowgroup:a,rowspan:s}),Co=(t,n,e,i,r,a)=>({$implicit:t,rowIndex:n,columns:e,expanded:i,editing:r,frozen:a}),od=(t,n,e,i)=>({$implicit:t,rowIndex:n,columns:e,frozen:i}),ld=(t,n)=>({$implicit:t,frozen:n});function ib(t,n){t&1&&ye(0)}function nb(t,n){if(t&1&&(_e(0,3),w(1,ib,1,0,"ng-container",4),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",a.dt.groupHeaderTemplate)("ngTemplateOutletContext",Ir(2,Kl,i,a.getRowIndex(r),a.columns,a.dt.editMode==="row"&&a.dt.isRowEditing(i),a.frozen))}}function rb(t,n){t&1&&ye(0)}function ab(t,n){if(t&1&&(_e(0),w(1,rb,1,0,"ng-container",4),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",i?a.template:a.dt.loadingBodyTemplate)("ngTemplateOutletContext",Ir(2,Kl,i,a.getRowIndex(r),a.columns,a.dt.editMode==="row"&&a.dt.isRowEditing(i),a.frozen))}}function sb(t,n){t&1&&ye(0)}function ob(t,n){if(t&1&&(_e(0),w(1,sb,1,0,"ng-container",4),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",i?a.template:a.dt.loadingBodyTemplate)("ngTemplateOutletContext",k0(2,tb,i,a.getRowIndex(r),a.columns,a.dt.editMode==="row"&&a.dt.isRowEditing(i),a.frozen,a.shouldRenderRowspan(a.value,i,r),a.calculateRowGroupSize(a.value,i,r)))}}function lb(t,n){t&1&&ye(0)}function cb(t,n){if(t&1&&(_e(0,3),w(1,lb,1,0,"ng-container",4),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",a.dt.groupFooterTemplate)("ngTemplateOutletContext",Ir(2,Kl,i,a.getRowIndex(r),a.columns,a.dt.editMode==="row"&&a.dt.isRowEditing(i),a.frozen))}}function db(t,n){if(t&1&&w(0,nb,2,8,"ng-container",2)(1,ab,2,8,"ng-container",0)(2,ob,2,10,"ng-container",0)(3,cb,2,8,"ng-container",2),t&2){let e=n.$implicit,i=n.index,r=f(2);u("ngIf",r.dt.groupHeaderTemplate&&!r.dt.virtualScroll&&r.dt.rowGroupMode==="subheader"&&r.shouldRenderRowGroupHeader(r.value,e,r.getRowIndex(i))),p(),u("ngIf",r.dt.rowGroupMode!=="rowspan"),p(),u("ngIf",r.dt.rowGroupMode==="rowspan"),p(),u("ngIf",r.dt.groupFooterTemplate&&!r.dt.virtualScroll&&r.dt.rowGroupMode==="subheader"&&r.shouldRenderRowGroupFooter(r.value,e,i))}}function pb(t,n){if(t&1&&(_e(0),w(1,db,4,4,"ng-template",1),ge()),t&2){let e=f();p(),u("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function ub(t,n){t&1&&ye(0)}function fb(t,n){if(t&1&&(_e(0),w(1,ub,1,0,"ng-container",4),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",a.template)("ngTemplateOutletContext",ur(2,Co,i,a.getRowIndex(r),a.columns,a.dt.isRowExpanded(i),a.dt.editMode==="row"&&a.dt.isRowEditing(i),a.frozen))}}function hb(t,n){t&1&&ye(0)}function mb(t,n){if(t&1&&(_e(0,3),w(1,hb,1,0,"ng-container",4),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",a.dt.groupHeaderTemplate)("ngTemplateOutletContext",ur(2,Co,i,a.getRowIndex(r),a.columns,a.dt.isRowExpanded(i),a.dt.editMode==="row"&&a.dt.isRowEditing(i),a.frozen))}}function _b(t,n){t&1&&ye(0)}function gb(t,n){t&1&&ye(0)}function xb(t,n){if(t&1&&(_e(0,3),w(1,gb,1,0,"ng-container",4),ge()),t&2){let e=f(2),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",a.dt.groupFooterTemplate)("ngTemplateOutletContext",ur(2,Co,i,a.getRowIndex(r),a.columns,a.dt.isRowExpanded(i),a.dt.editMode==="row"&&a.dt.isRowEditing(i),a.frozen))}}function vb(t,n){if(t&1&&(_e(0),w(1,_b,1,0,"ng-container",4)(2,xb,2,9,"ng-container",2),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",a.dt.expandedRowTemplate)("ngTemplateOutletContext",pr(3,od,i,a.getRowIndex(r),a.columns,a.frozen)),p(),u("ngIf",a.dt.groupFooterTemplate&&a.dt.rowGroupMode==="subheader"&&a.shouldRenderRowGroupFooter(a.value,i,a.getRowIndex(r)))}}function bb(t,n){if(t&1&&w(0,fb,2,9,"ng-container",0)(1,mb,2,9,"ng-container",2)(2,vb,3,8,"ng-container",0),t&2){let e=n.$implicit,i=n.index,r=f(2);u("ngIf",!r.dt.groupHeaderTemplate),p(),u("ngIf",r.dt.groupHeaderTemplate&&r.dt.rowGroupMode==="subheader"&&r.shouldRenderRowGroupHeader(r.value,e,r.getRowIndex(i))),p(),u("ngIf",r.dt.isRowExpanded(e))}}function yb(t,n){if(t&1&&(_e(0),w(1,bb,3,3,"ng-template",1),ge()),t&2){let e=f();p(),u("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function wb(t,n){t&1&&ye(0)}function Cb(t,n){t&1&&ye(0)}function Tb(t,n){if(t&1&&(_e(0),w(1,Cb,1,0,"ng-container",4),ge()),t&2){let e=f(),i=e.$implicit,r=e.index,a=f(2);p(),u("ngTemplateOutlet",a.dt.frozenExpandedRowTemplate)("ngTemplateOutletContext",pr(2,od,i,a.getRowIndex(r),a.columns,a.frozen))}}function Sb(t,n){if(t&1&&w(0,wb,1,0,"ng-container",4)(1,Tb,2,7,"ng-container",0),t&2){let e=n.$implicit,i=n.index,r=f(2);u("ngTemplateOutlet",r.template)("ngTemplateOutletContext",ur(3,Co,e,r.getRowIndex(i),r.columns,r.dt.isRowExpanded(e),r.dt.editMode==="row"&&r.dt.isRowEditing(e),r.frozen)),p(),u("ngIf",r.dt.isRowExpanded(e))}}function Ib(t,n){if(t&1&&(_e(0),w(1,Sb,2,10,"ng-template",1),ge()),t&2){let e=f();p(),u("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function kb(t,n){t&1&&ye(0)}function Eb(t,n){if(t&1&&(_e(0),w(1,kb,1,0,"ng-container",4),ge()),t&2){let e=f();p(),u("ngTemplateOutlet",e.dt.loadingBodyTemplate)("ngTemplateOutletContext",pt(2,ld,e.columns,e.frozen))}}function Fb(t,n){t&1&&ye(0)}function Db(t,n){if(t&1&&(_e(0),w(1,Fb,1,0,"ng-container",4),ge()),t&2){let e=f();p(),u("ngTemplateOutlet",e.dt.emptyMessageTemplate)("ngTemplateOutletContext",pt(2,ld,e.columns,e.frozen))}}function Mb(t,n){t&1&&N(0,"SortAltIcon",4),t&2&&u("styleClass","p-sortable-column-icon")}function Ob(t,n){t&1&&N(0,"SortAmountUpAltIcon",4),t&2&&u("styleClass","p-sortable-column-icon")}function Ab(t,n){t&1&&N(0,"SortAmountDownIcon",4),t&2&&u("styleClass","p-sortable-column-icon")}function Lb(t,n){if(t&1&&(_e(0),w(1,Mb,1,1,"SortAltIcon",3)(2,Ob,1,1,"SortAmountUpAltIcon",3)(3,Ab,1,1,"SortAmountDownIcon",3),ge()),t&2){let e=f();p(),u("ngIf",e.sortOrder===0),p(),u("ngIf",e.sortOrder===1),p(),u("ngIf",e.sortOrder===-1)}}function Rb(t,n){}function Vb(t,n){t&1&&w(0,Rb,0,0,"ng-template")}function Pb(t,n){if(t&1&&(g(0,"span",5),w(1,Vb,1,0,null,6),x()),t&2){let e=f();p(),u("ngTemplateOutlet",e.dt.sortIconTemplate)("ngTemplateOutletContext",Le(2,Ha,e.sortOrder))}}function Bb(t,n){if(t&1&&(g(0,"span",7),Y(1),x()),t&2){let e=f();p(),be(e.getBadgeValue())}}var cd=(t,n)=>({"p-checkbox-focused":t,"p-checkbox-disabled":n}),Nb=(t,n,e)=>({"p-checkbox-box p-component":!0,"p-highlight":t,"p-focus":n,"p-disabled":e});function Ub(t,n){t&1&&N(0,"CheckIcon",7),t&2&&u("styleClass","p-checkbox-icon")}function Hb(t,n){if(t&1&&(_e(0),w(1,Ub,1,1,"CheckIcon",6),ge()),t&2){let e=f();p(),u("ngIf",e.checked)}}function zb(t,n){}function Wb(t,n){t&1&&w(0,zb,0,0,"ng-template")}function jb(t,n){if(t&1&&(g(0,"span"),w(1,Wb,1,0,null,8),x()),t&2){let e=f();p(),u("ngTemplateOutlet",e.dt.checkboxIconTemplate)("ngTemplateOutletContext",Le(2,Ha,e.checked))}}var Kb=(t,n,e)=>({"p-checkbox-box":!0,"p-highlight":t,"p-focus":n,"p-disabled":e});function Gb(t,n){t&1&&N(0,"CheckIcon",9),t&2&&u("styleClass","p-checkbox-icon")}function $b(t,n){if(t&1&&(_e(0),w(1,Gb,1,1,"CheckIcon",8),ge()),t&2){let e=f();p(),u("ngIf",e.checked)}}function Yb(t,n){}function Xb(t,n){t&1&&w(0,Yb,0,0,"ng-template")}function qb(t,n){if(t&1&&(g(0,"span",10),w(1,Xb,1,0,null,11),x()),t&2){let e=f();p(),u("ngTemplateOutlet",e.dt.headerCheckboxIconTemplate)("ngTemplateOutletContext",Le(2,Ha,e.checked))}}var ws=(()=>{class t{sortSource=new Tr;selectionSource=new Tr;contextMenuSource=new Tr;valueSource=new Tr;totalRecordsSource=new Tr;columnsSource=new Tr;isHeaderCheckboxSelection=new Tr;sortSource$=this.sortSource.asObservable();isHeaderCheckboxSelection$=this.isHeaderCheckboxSelection.asObservable();selectionSource$=this.selectionSource.asObservable();contextMenuSource$=this.contextMenuSource.asObservable();valueSource$=this.valueSource.asObservable();totalRecordsSource$=this.totalRecordsSource.asObservable();columnsSource$=this.columnsSource.asObservable();onSort(e){this.sortSource.next(e)}onSelectionChange(){this.selectionSource.next(null)}onContextMenu(e){this.contextMenuSource.next(e)}onValueChange(e){this.valueSource.next(e)}onTotalRecordsChange(e){this.totalRecordsSource.next(e)}onColumnsChange(e){this.columnsSource.next(e)}onHeaderCheckboxSelection(e){this.isHeaderCheckboxSelection.next(e)}static \u0275fac=function(i){return new(i||t)};static \u0275prov=so({token:t,factory:t.\u0275fac})}return t})(),fr=(()=>{class t{document;platformId;renderer;el;zone;tableService;cd;filterService;overlayService;config;domSanitizer;frozenColumns;frozenValue;style;styleClass;tableStyle;tableStyleClass;paginator;pageLinks=5;rowsPerPageOptions;alwaysShowPaginator=!0;paginatorPosition="bottom";paginatorStyleClass;paginatorDropdownAppendTo;paginatorDropdownScrollHeight="200px";currentPageReportTemplate="{currentPage} of {totalPages}";showCurrentPageReport;showJumpToPageDropdown;showJumpToPageInput;showFirstLastIcon=!0;showPageLinks=!0;defaultSortOrder=1;sortMode="single";resetPageOnSort=!0;selectionMode;selectionPageOnly;contextMenuSelection;contextMenuSelectionChange=new fe;contextMenuSelectionMode="separate";dataKey;metaKeySelection=!1;rowSelectable;rowTrackBy=(e,i)=>i;lazy=!1;lazyLoadOnInit=!0;compareSelectionBy="deepEquals";csvSeparator=",";exportFilename="download";filters={};globalFilterFields;filterDelay=300;filterLocale;expandedRowKeys={};editingRowKeys={};rowExpandMode="multiple";scrollable;scrollDirection="vertical";rowGroupMode;scrollHeight;virtualScroll;virtualScrollItemSize;virtualScrollOptions;virtualScrollDelay=250;frozenWidth;get responsive(){return this._responsive}set responsive(e){this._responsive=e,console.warn("responsive property is deprecated as table is always responsive with scrollable behavior.")}_responsive;contextMenu;resizableColumns;columnResizeMode="fit";reorderableColumns;loading;loadingIcon;showLoader=!0;rowHover;customSort;showInitialSortBadge=!0;autoLayout;exportFunction;exportHeader;stateKey;stateStorage="session";editMode="cell";groupRowsBy;groupRowsByOrder=1;responsiveLayout="scroll";breakpoint="960px";paginatorLocale;get value(){return this._value}set value(e){this._value=e}get columns(){return this._columns}set columns(e){this._columns=e}get first(){return this._first}set first(e){this._first=e}get rows(){return this._rows}set rows(e){this._rows=e}get totalRecords(){return this._totalRecords}set totalRecords(e){this._totalRecords=e,this.tableService.onTotalRecordsChange(this._totalRecords)}get sortField(){return this._sortField}set sortField(e){this._sortField=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get multiSortMeta(){return this._multiSortMeta}set multiSortMeta(e){this._multiSortMeta=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectAll(){return this._selection}set selectAll(e){this._selection=e}selectAllChange=new fe;selectionChange=new fe;onRowSelect=new fe;onRowUnselect=new fe;onPage=new fe;onSort=new fe;onFilter=new fe;onLazyLoad=new fe;onRowExpand=new fe;onRowCollapse=new fe;onContextMenuSelect=new fe;onColResize=new fe;onColReorder=new fe;onRowReorder=new fe;onEditInit=new fe;onEditComplete=new fe;onEditCancel=new fe;onHeaderCheckboxToggle=new fe;sortFunction=new fe;firstChange=new fe;rowsChange=new fe;onStateSave=new fe;onStateRestore=new fe;containerViewChild;resizeHelperViewChild;reorderIndicatorUpViewChild;reorderIndicatorDownViewChild;wrapperViewChild;tableViewChild;tableHeaderViewChild;tableFooterViewChild;scroller;templates;get virtualRowHeight(){return this._virtualRowHeight}set virtualRowHeight(e){this._virtualRowHeight=e,console.warn("The virtualRowHeight property is deprecated.")}_virtualRowHeight=28;_value=[];_columns;_totalRecords=0;_first=0;_rows;filteredValue;headerTemplate;headerGroupedTemplate;bodyTemplate;loadingBodyTemplate;captionTemplate;footerTemplate;footerGroupedTemplate;summaryTemplate;colGroupTemplate;expandedRowTemplate;groupHeaderTemplate;groupFooterTemplate;frozenExpandedRowTemplate;frozenHeaderTemplate;frozenBodyTemplate;frozenFooterTemplate;frozenColGroupTemplate;emptyMessageTemplate;paginatorLeftTemplate;paginatorRightTemplate;paginatorDropdownItemTemplate;loadingIconTemplate;reorderIndicatorUpIconTemplate;reorderIndicatorDownIconTemplate;sortIconTemplate;checkboxIconTemplate;headerCheckboxIconTemplate;paginatorDropdownIconTemplate;paginatorFirstPageLinkIconTemplate;paginatorLastPageLinkIconTemplate;paginatorPreviousPageLinkIconTemplate;paginatorNextPageLinkIconTemplate;selectionKeys={};lastResizerHelperX;reorderIconWidth;reorderIconHeight;draggedColumn;draggedRowIndex;droppedRowIndex;rowDragging;dropPosition;editingCell;editingCellData;editingCellField;editingCellRowIndex;selfClick;documentEditListener;_multiSortMeta;_sortField;_sortOrder=1;preventSelectionSetterPropagation;_selection;_selectAll=null;anchorRowIndex;rangeRowIndex;filterTimeout;initialized;rowTouched;restoringSort;restoringFilter;stateRestored;columnOrderStateRestored;columnWidthsState;tableWidthState;overlaySubscription;resizeColumnElement;columnResizing=!1;rowGroupHeaderStyleObject={};id=ot();styleElement;responsiveStyleElement;window;constructor(e,i,r,a,s,o,l,c,d,h,_){this.document=e,this.platformId=i,this.renderer=r,this.el=a,this.zone=s,this.tableService=o,this.cd=l,this.filterService=c,this.overlayService=d,this.config=h,this.domSanitizer=_,this.window=this.document.defaultView}ngOnInit(){this.lazy&&this.lazyLoadOnInit&&(this.virtualScroll||this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.restoringFilter&&(this.restoringFilter=!1)),this.responsiveLayout==="stack"&&this.createResponsiveStyle(),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"caption":this.captionTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"headergrouped":this.headerGroupedTemplate=e.template;break;case"body":this.bodyTemplate=e.template;break;case"loadingbody":this.loadingBodyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"footergrouped":this.footerGroupedTemplate=e.template;break;case"summary":this.summaryTemplate=e.template;break;case"colgroup":this.colGroupTemplate=e.template;break;case"rowexpansion":this.expandedRowTemplate=e.template;break;case"groupheader":this.groupHeaderTemplate=e.template;break;case"groupfooter":this.groupFooterTemplate=e.template;break;case"frozenheader":this.frozenHeaderTemplate=e.template;break;case"frozenbody":this.frozenBodyTemplate=e.template;break;case"frozenfooter":this.frozenFooterTemplate=e.template;break;case"frozencolgroup":this.frozenColGroupTemplate=e.template;break;case"frozenrowexpansion":this.frozenExpandedRowTemplate=e.template;break;case"emptymessage":this.emptyMessageTemplate=e.template;break;case"paginatorleft":this.paginatorLeftTemplate=e.template;break;case"paginatorright":this.paginatorRightTemplate=e.template;break;case"paginatordropdownicon":this.paginatorDropdownIconTemplate=e.template;break;case"paginatordropdownitem":this.paginatorDropdownItemTemplate=e.template;break;case"paginatorfirstpagelinkicon":this.paginatorFirstPageLinkIconTemplate=e.template;break;case"paginatorlastpagelinkicon":this.paginatorLastPageLinkIconTemplate=e.template;break;case"paginatorpreviouspagelinkicon":this.paginatorPreviousPageLinkIconTemplate=e.template;break;case"paginatornextpagelinkicon":this.paginatorNextPageLinkIconTemplate=e.template;break;case"loadingicon":this.loadingIconTemplate=e.template;break;case"reorderindicatorupicon":this.reorderIndicatorUpIconTemplate=e.template;break;case"reorderindicatordownicon":this.reorderIndicatorDownIconTemplate=e.template;break;case"sorticon":this.sortIconTemplate=e.template;break;case"checkboxicon":this.checkboxIconTemplate=e.template;break;case"headercheckboxicon":this.headerCheckboxIconTemplate=e.template;break}})}ngAfterViewInit(){ni(this.platformId)&&this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths()}ngOnChanges(e){e.value&&(this.isStateful()&&!this.stateRestored&&ni(this.platformId)&&this.restoreState(),this._value=e.value.currentValue,this.lazy||(this.totalRecords=this._value?this._value.length:0,this.sortMode=="single"&&(this.sortField||this.groupRowsBy)?this.sortSingle():this.sortMode=="multiple"&&(this.multiSortMeta||this.groupRowsBy)?this.sortMultiple():this.hasFilter()&&this._filter()),this.tableService.onValueChange(e.value.currentValue)),e.columns&&(this.isStateful()||(this._columns=e.columns.currentValue,this.tableService.onColumnsChange(e.columns.currentValue)),this._columns&&this.isStateful()&&this.reorderableColumns&&!this.columnOrderStateRestored&&(this.restoreColumnOrder(),this.tableService.onColumnsChange(this._columns))),e.sortField&&(this._sortField=e.sortField.currentValue,(!this.lazy||this.initialized)&&this.sortMode==="single"&&this.sortSingle()),e.groupRowsBy&&(!this.lazy||this.initialized)&&this.sortMode==="single"&&this.sortSingle(),e.sortOrder&&(this._sortOrder=e.sortOrder.currentValue,(!this.lazy||this.initialized)&&this.sortMode==="single"&&this.sortSingle()),e.groupRowsByOrder&&(!this.lazy||this.initialized)&&this.sortMode==="single"&&this.sortSingle(),e.multiSortMeta&&(this._multiSortMeta=e.multiSortMeta.currentValue,this.sortMode==="multiple"&&(this.initialized||!this.lazy&&!this.virtualScroll)&&this.sortMultiple()),e.selection&&(this._selection=e.selection.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange()),this.preventSelectionSetterPropagation=!1),e.selectAll&&(this._selectAll=e.selectAll.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()),this.preventSelectionSetterPropagation=!1)}get processedData(){return this.filteredValue||this.value||[]}_initialColWidths;dataToRender(e){let i=e||this.processedData;if(i&&this.paginator){let r=this.lazy?0:this.first;return i.slice(r,r+this.rows)}return i}updateSelectionKeys(){if(this.dataKey&&this._selection)if(this.selectionKeys={},Array.isArray(this._selection))for(let e of this._selection)this.selectionKeys[String(Re.resolveFieldData(e,this.dataKey))]=1;else this.selectionKeys[String(Re.resolveFieldData(this._selection,this.dataKey))]=1}onPageChange(e){this.first=e.first,this.rows=e.rows,this.onPage.emit({first:this.first,rows:this.rows}),this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.firstChange.emit(this.first),this.rowsChange.emit(this.rows),this.tableService.onValueChange(this.value),this.isStateful()&&this.saveState(),this.anchorRowIndex=null,this.scrollable&&this.resetScrollTop()}sort(e){let i=e.originalEvent;if(this.sortMode==="single"&&(this._sortOrder=this.sortField===e.field?this.sortOrder*-1:this.defaultSortOrder,this._sortField=e.field,this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop()),this.sortSingle()),this.sortMode==="multiple"){let r=i.metaKey||i.ctrlKey,a=this.getSortMeta(e.field);a?r?a.order=a.order*-1:(this._multiSortMeta=[{field:e.field,order:a.order*-1}],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop())):((!r||!this.multiSortMeta)&&(this._multiSortMeta=[],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first))),this._multiSortMeta.push({field:e.field,order:this.defaultSortOrder})),this.sortMultiple()}this.isStateful()&&this.saveState(),this.anchorRowIndex=null}sortSingle(){let e=this.sortField||this.groupRowsBy,i=this.sortField?this.sortOrder:this.groupRowsByOrder;if(this.groupRowsBy&&this.sortField&&this.groupRowsBy!==this.sortField){this._multiSortMeta=[this.getGroupRowsMeta(),{field:this.sortField,order:this.sortOrder}],this.sortMultiple();return}if(e&&i){this.restoringSort&&(this.restoringSort=!1),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,field:e,order:i}):(this.value.sort((a,s)=>{let o=Re.resolveFieldData(a,e),l=Re.resolveFieldData(s,e),c=null;return o==null&&l!=null?c=-1:o!=null&&l==null?c=1:o==null&&l==null?c=0:typeof o=="string"&&typeof l=="string"?c=o.localeCompare(l):c=o<l?-1:o>l?1:0,i*c}),this._value=[...this.value]),this.hasFilter()&&this._filter());let r={field:e,order:i};this.onSort.emit(r),this.tableService.onSort(r)}}sortMultiple(){this.groupRowsBy&&(this._multiSortMeta?this.multiSortMeta[0].field!==this.groupRowsBy&&(this._multiSortMeta=[this.getGroupRowsMeta(),...this._multiSortMeta]):this._multiSortMeta=[this.getGroupRowsMeta()]),this.multiSortMeta&&(this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,multiSortMeta:this.multiSortMeta}):(this.value.sort((e,i)=>this.multisortField(e,i,this.multiSortMeta,0)),this._value=[...this.value]),this.hasFilter()&&this._filter()),this.onSort.emit({multisortmeta:this.multiSortMeta}),this.tableService.onSort(this.multiSortMeta))}multisortField(e,i,r,a){let s=Re.resolveFieldData(e,r[a].field),o=Re.resolveFieldData(i,r[a].field);return Re.compare(s,o,this.filterLocale)===0?r.length-1>a?this.multisortField(e,i,r,a+1):0:this.compareValuesOnSort(s,o,r[a].order)}compareValuesOnSort(e,i,r){return Re.sort(e,i,r,this.filterLocale,this.sortOrder)}getSortMeta(e){if(this.multiSortMeta&&this.multiSortMeta.length){for(let i=0;i<this.multiSortMeta.length;i++)if(this.multiSortMeta[i].field===e)return this.multiSortMeta[i]}return null}isSorted(e){if(this.sortMode==="single")return this.sortField&&this.sortField===e;if(this.sortMode==="multiple"){let i=!1;if(this.multiSortMeta){for(let r=0;r<this.multiSortMeta.length;r++)if(this.multiSortMeta[r].field==e){i=!0;break}}return i}}handleRowClick(e){let i=e.originalEvent.target,r=i.nodeName,a=i.parentElement&&i.parentElement.nodeName;if(!(r=="INPUT"||r=="BUTTON"||r=="A"||a=="INPUT"||a=="BUTTON"||a=="A"||R.hasClass(e.originalEvent.target,"p-clickable"))){if(this.selectionMode){let s=e.rowData,o=e.rowIndex;if(this.preventSelectionSetterPropagation=!0,this.isMultipleSelectionMode()&&e.originalEvent.shiftKey&&this.anchorRowIndex!=null)R.clearSelection(),this.rangeRowIndex!=null&&this.clearSelectionRange(e.originalEvent),this.rangeRowIndex=o,this.selectRange(e.originalEvent,o);else{let l=this.isSelected(s);if(!l&&!this.isRowSelectable(s,o))return;let c=this.rowTouched?!1:this.metaKeySelection,d=this.dataKey?String(Re.resolveFieldData(s,this.dataKey)):null;if(this.anchorRowIndex=o,this.rangeRowIndex=o,c){let h=e.originalEvent.metaKey||e.originalEvent.ctrlKey;if(l&&h){if(this.isSingleSelectionMode())this._selection=null,this.selectionKeys={},this.selectionChange.emit(null);else{let _=this.findIndexInSelection(s);this._selection=this.selection.filter((v,b)=>b!=_),this.selectionChange.emit(this.selection),d&&delete this.selectionKeys[d]}this.onRowUnselect.emit({originalEvent:e.originalEvent,data:s,type:"row"})}else this.isSingleSelectionMode()?(this._selection=s,this.selectionChange.emit(s),d&&(this.selectionKeys={},this.selectionKeys[d]=1)):this.isMultipleSelectionMode()&&(h?this._selection=this.selection||[]:(this._selection=[],this.selectionKeys={}),this._selection=[...this.selection,s],this.selectionChange.emit(this.selection),d&&(this.selectionKeys[d]=1)),this.onRowSelect.emit({originalEvent:e.originalEvent,data:s,type:"row",index:o})}else if(this.selectionMode==="single")l?(this._selection=null,this.selectionKeys={},this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:s,type:"row",index:o})):(this._selection=s,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:s,type:"row",index:o}),d&&(this.selectionKeys={},this.selectionKeys[d]=1));else if(this.selectionMode==="multiple")if(l){let h=this.findIndexInSelection(s);this._selection=this.selection.filter((_,v)=>v!=h),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:s,type:"row",index:o}),d&&delete this.selectionKeys[d]}else this._selection=this.selection?[...this.selection,s]:[s],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:s,type:"row",index:o}),d&&(this.selectionKeys[d]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}this.rowTouched=!1}}handleRowTouchEnd(e){this.rowTouched=!0}handleRowRightClick(e){if(this.contextMenu){let i=e.rowData,r=e.rowIndex;if(this.contextMenuSelectionMode==="separate")this.contextMenuSelection=i,this.contextMenuSelectionChange.emit(i),this.onContextMenuSelect.emit({originalEvent:e.originalEvent,data:i,index:e.rowIndex}),this.contextMenu.show(e.originalEvent),this.tableService.onContextMenu(i);else if(this.contextMenuSelectionMode==="joint"){this.preventSelectionSetterPropagation=!0;let a=this.isSelected(i),s=this.dataKey?String(Re.resolveFieldData(i,this.dataKey)):null;if(!a){if(!this.isRowSelectable(i,r))return;this.isSingleSelectionMode()?(this.selection=i,this.selectionChange.emit(i),s&&(this.selectionKeys={},this.selectionKeys[s]=1)):this.isMultipleSelectionMode()&&(this._selection=this.selection?[...this.selection,i]:[i],this.selectionChange.emit(this.selection),s&&(this.selectionKeys[s]=1))}this.tableService.onSelectionChange(),this.contextMenu.show(e.originalEvent),this.onContextMenuSelect.emit({originalEvent:e,data:i,index:e.rowIndex})}}}selectRange(e,i,r){let a,s;this.anchorRowIndex>i?(a=i,s=this.anchorRowIndex):this.anchorRowIndex<i?(a=this.anchorRowIndex,s=i):(a=i,s=i),this.lazy&&this.paginator&&(a-=this.first,s-=this.first);let o=[];for(let l=a;l<=s;l++){let c=this.filteredValue?this.filteredValue[l]:this.value[l];if(!this.isSelected(c)&&!r){if(!this.isRowSelectable(c,i))continue;o.push(c),this._selection=[...this.selection,c];let d=this.dataKey?String(Re.resolveFieldData(c,this.dataKey)):null;d&&(this.selectionKeys[d]=1)}}this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e,data:o,type:"row"})}clearSelectionRange(e){let i,r,a=this.rangeRowIndex,s=this.anchorRowIndex;a>s?(i=this.anchorRowIndex,r=this.rangeRowIndex):a<s?(i=this.rangeRowIndex,r=this.anchorRowIndex):(i=this.rangeRowIndex,r=this.rangeRowIndex);for(let o=i;o<=r;o++){let l=this.value[o],c=this.findIndexInSelection(l);this._selection=this.selection.filter((h,_)=>_!=c);let d=this.dataKey?String(Re.resolveFieldData(l,this.dataKey)):null;d&&delete this.selectionKeys[d],this.onRowUnselect.emit({originalEvent:e,data:l,type:"row"})}}isSelected(e){return e&&this.selection?this.dataKey?this.selectionKeys[Re.resolveFieldData(e,this.dataKey)]!==void 0:Array.isArray(this.selection)?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1}findIndexInSelection(e){let i=-1;if(this.selection&&this.selection.length){for(let r=0;r<this.selection.length;r++)if(this.equals(e,this.selection[r])){i=r;break}}return i}isRowSelectable(e,i){return!(this.rowSelectable&&!this.rowSelectable({data:e,index:i}))}toggleRowWithRadio(e,i){if(this.preventSelectionSetterPropagation=!0,this.selection!=i){if(!this.isRowSelectable(i,e.rowIndex))return;this._selection=i,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"radiobutton"}),this.dataKey&&(this.selectionKeys={},this.selectionKeys[String(Re.resolveFieldData(i,this.dataKey))]=1)}else this._selection=null,this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"radiobutton"});this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowWithCheckbox(e,i){this.selection=this.selection||[];let r=this.isSelected(i),a=this.dataKey?String(Re.resolveFieldData(i,this.dataKey)):null;if(this.preventSelectionSetterPropagation=!0,r){let s=this.findIndexInSelection(i);this._selection=this.selection.filter((o,l)=>l!=s),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"checkbox"}),a&&delete this.selectionKeys[a]}else{if(!this.isRowSelectable(i,e.rowIndex))return;this._selection=this.selection?[...this.selection,i]:[i],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"checkbox"}),a&&(this.selectionKeys[a]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowsWithCheckbox(e,i){if(this._selectAll!==null)this.selectAllChange.emit({originalEvent:e,checked:i});else{let r=this.selectionPageOnly?this.dataToRender(this.processedData):this.processedData,a=this.selectionPageOnly&&this._selection?this._selection.filter(s=>!r.some(o=>this.equals(s,o))):[];i&&(a=this.frozenValue?[...a,...this.frozenValue,...r]:[...a,...r],a=this.rowSelectable?a.filter((s,o)=>this.rowSelectable({data:s,index:o})):a),this._selection=a,this.preventSelectionSetterPropagation=!0,this.updateSelectionKeys(),this.selectionChange.emit(this._selection),this.tableService.onSelectionChange(),this.onHeaderCheckboxToggle.emit({originalEvent:e,checked:i}),this.isStateful()&&this.saveState()}}equals(e,i){return this.compareSelectionBy==="equals"?e===i:Re.equals(e,i,this.dataKey)}filter(e,i,r){this.filterTimeout&&clearTimeout(this.filterTimeout),this.isFilterBlank(e)?this.filters[i]&&delete this.filters[i]:this.filters[i]={value:e,matchMode:r},this.filterTimeout=setTimeout(()=>{this._filter(),this.filterTimeout=null},this.filterDelay),this.anchorRowIndex=null}filterGlobal(e,i){this.filter(e,"global",i)}isFilterBlank(e){return e!=null?!!(typeof e=="string"&&e.trim().length==0||Array.isArray(e)&&e.length==0):!0}_filter(){if(this.restoringFilter||(this.first=0,this.firstChange.emit(this.first)),this.lazy)this.onLazyLoad.emit(this.createLazyLoadMetadata());else{if(!this.value)return;if(!this.hasFilter())this.filteredValue=null,this.paginator&&(this.totalRecords=this.value?this.value.length:0);else{let e;if(this.filters.global){if(!this.columns&&!this.globalFilterFields)throw new Error("Global filtering requires dynamic columns or globalFilterFields to be defined.");e=this.globalFilterFields||this.columns}this.filteredValue=[];for(let i=0;i<this.value.length;i++){let r=!0,a=!1,s=!1;for(let l in this.filters)if(this.filters.hasOwnProperty(l)&&l!=="global"){s=!0;let c=l,d=this.filters[c];if(Array.isArray(d)){for(let h of d)if(r=this.executeLocalFilter(c,this.value[i],h),h.operator===vl.OR&&r||h.operator===vl.AND&&!r)break}else r=this.executeLocalFilter(c,this.value[i],d);if(!r)break}if(this.filters.global&&!a&&e)for(let l=0;l<e.length;l++){let c=e[l].field||e[l];if(a=this.filterService.filters[this.filters.global.matchMode](Re.resolveFieldData(this.value[i],c),this.filters.global.value,this.filterLocale),a)break}let o;this.filters.global?o=s?s&&r&&a:a:o=s&&r,o&&this.filteredValue.push(this.value[i])}this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0)}}this.onFilter.emit({filters:this.filters,filteredValue:this.filteredValue||this.value}),this.tableService.onValueChange(this.value),this.isStateful()&&!this.restoringFilter&&this.saveState(),this.restoringFilter&&(this.restoringFilter=!1),this.cd.markForCheck(),this.scrollable&&this.resetScrollTop()}executeLocalFilter(e,i,r){let a=r.value,s=r.matchMode||B0.STARTS_WITH,o=Re.resolveFieldData(i,e),l=this.filterService.filters[s];return l(o,a,this.filterLocale)}hasFilter(){let e=!0;for(let i in this.filters)if(this.filters.hasOwnProperty(i)){e=!1;break}return!e}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder,filters:this.filters,globalFilter:this.filters&&this.filters.global?this.filters.global.value:null,multiSortMeta:this.multiSortMeta,forceUpdate:()=>this.cd.detectChanges()}}clear(){this._sortField=null,this._sortOrder=this.defaultSortOrder,this._multiSortMeta=null,this.tableService.onSort(null),this.clearFilterValues(),this.filteredValue=null,this.first=0,this.firstChange.emit(this.first),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.totalRecords=this._value?this._value.length:0}clearFilterValues(){for(let[,e]of Object.entries(this.filters))if(Array.isArray(e))for(let i of e)i.value=null;else e&&(e.value=null)}reset(){this.clear()}getExportHeader(e){return e[this.exportHeader]||e.header||e.field}exportCSV(e){let i,r="",a=this.columns;e&&e.selectionOnly?i=this.selection||[]:e&&e.allValues?i=this.value||[]:(i=this.filteredValue||this.value,this.frozenValue&&(i=i?[...this.frozenValue,...i]:this.frozenValue));let s=a.filter(d=>d.exportable!==!1&&d.field);r+=s.map(d=>'"'+this.getExportHeader(d)+'"').join(this.csvSeparator);let o=i.map(d=>s.map(h=>{let _=Re.resolveFieldData(d,h.field);return _!=null?this.exportFunction?_=this.exportFunction({data:_,field:h.field}):_=String(_).replace(/"/g,'""'):_="",'"'+_+'"'}).join(this.csvSeparator)).join(`
`);o.length&&(r+=`
`+o);let l=new Blob([new Uint8Array([239,187,191]),r],{type:"text/csv;charset=utf-8;"}),c=this.renderer.createElement("a");c.style.display="none",this.renderer.appendChild(this.document.body,c),c.download!==void 0?(c.setAttribute("href",URL.createObjectURL(l)),c.setAttribute("download",this.exportFilename+".csv"),c.click()):(r="data:text/csv;charset=utf-8,"+r,this.window.open(encodeURI(r))),this.renderer.removeChild(this.document.body,c)}onLazyItemLoad(e){this.onLazyLoad.emit(_n(Tt(Tt({},this.createLazyLoadMetadata()),e),{rows:e.last-e.first}))}resetScrollTop(){this.virtualScroll?this.scrollToVirtualIndex(0):this.scrollTo({top:0})}scrollToVirtualIndex(e){this.scroller&&this.scroller.scrollToIndex(e)}scrollTo(e){this.virtualScroll?this.scroller?.scrollTo(e):this.wrapperViewChild&&this.wrapperViewChild.nativeElement&&(this.wrapperViewChild.nativeElement.scrollTo?this.wrapperViewChild.nativeElement.scrollTo(e):(this.wrapperViewChild.nativeElement.scrollLeft=e.left,this.wrapperViewChild.nativeElement.scrollTop=e.top))}updateEditingCell(e,i,r,a){this.editingCell=e,this.editingCellData=i,this.editingCellField=r,this.editingCellRowIndex=a,this.bindDocumentEditListener()}isEditingCellValid(){return this.editingCell&&R.find(this.editingCell,".ng-invalid.ng-dirty").length===0}bindDocumentEditListener(){this.documentEditListener||(this.documentEditListener=this.renderer.listen(this.document,"click",e=>{this.editingCell&&!this.selfClick&&this.isEditingCellValid()&&(R.removeClass(this.editingCell,"p-cell-editing"),this.editingCell=null,this.onEditComplete.emit({field:this.editingCellField,data:this.editingCellData,originalEvent:e,index:this.editingCellRowIndex}),this.editingCellField=null,this.editingCellData=null,this.editingCellRowIndex=null,this.unbindDocumentEditListener(),this.cd.markForCheck(),this.overlaySubscription&&this.overlaySubscription.unsubscribe()),this.selfClick=!1}))}unbindDocumentEditListener(){this.documentEditListener&&(this.documentEditListener(),this.documentEditListener=null)}initRowEdit(e){let i=String(Re.resolveFieldData(e,this.dataKey));this.editingRowKeys[i]=!0}saveRowEdit(e,i){if(R.find(i,".ng-invalid.ng-dirty").length===0){let r=String(Re.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[r]}}cancelRowEdit(e){let i=String(Re.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[i]}toggleRow(e,i){if(!this.dataKey&&!this.groupRowsBy)throw new Error("dataKey or groupRowsBy must be defined to use row expansion");let r=this.groupRowsBy?String(Re.resolveFieldData(e,this.groupRowsBy)):String(Re.resolveFieldData(e,this.dataKey));this.expandedRowKeys[r]!=null?(delete this.expandedRowKeys[r],this.onRowCollapse.emit({originalEvent:i,data:e})):(this.rowExpandMode==="single"&&(this.expandedRowKeys={}),this.expandedRowKeys[r]=!0,this.onRowExpand.emit({originalEvent:i,data:e})),i&&i.preventDefault(),this.isStateful()&&this.saveState()}isRowExpanded(e){return this.groupRowsBy?this.expandedRowKeys[String(Re.resolveFieldData(e,this.groupRowsBy))]===!0:this.expandedRowKeys[String(Re.resolveFieldData(e,this.dataKey))]===!0}isRowEditing(e){return this.editingRowKeys[String(Re.resolveFieldData(e,this.dataKey))]===!0}isSingleSelectionMode(){return this.selectionMode==="single"}isMultipleSelectionMode(){return this.selectionMode==="multiple"}onColumnResizeBegin(e){let i=R.getOffset(this.containerViewChild?.nativeElement).left;this.resizeColumnElement=e.target.closest("th"),this.columnResizing=!0,e.type=="touchstart"?this.lastResizerHelperX=e.changedTouches[0].clientX-i+this.containerViewChild?.nativeElement.scrollLeft:this.lastResizerHelperX=e.pageX-i+this.containerViewChild?.nativeElement.scrollLeft,this.onColumnResize(e),e.preventDefault()}onColumnResize(e){let i=R.getOffset(this.containerViewChild?.nativeElement).left;R.addClass(this.containerViewChild?.nativeElement,"p-unselectable-text"),this.resizeHelperViewChild.nativeElement.style.height=this.containerViewChild?.nativeElement.offsetHeight+"px",this.resizeHelperViewChild.nativeElement.style.top="0px",e.type=="touchmove"?this.resizeHelperViewChild.nativeElement.style.left=e.changedTouches[0].clientX-i+this.containerViewChild?.nativeElement.scrollLeft+"px":this.resizeHelperViewChild.nativeElement.style.left=e.pageX-i+this.containerViewChild?.nativeElement.scrollLeft+"px",this.resizeHelperViewChild.nativeElement.style.display="block"}onColumnResizeEnd(){let e=this.resizeHelperViewChild?.nativeElement.offsetLeft-this.lastResizerHelperX,r=this.resizeColumnElement.offsetWidth+e,a=this.resizeColumnElement.style.minWidth.replace(/[^\d.]/g,""),s=a?parseFloat(a):15;if(r>=s){if(this.columnResizeMode==="fit"){let l=this.resizeColumnElement.nextElementSibling.offsetWidth-e;r>15&&l>15&&this.resizeTableCells(r,l)}else if(this.columnResizeMode==="expand"){this._initialColWidths=this._totalTableWidth();let o=this.tableViewChild?.nativeElement.offsetWidth+e;this.setResizeTableWidth(o+"px"),this.resizeTableCells(r,null)}this.onColResize.emit({element:this.resizeColumnElement,delta:e}),this.isStateful()&&this.saveState()}this.resizeHelperViewChild.nativeElement.style.display="none",R.removeClass(this.containerViewChild?.nativeElement,"p-unselectable-text")}_totalTableWidth(){let e=[],i=R.findSingle(this.containerViewChild.nativeElement,".p-datatable-thead");return R.find(i,"tr > th").forEach(a=>e.push(R.getOuterWidth(a))),e}onColumnDragStart(e,i){this.reorderIconWidth=R.getHiddenElementOuterWidth(this.reorderIndicatorUpViewChild?.nativeElement),this.reorderIconHeight=R.getHiddenElementOuterHeight(this.reorderIndicatorDownViewChild?.nativeElement),this.draggedColumn=i,e.dataTransfer.setData("text","b")}onColumnDragEnter(e,i){if(this.reorderableColumns&&this.draggedColumn&&i){e.preventDefault();let r=R.getOffset(this.containerViewChild?.nativeElement),a=R.getOffset(i);if(this.draggedColumn!=i){let s=R.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),o=R.indexWithinGroup(i,"preorderablecolumn"),l=a.left-r.left,c=r.top-a.top,d=a.left+i.offsetWidth/2;this.reorderIndicatorUpViewChild.nativeElement.style.top=a.top-r.top-(this.reorderIconHeight-1)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.top=a.top-r.top+i.offsetHeight+"px",e.pageX>d?(this.reorderIndicatorUpViewChild.nativeElement.style.left=l+i.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=l+i.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=1):(this.reorderIndicatorUpViewChild.nativeElement.style.left=l-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=l-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=-1),this.reorderIndicatorUpViewChild.nativeElement.style.display="block",this.reorderIndicatorDownViewChild.nativeElement.style.display="block"}else e.dataTransfer.dropEffect="none"}}onColumnDragLeave(e){this.reorderableColumns&&this.draggedColumn&&e.preventDefault()}onColumnDrop(e,i){if(e.preventDefault(),this.draggedColumn){let r=R.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),a=R.indexWithinGroup(i,"preorderablecolumn"),s=r!=a;if(s&&(a-r==1&&this.dropPosition===-1||r-a==1&&this.dropPosition===1)&&(s=!1),s&&a<r&&this.dropPosition===1&&(a=a+1),s&&a>r&&this.dropPosition===-1&&(a=a-1),s&&(Re.reorderArray(this.columns,r,a),this.onColReorder.emit({dragIndex:r,dropIndex:a,columns:this.columns}),this.isStateful()&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.saveState()})})),this.resizableColumns&&this.resizeColumnElement){let o=this.columnResizeMode==="expand"?this._initialColWidths:this._totalTableWidth();Re.reorderArray(o,r+1,a+1),this.updateStyleElement(o,r,null,null)}this.reorderIndicatorUpViewChild.nativeElement.style.display="none",this.reorderIndicatorDownViewChild.nativeElement.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}}resizeTableCells(e,i){let r=R.index(this.resizeColumnElement),a=this.columnResizeMode==="expand"?this._initialColWidths:this._totalTableWidth();this.updateStyleElement(a,r,e,i)}updateStyleElement(e,i,r,a){this.destroyStyleElement(),this.createStyleElement();let s="";e.forEach((o,l)=>{let c=l===i?r:a&&l===i+1?a:o,d=`width: ${c}px !important; max-width: ${c}px !important;`;s+=`
                #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${l+1}),
                #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${l+1}),
                #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${l+1}) {
                    ${d}
                }
            `}),this.renderer.setProperty(this.styleElement,"innerHTML",this.domSanitizer.bypassSecurityTrustStyle(s))}onRowDragStart(e,i){this.rowDragging=!0,this.draggedRowIndex=i,e.dataTransfer.setData("text","b")}onRowDragOver(e,i,r){if(this.rowDragging&&this.draggedRowIndex!==i){let a=R.getOffset(r).top,s=e.pageY,o=a+R.getOuterHeight(r)/2,l=r.previousElementSibling;s<o?(R.removeClass(r,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=i,l?R.addClass(l,"p-datatable-dragpoint-bottom"):R.addClass(r,"p-datatable-dragpoint-top")):(l?R.removeClass(l,"p-datatable-dragpoint-bottom"):R.addClass(r,"p-datatable-dragpoint-top"),this.droppedRowIndex=i+1,R.addClass(r,"p-datatable-dragpoint-bottom"))}}onRowDragLeave(e,i){let r=i.previousElementSibling;r&&R.removeClass(r,"p-datatable-dragpoint-bottom"),R.removeClass(i,"p-datatable-dragpoint-bottom"),R.removeClass(i,"p-datatable-dragpoint-top")}onRowDragEnd(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null}onRowDrop(e,i){if(this.droppedRowIndex!=null){let r=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:this.droppedRowIndex===0?0:this.droppedRowIndex-1;Re.reorderArray(this.value,this.draggedRowIndex,r),this.virtualScroll&&(this._value=[...this._value]),this.onRowReorder.emit({dragIndex:this.draggedRowIndex,dropIndex:r})}this.onRowDragLeave(e,i),this.onRowDragEnd(e)}isEmpty(){let e=this.filteredValue||this.value;return e==null||e.length==0}getBlockableElement(){return this.el.nativeElement.children[0]}getStorage(){if(ni(this.platformId))switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}else throw new Error("Browser storage is not available in the server side.")}isStateful(){return this.stateKey!=null}saveState(){let e=this.getStorage(),i={};this.paginator&&(i.first=this.first,i.rows=this.rows),this.sortField&&(i.sortField=this.sortField,i.sortOrder=this.sortOrder),this.multiSortMeta&&(i.multiSortMeta=this.multiSortMeta),this.hasFilter()&&(i.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(i),this.reorderableColumns&&this.saveColumnOrder(i),this.selection&&(i.selection=this.selection),Object.keys(this.expandedRowKeys).length&&(i.expandedRowKeys=this.expandedRowKeys),e.setItem(this.stateKey,JSON.stringify(i)),this.onStateSave.emit(i)}clearState(){let e=this.getStorage();this.stateKey&&e.removeItem(this.stateKey)}restoreState(){let i=this.getStorage().getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,a=function(s,o){return typeof o=="string"&&r.test(o)?new Date(o):o};if(i){let s=JSON.parse(i,a);this.paginator&&(this.first!==void 0&&(this.first=s.first,this.firstChange.emit(this.first)),this.rows!==void 0&&(this.rows=s.rows,this.rowsChange.emit(this.rows))),s.sortField&&(this.restoringSort=!0,this._sortField=s.sortField,this._sortOrder=s.sortOrder),s.multiSortMeta&&(this.restoringSort=!0,this._multiSortMeta=s.multiSortMeta),s.filters&&(this.restoringFilter=!0,this.filters=s.filters),this.resizableColumns&&(this.columnWidthsState=s.columnWidths,this.tableWidthState=s.tableWidth),s.expandedRowKeys&&(this.expandedRowKeys=s.expandedRowKeys),s.selection&&Promise.resolve(null).then(()=>this.selectionChange.emit(s.selection)),this.stateRestored=!0,this.onStateRestore.emit(s)}}saveColumnWidths(e){let i=[],r=[],a=this.containerViewChild?.nativeElement;a&&(r=R.find(a,".p-datatable-thead > tr > th")),r.forEach(s=>i.push(R.getOuterWidth(s))),e.columnWidths=i.join(","),this.columnResizeMode==="expand"&&(e.tableWidth=R.getOuterWidth(this.tableViewChild?.nativeElement))}setResizeTableWidth(e){this.tableViewChild.nativeElement.style.width=e,this.tableViewChild.nativeElement.style.minWidth=e}restoreColumnWidths(){if(this.columnWidthsState){let e=this.columnWidthsState.split(",");if(this.columnResizeMode==="expand"&&this.tableWidthState&&this.setResizeTableWidth(this.tableWidthState+"px"),Re.isNotEmpty(e)){this.createStyleElement();let i="";e.forEach((r,a)=>{let s=`width: ${r}px !important; max-width: ${r}px !important`;i+=`
                        #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${a+1}),
                        #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${a+1}),
                        #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${a+1}) {
                            ${s}
                        }
                    `}),this.styleElement.textContent=i}}}saveColumnOrder(e){if(this.columns){let i=[];this.columns.map(r=>{i.push(r.field||r.key)}),e.columnOrder=i}}restoreColumnOrder(){let i=this.getStorage().getItem(this.stateKey);if(i){let a=JSON.parse(i).columnOrder;if(a){let s=[];a.map(o=>{let l=this.findColumnByKey(o);l&&s.push(l)}),this.columnOrderStateRestored=!0,this.columns=s}}}findColumnByKey(e){if(this.columns){for(let i of this.columns)if(i.key===e||i.field===e)return i}else return null}createStyleElement(){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",R.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce),this.renderer.appendChild(this.document.head,this.styleElement)}getGroupRowsMeta(){return{field:this.groupRowsBy,order:this.groupRowsByOrder}}createResponsiveStyle(){if(ni(this.platformId)&&!this.responsiveStyleElement){this.responsiveStyleElement=this.renderer.createElement("style"),this.responsiveStyleElement.type="text/css",R.setAttribute(this.responsiveStyleElement,"nonce",this.config?.csp()?.nonce),this.renderer.appendChild(this.document.head,this.responsiveStyleElement);let e=`
    @media screen and (max-width: ${this.breakpoint}) {
        #${this.id}-table > .p-datatable-thead > tr > th,
        #${this.id}-table > .p-datatable-tfoot > tr > td {
            display: none !important;
        }

        #${this.id}-table > .p-datatable-tbody > tr > td {
            display: flex;
            width: 100% !important;
            align-items: center;
            justify-content: space-between;
        }

        #${this.id}-table > .p-datatable-tbody > tr > td:not(:last-child) {
            border: 0 none;
        }

        #${this.id}.p-datatable-gridlines > .p-datatable-wrapper > .p-datatable-table > .p-datatable-tbody > tr > td:last-child {
            border-top: 0;
            border-right: 0;
            border-left: 0;
        }

        #${this.id}-table > .p-datatable-tbody > tr > td > .p-column-title {
            display: block;
        }
    }
    `;this.renderer.setProperty(this.responsiveStyleElement,"innerHTML",this.domSanitizer.bypassSecurityTrustStyle(e))}}destroyResponsiveStyle(){this.responsiveStyleElement&&(this.renderer.removeChild(this.document.head,this.responsiveStyleElement),this.responsiveStyleElement=null)}destroyStyleElement(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.unbindDocumentEditListener(),this.editingCell=null,this.initialized=null,this.destroyStyleElement(),this.destroyResponsiveStyle()}getPaginatorStyleClasses(e){return[this.paginatorStyleClass,e].filter(i=>!!i).join(" ").trim()}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Wi),Z(Qt),Z(Lt),Z(yi),Z(ws),Z(St),Z(ho),Z(ka),Z(Nt),Z(po))};static \u0275cmp=he({type:t,selectors:[["p-table"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(M2,5),Je(O2,5),Je(A2,5),Je(L2,5),Je(R2,5),Je(V2,5),Je(P2,5),Je(B2,5),Je(N2,5)),i&2){let a;Ee(a=Fe())&&(r.containerViewChild=a.first),Ee(a=Fe())&&(r.resizeHelperViewChild=a.first),Ee(a=Fe())&&(r.reorderIndicatorUpViewChild=a.first),Ee(a=Fe())&&(r.reorderIndicatorDownViewChild=a.first),Ee(a=Fe())&&(r.wrapperViewChild=a.first),Ee(a=Fe())&&(r.tableViewChild=a.first),Ee(a=Fe())&&(r.tableHeaderViewChild=a.first),Ee(a=Fe())&&(r.tableFooterViewChild=a.first),Ee(a=Fe())&&(r.scroller=a.first)}},hostAttrs:[1,"p-element"],inputs:{frozenColumns:"frozenColumns",frozenValue:"frozenValue",style:"style",styleClass:"styleClass",tableStyle:"tableStyle",tableStyleClass:"tableStyleClass",paginator:[2,"paginator","paginator",Q],pageLinks:[2,"pageLinks","pageLinks",We],rowsPerPageOptions:"rowsPerPageOptions",alwaysShowPaginator:[2,"alwaysShowPaginator","alwaysShowPaginator",Q],paginatorPosition:"paginatorPosition",paginatorStyleClass:"paginatorStyleClass",paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:[2,"showCurrentPageReport","showCurrentPageReport",Q],showJumpToPageDropdown:[2,"showJumpToPageDropdown","showJumpToPageDropdown",Q],showJumpToPageInput:[2,"showJumpToPageInput","showJumpToPageInput",Q],showFirstLastIcon:[2,"showFirstLastIcon","showFirstLastIcon",Q],showPageLinks:[2,"showPageLinks","showPageLinks",Q],defaultSortOrder:[2,"defaultSortOrder","defaultSortOrder",We],sortMode:"sortMode",resetPageOnSort:[2,"resetPageOnSort","resetPageOnSort",Q],selectionMode:"selectionMode",selectionPageOnly:[2,"selectionPageOnly","selectionPageOnly",Q],contextMenuSelection:"contextMenuSelection",contextMenuSelectionMode:"contextMenuSelectionMode",dataKey:"dataKey",metaKeySelection:[2,"metaKeySelection","metaKeySelection",Q],rowSelectable:"rowSelectable",rowTrackBy:"rowTrackBy",lazy:[2,"lazy","lazy",Q],lazyLoadOnInit:[2,"lazyLoadOnInit","lazyLoadOnInit",Q],compareSelectionBy:"compareSelectionBy",csvSeparator:"csvSeparator",exportFilename:"exportFilename",filters:"filters",globalFilterFields:"globalFilterFields",filterDelay:[2,"filterDelay","filterDelay",We],filterLocale:"filterLocale",expandedRowKeys:"expandedRowKeys",editingRowKeys:"editingRowKeys",rowExpandMode:"rowExpandMode",scrollable:[2,"scrollable","scrollable",Q],scrollDirection:"scrollDirection",rowGroupMode:"rowGroupMode",scrollHeight:"scrollHeight",virtualScroll:[2,"virtualScroll","virtualScroll",Q],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",We],virtualScrollOptions:"virtualScrollOptions",virtualScrollDelay:[2,"virtualScrollDelay","virtualScrollDelay",We],frozenWidth:"frozenWidth",responsive:"responsive",contextMenu:"contextMenu",resizableColumns:[2,"resizableColumns","resizableColumns",Q],columnResizeMode:"columnResizeMode",reorderableColumns:[2,"reorderableColumns","reorderableColumns",Q],loading:[2,"loading","loading",Q],loadingIcon:"loadingIcon",showLoader:[2,"showLoader","showLoader",Q],rowHover:[2,"rowHover","rowHover",Q],customSort:[2,"customSort","customSort",Q],showInitialSortBadge:[2,"showInitialSortBadge","showInitialSortBadge",Q],autoLayout:[2,"autoLayout","autoLayout",Q],exportFunction:"exportFunction",exportHeader:"exportHeader",stateKey:"stateKey",stateStorage:"stateStorage",editMode:"editMode",groupRowsBy:"groupRowsBy",groupRowsByOrder:[2,"groupRowsByOrder","groupRowsByOrder",We],responsiveLayout:"responsiveLayout",breakpoint:"breakpoint",paginatorLocale:"paginatorLocale",value:"value",columns:"columns",first:"first",rows:"rows",totalRecords:"totalRecords",sortField:"sortField",sortOrder:"sortOrder",multiSortMeta:"multiSortMeta",selection:"selection",selectAll:"selectAll",virtualRowHeight:"virtualRowHeight"},outputs:{contextMenuSelectionChange:"contextMenuSelectionChange",selectAllChange:"selectAllChange",selectionChange:"selectionChange",onRowSelect:"onRowSelect",onRowUnselect:"onRowUnselect",onPage:"onPage",onSort:"onSort",onFilter:"onFilter",onLazyLoad:"onLazyLoad",onRowExpand:"onRowExpand",onRowCollapse:"onRowCollapse",onContextMenuSelect:"onContextMenuSelect",onColResize:"onColResize",onColReorder:"onColReorder",onRowReorder:"onRowReorder",onEditInit:"onEditInit",onEditComplete:"onEditComplete",onEditCancel:"onEditCancel",onHeaderCheckboxToggle:"onHeaderCheckboxToggle",sortFunction:"sortFunction",firstChange:"firstChange",rowsChange:"rowsChange",onStateSave:"onStateSave",onStateRestore:"onStateRestore"},features:[ji([ws]),_t,Sn],decls:16,vars:22,consts:[["container",""],["wrapper",""],["buildInTable",""],["scroller",""],["table",""],["thead",""],["tfoot",""],["resizeHelper",""],["reorderIndicatorUp",""],["reorderIndicatorDown",""],[3,"ngStyle","ngClass"],["class","p-datatable-loading-overlay p-component-overlay",4,"ngIf"],["class","p-datatable-header",4,"ngIf"],[3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","styleClass","locale","onPageChange",4,"ngIf"],[1,"p-datatable-wrapper",3,"ngStyle"],[3,"items","columns","style","scrollHeight","itemSize","step","delay","inline","autoSize","lazy","loaderDisabled","showSpacer","showLoader","options","onLazyLoad",4,"ngIf"],[4,"ngIf"],["class","p-datatable-footer",4,"ngIf"],["class","p-column-resizer-helper",3,"ngStyle",4,"ngIf"],["class","p-datatable-reorder-indicator-up",3,"ngStyle",4,"ngIf"],["class","p-datatable-reorder-indicator-down",3,"ngStyle",4,"ngIf"],[1,"p-datatable-loading-overlay","p-component-overlay"],[3,"class",4,"ngIf"],[3,"spin","styleClass",4,"ngIf"],["class","p-datatable-loading-icon",4,"ngIf"],[3,"spin","styleClass"],[1,"p-datatable-loading-icon"],[4,"ngTemplateOutlet"],[1,"p-datatable-header"],[3,"onPageChange","rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","styleClass","locale"],["pTemplate","dropdownicon"],["pTemplate","firstpagelinkicon"],["pTemplate","previouspagelinkicon"],["pTemplate","lastpagelinkicon"],["pTemplate","nextpagelinkicon"],[3,"onLazyLoad","items","columns","scrollHeight","itemSize","step","delay","inline","autoSize","lazy","loaderDisabled","showSpacer","showLoader","options"],["pTemplate","content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","table",3,"ngClass","ngStyle"],["role","rowgroup",1,"p-datatable-thead"],["role","rowgroup","class","p-datatable-tbody p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen",4,"ngIf"],["role","rowgroup",1,"p-datatable-tbody",3,"ngClass","ngStyle","value","pTableBody","pTableBodyTemplate","scrollerOptions"],["role","rowgroup","class","p-datatable-scroller-spacer",3,"ngStyle",4,"ngIf"],["role","rowgroup","class","p-datatable-tfoot",4,"ngIf"],["role","rowgroup",1,"p-datatable-tbody","p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen"],["role","rowgroup",1,"p-datatable-scroller-spacer",3,"ngStyle"],["role","rowgroup",1,"p-datatable-tfoot"],[1,"p-datatable-footer"],[1,"p-column-resizer-helper",3,"ngStyle"],[1,"p-datatable-reorder-indicator-up",3,"ngStyle"],[1,"p-datatable-reorder-indicator-down",3,"ngStyle"]],template:function(i,r){i&1&&(g(0,"div",10,0),w(2,q2,3,2,"div",11)(3,Q2,2,1,"div",12)(4,hv,6,24,"p-paginator",13),g(5,"div",14,1),w(7,gv,3,17,"p-scroller",15)(8,vv,2,7,"ng-container",16)(9,Iv,10,26,"ng-template",null,2,$t),x(),w(11,zv,6,24,"p-paginator",13)(12,jv,2,1,"div",17)(13,Kv,2,2,"div",18)(14,Xv,4,4,"span",19)(15,Jv,4,4,"span",20),x()),i&2&&(ue(r.styleClass),u("ngStyle",r.style)("ngClass",Ci(16,U2,r.rowHover||r.selectionMode,r.scrollable,r.scrollable&&r.scrollHeight==="flex")),V("id",r.id),p(2),u("ngIf",r.loading&&r.showLoader),p(),u("ngIf",r.captionTemplate),p(),u("ngIf",r.paginator&&(r.paginatorPosition==="top"||r.paginatorPosition=="both")),p(),u("ngStyle",Le(20,H2,r.virtualScroll?"":r.scrollHeight)),p(2),u("ngIf",r.virtualScroll),p(),u("ngIf",!r.virtualScroll),p(3),u("ngIf",r.paginator&&(r.paginatorPosition==="bottom"||r.paginatorPosition=="both")),p(),u("ngIf",r.summaryTemplate),p(),u("ngIf",r.resizableColumns),p(),u("ngIf",r.reorderableColumns),p(),u("ngIf",r.reorderableColumns))},dependencies:()=>[at,rt,bt,It,id,Ze,xo,Ml,Ol,Ea,Zb],styles:[`@layer primeng{.p-datatable{position:relative}.p-datatable>.p-datatable-wrapper{overflow:auto}.p-datatable-table{border-spacing:0px;width:100%}.p-datatable .p-sortable-column{cursor:pointer;-webkit-user-select:none;user-select:none}.p-datatable .p-sortable-column .p-column-title,.p-datatable .p-sortable-column .p-sortable-column-icon,.p-datatable .p-sortable-column .p-sortable-column-badge{vertical-align:middle}.p-datatable .p-sortable-column .p-icon-wrapper{display:inline}.p-datatable .p-sortable-column .p-sortable-column-badge{display:inline-flex;align-items:center;justify-content:center}.p-datatable-hoverable-rows .p-selectable-row{cursor:pointer}.p-datatable-scrollable>.p-datatable-wrapper{position:relative}.p-datatable-scrollable-table>.p-datatable-thead{position:sticky;top:0;z-index:2}.p-datatable-scrollable-table>.p-datatable-frozen-tbody{position:sticky;z-index:1}.p-datatable-scrollable-table>.p-datatable-tfoot{position:sticky;bottom:0;z-index:1}.p-datatable-scrollable .p-frozen-column{position:sticky;background:inherit;z-index:1}.p-datatable-scrollable th.p-frozen-column{z-index:1}.p-datatable-flex-scrollable{display:flex;flex-direction:column;height:100%}.p-datatable-flex-scrollable>.p-datatable-wrapper{display:flex;flex-direction:column;flex:1;height:100%}.p-datatable-scrollable-table>.p-datatable-tbody>.p-rowgroup-header{position:sticky;z-index:2}.p-datatable-resizable-table>.p-datatable-thead>tr>th,.p-datatable-resizable-table>.p-datatable-tfoot>tr>td,.p-datatable-resizable-table>.p-datatable-tbody>tr>td{overflow:hidden;white-space:nowrap}.p-datatable-resizable-table>.p-datatable-thead>tr>th.p-resizable-column:not(.p-frozen-column){background-clip:padding-box;position:relative}.p-datatable-resizable-table-fit>.p-datatable-thead>tr>th.p-resizable-column:last-child .p-column-resizer{display:none}.p-datatable .p-column-resizer{display:block;position:absolute!important;top:0;right:0;margin:0;width:.5rem;height:100%;padding:0;cursor:col-resize;border:1px solid transparent}.p-datatable .p-column-resizer-helper{width:1px;position:absolute;z-index:10;display:none}.p-datatable .p-row-editor-init,.p-datatable .p-row-editor-save,.p-datatable .p-row-editor-cancel,.p-datatable .p-row-toggler{display:inline-flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-datatable-reorder-indicator-up,.p-datatable-reorder-indicator-down{position:absolute}.p-datatable-reorderablerow-handle,[pReorderableColumn]{cursor:move}.p-datatable .p-datatable-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:3}.p-column-filter-row{display:flex;align-items:center;width:100%}.p-column-filter-menu{display:inline-flex}.p-column-filter-row p-columnfilterformelement{flex:1 1 auto;width:1%}.p-column-filter-menu-button,.p-column-filter-clear-button{display:inline-flex;justify-content:center;align-items:center;cursor:pointer;text-decoration:none;overflow:hidden;position:relative}.p-column-filter-overlay{position:absolute;top:0;left:0}.p-column-filter-row-items{margin:0;padding:0;list-style:none}.p-column-filter-row-item{cursor:pointer}.p-column-filter-add-button,.p-column-filter-remove-button{justify-content:center}.p-column-filter-add-button .p-button-label,.p-column-filter-remove-button .p-button-label{flex-grow:0}.p-column-filter-buttonbar{display:flex;align-items:center;justify-content:space-between}.p-column-filter-buttonbar .p-button{width:auto}.p-datatable-tbody>tr>td>.p-column-title{display:none}.p-datatable-scroller-spacer{display:flex}.p-datatable .p-scroller .p-scroller-loading{transform:none!important;min-height:0;position:sticky;top:0;left:0}}
`],encapsulation:2})}return t})(),Zb=(()=>{class t{dt;tableService;cd;el;columns;template;get value(){return this._value}set value(e){this._value=e,this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&this.dt.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()}frozen;frozenRows;scrollerOptions;subscription;_value;ngAfterViewInit(){this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&this.dt.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()}constructor(e,i,r,a){this.dt=e,this.tableService=i,this.cd=r,this.el=a,this.subscription=this.dt.tableService.valueSource$.subscribe(()=>{this.dt.virtualScroll&&this.cd.detectChanges()})}shouldRenderRowGroupHeader(e,i,r){let a=Re.resolveFieldData(i,this.dt.groupRowsBy),s=e[r-(1+this.dt._first)];if(s){let o=Re.resolveFieldData(s,this.dt.groupRowsBy);return a!==o}else return!0}shouldRenderRowGroupFooter(e,i,r){let a=Re.resolveFieldData(i,this.dt.groupRowsBy),s=e[r+(1+this.dt._first)];if(s){let o=Re.resolveFieldData(s,this.dt.groupRowsBy);return a!==o}else return!0}shouldRenderRowspan(e,i,r){let a=Re.resolveFieldData(i,this.dt.groupRowsBy),s=e[r-1];if(s){let o=Re.resolveFieldData(s,this.dt.groupRowsBy);return a!==o}else return!0}calculateRowGroupSize(e,i,r){let a=Re.resolveFieldData(i,this.dt.groupRowsBy),s=a,o=0;for(;a===s;){o++;let l=e[++r];if(l)s=Re.resolveFieldData(l,this.dt.groupRowsBy);else break}return o===1?null:o}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}updateFrozenRowStickyPosition(){this.el.nativeElement.style.top=R.getOuterHeight(this.el.nativeElement.previousElementSibling)+"px"}updateFrozenRowGroupHeaderStickyPosition(){if(this.el.nativeElement.previousElementSibling){let e=R.getOuterHeight(this.el.nativeElement.previousElementSibling);this.dt.rowGroupHeaderStyleObject.top=e+"px"}}getScrollerOption(e,i){return this.dt.virtualScroll?(i=i||this.scrollerOptions,i?i[e]:null):null}getRowIndex(e){let i=this.dt.paginator?this.dt.first+e:e,r=this.getScrollerOption("getItemOptions");return r?r(i).index:i}static \u0275fac=function(i){return new(i||t)(Z(fr),Z(ws),Z(St),Z(Lt))};static \u0275cmp=he({type:t,selectors:[["","pTableBody",""]],hostAttrs:[1,"p-element"],inputs:{columns:[0,"pTableBody","columns"],template:[0,"pTableBodyTemplate","template"],value:"value",frozen:[2,"frozen","frozen",Q],frozenRows:[2,"frozenRows","frozenRows",Q],scrollerOptions:"scrollerOptions"},features:[_t],attrs:eb,decls:5,vars:5,consts:[[4,"ngIf"],["ngFor","",3,"ngForOf","ngForTrackBy"],["role","row",4,"ngIf"],["role","row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,r){i&1&&w(0,pb,2,2,"ng-container",0)(1,yb,2,2,"ng-container",0)(2,Ib,2,2,"ng-container",0)(3,Eb,2,5,"ng-container",0)(4,Db,2,5,"ng-container",0),i&2&&(u("ngIf",!r.dt.expandedRowTemplate),p(),u("ngIf",r.dt.expandedRowTemplate&&!(r.frozen&&r.dt.frozenExpandedRowTemplate)),p(),u("ngIf",r.dt.frozenExpandedRowTemplate&&r.frozen),p(),u("ngIf",r.dt.loading),p(),u("ngIf",r.dt.isEmpty()&&!r.dt.loading))},dependencies:[ii,rt,bt],encapsulation:2})}return t})();var To=(()=>{class t{dt;field;pSortableColumnDisabled;sorted;sortOrder;subscription;constructor(e){this.dt=e,this.isEnabled()&&(this.subscription=this.dt.tableService.sortSource$.subscribe(i=>{this.updateSortState()}))}ngOnInit(){this.isEnabled()&&this.updateSortState()}updateSortState(){this.sorted=this.dt.isSorted(this.field),this.sortOrder=this.sorted?this.dt.sortOrder===1?"ascending":"descending":"none"}onClick(e){this.isEnabled()&&!this.isFilterElement(e.target)&&(this.updateSortState(),this.dt.sort({originalEvent:e,field:this.field}),R.clearSelection())}onEnterKey(e){this.onClick(e),e.preventDefault()}isEnabled(){return this.pSortableColumnDisabled!==!0}isFilterElement(e){return this.isFilterElementIconOrButton(e)||this.isFilterElementIconOrButton(e?.parentElement?.parentElement)}isFilterElementIconOrButton(e){return R.hasClass(e,"pi-filter-icon")||R.hasClass(e,"p-column-filter-menu-button")}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||t)(Z(fr))};static \u0275dir=Sr({type:t,selectors:[["","pSortableColumn",""]],hostAttrs:[1,"p-element"],hostVars:7,hostBindings:function(i,r){i&1&&G("click",function(s){return r.onClick(s)})("keydown.space",function(s){return r.onEnterKey(s)})("keydown.enter",function(s){return r.onEnterKey(s)}),i&2&&(V("tabindex",r.isEnabled()?"0":null)("role","columnheader")("aria-sort",r.sortOrder),cn("p-sortable-column",r.isEnabled())("p-highlight",r.sorted))},inputs:{field:[0,"pSortableColumn","field"],pSortableColumnDisabled:[2,"pSortableColumnDisabled","pSortableColumnDisabled",Q]},features:[_t]})}return t})(),So=(()=>{class t{dt;cd;field;subscription;sortOrder;constructor(e,i){this.dt=e,this.cd=i,this.subscription=this.dt.tableService.sortSource$.subscribe(r=>{this.updateSortState()})}ngOnInit(){this.updateSortState()}onClick(e){e.preventDefault()}updateSortState(){if(this.dt.sortMode==="single")this.sortOrder=this.dt.isSorted(this.field)?this.dt.sortOrder:0;else if(this.dt.sortMode==="multiple"){let e=this.dt.getSortMeta(this.field);this.sortOrder=e?e.order:0}this.cd.markForCheck()}getMultiSortMetaIndex(){let e=this.dt._multiSortMeta,i=-1;if(e&&this.dt.sortMode==="multiple"&&this.dt.showInitialSortBadge&&e.length>1)for(let r=0;r<e.length;r++){let a=e[r];if(a.field===this.field||a.field===this.field){i=r;break}}return i}getBadgeValue(){let e=this.getMultiSortMetaIndex();return this.dt.groupRowsBy&&e>-1?e:e+1}isMultiSorted(){return this.dt.sortMode==="multiple"&&this.getMultiSortMetaIndex()>-1}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||t)(Z(fr),Z(St))};static \u0275cmp=he({type:t,selectors:[["p-sortIcon"]],hostAttrs:[1,"p-element"],inputs:{field:"field"},decls:3,vars:3,consts:[[4,"ngIf"],["class","p-sortable-column-icon",4,"ngIf"],["class","p-sortable-column-badge",4,"ngIf"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[1,"p-sortable-column-icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-sortable-column-badge"]],template:function(i,r){i&1&&w(0,Lb,4,3,"ng-container",0)(1,Pb,2,4,"span",1)(2,Bb,2,1,"span",2),i&2&&(u("ngIf",!r.dt.sortIconTemplate),p(),u("ngIf",r.dt.sortIconTemplate),p(),u("ngIf",r.isMultiSorted()))},dependencies:()=>[rt,bt,Al,Rl,Ll],encapsulation:2,changeDetection:0})}return t})();var dd=(()=>{class t{dt;tableService;cd;disabled;value;index;inputId;name;required;ariaLabel;checked;focused;subscription;tableHeaderCheckboxSubscription;isTableHeaderCheckboxSelection=!1;constructor(e,i,r){this.dt=e,this.tableService=i,this.cd=r,this.subscription=this.dt.tableService.selectionSource$.subscribe(()=>{setTimeout(()=>{this.checked=this.isTableHeaderCheckboxSelection?this.dt.isSelected(this.value)&&!this.disabled:this.dt.isSelected(this.value),this.cd.markForCheck()}),this.ariaLabel=this.ariaLabel||this.dt.config.translation.aria?this.checked?this.dt.config.translation.aria.selectRow:this.dt.config.translation.aria.unselectRow:void 0}),this.tableHeaderCheckboxSubscription=this.dt.tableService.isHeaderCheckboxSelection$.subscribe(a=>{this.isTableHeaderCheckboxSelection=a})}ngOnInit(){this.checked=this.dt.isSelected(this.value)}onClick(e){this.disabled||(this.dt.toggleRowWithCheckbox({originalEvent:e,rowIndex:this.index},this.value),this.tableService.onHeaderCheckboxSelection(!1)),R.clearSelection()}onFocus(){this.focused=!0}onBlur(){this.focused=!1}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe(),this.tableHeaderCheckboxSubscription&&this.tableHeaderCheckboxSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||t)(Z(fr),Z(ws),Z(St))};static \u0275cmp=he({type:t,selectors:[["p-tableCheckbox"]],hostAttrs:[1,"p-element"],inputs:{disabled:[2,"disabled","disabled",Q],value:"value",index:[2,"index","index",We],inputId:"inputId",name:"name",required:[2,"required","required",Q],ariaLabel:"ariaLabel"},features:[_t],decls:7,vars:18,consts:[["box",""],[1,"p-checkbox","p-component",3,"click","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"focus","blur","checked","disabled","tabindex"],[3,"ngClass"],[4,"ngIf"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,r){if(i&1){let a=le();g(0,"div",1),G("click",function(o){return S(a),I(r.onClick(o))}),g(1,"div",2)(2,"input",3),G("focus",function(){return S(a),I(r.onFocus())})("blur",function(){return S(a),I(r.onBlur())}),x()(),g(3,"div",4,0),w(5,Hb,2,1,"ng-container",5)(6,jb,2,4,"span",5),x()()}i&2&&(u("ngClass",pt(11,cd,r.focused,r.disabled)),p(2),u("checked",r.checked)("disabled",r.disabled)("tabindex",r.disabled?null:"0"),V("id",r.inputId)("name",r.name)("required",r.required)("aria-label",r.ariaLabel),p(),u("ngClass",Ci(14,Nb,r.checked,r.focused,r.disabled)),p(2),u("ngIf",!r.dt.checkboxIconTemplate),p(),u("ngIf",r.dt.checkboxIconTemplate))},dependencies:()=>[at,rt,bt,Di],encapsulation:2,changeDetection:0})}return t})(),pd=(()=>{class t{dt;tableService;cd;disabled;inputId;name;ariaLabel;checked;focused;selectionChangeSubscription;valueChangeSubscription;tableHeaderCheckboxSubscription;constructor(e,i,r){this.dt=e,this.tableService=i,this.cd=r,this.valueChangeSubscription=this.dt.tableService.valueSource$.subscribe(()=>{this.checked=this.updateCheckedState(),this.ariaLabel=this.ariaLabel||this.dt.config.translation.aria?this.checked?this.dt.config.translation.aria.selectAll:this.dt.config.translation.aria.unselectAll:void 0}),this.selectionChangeSubscription=this.dt.tableService.selectionSource$.subscribe(()=>{this.checked=this.updateCheckedState()})}ngOnInit(){this.checked=this.updateCheckedState()}onClick(e){this.disabled||this.dt.value&&this.dt.value.length>0&&(this.tableService.onHeaderCheckboxSelection(!0),this.dt.toggleRowsWithCheckbox(e,!this.checked)),R.clearSelection()}onFocus(){this.focused=!0}onBlur(){this.focused=!1}isDisabled(){return this.disabled||!this.dt.value||!this.dt.value.length}ngOnDestroy(){this.selectionChangeSubscription&&this.selectionChangeSubscription.unsubscribe(),this.valueChangeSubscription&&this.valueChangeSubscription.unsubscribe()}updateCheckedState(){if(this.cd.markForCheck(),this.dt._selectAll!==null)return this.dt._selectAll;{let e=this.dt.selectionPageOnly?this.dt.dataToRender(this.dt.processedData):this.dt.processedData,i=this.dt.frozenValue?[...this.dt.frozenValue,...e]:e,r=this.dt.rowSelectable?i.filter((a,s)=>this.dt.rowSelectable({data:a,index:s})):i;return Re.isNotEmpty(r)&&Re.isNotEmpty(this.dt.selection)&&r.every(a=>this.dt.selection.some(s=>this.dt.equals(a,s)))}}static \u0275fac=function(i){return new(i||t)(Z(fr),Z(ws),Z(St))};static \u0275cmp=he({type:t,selectors:[["p-tableHeaderCheckbox"]],hostAttrs:[1,"p-element"],inputs:{disabled:[2,"disabled","disabled",Q],inputId:"inputId",name:"name",ariaLabel:"ariaLabel"},features:[_t],decls:8,vars:17,consts:[["cb",""],["box",""],[1,"p-checkbox","p-component",3,"click","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"focus","blur","tabindex","checked","disabled"],[3,"ngClass"],[4,"ngIf"],["class","p-checkbox-icon",4,"ngIf"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[1,"p-checkbox-icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,r){if(i&1){let a=le();g(0,"div",2),G("click",function(o){return S(a),I(r.onClick(o))}),g(1,"div",3)(2,"input",4,0),G("focus",function(){return S(a),I(r.onFocus())})("blur",function(){return S(a),I(r.onBlur())}),x()(),g(4,"div",5,1),w(6,$b,2,1,"ng-container",6)(7,qb,2,4,"span",7),x()()}i&2&&(u("ngClass",pt(10,cd,r.focused,r.isDisabled())),p(2),u("tabindex",r.disabled?null:"0")("checked",r.checked)("disabled",r.isDisabled()),V("id",r.inputId)("name",r.name)("aria-label",r.ariaLabel),p(2),u("ngClass",Ci(13,Kb,r.checked,r.focused,r.isDisabled())),p(2),u("ngIf",!r.dt.headerCheckboxIconTemplate),p(),u("ngIf",r.dt.headerCheckboxIconTemplate))},dependencies:()=>[at,rt,bt,Di],encapsulation:2,changeDetection:0})}return t})();var Lr=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,wo,Gi,xn,gn,Fi,nd,Or,ys,rd,Na,Ml,Ol,Ea,Al,Rl,Ll,Di,Z0,Q0,bs,J0,ct,Na]})}return t})();var Qb=["*"];function Jb(t,n){t&1&&ye(0)}function ey(t,n){if(t&1&&(g(0,"div",4),w(1,Jb,1,0,"ng-container",5),x()),t&2){let e=f();V("data-pc-section","start"),p(),u("ngTemplateOutlet",e.startTemplate)}}function ty(t,n){t&1&&ye(0)}function iy(t,n){if(t&1&&(g(0,"div",6),w(1,ty,1,0,"ng-container",5),x()),t&2){let e=f();V("data-pc-section","center"),p(),u("ngTemplateOutlet",e.centerTemplate)}}function ny(t,n){t&1&&ye(0)}function ry(t,n){if(t&1&&(g(0,"div",7),w(1,ny,1,0,"ng-container",5),x()),t&2){let e=f();V("data-pc-section","end"),p(),u("ngTemplateOutlet",e.endTemplate)}}var za=(()=>{class t{el;style;styleClass;ariaLabelledBy;templates;startTemplate;endTemplate;centerTemplate;constructor(e){this.el=e}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"start":case"left":this.startTemplate=e.template;break;case"end":case"right":this.endTemplate=e.template;break;case"center":this.centerTemplate=e.template;break}})}static \u0275fac=function(i){return new(i||t)(Z(Lt))};static \u0275cmp=he({type:t,selectors:[["p-toolbar"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy"},ngContentSelectors:Qb,decls:5,vars:9,consts:[["role","toolbar",3,"ngClass","ngStyle"],["class","p-toolbar-group-left p-toolbar-group-start",4,"ngIf"],["class","p-toolbar-group-center",4,"ngIf"],["class","p-toolbar-group-right p-toolbar-group-end",4,"ngIf"],[1,"p-toolbar-group-left","p-toolbar-group-start"],[4,"ngTemplateOutlet"],[1,"p-toolbar-group-center"],[1,"p-toolbar-group-right","p-toolbar-group-end"]],template:function(i,r){i&1&&(Ni(),g(0,"div",0),wi(1),w(2,ey,2,2,"div",1)(3,iy,2,2,"div",2)(4,ry,2,2,"div",3),x()),i&2&&(ue(r.styleClass),u("ngClass","p-toolbar p-component")("ngStyle",r.style),V("aria-labelledby",r.ariaLabelledBy)("data-pc-name","toolbar"),p(2),u("ngIf",r.startTemplate),p(),u("ngIf",r.centerTemplate),p(),u("ngIf",r.endTemplate))},dependencies:[at,rt,bt,It],styles:[`@layer primeng{.p-toolbar{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}.p-toolbar-group-start,.p-toolbar-group-center,.p-toolbar-group-end,.p-toolbar-group-left,.p-toolbar-group-right{display:flex;align-items:center}}
`],encapsulation:2,changeDetection:0})}return t})(),Rr=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ct,ct]})}return t})();var fd=(()=>{class t{pFocusTrapDisabled=!1;platformId=oo(Wi);host=oo(Lt);document=oo(oi);firstHiddenFocusableElement;lastHiddenFocusableElement;ngOnInit(){ni(this.platformId)&&!this.pFocusTrapDisabled&&!this.firstHiddenFocusableElement&&!this.lastHiddenFocusableElement&&this.createHiddenFocusableElements()}ngOnChanges(e){e.pFocusTrapDisabled&&ni(this.platformId)&&(e.pFocusTrapDisabled.currentValue?this.removeHiddenFocusableElements():this.createHiddenFocusableElements())}removeHiddenFocusableElements(){this.firstHiddenFocusableElement&&this.firstHiddenFocusableElement.parentNode&&this.firstHiddenFocusableElement.parentNode.removeChild(this.firstHiddenFocusableElement),this.lastHiddenFocusableElement&&this.lastHiddenFocusableElement.parentNode&&this.lastHiddenFocusableElement.parentNode.removeChild(this.lastHiddenFocusableElement)}getComputedSelector(e){return`:not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])${e??""}`}createHiddenFocusableElements(){let e="0",i=r=>R.createElement("span",{class:"p-hidden-accessible p-hidden-focusable",tabindex:e,role:"presentation","data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:r?.bind(this)});this.firstHiddenFocusableElement=i(this.onFirstHiddenElementFocus),this.lastHiddenFocusableElement=i(this.onLastHiddenElementFocus),this.firstHiddenFocusableElement.setAttribute("data-pc-section","firstfocusableelement"),this.lastHiddenFocusableElement.setAttribute("data-pc-section","lastfocusableelement"),this.host.nativeElement.prepend(this.firstHiddenFocusableElement),this.host.nativeElement.append(this.lastHiddenFocusableElement)}onFirstHiddenElementFocus(e){let{currentTarget:i,relatedTarget:r}=e,a=r===this.lastHiddenFocusableElement||!this.host.nativeElement?.contains(r)?R.getFirstFocusableElement(i.parentElement,":not(.p-hidden-focusable)"):this.lastHiddenFocusableElement;R.focus(a)}onLastHiddenElementFocus(e){let{currentTarget:i,relatedTarget:r}=e,a=r===this.firstHiddenFocusableElement||!this.host.nativeElement?.contains(r)?R.getLastFocusableElement(i.parentElement,":not(.p-hidden-focusable)"):this.firstHiddenFocusableElement;R.focus(a)}static \u0275fac=function(i){return new(i||t)};static \u0275dir=Sr({type:t,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],inputs:{pFocusTrapDisabled:[2,"pFocusTrapDisabled","pFocusTrapDisabled",Q]},features:[_t,Sn]})}return t})(),hd=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st]})}return t})();var $l=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Yl=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var sy=["titlebar"],oy=["content"],ly=["footer"],cy=["*",[["p-header"]],[["p-footer"]]],dy=["*","p-header","p-footer"],py=(t,n,e,i,r,a,s,o,l,c)=>({"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":t,"p-dialog-mask-scrollblocker":n,"p-dialog-left":e,"p-dialog-right":i,"p-dialog-top":r,"p-dialog-top-left":a,"p-dialog-top-right":s,"p-dialog-bottom":o,"p-dialog-bottom-left":l,"p-dialog-bottom-right":c}),uy=(t,n,e,i)=>({"p-dialog p-component":!0,"p-dialog-rtl":t,"p-dialog-draggable":n,"p-dialog-resizable":e,"p-dialog-maximized":i}),fy=(t,n)=>({transform:t,transition:n}),hy=t=>({value:"visible",params:t}),my=()=>({"p-dialog-header-icon p-dialog-header-maximize p-link":!0}),_y=()=>({"p-dialog-header-icon p-dialog-header-close p-link":!0}),gy=()=>({"min-width":0});function xy(t,n){t&1&&ye(0)}function vy(t,n){if(t&1&&(_e(0),w(1,xy,1,0,"ng-container",10),ge()),t&2){let e=f(3);p(),u("ngTemplateOutlet",e.headlessTemplate)}}function by(t,n){if(t&1){let e=le();g(0,"div",15),G("mousedown",function(r){S(e);let a=f(4);return I(a.initResize(r))}),x()}}function yy(t,n){if(t&1&&(g(0,"span",21),Y(1),x()),t&2){let e=f(5);u("id",e.ariaLabelledBy),p(),be(e.header)}}function wy(t,n){if(t&1&&(g(0,"span",21),wi(1,1),x()),t&2){let e=f(5);u("id",e.ariaLabelledBy)}}function Cy(t,n){t&1&&ye(0)}function Ty(t,n){if(t&1&&N(0,"span",25),t&2){let e=f(6);u("ngClass",e.maximized?e.minimizeIcon:e.maximizeIcon)}}function Sy(t,n){t&1&&N(0,"WindowMaximizeIcon",27),t&2&&u("styleClass","p-dialog-header-maximize-icon")}function Iy(t,n){t&1&&N(0,"WindowMinimizeIcon",27),t&2&&u("styleClass","p-dialog-header-maximize-icon")}function ky(t,n){if(t&1&&(_e(0),w(1,Sy,1,1,"WindowMaximizeIcon",26)(2,Iy,1,1,"WindowMinimizeIcon",26),ge()),t&2){let e=f(6);p(),u("ngIf",!e.maximized&&!e.maximizeIconTemplate),p(),u("ngIf",e.maximized&&!e.minimizeIconTemplate)}}function Ey(t,n){}function Fy(t,n){t&1&&w(0,Ey,0,0,"ng-template")}function Dy(t,n){if(t&1&&(_e(0),w(1,Fy,1,0,null,10),ge()),t&2){let e=f(6);p(),u("ngTemplateOutlet",e.maximizeIconTemplate)}}function My(t,n){}function Oy(t,n){t&1&&w(0,My,0,0,"ng-template")}function Ay(t,n){if(t&1&&(_e(0),w(1,Oy,1,0,null,10),ge()),t&2){let e=f(6);p(),u("ngTemplateOutlet",e.minimizeIconTemplate)}}function Ly(t,n){if(t&1){let e=le();g(0,"button",22),G("click",function(){S(e);let r=f(5);return I(r.maximize())})("keydown.enter",function(){S(e);let r=f(5);return I(r.maximize())}),w(1,Ty,1,1,"span",23)(2,ky,3,2,"ng-container",24)(3,Dy,2,1,"ng-container",24)(4,Ay,2,1,"ng-container",24),x()}if(t&2){let e=f(5);u("ngClass",Ot(7,my)),V("tabindex",e.maximizable?"0":"-1")("aria-label",e.maximizeLabel),p(),u("ngIf",e.maximizeIcon&&!e.maximizeIconTemplate&&!e.minimizeIconTemplate),p(),u("ngIf",!e.maximizeIcon),p(),u("ngIf",!e.maximized),p(),u("ngIf",e.maximized)}}function Ry(t,n){if(t&1&&N(0,"span",30),t&2){let e=f(7);u("ngClass",e.closeIcon)}}function Vy(t,n){t&1&&N(0,"TimesIcon",27),t&2&&u("styleClass","p-dialog-header-close-icon")}function Py(t,n){if(t&1&&(_e(0),w(1,Ry,1,1,"span",29)(2,Vy,1,1,"TimesIcon",26),ge()),t&2){let e=f(6);p(),u("ngIf",e.closeIcon),p(),u("ngIf",!e.closeIcon)}}function By(t,n){}function Ny(t,n){t&1&&w(0,By,0,0,"ng-template")}function Uy(t,n){if(t&1&&(g(0,"span"),w(1,Ny,1,0,null,10),x()),t&2){let e=f(6);p(),u("ngTemplateOutlet",e.closeIconTemplate)}}function Hy(t,n){if(t&1){let e=le();g(0,"button",28),G("click",function(r){S(e);let a=f(5);return I(a.close(r))})("keydown.enter",function(r){S(e);let a=f(5);return I(a.close(r))}),w(1,Py,3,2,"ng-container",24)(2,Uy,2,1,"span",24),x()}if(t&2){let e=f(5);u("ngClass",Ot(6,_y))("ngStyle",Ot(7,gy)),V("aria-label",e.closeAriaLabel)("tabindex",e.closeTabindex),p(),u("ngIf",!e.closeIconTemplate),p(),u("ngIf",e.closeIconTemplate)}}function zy(t,n){if(t&1){let e=le();g(0,"div",16,3),G("mousedown",function(r){S(e);let a=f(4);return I(a.initDrag(r))}),w(2,yy,2,2,"span",17)(3,wy,2,1,"span",17)(4,Cy,1,0,"ng-container",10),g(5,"div",18),w(6,Ly,5,8,"button",19)(7,Hy,3,8,"button",20),x()()}if(t&2){let e=f(4);p(2),u("ngIf",!e.headerFacet&&!e.headerTemplate),p(),u("ngIf",e.headerFacet),p(),u("ngTemplateOutlet",e.headerTemplate),p(2),u("ngIf",e.maximizable),p(),u("ngIf",e.closable)}}function Wy(t,n){t&1&&ye(0)}function jy(t,n){t&1&&ye(0)}function Ky(t,n){if(t&1&&(g(0,"div",31,4),wi(2,2),w(3,jy,1,0,"ng-container",10),x()),t&2){let e=f(4);p(3),u("ngTemplateOutlet",e.footerTemplate)}}function Gy(t,n){if(t&1&&(w(0,by,1,0,"div",11)(1,zy,8,5,"div",12),g(2,"div",13,2),wi(4),w(5,Wy,1,0,"ng-container",10),x(),w(6,Ky,4,1,"div",14)),t&2){let e=f(3);u("ngIf",e.resizable),p(),u("ngIf",e.showHeader),p(),ue(e.contentStyleClass),u("ngClass","p-dialog-content")("ngStyle",e.contentStyle),p(3),u("ngTemplateOutlet",e.contentTemplate),p(),u("ngIf",e.footerFacet||e.footerTemplate)}}function $y(t,n){if(t&1){let e=le();g(0,"div",8,0),G("@animation.start",function(r){S(e);let a=f(2);return I(a.onAnimationStart(r))})("@animation.done",function(r){S(e);let a=f(2);return I(a.onAnimationEnd(r))}),w(2,vy,2,1,"ng-container",9)(3,Gy,7,8,"ng-template",null,1,$t),x()}if(t&2){let e=vt(4),i=f(2);ue(i.styleClass),u("ngClass",pr(10,uy,i.rtl,i.draggable,i.resizable,i.maximized))("ngStyle",i.style)("pFocusTrapDisabled",i.focusTrap===!1)("@animation",Le(18,hy,pt(15,fy,i.transformOptions,i.transitionOptions))),V("aria-labelledby",i.ariaLabelledBy)("aria-modal",!0),p(2),u("ngIf",i.headlessTemplate)("ngIfElse",e)}}function Yy(t,n){if(t&1&&(g(0,"div",6),w(1,$y,5,20,"div",7),x()),t&2){let e=f();ue(e.maskStyleClass),u("ngStyle",e.maskStyle)("ngClass",_s(5,py,[e.modal,e.modal||e.blockScroll,e.position==="left",e.position==="right",e.position==="top",e.position==="topleft"||e.position==="top-left",e.position==="topright"||e.position==="top-right",e.position==="bottom",e.position==="bottomleft"||e.position==="bottom-left",e.position==="bottomright"||e.position==="bottom-right"])),p(),u("ngIf",e.visible)}}var Xy=En([qt({transform:"{{transform}}",opacity:0}),li("{{transition}}")]),qy=En([li("{{transition}}",qt({transform:"{{transform}}",opacity:0}))]),Vr=(()=>{class t{document;platformId;el;renderer;zone;cd;config;header;draggable=!0;resizable=!0;get positionLeft(){return 0}set positionLeft(e){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(e){console.log("positionTop property is deprecated.")}contentStyle;contentStyleClass;modal=!1;closeOnEscape=!0;dismissableMask=!1;rtl=!1;closable=!0;get responsive(){return!1}set responsive(e){console.log("Responsive property is deprecated.")}appendTo;breakpoints;styleClass;maskStyleClass;maskStyle;showHeader=!0;get breakpoint(){return 649}set breakpoint(e){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}blockScroll=!1;autoZIndex=!0;baseZIndex=0;minX=0;minY=0;focusOnShow=!0;maximizable=!1;keepInViewport=!0;focusTrap=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";closeIcon;closeAriaLabel;closeTabindex="0";minimizeIcon;maximizeIcon;get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(e){e&&(this._style=Tt({},e),this.originalStyle=e)}get position(){return this._position}set position(e){switch(this._position=e,e){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)";break}}onShow=new fe;onHide=new fe;visibleChange=new fe;onResizeInit=new fe;onResizeEnd=new fe;onDragEnd=new fe;onMaximize=new fe;headerFacet;footerFacet;templates;headerViewChild;contentViewChild;footerViewChild;headerTemplate;contentTemplate;footerTemplate;maximizeIconTemplate;closeIconTemplate;minimizeIconTemplate;headlessTemplate;_visible=!1;maskVisible;container;wrapper;dragging;ariaLabelledBy=this.getAriaLabelledBy();documentDragListener;documentDragEndListener;resizing;documentResizeListener;documentResizeEndListener;documentEscapeListener;maskClickListener;lastPageX;lastPageY;preventVisibleChangePropagation;maximized;preMaximizeContentHeight;preMaximizeContainerWidth;preMaximizeContainerHeight;preMaximizePageX;preMaximizePageY;id=ot();_style={};_position="center";originalStyle;transformOptions="scale(0.7)";styleElement;window;get maximizeLabel(){return this.config.getTranslation(Yt.ARIA).maximizeLabel}constructor(e,i,r,a,s,o,l){this.document=e,this.platformId=i,this.el=r,this.renderer=a,this.zone=s,this.cd=o,this.config=l,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"content":this.contentTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"closeicon":this.closeIconTemplate=e.template;break;case"maximizeicon":this.maximizeIconTemplate=e.template;break;case"minimizeicon":this.minimizeIconTemplate=e.template;break;case"headless":this.headlessTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}ngOnInit(){this.breakpoints&&this.createStyle()}getAriaLabelledBy(){return this.header!==null?ot()+"_header":null}parseDurationToMilliseconds(e){let i=/([\d\.]+)(ms|s)\b/g,r=0,a;for(;(a=i.exec(e))!==null;){let s=parseFloat(a[1]),o=a[2];o==="ms"?r+=s:o==="s"&&(r+=s*1e3)}if(r!==0)return r}focus(e=this.contentViewChild?.nativeElement){let i=this.parseDurationToMilliseconds(this.transitionOptions),r=R.getFocusableElement(e,"[autofocus]");if(r){this.zone.runOutsideAngular(()=>{setTimeout(()=>r.focus(),i||5)});return}let a=R.getFocusableElement(e);a?this.zone.runOutsideAngular(()=>{setTimeout(()=>a.focus(),i||5)}):this.footerViewChild&&e!==this.footerViewChild.nativeElement&&this.focus(this.footerViewChild.nativeElement)}close(e){this.visibleChange.emit(!1),e.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)})),this.modal&&R.blockBodyScroll()}disableModality(){if(this.wrapper){this.dismissableMask&&this.unbindMaskClickListener();let e=document.querySelectorAll(".p-dialog-mask-scrollblocker");this.modal&&e&&e.length==1&&R.unblockBodyScroll(),this.cd.destroyed||this.cd.detectChanges()}}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?R.blockBodyScroll():R.unblockBodyScroll()),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(Ut.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(ni(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",R.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce),this.renderer.appendChild(this.document.head,this.styleElement);let e="";for(let i in this.breakpoints)e+=`
                        @media screen and (max-width: ${i}) {
                            .p-dialog[${this.id}]:not(.p-dialog-maximized) {
                                width: ${this.breakpoints[i]} !important;
                            }
                        }
                    `;this.renderer.setProperty(this.styleElement,"innerHTML",e)}}initDrag(e){R.hasClass(e.target,"p-dialog-header-icon")||R.hasClass(e.target,"p-dialog-header-close-icon")||R.hasClass(e.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,this.container.style.margin="0",R.addClass(this.document.body,"p-unselectable-text"))}onDrag(e){if(this.dragging){let i=R.getOuterWidth(this.container),r=R.getOuterHeight(this.container),a=e.pageX-this.lastPageX,s=e.pageY-this.lastPageY,o=this.container.getBoundingClientRect(),l=getComputedStyle(this.container),c=parseFloat(l.marginLeft),d=parseFloat(l.marginTop),h=o.left+a-c,_=o.top+s-d,v=R.getViewport();this.container.style.position="fixed",this.keepInViewport?(h>=this.minX&&h+i<v.width&&(this._style.left=`${h}px`,this.lastPageX=e.pageX,this.container.style.left=`${h}px`),_>=this.minY&&_+r<v.height&&(this._style.top=`${_}px`,this.lastPageY=e.pageY,this.container.style.top=`${_}px`)):(this.lastPageX=e.pageX,this.container.style.left=`${h}px`,this.lastPageY=e.pageY,this.container.style.top=`${_}px`)}}endDrag(e){this.dragging&&(this.dragging=!1,R.removeClass(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(e))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(e){this.resizable&&(this.resizing=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,R.addClass(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(e))}onResize(e){if(this.resizing){let i=e.pageX-this.lastPageX,r=e.pageY-this.lastPageY,a=R.getOuterWidth(this.container),s=R.getOuterHeight(this.container),o=R.getOuterHeight(this.contentViewChild?.nativeElement),l=a+i,c=s+r,d=this.container.style.minWidth,h=this.container.style.minHeight,_=this.container.getBoundingClientRect(),v=R.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(l+=i,c+=r),(!d||l>parseInt(d))&&_.left+l<v.width&&(this._style.width=l+"px",this.container.style.width=this._style.width),(!h||c>parseInt(h))&&_.top+c<v.height&&(this.contentViewChild.nativeElement.style.height=o+c-s+"px",this._style.height&&(this._style.height=c+"px",this.container.style.height=this._style.height)),this.lastPageX=e.pageX,this.lastPageY=e.pageY}}resizeEnd(e){this.resizing&&(this.resizing=!1,R.removeClass(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(e))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.window,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.window,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.window,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.window,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentEscapeListener=this.renderer.listen(e,"keydown",i=>{i.key=="Escape"&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.wrapper):R.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.wrapper=this.container?.parentElement,this.moveOnTop(),this.appendContainer(),this.bindGlobalListeners(),this.container?.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&R.addClass(this.document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&R.addClass(this.wrapper,"p-component-overlay-leave");break}}onAnimationEnd(e){switch(e.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({});break}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(R.removeClass(this.document.body,"p-overflow-hidden"),this.document.body.style.removeProperty("--scrollbar-width"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&R.removeClass(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&Ut.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?Tt({},this.originalStyle):{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Wi),Z(Lt),Z(Qt),Z(yi),Z(St),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-dialog"]],contentQueries:function(i,r,a){if(i&1&&(xt(a,N0,5),xt(a,mo,5),xt(a,Ze,4)),i&2){let s;Ee(s=Fe())&&(r.headerFacet=s.first),Ee(s=Fe())&&(r.footerFacet=s.first),Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(sy,5),Je(oy,5),Je(ly,5)),i&2){let a;Ee(a=Fe())&&(r.headerViewChild=a.first),Ee(a=Fe())&&(r.contentViewChild=a.first),Ee(a=Fe())&&(r.footerViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:[2,"draggable","draggable",Q],resizable:[2,"resizable","resizable",Q],positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:[2,"modal","modal",Q],closeOnEscape:[2,"closeOnEscape","closeOnEscape",Q],dismissableMask:[2,"dismissableMask","dismissableMask",Q],rtl:[2,"rtl","rtl",Q],closable:[2,"closable","closable",Q],responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",maskStyle:"maskStyle",showHeader:[2,"showHeader","showHeader",Q],breakpoint:"breakpoint",blockScroll:[2,"blockScroll","blockScroll",Q],autoZIndex:[2,"autoZIndex","autoZIndex",Q],baseZIndex:[2,"baseZIndex","baseZIndex",We],minX:[2,"minX","minX",We],minY:[2,"minY","minY",We],focusOnShow:[2,"focusOnShow","focusOnShow",Q],maximizable:[2,"maximizable","maximizable",Q],keepInViewport:[2,"keepInViewport","keepInViewport",Q],focusTrap:[2,"focusTrap","focusTrap",Q],transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},features:[_t],ngContentSelectors:dy,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["content",""],["titlebar",""],["footer",""],[3,"class","ngStyle","ngClass",4,"ngIf"],[3,"ngStyle","ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],["class","p-resizable-handle",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["class","p-dialog-title",3,"id",4,"ngIf"],[1,"p-dialog-header-icons"],["role","button","type","button","pRipple","","pButton","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","","pButton","",3,"ngClass","ngStyle","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title",3,"id"],["role","button","type","button","pRipple","","pButton","",3,"click","keydown.enter","ngClass"],["class","p-dialog-header-maximize-icon",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],["type","button","pRipple","","pButton","",3,"click","keydown.enter","ngClass","ngStyle"],["class","p-dialog-header-close-icon",3,"ngClass",4,"ngIf"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"]],template:function(i,r){i&1&&(Ni(cy),w(0,Yy,2,16,"div",5)),i&2&&u("ngIf",r.maskVisible)},dependencies:()=>[at,rt,bt,It,fd,si,At,Rt,$l,Yl],styles:[`@layer primeng{.p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{-webkit-transition:none;transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}}
`],encapsulation:2,data:{animation:[rn("animation",[ri("void => visible",[Fn(Xy)]),ri("visible => void",[Fn(qy)])])]},changeDetection:0})}return t})(),Pr=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,hd,Fi,ai,Rt,$l,Yl,ct]})}return t})();var Wa=(()=>{class t{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new fe;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(e,i,r,a,s){this.el=e,this.ngModel=i,this.control=r,this.cd=a,this.config=s}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(e){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(e){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(e||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||t)(Z(Lt),Z(dn,8),Z(uo,8),Z(St),Z(Nt))};static \u0275dir=Sr({type:t,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(i,r){i&1&&G("input",function(s){return r.onInput(s)}),i&2&&cn("p-filled",r.filled)("p-inputtextarea-resizable",r.autoResize)("p-variant-filled",r.variant==="filled"||r.config.inputStyle()==="filled")},inputs:{autoResize:[2,"autoResize","autoResize",Q],variant:"variant"},outputs:{onResize:"onResize"},features:[_t]})}return t})(),Br=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st]})}return t})();var md=["*"];function Zy(t,n){t&1&&ye(0)}function Qy(t,n){if(t&1&&(_e(0),w(1,Zy,1,0,"ng-container",3),ge()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.contentTemplate)}}function Jy(t,n){if(t&1&&(g(0,"div",1),wi(1),w(2,Qy,2,1,"ng-container",2),x()),t&2){let e=f();u("hidden",!e.selected),V("id",e.tabView.getTabContentId(e.id))("aria-hidden",!e.selected)("aria-labelledby",e.tabView.getTabHeaderActionId(e.id))("data-pc-name","tabpanel"),p(2),u("ngIf",e.contentTemplate&&(e.cache?e.loaded:e.selected))}}var ew=["content"],tw=["navbar"],iw=["prevBtn"],nw=["nextBtn"],rw=["inkbar"],aw=["elementToObserve"],sw=t=>({"p-tabview p-component":!0,"p-tabview-scrollable":t}),ow=(t,n)=>({"p-highlight":t,"p-disabled":n});function lw(t,n){t&1&&N(0,"ChevronLeftIcon"),t&2&&V("aria-hidden",!0)}function cw(t,n){}function dw(t,n){t&1&&w(0,cw,0,0,"ng-template")}function pw(t,n){if(t&1){let e=le();g(0,"button",15,4),G("click",function(){S(e);let r=f();return I(r.navBackward())}),w(2,lw,1,1,"ChevronLeftIcon",16)(3,dw,1,0,null,17),x()}if(t&2){let e=f();V("tabindex",e.tabindex)("aria-label",e.prevButtonAriaLabel),p(2),u("ngIf",!e.previousIconTemplate),p(),u("ngTemplateOutlet",e.previousIconTemplate)}}function uw(t,n){if(t&1&&N(0,"span",26),t&2){let e=f(3).$implicit;u("ngClass",e.leftIcon)}}function fw(t,n){}function hw(t,n){t&1&&w(0,fw,0,0,"ng-template")}function mw(t,n){if(t&1&&(g(0,"span",27),w(1,hw,1,0,null,17),x()),t&2){let e=f(3).$implicit;p(),u("ngTemplateOutlet",e.leftIconTemplate)}}function _w(t,n){if(t&1&&N(0,"span",28),t&2){let e=f(3).$implicit;u("ngClass",e.rightIcon)}}function gw(t,n){}function xw(t,n){t&1&&w(0,gw,0,0,"ng-template")}function vw(t,n){if(t&1&&(g(0,"span",29),w(1,xw,1,0,null,17),x()),t&2){let e=f(3).$implicit;p(),u("ngTemplateOutlet",e.rightIconTemplate)}}function bw(t,n){if(t&1&&(_e(0),w(1,uw,1,1,"span",21)(2,mw,2,1,"span",22),g(3,"span",23),Y(4),x(),w(5,_w,1,1,"span",24)(6,vw,2,1,"span",25),ge()),t&2){let e=f(2).$implicit;p(),u("ngIf",e.leftIcon&&!e.leftIconTemplate),p(),u("ngIf",e.leftIconTemplate),p(2),be(e.header),p(),u("ngIf",e.rightIcon&&!e.rightIconTemplate),p(),u("ngIf",e.rightIconTemplate)}}function yw(t,n){t&1&&ye(0)}function ww(t,n){if(t&1){let e=le();g(0,"TimesIcon",32),G("click",function(r){S(e);let a=f(3).$implicit,s=f();return I(s.close(r,a))}),x()}t&2&&u("styleClass","p-tabview-close")}function Cw(t,n){t&1&&N(0,"span",33)}function Tw(t,n){}function Sw(t,n){t&1&&w(0,Tw,0,0,"ng-template")}function Iw(t,n){if(t&1&&(_e(0),w(1,ww,1,1,"TimesIcon",30)(2,Cw,1,0,"span",31)(3,Sw,1,0,null,17),ge()),t&2){let e=f(2).$implicit;p(),u("ngIf",!e.closeIconTemplate),p(),u("ngIf",e.closeIconTemplate),p(),u("ngTemplateOutlet",e.closeIconTemplate)}}function kw(t,n){if(t&1){let e=le();g(0,"li",19)(1,"a",20),G("click",function(r){S(e);let a=f().$implicit,s=f();return I(s.open(r,a))})("keydown",function(r){S(e);let a=f().$implicit,s=f();return I(s.onTabKeyDown(r,a))}),w(2,bw,7,5,"ng-container",16)(3,yw,1,0,"ng-container",17)(4,Iw,4,3,"ng-container",16),x()()}if(t&2){let e=f(),i=e.$implicit,r=e.index,a=f();ue(i.headerStyleClass),u("ngClass",pt(19,ow,i.selected,i.disabled))("ngStyle",i.headerStyle),V("data-p-disabled",i.disabled),p(),u("pTooltip",i.tooltip)("tooltipPosition",i.tooltipPosition)("positionStyle",i.tooltipPositionStyle)("tooltipStyleClass",i.tooltipStyleClass),V("id",a.getTabHeaderActionId(i.id))("aria-controls",a.getTabContentId(i.id))("aria-selected",i.selected)("tabindex",i.disabled||!i.selected?"-1":a.tabindex)("aria-disabled",i.disabled)("data-pc-index",r)("data-pc-section","headeraction"),p(),u("ngIf",!i.headerTemplate),p(),u("ngTemplateOutlet",i.headerTemplate),p(),u("ngIf",i.closable)}}function Ew(t,n){if(t&1&&w(0,kw,5,22,"li",18),t&2){let e=n.$implicit;u("ngIf",!e.closed)}}function Fw(t,n){t&1&&N(0,"ChevronRightIcon"),t&2&&V("aria-hidden",!0)}function Dw(t,n){}function Mw(t,n){t&1&&w(0,Dw,0,0,"ng-template")}function Ow(t,n){if(t&1){let e=le();g(0,"button",34,5),G("click",function(){S(e);let r=f();return I(r.navForward())}),w(2,Fw,1,1,"ChevronRightIcon",16)(3,Mw,1,0,null,17),x()}if(t&2){let e=f();V("tabindex",e.tabindex)("aria-label",e.nextButtonAriaLabel),p(2),u("ngIf",!e.nextIconTemplate),p(),u("ngTemplateOutlet",e.nextIconTemplate)}}var ql=(()=>{class t{el;viewContainer;cd;closable=!1;get headerStyle(){return this._headerStyle}set headerStyle(e){this._headerStyle=e,this.tabView.cd.markForCheck()}get headerStyleClass(){return this._headerStyleClass}set headerStyleClass(e){this._headerStyleClass=e,this.tabView.cd.markForCheck()}cache=!0;tooltip;tooltipPosition="top";tooltipPositionStyle="absolute";tooltipStyleClass;get selected(){return!!this._selected}set selected(e){this._selected=e,this.loaded||this.cd.detectChanges(),e&&(this.loaded=!0)}get disabled(){return!!this._disabled}set disabled(e){this._disabled=e,this.tabView.cd.markForCheck()}get header(){return this._header}set header(e){this._header=e,Promise.resolve().then(()=>{this.tabView.updateInkBar(),this.tabView.cd.markForCheck()})}get leftIcon(){return this._leftIcon}set leftIcon(e){this._leftIcon=e,this.tabView.cd.markForCheck()}get rightIcon(){return this._rightIcon}set rightIcon(e){this._rightIcon=e,this.tabView.cd.markForCheck()}templates;closed=!1;view=null;_headerStyle;_headerStyleClass;_selected;_disabled;_header;_leftIcon;_rightIcon=void 0;loaded=!1;id;contentTemplate;headerTemplate;leftIconTemplate;rightIconTemplate;closeIconTemplate;tabView;constructor(e,i,r,a){this.el=i,this.viewContainer=r,this.cd=a,this.tabView=e,this.id=ot()}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"content":this.contentTemplate=e.template;break;case"righticon":this.rightIconTemplate=e.template;break;case"lefticon":this.leftIconTemplate=e.template;break;case"closeicon":this.closeIconTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}ngOnDestroy(){this.view=null}static \u0275fac=function(i){return new(i||t)(Z(ln(()=>Zl)),Z(Lt),Z(lo),Z(St))};static \u0275cmp=he({type:t,selectors:[["p-tabPanel"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},hostAttrs:[1,"p-element"],inputs:{closable:[2,"closable","closable",Q],headerStyle:"headerStyle",headerStyleClass:"headerStyleClass",cache:[2,"cache","cache",Q],tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",selected:"selected",disabled:"disabled",header:"header",leftIcon:"leftIcon",rightIcon:"rightIcon"},features:[_t],ngContentSelectors:md,decls:1,vars:1,consts:[["class","p-tabview-panel","role","tabpanel",3,"hidden",4,"ngIf"],["role","tabpanel",1,"p-tabview-panel",3,"hidden"],[4,"ngIf"],[4,"ngTemplateOutlet"]],template:function(i,r){i&1&&(Ni(),w(0,Jy,3,6,"div",0)),i&2&&u("ngIf",!r.closed)},dependencies:[rt,bt],encapsulation:2})}return t})(),Zl=(()=>{class t{platformId;el;cd;renderer;style;styleClass;controlClose;scrollable;get activeIndex(){return this._activeIndex}set activeIndex(e){if(this._activeIndex=e,this.preventActiveIndexPropagation){this.preventActiveIndexPropagation=!1;return}this.tabs&&this.tabs.length&&this._activeIndex!=null&&this.tabs.length>this._activeIndex&&(this.findSelectedTab().selected=!1,this.tabs[this._activeIndex].selected=!0,this.tabChanged=!0,this.updateScrollBar(e))}selectOnFocus=!1;nextButtonAriaLabel;prevButtonAriaLabel;autoHideButtons=!0;tabindex=0;onChange=new fe;onClose=new fe;activeIndexChange=new fe;content;navbar;prevBtn;nextBtn;inkbar;tabPanels;templates;initialized;tabs;_activeIndex;preventActiveIndexPropagation;tabChanged;backwardIsDisabled=!0;forwardIsDisabled=!1;tabChangesSubscription;nextIconTemplate;previousIconTemplate;resizeObserver;container;list;buttonVisible;elementToObserve;constructor(e,i,r,a){this.platformId=e,this.el=i,this.cd=r,this.renderer=a}ngAfterContentInit(){this.initTabs(),this.tabChangesSubscription=this.tabPanels.changes.subscribe(e=>{this.initTabs(),this.refreshButtonState(),this.callResizeObserver()}),this.templates.forEach(e=>{switch(e.getType()){case"previousicon":this.previousIconTemplate=e.template;break;case"nexticon":this.nextIconTemplate=e.template;break}})}callResizeObserver(){ni(this.platformId)&&this.autoHideButtons&&this.bindResizeObserver()}ngAfterViewInit(){this.callResizeObserver()}bindResizeObserver(){this.container=R.findSingle(this.el.nativeElement,'[data-pc-section="navcontent"]'),this.list=R.findSingle(this.el.nativeElement,'[data-pc-section="nav"]'),this.resizeObserver=new ResizeObserver(()=>{this.list.offsetWidth>=this.container.offsetWidth?this.buttonVisible=!0:this.buttonVisible=!1,this.updateButtonState(),this.cd.detectChanges()}),this.resizeObserver.observe(this.container)}unbindResizeObserver(){this.resizeObserver.unobserve(this.elementToObserve.nativeElement),this.resizeObserver=null}ngAfterViewChecked(){ni(this.platformId)&&this.tabChanged&&(this.updateInkBar(),this.tabChanged=!1)}ngOnDestroy(){this.tabChangesSubscription&&this.tabChangesSubscription.unsubscribe(),this.resizeObserver&&this.unbindResizeObserver()}getTabHeaderActionId(e){return`${e}_header_action`}getTabContentId(e){return`${e}_content`}initTabs(){this.tabs=this.tabPanels.toArray(),!this.findSelectedTab()&&this.tabs.length&&(this.activeIndex!=null&&this.tabs.length>this.activeIndex?this.tabs[this.activeIndex].selected=!0:this.tabs[0].selected=!0,this.tabChanged=!0),this.cd.markForCheck()}onTabKeyDown(e,i){switch(e.code){case"ArrowLeft":this.onTabArrowLeftKey(e);break;case"ArrowRight":this.onTabArrowRightKey(e);break;case"Home":this.onTabHomeKey(e);break;case"End":this.onTabEndKey(e);break;case"PageDown":this.onTabEndKey(e);break;case"PageUp":this.onTabHomeKey(e);break;case"Enter":case"Space":this.open(e,i);break;default:break}}onTabArrowLeftKey(e){let i=this.findPrevHeaderAction(e.target.parentElement),r=R.getAttribute(i,"data-pc-index");i?this.changeFocusedTab(e,i,r):this.onTabEndKey(e),e.preventDefault()}onTabArrowRightKey(e){let i=this.findNextHeaderAction(e.target.parentElement),r=R.getAttribute(i,"data-pc-index");i?this.changeFocusedTab(e,i,r):this.onTabHomeKey(e),e.preventDefault()}onTabHomeKey(e){let i=this.findFirstHeaderAction(),r=R.getAttribute(i,"data-pc-index");this.changeFocusedTab(e,i,r),e.preventDefault()}onTabEndKey(e){let i=this.findLastHeaderAction(),r=R.getAttribute(i,"data-pc-index");this.changeFocusedTab(e,i,r),e.preventDefault()}changeFocusedTab(e,i,r){if(i&&(R.focus(i),i.scrollIntoView({block:"nearest"}),this.selectOnFocus)){let a=this.tabs[r];this.open(e,a)}}findNextHeaderAction(e,i=!1){let r=i?e:e.nextElementSibling;return r?R.getAttribute(r,"data-p-disabled")||R.getAttribute(r,"data-pc-section")==="inkbar"?this.findNextHeaderAction(r):R.findSingle(r,'[data-pc-section="headeraction"]'):null}findPrevHeaderAction(e,i=!1){let r=i?e:e.previousElementSibling;return r?R.getAttribute(r,"data-p-disabled")||R.getAttribute(r,"data-pc-section")==="inkbar"?this.findPrevHeaderAction(r):R.findSingle(r,'[data-pc-section="headeraction"]'):null}findFirstHeaderAction(){let e=this.navbar.nativeElement.firstElementChild;return this.findNextHeaderAction(e,!0)}findLastHeaderAction(){let e=this.navbar.nativeElement.lastElementChild,i=R.getAttribute(e,"data-pc-section")==="inkbar"?e.previousElementSibling:e;return this.findPrevHeaderAction(i,!0)}open(e,i){if(i.disabled){e&&e.preventDefault();return}if(!i.selected){let r=this.findSelectedTab();r&&(r.selected=!1),this.tabChanged=!0,i.selected=!0;let a=this.findTabIndex(i);this.preventActiveIndexPropagation=!0,this.activeIndexChange.emit(a),this.onChange.emit({originalEvent:e,index:a}),this.updateScrollBar(a)}e&&e.preventDefault()}close(e,i){this.controlClose?this.onClose.emit({originalEvent:e,index:this.findTabIndex(i),close:()=>{this.closeTab(i)}}):(this.closeTab(i),this.onClose.emit({originalEvent:e,index:this.findTabIndex(i)}))}closeTab(e){if(!e.disabled){if(e.selected){this.tabChanged=!0,e.selected=!1;for(let i=0;i<this.tabs.length;i++){let r=this.tabs[i];if(!r.closed&&!e.disabled&&r!=e){r.selected=!0;break}}}e.closed=!0,setTimeout(()=>{this.updateInkBar()})}}findSelectedTab(){for(let e=0;e<this.tabs.length;e++)if(this.tabs[e].selected)return this.tabs[e];return null}findTabIndex(e){let i=-1;for(let r=0;r<this.tabs.length;r++)if(this.tabs[r]==e){i=r;break}return i}getBlockableElement(){return this.el.nativeElement.children[0]}updateInkBar(){if(ni(this.platformId)&&this.navbar){let e=R.findSingle(this.navbar.nativeElement,"li.p-highlight");if(!e)return;this.inkbar.nativeElement.style.width=R.getWidth(e)+"px",this.inkbar.nativeElement.style.left=R.getOffset(e).left-R.getOffset(this.navbar.nativeElement).left+"px"}}updateScrollBar(e){let i=this.navbar.nativeElement.children[e];i&&i.scrollIntoView({block:"nearest"})}updateButtonState(){let e=this.content.nativeElement,{scrollLeft:i,scrollWidth:r}=e,a=R.getWidth(e);this.backwardIsDisabled=i===0,this.forwardIsDisabled=Math.round(i)===r-a}refreshButtonState(){this.container=R.findSingle(this.el.nativeElement,'[data-pc-section="navcontent"]'),this.list=R.findSingle(this.el.nativeElement,'[data-pc-section="nav"]'),this.list.offsetWidth>=this.container.offsetWidth&&(this.list.offsetWidth>=this.container.offsetWidth?this.buttonVisible=!0:this.buttonVisible=!1,this.updateButtonState(),this.cd.markForCheck())}onScroll(e){this.scrollable&&this.updateButtonState(),e.preventDefault()}getVisibleButtonWidths(){return[this.prevBtn?.nativeElement,this.nextBtn?.nativeElement].reduce((e,i)=>i?e+R.getWidth(i):e,0)}navBackward(){let e=this.content.nativeElement,i=R.getWidth(e)-this.getVisibleButtonWidths(),r=e.scrollLeft-i;e.scrollLeft=r<=0?0:r}navForward(){let e=this.content.nativeElement,i=R.getWidth(e)-this.getVisibleButtonWidths(),r=e.scrollLeft+i,a=e.scrollWidth-i;e.scrollLeft=r>=a?a:r}static \u0275fac=function(i){return new(i||t)(Z(Wi),Z(Lt),Z(St),Z(Qt))};static \u0275cmp=he({type:t,selectors:[["p-tabView"]],contentQueries:function(i,r,a){if(i&1&&(xt(a,ql,4),xt(a,Ze,4)),i&2){let s;Ee(s=Fe())&&(r.tabPanels=s),Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(ew,5),Je(tw,5),Je(iw,5),Je(nw,5),Je(rw,5),Je(aw,5)),i&2){let a;Ee(a=Fe())&&(r.content=a.first),Ee(a=Fe())&&(r.navbar=a.first),Ee(a=Fe())&&(r.prevBtn=a.first),Ee(a=Fe())&&(r.nextBtn=a.first),Ee(a=Fe())&&(r.inkbar=a.first),Ee(a=Fe())&&(r.elementToObserve=a.first)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",controlClose:[2,"controlClose","controlClose",Q],scrollable:[2,"scrollable","scrollable",Q],activeIndex:"activeIndex",selectOnFocus:[2,"selectOnFocus","selectOnFocus",Q],nextButtonAriaLabel:"nextButtonAriaLabel",prevButtonAriaLabel:"prevButtonAriaLabel",autoHideButtons:[2,"autoHideButtons","autoHideButtons",Q],tabindex:[2,"tabindex","tabindex",We]},outputs:{onChange:"onChange",onClose:"onClose",activeIndexChange:"activeIndexChange"},features:[_t],ngContentSelectors:md,decls:14,vars:13,consts:[["elementToObserve",""],["content",""],["navbar",""],["inkbar",""],["prevBtn",""],["nextBtn",""],[3,"ngClass","ngStyle"],[1,"p-tabview-nav-container"],["class","p-tabview-nav-prev p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-nav-content",3,"scroll"],["role","tablist",1,"p-tabview-nav"],["ngFor","",3,"ngForOf"],["role","presentation","aria-hidden","true",1,"p-tabview-ink-bar"],["class","p-tabview-nav-next p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-panels"],["type","button","pRipple","",1,"p-tabview-nav-prev","p-tabview-nav-btn","p-link",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet"],["role","presentation",3,"ngClass","ngStyle","class",4,"ngIf"],["role","presentation",3,"ngClass","ngStyle"],["role","tab","pRipple","",1,"p-tabview-nav-link",3,"click","keydown","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],["class","p-tabview-left-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-left-icon",4,"ngIf"],[1,"p-tabview-title"],["class","p-tabview-right-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-right-icon",4,"ngIf"],[1,"p-tabview-left-icon",3,"ngClass"],[1,"p-tabview-left-icon"],[1,"p-tabview-right-icon",3,"ngClass"],[1,"p-tabview-right-icon"],[3,"styleClass","click",4,"ngIf"],["class","tab.closeIconTemplate",4,"ngIf"],[3,"click","styleClass"],[1,"tab.closeIconTemplate"],["type","button","pRipple","",1,"p-tabview-nav-next","p-tabview-nav-btn","p-link",3,"click"]],template:function(i,r){if(i&1){let a=le();Ni(),g(0,"div",6)(1,"div",7,0),w(3,pw,4,4,"button",8),g(4,"div",9,1),G("scroll",function(o){return S(a),I(r.onScroll(o))}),g(6,"ul",10,2),w(8,Ew,1,1,"ng-template",11),N(9,"li",12,3),x()(),w(11,Ow,4,4,"button",13),x(),g(12,"div",14),wi(13),x()()}i&2&&(ue(r.styleClass),u("ngClass",Le(11,sw,r.scrollable))("ngStyle",r.style),V("data-pc-name","tabview"),p(3),u("ngIf",r.scrollable&&!r.backwardIsDisabled&&r.autoHideButtons),p(),V("data-pc-section","navcontent"),p(2),V("data-pc-section","nav"),p(2),u("ngForOf",r.tabs),p(),V("data-pc-section","inkbar"),p(2),u("ngIf",r.scrollable&&!r.forwardIsDisabled&&r.buttonVisible))},dependencies:()=>[at,ii,rt,bt,It,Ar,At,Rt,Ra,Va],styles:[`@layer primeng{.p-tabview-nav-container{position:relative}.p-tabview-scrollable .p-tabview-nav-container{overflow:hidden}.p-tabview-nav-content{overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scrollbar-width:none;overscroll-behavior:contain auto}.p-tabview-nav{display:inline-flex;min-width:100%;margin:0;padding:0;list-style-type:none;flex:1 1 auto}.p-tabview-nav-link{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;position:relative;text-decoration:none;overflow:hidden}.p-tabview-ink-bar{display:none;z-index:1}.p-tabview-nav-link:focus{z-index:1}.p-tabview-title{line-height:1;white-space:nowrap}.p-tabview-nav-btn{position:absolute;top:0;z-index:2;height:100%;display:flex;align-items:center;justify-content:center}.p-tabview-nav-prev{left:0}.p-tabview-nav-next{right:0}.p-tabview-nav-content::-webkit-scrollbar{display:none}.p-tabview-close{z-index:1}}
`],encapsulation:2,changeDetection:0})}return t})(),_d=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ct,zn,ai,Rt,Ra,Va,ct]})}return t})();var ja=class t{transform(n){if(!n)return"";let e=n.replace(/\D/g,"");return e.length!==9?n:`+996 ${e.substring(0,3)} ${e.substring(3,5)} ${e.substring(5,7)} ${e.substring(7)}`}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=gl({name:"phoneNumberFormat",type:t,pure:!0,standalone:!0})};var Lw=(t,n)=>({"status-false":t,"status-true":n});function Rw(t,n){t&1&&(g(0,"th",6),N(1,"p-tableHeaderCheckbox"),x())}function Vw(t,n){if(t&1&&(g(0,"th",7),Y(1),N(2,"p-sortIcon",8),x()),t&2){let e=n.$implicit;u("pSortableColumn",e.field),p(),He(" ",e.header," "),p(),u("field",e.field)}}function Pw(t,n){t&1&&N(0,"th",9)}function Bw(t,n){if(t&1&&(g(0,"tr"),w(1,Rw,2,0,"th",3)(2,Vw,3,3,"th",4)(3,Pw,1,0,"th",5),x()),t&2){let e=f();p(),u("ngIf",e.isAdmin),p(),u("ngForOf",e.columns),p(),u("ngIf",e.isAdmin)}}function Nw(t,n){if(t&1&&(g(0,"td"),N(1,"p-tableCheckbox",13),x()),t&2){let e=f().$implicit;p(),u("value",e)}}function Uw(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f().$implicit,i=f().$implicit;p(),He(" ",i[e.field]?"\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u043E":"\u041D\u0435 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u043E"," ")}}function Hw(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f().$implicit,i=f().$implicit,r=f();p(),He(" ",r.transformColumn(i[e.field])," ")}}function zw(t,n){if(t&1&&(_e(0),Y(1),ae(2,"phoneNumberFormat"),ge()),t&2){let e=f().$implicit,i=f().$implicit;p(),He(" ",se(2,1,i[e.field])," ")}}function Ww(t,n){if(t&1&&(_e(0),Y(1),ge()),t&2){let e=f().$implicit,i=f().$implicit;p(),He(" ",i[e.field]," ")}}function jw(t,n){if(t&1&&(g(0,"td",14),w(1,Uw,2,1,"ng-container",10)(2,Hw,2,1,"ng-container",10)(3,zw,3,3,"ng-container",10)(4,Ww,2,1,"ng-container",10),x()),t&2){let e=n.$implicit,i=f().$implicit;u("ngClass",pt(5,Lw,e.field==="status"&&!i[e.field],e.field==="status"&&i[e.field])),p(),u("ngIf",e.field==="status"),p(),u("ngIf",e.field==="role"),p(),u("ngIf",e.field==="phoneNumber"),p(),u("ngIf",e.field!=="status"&&e.field!=="role"&&e.field!=="phoneNumber")}}function Kw(t,n){if(t&1){let e=le();g(0,"button",19),G("click",function(){S(e);let r=f(2).$implicit,a=f();return I(a.onViewDetails(r))}),x()}}function Gw(t,n){if(t&1){let e=le();g(0,"td",15),w(1,Kw,1,0,"button",16),g(2,"button",17),G("click",function(){S(e);let r=f().$implicit,a=f();return I(a.onEdit(r))}),x(),g(3,"button",18),G("click",function(){S(e);let r=f().$implicit,a=f();return I(a.onDelete(r))}),x()()}if(t&2){let e=f(2);p(),u("ngIf",e.showViewButton)}}function $w(t,n){if(t&1&&(g(0,"tr"),w(1,Nw,2,1,"td",10)(2,jw,5,8,"td",11)(3,Gw,4,1,"td",12),x()),t&2){let e=f();p(),u("ngIf",e.isAdmin),p(),u("ngForOf",e.columns),p(),u("ngIf",e.isAdmin)}}var Nr=class t{_selectedItems=[];get selectedItems(){return this._selectedItems}selectedItemsChange=new fe;set selectedItems(n){this._selectedItems=n,this.selectedItemsChange.emit(this._selectedItems)}viewDetails=new fe;transformColumn=n=>n;data=[];columns=[];rows=5;isAdmin=!1;showViewButton=!1;edit=new fe;delete=new fe;onViewDetails(n){this.viewDetails.emit(n)}onRowSelect(n){this.selectedItemsChange.emit(this._selectedItems)}onEdit(n){this.edit.emit(n)}onDelete(n){this.delete.emit(n)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=he({type:t,selectors:[["app-shared-table"]],inputs:{selectedItems:"selectedItems",transformColumn:"transformColumn",data:"data",columns:"columns",rows:"rows",isAdmin:"isAdmin",showViewButton:"showViewButton"},outputs:{selectedItemsChange:"selectedItemsChange",viewDetails:"viewDetails",edit:"edit",delete:"delete"},standalone:!0,features:[Ue],decls:3,vars:5,consts:[["selectionMode","multiple","dataKey","id",3,"selectionChange","value","paginator","rows","rowHover","selection"],["pTemplate","header"],["pTemplate","body"],["style","width: 3rem",4,"ngIf"],[3,"pSortableColumn",4,"ngFor","ngForOf"],["style","width: 2rem",4,"ngIf"],[2,"width","3rem"],[3,"pSortableColumn"],[3,"field"],[2,"width","2rem"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["class","button-group",4,"ngIf"],[3,"value"],[3,"ngClass"],[1,"button-group"],["pButton","","pRipple","","icon","pi pi-eye","class","p-button-rounded p-button-info mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-eye",1,"p-button-rounded","p-button-info","mr-2",3,"click"]],template:function(e,i){e&1&&(g(0,"p-table",0),nt("selectionChange",function(a){return it(i.selectedItems,a)||(i.selectedItems=a),a}),G("selectionChange",function(a){return i.onRowSelect(a)}),w(1,Bw,4,3,"ng-template",1)(2,$w,4,3,"ng-template",2),x()),e&2&&(u("value",i.data)("paginator",!0)("rows",i.rows)("rowHover",!0),tt("selection",i.selectedItems))},dependencies:[ii,Lr,fr,Ze,To,So,dd,pd,rt,At,si,at,ja]})};var Ql=(()=>{class t extends Qe{pathId;ngOnInit(){this.pathId="url(#"+ot()+")"}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Xe(t)))(r||t)}})();static \u0275cmp=he({type:t,selectors:[["UploadIcon"]],standalone:!0,features:[qe,Ue],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M6.58942 9.82197C6.70165 9.93405 6.85328 9.99793 7.012 10C7.17071 9.99793 7.32234 9.93405 7.43458 9.82197C7.54681 9.7099 7.61079 9.55849 7.61286 9.4V2.04798L9.79204 4.22402C9.84752 4.28011 9.91365 4.32457 9.98657 4.35479C10.0595 4.38502 10.1377 4.40039 10.2167 4.40002C10.2956 4.40039 10.3738 4.38502 10.4467 4.35479C10.5197 4.32457 10.5858 4.28011 10.6413 4.22402C10.7538 4.11152 10.817 3.95902 10.817 3.80002C10.817 3.64102 10.7538 3.48852 10.6413 3.37602L7.45127 0.190618C7.44656 0.185584 7.44176 0.180622 7.43687 0.175736C7.32419 0.063214 7.17136 0 7.012 0C6.85264 0 6.69981 0.063214 6.58712 0.175736C6.58181 0.181045 6.5766 0.186443 6.5715 0.191927L3.38282 3.37602C3.27669 3.48976 3.2189 3.6402 3.22165 3.79564C3.2244 3.95108 3.28746 4.09939 3.39755 4.20932C3.50764 4.31925 3.65616 4.38222 3.81182 4.38496C3.96749 4.3877 4.11814 4.33001 4.23204 4.22402L6.41113 2.04807V9.4C6.41321 9.55849 6.47718 9.7099 6.58942 9.82197ZM11.9952 14H2.02883C1.751 13.9887 1.47813 13.9228 1.22584 13.8061C0.973545 13.6894 0.746779 13.5241 0.558517 13.3197C0.370254 13.1154 0.22419 12.876 0.128681 12.6152C0.0331723 12.3545 -0.00990605 12.0775 0.0019109 11.8V9.40005C0.0019109 9.24092 0.065216 9.08831 0.1779 8.97579C0.290584 8.86326 0.443416 8.80005 0.602775 8.80005C0.762134 8.80005 0.914966 8.86326 1.02765 8.97579C1.14033 9.08831 1.20364 9.24092 1.20364 9.40005V11.8C1.18295 12.0376 1.25463 12.274 1.40379 12.4602C1.55296 12.6463 1.76817 12.7681 2.00479 12.8H11.9952C12.2318 12.7681 12.447 12.6463 12.5962 12.4602C12.7453 12.274 12.817 12.0376 12.7963 11.8V9.40005C12.7963 9.24092 12.8596 9.08831 12.9723 8.97579C13.085 8.86326 13.2378 8.80005 13.3972 8.80005C13.5565 8.80005 13.7094 8.86326 13.8221 8.97579C13.9347 9.08831 13.998 9.24092 13.998 9.40005V11.8C14.022 12.3563 13.8251 12.8996 13.45 13.3116C13.0749 13.7236 12.552 13.971 11.9952 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&($e(),g(0,"svg",0)(1,"g"),N(2,"path",1),x(),g(3,"defs")(4,"clipPath",2),N(5,"rect",3),x()()()),i&2&&(ue(r.getClassNames()),V("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),p(),V("clip-path",r.pathId),p(3),u("id",r.pathId))},encapsulation:2})}return t})();var Yw=(t,n)=>({showTransitionParams:t,hideTransitionParams:n}),Xw=t=>({value:"visible",params:t});function qw(t,n){if(t&1&&N(0,"span"),t&2){let e=f().$implicit;ue("p-message-icon pi "+e.icon),V("data-pc-section","icon")}}function Zw(t,n){t&1&&N(0,"CheckIcon"),t&2&&V("data-pc-section","icon")}function Qw(t,n){t&1&&N(0,"InfoCircleIcon"),t&2&&V("data-pc-section","icon")}function Jw(t,n){t&1&&N(0,"TimesCircleIcon"),t&2&&V("data-pc-section","icon")}function eC(t,n){t&1&&N(0,"ExclamationTriangleIcon"),t&2&&V("data-pc-section","icon")}function tC(t,n){if(t&1&&(g(0,"span",10),_e(1),w(2,Zw,1,1,"CheckIcon",11)(3,Qw,1,1,"InfoCircleIcon",11)(4,Jw,1,1,"TimesCircleIcon",11)(5,eC,1,1,"ExclamationTriangleIcon",11),ge(),x()),t&2){let e=f().$implicit;p(2),u("ngIf",e.severity==="success"),p(),u("ngIf",e.severity==="info"),p(),u("ngIf",e.severity==="error"),p(),u("ngIf",e.severity==="warn")}}function iC(t,n){if(t&1&&N(0,"span",14),t&2){let e=f(2).$implicit;u("innerHTML",e.summary,ba),V("data-pc-section","summary")}}function nC(t,n){if(t&1&&N(0,"span",15),t&2){let e=f(2).$implicit;u("innerHTML",e.detail,ba),V("data-pc-section","detail")}}function rC(t,n){if(t&1&&(_e(0),w(1,iC,1,2,"span",12)(2,nC,1,2,"span",13),ge()),t&2){let e=f().$implicit;p(),u("ngIf",e.summary),p(),u("ngIf",e.detail)}}function aC(t,n){if(t&1&&(g(0,"span",18),Y(1),x()),t&2){let e=f(2).$implicit;V("data-pc-section","summary"),p(),be(e.summary)}}function sC(t,n){if(t&1&&(g(0,"span",19),Y(1),x()),t&2){let e=f(2).$implicit;V("data-pc-section","detail"),p(),be(e.detail)}}function oC(t,n){if(t&1&&w(0,aC,2,2,"span",16)(1,sC,2,2,"span",17),t&2){let e=f().$implicit;u("ngIf",e.summary),p(),u("ngIf",e.detail)}}function lC(t,n){if(t&1){let e=le();g(0,"button",20),G("click",function(){S(e);let r=f().index,a=f(2);return I(a.removeMessage(r))}),N(1,"TimesIcon",21),x()}if(t&2){let e=f(3);V("aria-label",e.closeAriaLabel)("data-pc-section","closebutton"),p(),u("styleClass","p-message-close-icon"),V("data-pc-section","closeicon")}}function cC(t,n){if(t&1&&(g(0,"div",5)(1,"div",6),w(2,qw,1,3,"span",7)(3,tC,6,4,"span",8)(4,rC,3,2,"ng-container",3)(5,oC,2,2,"ng-template",null,1,$t)(7,lC,2,4,"button",9),x()()),t&2){let e,i=n.$implicit,r=vt(6),a=f(2);ue("p-message p-message-"+i.severity),u("@messageAnimation",Le(13,Xw,pt(10,Yw,a.showTransitionOptions,a.hideTransitionOptions))),p(),V("data-pc-section","wrapper")("id",i.id||null),p(),u("ngIf",i.icon),p(),u("ngIf",!i.icon),p(),u("ngIf",!a.escape)("ngIfElse",r),p(3),u("ngIf",a.closable&&((e=i.closable)!==null&&e!==void 0?e:!0))}}function dC(t,n){if(t&1&&(_e(0),w(1,cC,8,15,"div",4),ge()),t&2){let e=f();p(),u("ngForOf",e.messages)}}function pC(t,n){t&1&&ye(0)}function uC(t,n){if(t&1&&(g(0,"div",22)(1,"div",6),w(2,pC,1,0,"ng-container",23),x()()),t&2){let e=f();u("ngClass","p-message p-message-"+e.severity),p(2),u("ngTemplateOutlet",e.contentTemplate)}}var gd=(()=>{class t{messageService;el;cd;config;set value(e){this.messages=e,this.startMessageLifes(this.messages)}closable=!0;style;styleClass;enableService=!0;key;escape=!0;severity;showTransitionOptions="300ms ease-out";hideTransitionOptions="200ms cubic-bezier(0.86, 0, 0.07, 1)";valueChange=new fe;onClose=new fe;templates;messages;messageSubscription;clearSubscription;timerSubscriptions=[];contentTemplate;constructor(e,i,r,a){this.messageService=e,this.el=i,this.cd=r,this.config=a}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;default:this.contentTemplate=e.template;break}}),this.messageService&&this.enableService&&!this.contentTemplate&&(this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e){Array.isArray(e)||(e=[e]);let i=e.filter(r=>this.key===r.key);this.messages=this.messages?[...this.messages,...i]:[...i],this.startMessageLifes(i),this.cd.markForCheck()}}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()}))}hasMessages(){let e=this.el.nativeElement.parentElement;return e&&e.offsetParent?this.contentTemplate!=null||this.messages&&this.messages.length>0:!1}clear(){this.messages=[],this.valueChange.emit(this.messages)}removeMessage(e){let i=this.messages[e];this.messages=this.messages?.filter((r,a)=>a!==e),i&&this.onClose.emit(i),this.valueChange.emit(this.messages)}get icon(){let e=this.severity||(this.hasMessages()?this.messages[0].severity:null);if(this.hasMessages())switch(e){case"success":return"pi-check";case"info":return"pi-info-circle";case"error":return"pi-times";case"warn":return"pi-exclamation-triangle";default:return"pi-info-circle"}return null}get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.timerSubscriptions?.forEach(e=>e.unsubscribe())}startMessageLifes(e){e?.forEach(i=>i.life&&this.startMessageLife(i))}startMessageLife(e){let i=T0(e.life).subscribe(()=>{this.messages=this.messages?.filter(r=>r!==e),this.timerSubscriptions=this.timerSubscriptions?.filter(r=>r!==i),this.valueChange.emit(this.messages),this.cd.markForCheck()});this.timerSubscriptions.push(i)}static \u0275fac=function(i){return new(i||t)(Z(Ki,8),Z(Lt),Z(St),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-messages"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},hostAttrs:[1,"p-element"],inputs:{value:"value",closable:[2,"closable","closable",Q],style:"style",styleClass:"styleClass",enableService:[2,"enableService","enableService",Q],key:"key",escape:[2,"escape","escape",Q],severity:"severity",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{valueChange:"valueChange",onClose:"onClose"},features:[_t],decls:4,vars:8,consts:[["staticMessage",""],["escapeOut",""],["role","alert",1,"p-messages","p-component",3,"ngStyle"],[4,"ngIf","ngIfElse"],["role","alert",3,"class",4,"ngFor","ngForOf"],["role","alert"],[1,"p-message-wrapper"],[3,"class",4,"ngIf"],["class","p-message-icon",4,"ngIf"],["class","p-message-close p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-message-icon"],[4,"ngIf"],["class","p-message-summary",3,"innerHTML",4,"ngIf"],["class","p-message-detail",3,"innerHTML",4,"ngIf"],[1,"p-message-summary",3,"innerHTML"],[1,"p-message-detail",3,"innerHTML"],["class","p-message-summary",4,"ngIf"],["class","p-message-detail",4,"ngIf"],[1,"p-message-summary"],[1,"p-message-detail"],["type","button","pRipple","",1,"p-message-close","p-link",3,"click"],[3,"styleClass"],["role","alert",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(i,r){if(i&1&&(g(0,"div",2),w(1,dC,2,1,"ng-container",3)(2,uC,3,2,"ng-template",null,0,$t),x()),i&2){let a=vt(3);ue(r.styleClass),u("ngStyle",r.style),V("aria-atomic",!0)("aria-live","assertive")("data-pc-name","message"),p(),u("ngIf",!r.contentTemplate)("ngIfElse",a)}},dependencies:()=>[at,ii,rt,bt,It,At,Di,Oa,Aa,Ma,Rt],styles:[`@layer primeng{.p-message-wrapper{display:flex;align-items:center}.p-message-close{display:flex;align-items:center;justify-content:center;flex:none}.p-message-close.p-link{margin-left:auto;overflow:hidden;position:relative}.p-messages .p-message.ng-animating{overflow:hidden}}
`],encapsulation:2,data:{animation:[rn("messageAnimation",[ri(":enter",[qt({opacity:0,transform:"translateY(-25%)"}),li("{{showTransitionParams}}")]),ri(":leave",[li("{{hideTransitionParams}}",qt({height:0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,opacity:0}))])])]},changeDetection:0})}return t})(),Jl=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ai,Di,Oa,Aa,Ma,Rt,ct,ct]})}return t})();var hC=(t,n)=>({"p-progressbar p-component":!0,"p-progressbar-determinate":t,"p-progressbar-indeterminate":n}),mC=(t,n)=>({width:t,display:"flex",background:n}),_C=t=>({$implicit:t}),gC=t=>({display:t}),xC=t=>({background:t});function vC(t,n){if(t&1&&(g(0,"div",7),Y(1),x()),t&2){let e=f(2);u("ngStyle",Le(4,gC,e.value!=null&&e.value!==0?"flex":"none")),V("data-pc-section","label"),p(),dr(" ",e.value,"",e.unit," ")}}function bC(t,n){t&1&&ye(0)}function yC(t,n){if(t&1&&(g(0,"div",3)(1,"div",4),w(2,vC,2,6,"div",5)(3,bC,1,0,"ng-container",6),x()()),t&2){let e=f();u("ngStyle",pt(5,mC,e.value+"%",e.color)),V("data-pc-section","value"),p(2),u("ngIf",e.showValue&&!e.contentTemplate),p(),u("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",Le(8,_C,e.value))}}function wC(t,n){if(t&1&&(g(0,"div",8),N(1,"div",3),x()),t&2){let e=f();V("data-pc-section","container"),p(),u("ngStyle",Le(3,xC,e.color)),V("data-pc-section","value")}}var xd=(()=>{class t{value;showValue=!0;styleClass;style;unit="%";mode="determinate";color;templates;contentTemplate;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;default:this.contentTemplate=e.template}})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=he({type:t,selectors:[["p-progressBar"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},hostAttrs:[1,"p-element"],inputs:{value:[2,"value","value",We],showValue:[2,"showValue","showValue",Q],styleClass:"styleClass",style:"style",unit:"unit",mode:"mode",color:"color"},features:[_t],decls:3,vars:14,consts:[["role","progressbar",3,"ngStyle","ngClass"],["class","p-progressbar-value p-progressbar-value-animate",3,"ngStyle",4,"ngIf"],["class","p-progressbar-indeterminate-container",4,"ngIf"],[1,"p-progressbar-value","p-progressbar-value-animate",3,"ngStyle"],[1,"p-progressbar-label"],[3,"ngStyle",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngStyle"],[1,"p-progressbar-indeterminate-container"]],template:function(i,r){i&1&&(g(0,"div",0),w(1,yC,4,10,"div",1)(2,wC,2,5,"div",2),x()),i&2&&(ue(r.styleClass),u("ngStyle",r.style)("ngClass",pt(11,hC,r.mode==="determinate",r.mode==="indeterminate")),V("aria-valuemin",0)("aria-valuenow",r.value)("aria-valuemax",100)("data-pc-name","progressbar")("data-pc-section","root"),p(),u("ngIf",r.mode==="determinate"),p(),u("ngIf",r.mode==="indeterminate"))},dependencies:[at,rt,bt,It],styles:[`@layer primeng{.p-progressbar{position:relative;overflow:hidden}.p-progressbar-determinate .p-progressbar-value{height:100%;width:0%;position:absolute;display:none;border:0 none;display:flex;align-items:center;justify-content:center;overflow:hidden}.p-progressbar-determinate .p-progressbar-label{display:inline-flex}.p-progressbar-determinate .p-progressbar-value-animate{transition:width 1s ease-in-out}.p-progressbar-indeterminate .p-progressbar-value:before{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite;animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite}.p-progressbar-indeterminate .p-progressbar-value:after{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;-webkit-animation-delay:1.15s;animation-delay:1.15s}}@-webkit-keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@-webkit-keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}@keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}
`],encapsulation:2,changeDetection:0})}return t})(),ec=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st]})}return t})();var TC=["advancedfileinput"],SC=["basicfileinput"],IC=["content"],kC=(t,n,e,i,r)=>({$implicit:t,uploadedFiles:n,chooseCallback:e,clearCallback:i,uploadCallback:r}),EC=(t,n,e,i,r,a,s,o)=>({$implicit:t,uploadedFiles:n,chooseCallback:e,clearCallback:i,removeUploadedFileCallback:r,removeFileCallback:a,progress:s,messages:o}),FC=(t,n)=>({"p-focus":t,"p-disabled":n}),DC=(t,n,e,i)=>({"p-button p-component p-fileupload-choose":!0,"p-button-icon-only":t,"p-fileupload-choose-selected":n,"p-focus":e,"p-disabled":i});function MC(t,n){if(t&1&&N(0,"span",21),t&2){let e=f(3);ue(e.chooseIcon),u("ngClass","p-button-icon p-button-icon-left"),V("aria-label",!0)("data-pc-section","chooseicon")}}function OC(t,n){t&1&&N(0,"PlusIcon",24),t&2&&(u("styleClass","p-button-icon p-button-icon-left"),V("aria-label",!0)("data-pc-section","chooseicon"))}function AC(t,n){}function LC(t,n){t&1&&w(0,AC,0,0,"ng-template")}function RC(t,n){if(t&1&&(g(0,"span",25),w(1,LC,1,0,null,11),x()),t&2){let e=f(4);V("aria-label",!0)("data-pc-section","chooseicon"),p(),u("ngTemplateOutlet",e.chooseIconTemplate)}}function VC(t,n){if(t&1&&(_e(0),w(1,OC,1,3,"PlusIcon",22)(2,RC,2,3,"span",23),ge()),t&2){let e=f(3);p(),u("ngIf",!e.chooseIconTemplate),p(),u("ngIf",e.chooseIconTemplate)}}function PC(t,n){if(t&1&&N(0,"span",28),t&2){let e=f(4);u("ngClass",e.uploadIcon),V("aria-hidden",!0)}}function BC(t,n){t&1&&N(0,"UploadIcon",24),t&2&&u("styleClass","p-button-icon p-button-icon-left")}function NC(t,n){}function UC(t,n){t&1&&w(0,NC,0,0,"ng-template")}function HC(t,n){if(t&1&&(g(0,"span",25),w(1,UC,1,0,null,11),x()),t&2){let e=f(5);V("aria-hidden",!0),p(),u("ngTemplateOutlet",e.uploadIconTemplate)}}function zC(t,n){if(t&1&&(_e(0),w(1,BC,1,1,"UploadIcon",22)(2,HC,2,2,"span",23),ge()),t&2){let e=f(4);p(),u("ngIf",!e.uploadIconTemplate),p(),u("ngIf",e.uploadIconTemplate)}}function WC(t,n){if(t&1){let e=le();g(0,"p-button",26),G("onClick",function(){S(e);let r=f(3);return I(r.upload())}),w(1,PC,1,2,"span",27)(2,zC,3,2,"ng-container",9),x()}if(t&2){let e=f(3);u("label",e.uploadButtonLabel)("disabled",!e.hasFiles()||e.isFileLimitExceeded())("styleClass",e.uploadStyleClass),p(),u("ngIf",e.uploadIcon),p(),u("ngIf",!e.uploadIcon)}}function jC(t,n){if(t&1&&N(0,"span",28),t&2){let e=f(4);u("ngClass",e.cancelIcon)}}function KC(t,n){t&1&&N(0,"TimesIcon",24),t&2&&(u("styleClass","p-button-icon p-button-icon-left"),V("aria-hidden",!0))}function GC(t,n){}function $C(t,n){t&1&&w(0,GC,0,0,"ng-template")}function YC(t,n){if(t&1&&(g(0,"span",25),w(1,$C,1,0,null,11),x()),t&2){let e=f(5);V("aria-hidden",!0),p(),u("ngTemplateOutlet",e.cancelIconTemplate)}}function XC(t,n){if(t&1&&(_e(0),w(1,KC,1,2,"TimesIcon",22)(2,YC,2,2,"span",23),ge()),t&2){let e=f(4);p(),u("ngIf",!e.cancelIconTemplate),p(),u("ngIf",e.cancelIconTemplate)}}function qC(t,n){if(t&1){let e=le();g(0,"p-button",26),G("onClick",function(){S(e);let r=f(3);return I(r.clear())}),w(1,jC,1,1,"span",27)(2,XC,3,2,"ng-container",9),x()}if(t&2){let e=f(3);u("label",e.cancelButtonLabel)("disabled",!e.hasFiles()||e.uploading)("styleClass",e.cancelStyleClass),p(),u("ngIf",e.cancelIcon),p(),u("ngIf",!e.cancelIcon)}}function ZC(t,n){if(t&1){let e=le();_e(0),g(1,"span",17),G("focus",function(){S(e);let r=f(2);return I(r.onFocus())})("blur",function(){S(e);let r=f(2);return I(r.onBlur())})("click",function(){S(e);let r=f(2);return I(r.choose())})("keydown.enter",function(){S(e);let r=f(2);return I(r.choose())}),g(2,"input",7,0),G("change",function(r){S(e);let a=f(2);return I(a.onFileSelect(r))}),x(),w(4,MC,1,5,"span",18)(5,VC,3,2,"ng-container",9),g(6,"span",19),Y(7),x()(),w(8,WC,3,5,"p-button",20)(9,qC,3,5,"p-button",20),ge()}if(t&2){let e=f(2);p(),ue(e.chooseStyleClass),u("ngClass",pt(16,FC,e.focus,e.disabled||e.isChooseDisabled())),V("data-pc-section","choosebutton"),p(),u("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled()),V("aria-label",e.browseFilesLabel)("title","")("data-pc-section","input"),p(2),u("ngIf",e.chooseIcon),p(),u("ngIf",!e.chooseIcon),p(),V("data-pc-section","choosebuttonlabel"),p(),be(e.chooseButtonLabel),p(),u("ngIf",!e.auto&&e.showUploadButton),p(),u("ngIf",!e.auto&&e.showCancelButton)}}function QC(t,n){t&1&&ye(0)}function JC(t,n){t&1&&ye(0)}function e3(t,n){if(t&1&&N(0,"p-progressBar",29),t&2){let e=f(2);u("value",e.progress)("showValue",!1)}}function t3(t,n){if(t&1){let e=le();g(0,"div")(1,"img",35),G("error",function(r){S(e);let a=f(5);return I(a.imageError(r))}),x()()}if(t&2){let e=f().$implicit,i=f(4);p(),u("src",e.objectURL,ya)("width",i.previewWidth)}}function i3(t,n){t&1&&N(0,"TimesIcon")}function n3(t,n){}function r3(t,n){t&1&&w(0,n3,0,0,"ng-template")}function a3(t,n){if(t&1){let e=le();g(0,"div",32),w(1,t3,2,2,"div",9),g(2,"div",33),Y(3),x(),g(4,"div"),Y(5),x(),g(6,"div")(7,"button",34),G("click",function(r){let a=S(e).index,s=f(4);return I(s.remove(r,a))}),w(8,i3,1,0,"TimesIcon",9)(9,r3,1,0,null,11),x()()()}if(t&2){let e=n.$implicit,i=f(4);p(),u("ngIf",i.isImage(e)),p(2),be(e.name),p(2),be(i.formatSize(e.size)),p(2),ue(i.removeStyleClass),u("disabled",i.uploading),p(),u("ngIf",!i.cancelIconTemplate),p(),u("ngTemplateOutlet",i.cancelIconTemplate)}}function s3(t,n){if(t&1&&(g(0,"div"),w(1,a3,10,8,"div",31),x()),t&2){let e=f(3);p(),u("ngForOf",e.files)}}function o3(t,n){}function l3(t,n){if(t&1&&(g(0,"div"),w(1,o3,0,0,"ng-template",36),x()),t&2){let e=f(3);p(),u("ngForOf",e.files)("ngForTemplate",e.fileTemplate)}}function c3(t,n){if(t&1&&(g(0,"div",30),w(1,s3,2,1,"div",9)(2,l3,2,2,"div",9),x()),t&2){let e=f(2);p(),u("ngIf",!e.fileTemplate),p(),u("ngIf",e.fileTemplate)}}function d3(t,n){t&1&&ye(0)}function p3(t,n){t&1&&ye(0)}function u3(t,n){if(t&1&&(g(0,"div",37),w(1,p3,1,0,"ng-container",11),x()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.emptyTemplate)}}function f3(t,n){if(t&1){let e=le();g(0,"div",6)(1,"input",7,0),G("change",function(r){S(e);let a=f();return I(a.onFileSelect(r))}),x(),g(3,"div",8),w(4,ZC,10,19,"ng-container",9)(5,QC,1,0,"ng-container",10)(6,JC,1,0,"ng-container",11),x(),g(7,"div",12,1),G("dragenter",function(r){S(e);let a=f();return I(a.onDragEnter(r))})("dragleave",function(r){S(e);let a=f();return I(a.onDragLeave(r))})("drop",function(r){S(e);let a=f();return I(a.onDrop(r))}),w(9,e3,1,2,"p-progressBar",13),N(10,"p-messages",14),w(11,c3,3,2,"div",15)(12,d3,1,0,"ng-container",10)(13,u3,2,1,"div",16),x()()}if(t&2){let e=f();ue(e.styleClass),u("ngClass","p-fileupload p-fileupload-advanced p-component")("ngStyle",e.style),V("data-pc-name","fileupload")("data-pc-section","root"),p(),Jr("display","none"),u("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled()),V("aria-label",e.browseFilesLabel)("title","")("data-pc-section","input"),p(2),V("data-pc-section","buttonbar"),p(),u("ngIf",!e.headerTemplate),p(),u("ngTemplateOutlet",e.headerTemplate)("ngTemplateOutletContext",Ir(27,kC,e.files,e.uploadedFiles,e.choose.bind(e),e.clear.bind(e),e.upload.bind(e))),p(),u("ngTemplateOutlet",e.toolbarTemplate),p(),V("data-pc-section","content"),p(2),u("ngIf",e.hasFiles()),p(),u("value",e.msgs)("enableService",!1),p(),u("ngIf",e.hasFiles()),p(),u("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",E0(33,EC,e.files,e.uploadedFiles,e.choose.bind(e),e.clear.bind(e),e.removeUploadedFile.bind(e),e.remove.bind(e),e.progress,e.msgs)),p(),u("ngIf",e.emptyTemplate&&!e.hasFiles()&&!e.hasUploadedFiles())}}function h3(t,n){if(t&1&&N(0,"span",28),t&2){let e=f(3);u("ngClass",e.uploadIcon)}}function m3(t,n){t&1&&N(0,"UploadIcon",24),t&2&&u("styleClass","p-button-icon p-button-icon-left")}function _3(t,n){}function g3(t,n){t&1&&w(0,_3,0,0,"ng-template")}function x3(t,n){if(t&1&&(g(0,"span",25),w(1,g3,1,0,null,11),x()),t&2){let e=f(4);p(),u("ngTemplateOutlet",e.uploadIconTemplate)}}function v3(t,n){if(t&1&&(_e(0),w(1,m3,1,1,"UploadIcon",22)(2,x3,2,1,"span",23),ge()),t&2){let e=f(3);p(),u("ngIf",!e.uploadIconTemplate),p(),u("ngIf",e.uploadIconTemplate)}}function b3(t,n){if(t&1&&(_e(0),w(1,h3,1,1,"span",27)(2,v3,3,2,"ng-container",9),ge()),t&2){let e=f(2);p(),u("ngIf",e.uploadIcon),p(),u("ngIf",!e.uploadIcon)}}function y3(t,n){if(t&1&&N(0,"span",44),t&2){let e=f(3);u("ngClass",e.chooseIcon)}}function w3(t,n){t&1&&N(0,"PlusIcon",24),t&2&&(u("styleClass","p-button-icon p-button-icon-left pi"),V("aria-hidden",!0)("data-pc-section","uploadicon"))}function C3(t,n){}function T3(t,n){t&1&&w(0,C3,0,0,"ng-template")}function S3(t,n){if(t&1&&(g(0,"span",46),w(1,T3,1,0,null,11),x()),t&2){let e=f(4);V("aria-hidden",!0)("data-pc-section","uploadicon"),p(),u("ngTemplateOutlet",e.chooseIconTemplate)}}function I3(t,n){if(t&1&&(_e(0),w(1,w3,1,3,"PlusIcon",22)(2,S3,2,3,"span",45),ge()),t&2){let e=f(3);p(),u("ngIf",!e.chooseIconTemplate),p(),u("ngIf",e.chooseIconTemplate)}}function k3(t,n){if(t&1&&w(0,y3,1,1,"span",43)(1,I3,3,2,"ng-container",9),t&2){let e=f(2);u("ngIf",e.chooseIcon),p(),u("ngIf",!e.chooseIcon)}}function E3(t,n){if(t&1&&(g(0,"span",19),Y(1),x()),t&2){let e=f(2);V("data-pc-section","label"),p(),be(e.basicButtonLabel)}}function F3(t,n){if(t&1){let e=le();g(0,"input",47,3),G("change",function(r){S(e);let a=f(2);return I(a.onFileSelect(r))})("focus",function(){S(e);let r=f(2);return I(r.onFocus())})("blur",function(){S(e);let r=f(2);return I(r.onBlur())}),x()}if(t&2){let e=f(2);u("accept",e.accept)("multiple",e.multiple)("disabled",e.disabled),V("aria-label",e.browseFilesLabel)("data-pc-section","input")}}function D3(t,n){if(t&1){let e=le();g(0,"div",38),N(1,"p-messages",14),g(2,"span",39),G("click",function(){S(e);let r=f();return I(r.onBasicUploaderClick())})("keydown",function(r){S(e);let a=f();return I(a.onBasicKeydown(r))}),w(3,b3,3,2,"ng-container",40)(4,k3,2,2,"ng-template",null,2,$t)(6,E3,2,2,"span",41)(7,F3,2,5,"input",42),x()()}if(t&2){let e=vt(5),i=f();V("data-pc-name","fileupload"),p(),u("value",i.msgs)("enableService",!1),p(),ue(i.styleClass),u("ngClass",pr(12,DC,!i.basicButtonLabel,i.hasFiles(),i.focus,i.disabled))("ngStyle",i.style),V("data-pc-section","choosebutton"),p(),u("ngIf",i.hasFiles()&&!i.auto)("ngIfElse",e),p(3),u("ngIf",i.basicButtonLabel),p(),u("ngIf",!i.hasFiles())}}var vd=(()=>{class t{document;platformId;locale;renderer;el;sanitizer;zone;http;cd;config;name;url;method="post";multiple;accept;disabled;auto;withCredentials;maxFileSize;invalidFileSizeMessageSummary="{0}: Invalid file size, ";invalidFileSizeMessageDetail="maximum upload size is {0}.";invalidFileTypeMessageSummary="{0}: Invalid file type, ";invalidFileTypeMessageDetail="allowed file types: {0}.";invalidFileLimitMessageDetail="limit is {0} at most.";invalidFileLimitMessageSummary="Maximum number of files exceeded, ";style;styleClass;previewWidth=50;chooseLabel;uploadLabel;cancelLabel;chooseIcon;uploadIcon;cancelIcon;showUploadButton=!0;showCancelButton=!0;mode="advanced";headers;customUpload;fileLimit;uploadStyleClass;cancelStyleClass;removeStyleClass;chooseStyleClass;onBeforeUpload=new fe;onSend=new fe;onUpload=new fe;onError=new fe;onClear=new fe;onRemove=new fe;onSelect=new fe;onProgress=new fe;uploadHandler=new fe;onImageError=new fe;onRemoveUploadedFile=new fe;templates;advancedFileInput;basicFileInput;content;set files(e){this._files=[];for(let i=0;i<e.length;i++){let r=e[i];this.validate(r)&&(this.isImage(r)&&(r.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(e[i]))),this._files.push(e[i]))}}get files(){return this._files}get basicButtonLabel(){return this.auto||!this.hasFiles()?this.chooseLabel:this.uploadLabel??this.files[0].name}_files=[];progress=0;dragHighlight;msgs;fileTemplate;headerTemplate;contentTemplate;toolbarTemplate;chooseIconTemplate;uploadIconTemplate;cancelIconTemplate;emptyTemplate;uploadedFileCount=0;focus;uploading;duplicateIEEvent;translationSubscription;dragOverListener;uploadedFiles=[];fileUploadSubcription;formatter;constructor(e,i,r,a,s,o,l,c,d,h){this.document=e,this.platformId=i,this.locale=r,this.renderer=a,this.el=s,this.sanitizer=o,this.zone=l,this.http=c,this.cd=d,this.config=h,this.formatter=new Intl.NumberFormat(this.locale,{maximumFractionDigits:3})}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"file":this.fileTemplate=e.template;break;case"content":this.contentTemplate=e.template;break;case"toolbar":this.toolbarTemplate=e.template;break;case"chooseicon":this.chooseIconTemplate=e.template;break;case"uploadicon":this.uploadIconTemplate=e.template;break;case"cancelicon":this.cancelIconTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;default:this.fileTemplate=e.template;break}})}ngOnInit(){this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()})}ngAfterViewInit(){ni(this.platformId)&&this.mode==="advanced"&&this.zone.runOutsideAngular(()=>{this.content&&(this.dragOverListener=this.renderer.listen(this.content.nativeElement,"dragover",this.onDragOver.bind(this)))})}getTranslation(e){return this.config.getTranslation(e)}choose(){this.advancedFileInput?.nativeElement.click()}onFileSelect(e){if(e.type!=="drop"&&this.isIE11()&&this.duplicateIEEvent){this.duplicateIEEvent=!1;return}this.msgs=[],this.multiple||(this.files=[]);let i=e.dataTransfer?e.dataTransfer.files:e.target.files;for(let r=0;r<i.length;r++){let a=i[r];this.isFileSelected(a)||this.validate(a)&&(this.isImage(a)&&(a.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(i[r]))),this.files.push(i[r]))}this.onSelect.emit({originalEvent:e,files:i,currentFiles:this.files}),this.checkFileLimit(i),this.hasFiles()&&this.auto&&(this.mode!=="advanced"||!this.isFileLimitExceeded())&&this.upload(),e.type!=="drop"&&this.isIE11()?this.clearIEInput():this.clearInputElement()}isFileSelected(e){for(let i of this.files)if(i.name+i.type+i.size===e.name+e.type+e.size)return!0;return!1}isIE11(){if(ni(this.platformId))return!!this.document.defaultView.MSInputMethodContext&&!!this.document.documentMode}validate(e){return this.msgs=this.msgs||[],this.accept&&!this.isFileTypeValid(e)?(this.msgs.push({severity:"error",summary:this.invalidFileTypeMessageSummary.replace("{0}",e.name),detail:this.invalidFileTypeMessageDetail.replace("{0}",this.accept)}),!1):this.maxFileSize&&e.size>this.maxFileSize?(this.msgs.push({severity:"error",summary:this.invalidFileSizeMessageSummary.replace("{0}",e.name),detail:this.invalidFileSizeMessageDetail.replace("{0}",this.formatSize(this.maxFileSize))}),!1):!0}isFileTypeValid(e){let i=this.accept?.split(",").map(r=>r.trim());for(let r of i)if(this.isWildcard(r)?this.getTypeClass(e.type)===this.getTypeClass(r):e.type==r||this.getFileExtension(e).toLowerCase()===r.toLowerCase())return!0;return!1}getTypeClass(e){return e.substring(0,e.indexOf("/"))}isWildcard(e){return e.indexOf("*")!==-1}getFileExtension(e){return"."+e.name.split(".").pop()}isImage(e){return/^image\//.test(e.type)}onImageLoad(e){window.URL.revokeObjectURL(e.src)}upload(){if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.uploadHandler.emit({files:this.files}),this.cd.markForCheck();else{this.uploading=!0,this.msgs=[];let e=new FormData;this.onBeforeUpload.emit({formData:e});for(let i=0;i<this.files.length;i++)e.append(this.name,this.files[i],this.files[i].name);this.cancelUploadRequest(),this.fileUploadSubcription=this.http.request(this.method,this.url,{body:e,headers:this.headers,reportProgress:!0,observe:"events",withCredentials:this.withCredentials}).subscribe(i=>{switch(i.type){case co.Sent:this.onSend.emit({originalEvent:i,formData:e});break;case co.Response:this.uploading=!1,this.progress=0,i.status>=200&&i.status<300?(this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.onUpload.emit({originalEvent:i,files:this.files})):this.onError.emit({files:this.files}),this.uploadedFiles.push(...this.files),this.clear();break;case co.UploadProgress:{i.loaded&&(this.progress=Math.round(i.loaded*100/i.total)),this.onProgress.emit({originalEvent:i,progress:this.progress});break}}this.cd.markForCheck()},i=>{this.uploading=!1,this.onError.emit({files:this.files,error:i})})}}clear(){this.files=[],this.uploadedFileCount=0,this.cancelUploadRequest(),this.onClear.emit(),this.clearInputElement(),this.cd.markForCheck()}remove(e,i){this.cancelUploadRequest(),this.clearInputElement(),this.onRemove.emit({originalEvent:e,file:this.files[i]}),this.files.splice(i,1),this.checkFileLimit(this.files)}removeUploadedFile(e){let i=this.uploadedFiles.splice(e,1)[0];this.uploadedFiles=[...this.uploadedFiles],this.onRemoveUploadedFile.emit({file:i,files:this.uploadedFiles})}cancelUploadRequest(){this.fileUploadSubcription&&(this.fileUploadSubcription.unsubscribe(),this.fileUploadSubcription=void 0)}isFileLimitExceeded(){let i=this.auto?this.files.length:this.files.length+this.uploadedFileCount;return this.fileLimit&&this.fileLimit<=i&&this.focus&&(this.focus=!1),this.fileLimit&&this.fileLimit<i}isChooseDisabled(){return this.auto?this.fileLimit&&this.fileLimit<=this.files.length:this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount}checkFileLimit(e){this.msgs??=[];let i=this.msgs.length>0&&this.fileLimit<e.length;(this.isFileLimitExceeded()||i)&&this.msgs.push({severity:"error",summary:this.invalidFileLimitMessageSummary.replace("{0}",this.fileLimit.toString()),detail:this.invalidFileLimitMessageDetail.replace("{0}",this.fileLimit.toString())})}clearInputElement(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.advancedFileInput.nativeElement.value=""),this.basicFileInput&&this.basicFileInput.nativeElement&&(this.basicFileInput.nativeElement.value="")}clearIEInput(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.duplicateIEEvent=!0,this.advancedFileInput.nativeElement.value="")}hasFiles(){return this.files&&this.files.length>0}hasUploadedFiles(){return this.uploadedFiles&&this.uploadedFiles.length>0}onDragEnter(e){this.disabled||(e.stopPropagation(),e.preventDefault())}onDragOver(e){this.disabled||(R.addClass(this.content?.nativeElement,"p-fileupload-highlight"),this.dragHighlight=!0,e.stopPropagation(),e.preventDefault())}onDragLeave(e){this.disabled||R.removeClass(this.content?.nativeElement,"p-fileupload-highlight")}onDrop(e){if(!this.disabled){R.removeClass(this.content?.nativeElement,"p-fileupload-highlight"),e.stopPropagation(),e.preventDefault();let i=e.dataTransfer?e.dataTransfer.files:e.target.files;(this.multiple||i&&i.length===1)&&this.onFileSelect(e)}}onFocus(){this.focus=!0}onBlur(){this.focus=!1}formatSize(e){let r=this.getTranslation(Yt.FILE_SIZE_TYPES);if(e===0)return`0 ${r[0]}`;let a=Math.floor(Math.log(e)/Math.log(1024));return`${this.formatter.format(e/Math.pow(1024,a))} ${r[a]}`}onBasicUploaderClick(){this.hasFiles()?this.upload():this.basicFileInput?.nativeElement.click()}onBasicKeydown(e){switch(e.code){case"Space":case"Enter":this.onBasicUploaderClick(),e.preventDefault();break}}imageError(e){this.onImageError.emit(e)}getBlockableElement(){return this.el.nativeElement.children[0]}get chooseButtonLabel(){return this.chooseLabel||this.config.getTranslation(Yt.CHOOSE)}get uploadButtonLabel(){return this.uploadLabel||this.config.getTranslation(Yt.UPLOAD)}get cancelButtonLabel(){return this.cancelLabel||this.config.getTranslation(Yt.CANCEL)}get browseFilesLabel(){return this.config.getTranslation(Yt.ARIA)[Yt.BROWSE_FILES]}ngOnDestroy(){this.content&&this.content.nativeElement&&this.dragOverListener&&(this.dragOverListener(),this.dragOverListener=null),this.translationSubscription&&this.translationSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Wi),Z(F0),Z(Qt),Z(Lt),Z(po),Z(yi),Z(M0),Z(St),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-fileUpload"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(Je(TC,5),Je(SC,5),Je(IC,5)),i&2){let a;Ee(a=Fe())&&(r.advancedFileInput=a.first),Ee(a=Fe())&&(r.basicFileInput=a.first),Ee(a=Fe())&&(r.content=a.first)}},hostAttrs:[1,"p-element"],inputs:{name:"name",url:"url",method:"method",multiple:[2,"multiple","multiple",Q],accept:"accept",disabled:[2,"disabled","disabled",Q],auto:[2,"auto","auto",Q],withCredentials:[2,"withCredentials","withCredentials",Q],maxFileSize:[2,"maxFileSize","maxFileSize",We],invalidFileSizeMessageSummary:"invalidFileSizeMessageSummary",invalidFileSizeMessageDetail:"invalidFileSizeMessageDetail",invalidFileTypeMessageSummary:"invalidFileTypeMessageSummary",invalidFileTypeMessageDetail:"invalidFileTypeMessageDetail",invalidFileLimitMessageDetail:"invalidFileLimitMessageDetail",invalidFileLimitMessageSummary:"invalidFileLimitMessageSummary",style:"style",styleClass:"styleClass",previewWidth:[2,"previewWidth","previewWidth",We],chooseLabel:"chooseLabel",uploadLabel:"uploadLabel",cancelLabel:"cancelLabel",chooseIcon:"chooseIcon",uploadIcon:"uploadIcon",cancelIcon:"cancelIcon",showUploadButton:[2,"showUploadButton","showUploadButton",Q],showCancelButton:[2,"showCancelButton","showCancelButton",Q],mode:"mode",headers:"headers",customUpload:[2,"customUpload","customUpload",Q],fileLimit:[2,"fileLimit","fileLimit",e=>We(e,null)],uploadStyleClass:"uploadStyleClass",cancelStyleClass:"cancelStyleClass",removeStyleClass:"removeStyleClass",chooseStyleClass:"chooseStyleClass",files:"files"},outputs:{onBeforeUpload:"onBeforeUpload",onSend:"onSend",onUpload:"onUpload",onError:"onError",onClear:"onClear",onRemove:"onRemove",onSelect:"onSelect",onProgress:"onProgress",uploadHandler:"uploadHandler",onImageError:"onImageError",onRemoveUploadedFile:"onRemoveUploadedFile"},features:[_t],decls:2,vars:2,consts:[["advancedfileinput",""],["content",""],["chooseSection",""],["basicfileinput",""],[3,"ngClass","ngStyle","class",4,"ngIf"],["class","p-fileupload p-fileupload-basic p-component",4,"ngIf"],[3,"ngClass","ngStyle"],["type","file",3,"change","multiple","accept","disabled"],[1,"p-fileupload-buttonbar"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"p-fileupload-content",3,"dragenter","dragleave","drop"],[3,"value","showValue",4,"ngIf"],[3,"value","enableService"],["class","p-fileupload-files",4,"ngIf"],["class","p-fileupload-empty",4,"ngIf"],["pRipple","","tabindex","0",1,"p-button","p-component","p-fileupload-choose",3,"focus","blur","click","keydown.enter","ngClass"],[3,"ngClass","class",4,"ngIf"],[1,"p-button-label"],["type","button",3,"label","disabled","styleClass","onClick",4,"ngIf"],[3,"ngClass"],[3,"styleClass",4,"ngIf"],["class","p-button-icon p-button-icon-left",4,"ngIf"],[3,"styleClass"],[1,"p-button-icon","p-button-icon-left"],["type","button",3,"onClick","label","disabled","styleClass"],["class","p-button-icon p-button-icon-left",3,"ngClass",4,"ngIf"],[1,"p-button-icon","p-button-icon-left",3,"ngClass"],[3,"value","showValue"],[1,"p-fileupload-files"],["class","p-fileupload-row",4,"ngFor","ngForOf"],[1,"p-fileupload-row"],[1,"p-fileupload-filename"],["type","button","pButton","",1,"p-button-icon-only",3,"click","disabled"],[3,"error","src","width"],["ngFor","",3,"ngForOf","ngForTemplate"],[1,"p-fileupload-empty"],[1,"p-fileupload","p-fileupload-basic","p-component"],["tabindex","0","pRipple","",3,"click","keydown","ngClass","ngStyle"],[4,"ngIf","ngIfElse"],["class","p-button-label",4,"ngIf"],["type","file",3,"accept","multiple","disabled","change","focus","blur",4,"ngIf"],["class","p-button-icon p-button-icon-left pi",3,"ngClass",4,"ngIf"],[1,"p-button-icon","p-button-icon-left","pi",3,"ngClass"],["class","p-button-icon p-button-icon-left pi",4,"ngIf"],[1,"p-button-icon","p-button-icon-left","pi"],["type","file",3,"change","focus","blur","accept","multiple","disabled"]],template:function(i,r){i&1&&w(0,f3,14,42,"div",4)(1,D3,8,17,"div",5),i&2&&(u("ngIf",r.mode==="advanced"),p(),u("ngIf",r.mode==="basic"))},dependencies:()=>[at,ii,rt,bt,It,si,Fa,xd,gd,At,bs,Ql,Rt],styles:[`@layer primeng{.p-fileupload-content{position:relative}.p-fileupload-row{display:flex;align-items:center}.p-fileupload-row>div{flex:1 1 auto;width:25%}.p-fileupload-row>div:last-child{text-align:right}.p-fileupload-content .p-progressbar{width:100%;position:absolute;top:0;left:0}.p-button.p-fileupload-choose{position:relative;overflow:hidden}.p-button.p-fileupload-choose input[type=file],.p-fileupload-choose.p-fileupload-choose-selected input[type=file]{display:none}.p-fluid .p-fileupload .p-button{width:auto}.p-fileupload-filename{word-break:break-all}}
`],encapsulation:2,changeDetection:0})}return t})(),ko=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ct,Fi,ec,Jl,ai,bs,Ql,Rt,ct,Fi,ec,Jl]})}return t})();var Vs={};Vs.version="0.18.5";var rr=1200,is=1252,O3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kc={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ec=function(t){O3.indexOf(t)!=-1&&(is=kc[0]=t)};function A3(){Ec(1252)}var Kn=function(t){rr=t,Ec(t)};function Fc(){Kn(1200),A3()}function mc(t){for(var n=[],e=0,i=t.length;e<i;++e)n[e]=t.charCodeAt(e);return n}function L3(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return n.join("")}function Ep(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return n.join("")}var Ss=function(t){var n=t.charCodeAt(0),e=t.charCodeAt(1);return n==255&&e==254?L3(t.slice(2)):n==254&&e==255?Ep(t.slice(2)):n==65279?t.slice(1):t},Eo=function(n){return String.fromCharCode(n)},bd=function(n){return String.fromCharCode(n)},Ht;var fi=null,Cs=!0,Hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ps(t){for(var n="",e=0,i=0,r=0,a=0,s=0,o=0,l=0,c=0;c<t.length;)e=t.charCodeAt(c++),a=e>>2,i=t.charCodeAt(c++),s=(e&3)<<4|i>>4,r=t.charCodeAt(c++),o=(i&15)<<2|r>>6,l=r&63,isNaN(i)?o=l=64:isNaN(r)&&(l=64),n+=Hr.charAt(a)+Hr.charAt(s)+Hr.charAt(o)+Hr.charAt(l);return n}function wn(t){var n="",e=0,i=0,r=0,a=0,s=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=Hr.indexOf(t.charAt(c++)),s=Hr.indexOf(t.charAt(c++)),e=a<<2|s>>4,n+=String.fromCharCode(e),o=Hr.indexOf(t.charAt(c++)),i=(s&15)<<4|o>>2,o!==64&&(n+=String.fromCharCode(i)),l=Hr.indexOf(t.charAt(c++)),r=(o&3)<<6|l,l!==64&&(n+=String.fromCharCode(r));return n}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),vr=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(n,e){return e?new Buffer(n,e):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function Wr(t){return kt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function yd(t){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var bn=function(n){return kt?vr(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)&255})};function Qo(t){if(typeof ArrayBuffer>"u")return bn(t);for(var n=new ArrayBuffer(t.length),e=new Uint8Array(n),i=0;i!=t.length;++i)e[i]=t.charCodeAt(i)&255;return n}function $r(t){if(Array.isArray(t))return t.map(function(i){return String.fromCharCode(i)}).join("");for(var n=[],e=0;e<t.length;++e)n[e]=String.fromCharCode(t[e]);return n.join("")}function R3(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Dc(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Dc(new Uint8Array(t));for(var n=new Array(t.length),e=0;e<t.length;++e)n[e]=t[e];return n}var Pi=kt?function(t){return Buffer.concat(t.map(function(n){return Buffer.isBuffer(n)?n:vr(n)}))}:function(t){if(typeof Uint8Array<"u"){var n=0,e=0;for(n=0;n<t.length;++n)e+=t[n].length;var i=new Uint8Array(e),r=0;for(n=0,e=0;n<t.length;e+=r,++n)if(r=t[n].length,t[n]instanceof Uint8Array)i.set(t[n],e);else{if(typeof t[n]=="string")throw"wtf";i.set(new Uint8Array(t[n]),e)}return i}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function V3(t){for(var n=[],e=0,i=t.length+250,r=Wr(t.length+255),a=0;a<t.length;++a){var s=t.charCodeAt(a);if(s<128)r[e++]=s;else if(s<2048)r[e++]=192|s>>6&31,r[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=t.charCodeAt(++a)&1023;r[e++]=240|s>>8&7,r[e++]=128|s>>2&63,r[e++]=128|o>>6&15|(s&3)<<4,r[e++]=128|o&63}else r[e++]=224|s>>12&15,r[e++]=128|s>>6&63,r[e++]=128|s&63;e>i&&(n.push(r.slice(0,e)),e=0,r=Wr(65535),i=65530)}return n.push(r.slice(0,e)),Pi(n)}var Qi=/\u0000/g,Is=/[\u0001-\u0006]/g;function Qa(t){for(var n="",e=t.length-1;e>=0;)n+=t.charAt(e--);return n}function Gn(t,n){var e=""+t;return e.length>=n?e:pi("0",n-e.length)+e}function Mc(t,n){var e=""+t;return e.length>=n?e:pi(" ",n-e.length)+e}function No(t,n){var e=""+t;return e.length>=n?e:e+pi(" ",n-e.length)}function P3(t,n){var e=""+Math.round(t);return e.length>=n?e:pi("0",n-e.length)+e}function B3(t,n){var e=""+t;return e.length>=n?e:pi("0",n-e.length)+e}var wd=Math.pow(2,32);function Ga(t,n){if(t>wd||t<-wd)return P3(t,n);var e=Math.round(t);return B3(e,n)}function Uo(t,n){return n=n||0,t.length>=7+n&&(t.charCodeAt(n)|32)===103&&(t.charCodeAt(n+1)|32)===101&&(t.charCodeAt(n+2)|32)===110&&(t.charCodeAt(n+3)|32)===101&&(t.charCodeAt(n+4)|32)===114&&(t.charCodeAt(n+5)|32)===97&&(t.charCodeAt(n+6)|32)===108}var Cd=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],tc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function N3(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Td={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},U3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ho(t,n,e){for(var i=t<0?-1:1,r=t*i,a=0,s=1,o=0,l=1,c=0,d=0,h=Math.floor(r);c<n&&(h=Math.floor(r),o=h*s+a,d=h*c+l,!(r-h<5e-8));)r=1/(r-h),a=s,s=o,l=c,c=d;if(d>n&&(c>n?(d=l,o=a):(d=c,o=s)),!e)return[0,i*o,d];var _=Math.floor(i*o/d);return[_,i*o-_*d,d]}function ia(t,n,e){if(t>2958465||t<0)return null;var i=t|0,r=Math.floor(86400*(t-i)),a=0,s=[],o={D:i,T:r,u:86400*(t-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),n&&n.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++r==86400&&(o.T=r=0,++i,++o.D)),i===60)s=e?[1317,10,29]:[1900,2,29],a=3;else if(i===0)s=e?[1317,8,29]:[1900,1,0],a=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),i<60&&(a=(a+6)%7),e&&(a=G3(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=r%60,r=Math.floor(r/60),o.M=r%60,r=Math.floor(r/60),o.H=r,o.q=a,o}var Fp=new Date(1899,11,31,0,0,0),H3=Fp.getTime(),z3=new Date(1900,2,1,0,0,0);function Dp(t,n){var e=t.getTime();return n?e-=1461*24*60*60*1e3:t>=z3&&(e+=24*60*60*1e3),(e-(H3+(t.getTimezoneOffset()-Fp.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Oc(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function W3(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function j3(t){var n=t<0?12:11,e=Oc(t.toFixed(12));return e.length<=n||(e=t.toPrecision(10),e.length<=n)?e:t.toExponential(5)}function K3(t){var n=Oc(t.toFixed(11));return n.length>(t<0?12:11)||n==="0"||n==="-0"?t.toPrecision(6):n}function Bs(t){var n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return n>=-4&&n<=-1?e=t.toPrecision(10+n):Math.abs(n)<=9?e=j3(t):n===10?e=t.toFixed(10).substr(0,12):e=K3(t),Oc(W3(e.toUpperCase()))}function oa(t,n){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Bs(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Nn(14,Dp(t,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+t)}function G3(t,n){n[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function $3(t,n,e,i){var r="",a=0,s=0,o=e.y,l,c=0;switch(t){case 98:o=e.y+543;case 121:switch(n.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(n.length){case 1:case 2:l=e.m,c=n.length;break;case 3:return tc[e.m-1][1];case 5:return tc[e.m-1][0];default:return tc[e.m-1][2]}break;case 100:switch(n.length){case 1:case 2:l=e.d,c=n.length;break;case 3:return Cd[e.q][0];default:return Cd[e.q][1]}break;case 104:switch(n.length){case 1:case 2:l=1+(e.H+11)%12,c=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:l=e.H,c=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:l=e.M,c=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return e.u===0&&(n=="s"||n=="ss")?Gn(e.S,n.length):(i>=2?s=i===3?1e3:100:s=i===1?10:1,a=Math.round(s*(e.S+e.u)),a>=60*s&&(a=0),n==="s"?a===0?"0":""+a/s:(r=Gn(a,2+i),n==="ss"?r.substr(0,2):"."+r.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+n}c=n.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?Gn(l,c):"";return d}function zr(t){var n=3;if(t.length<=n)return t;for(var e=t.length%n,i=t.substr(0,e);e!=t.length;e+=n)i+=(i.length>0?",":"")+t.substr(e,n);return i}var Mp=/%/g;function Y3(t,n,e){var i=n.replace(Mp,""),r=n.length-i.length;return mr(t,i,e*Math.pow(10,2*r))+pi("%",r)}function X3(t,n,e){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return mr(t,n.substr(0,i),e/Math.pow(10,3*(n.length-i)))}function Op(t,n){var e,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Op(t,-n);var r=t.indexOf(".");r===-1&&(r=t.indexOf("E"));var a=Math.floor(Math.log(n)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(n/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),e.indexOf("e")===-1){var s=Math.floor(Math.log(n)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(r+a)%r)+"."+d.substr(a)+"E"})}else e=n.toExponential(i);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Ap=/# (\?+)( ?)\/( ?)(\d+)/;function q3(t,n,e){var i=parseInt(t[4],10),r=Math.round(n*i),a=Math.floor(r/i),s=r-a*i,o=i;return e+(a===0?"":""+a)+" "+(s===0?pi(" ",t[1].length+1+t[4].length):Mc(s,t[1].length)+t[2]+"/"+t[3]+Gn(o,t[4].length))}function Z3(t,n,e){return e+(n===0?"":""+n)+pi(" ",t[1].length+2+t[4].length)}var Lp=/^#*0*\.([0#]+)/,Rp=/\).*[0#]/,Vp=/\(###\) ###\\?-####/;function an(t){for(var n="",e,i=0;i!=t.length;++i)switch(e=t.charCodeAt(i)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(e)}return n}function Sd(t,n){var e=Math.pow(10,n);return""+Math.round(t*e)/e}function Id(t,n){var e=t-Math.floor(t),i=Math.pow(10,n);return n<(""+Math.round(e*i)).length?0:Math.round(e*i)}function Q3(t,n){return n<(""+Math.round((t-Math.floor(t))*Math.pow(10,n))).length?1:0}function J3(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function An(t,n,e){if(t.charCodeAt(0)===40&&!n.match(Rp)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?An("n",i,e):"("+An("n",i,-e)+")"}if(n.charCodeAt(n.length-1)===44)return X3(t,n,e);if(n.indexOf("%")!==-1)return Y3(t,n,e);if(n.indexOf("E")!==-1)return Op(n,e);if(n.charCodeAt(0)===36)return"$"+An(t,n.substr(n.charAt(1)==" "?2:1),e);var r,a,s,o,l=Math.abs(e),c=e<0?"-":"";if(n.match(/^00+$/))return c+Ga(l,n.length);if(n.match(/^[#?]+$/))return r=Ga(e,0),r==="0"&&(r=""),r.length>n.length?r:an(n.substr(0,n.length-r.length))+r;if(a=n.match(Ap))return q3(a,l,c);if(n.match(/^#+0+$/))return c+Ga(l,n.length-n.indexOf("0"));if(a=n.match(Lp))return r=Sd(e,a[1].length).replace(/^([^\.]+)$/,"$1."+an(a[1])).replace(/\.$/,"."+an(a[1])).replace(/\.(\d*)$/,function(b,m){return"."+m+pi("0",an(a[1]).length-m.length)}),n.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),a=n.match(/^(0*)\.(#*)$/))return c+Sd(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=n.match(/^#{1,3},##0(\.?)$/))return c+zr(Ga(l,0));if(a=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+An(t,n,-e):zr(""+(Math.floor(e)+Q3(e,a[1].length)))+"."+Gn(Id(e,a[1].length),a[1].length);if(a=n.match(/^#,#*,#0/))return An(t,n.replace(/^#,#*,/,""),e);if(a=n.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Qa(An(t,n.replace(/[\\-]/g,""),e)),s=0,Qa(Qa(n.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<r.length?r.charAt(s++):b==="0"?"0":""}));if(n.match(Vp))return r=An(t,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(a=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Ho(l,Math.pow(10,s)-1,!1),r=""+c,d=mr("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),r+=d+a[2]+"/"+a[3],d=No(o[2],s),d.length<a[4].length&&(d=an(a[4].substr(a[4].length-d.length))+d),r+=d,r;if(a=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Ho(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Mc(o[1],s)+a[2]+"/"+a[3]+No(o[2],s):pi(" ",2*s+1+a[2].length+a[3].length));if(a=n.match(/^[#0?]+$/))return r=Ga(e,0),n.length<=r.length?r:an(n.substr(0,n.length-r.length))+r;if(a=n.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var h=n.indexOf(".")-s,_=n.length-r.length-h;return an(n.substr(0,h)+r+n.substr(n.length-_))}if(a=n.match(/^00,000\.([#0]*0)$/))return s=Id(e,a[1].length),e<0?"-"+An(t,n,-e):zr(J3(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Gn(0,3-b.length):"")+b})+"."+Gn(s,a[1].length);switch(n){case"###,##0.00":return An(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var v=zr(Ga(l,0));return v!=="0"?c+v:"";case"###,###.00":return An(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return An(t,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+n+"|")}function eT(t,n,e){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return mr(t,n.substr(0,i),e/Math.pow(10,3*(n.length-i)))}function tT(t,n,e){var i=n.replace(Mp,""),r=n.length-i.length;return mr(t,i,e*Math.pow(10,2*r))+pi("%",r)}function Pp(t,n){var e,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Pp(t,-n);var r=t.indexOf(".");r===-1&&(r=t.indexOf("E"));var a=Math.floor(Math.log(n)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(n/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),!e.match(/[Ee]/)){var s=Math.floor(Math.log(n)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(r+a)%r)+"."+d.substr(a)+"E"})}else e=n.toExponential(i);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function tr(t,n,e){if(t.charCodeAt(0)===40&&!n.match(Rp)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?tr("n",i,e):"("+tr("n",i,-e)+")"}if(n.charCodeAt(n.length-1)===44)return eT(t,n,e);if(n.indexOf("%")!==-1)return tT(t,n,e);if(n.indexOf("E")!==-1)return Pp(n,e);if(n.charCodeAt(0)===36)return"$"+tr(t,n.substr(n.charAt(1)==" "?2:1),e);var r,a,s,o,l=Math.abs(e),c=e<0?"-":"";if(n.match(/^00+$/))return c+Gn(l,n.length);if(n.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>n.length?r:an(n.substr(0,n.length-r.length))+r;if(a=n.match(Ap))return Z3(a,l,c);if(n.match(/^#+0+$/))return c+Gn(l,n.length-n.indexOf("0"));if(a=n.match(Lp))return r=(""+e).replace(/^([^\.]+)$/,"$1."+an(a[1])).replace(/\.$/,"."+an(a[1])),r=r.replace(/\.(\d*)$/,function(b,m){return"."+m+pi("0",an(a[1]).length-m.length)}),n.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),a=n.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=n.match(/^#{1,3},##0(\.?)$/))return c+zr(""+l);if(a=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+tr(t,n,-e):zr(""+e)+"."+pi("0",a[1].length);if(a=n.match(/^#,#*,#0/))return tr(t,n.replace(/^#,#*,/,""),e);if(a=n.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Qa(tr(t,n.replace(/[\\-]/g,""),e)),s=0,Qa(Qa(n.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<r.length?r.charAt(s++):b==="0"?"0":""}));if(n.match(Vp))return r=tr(t,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(a=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Ho(l,Math.pow(10,s)-1,!1),r=""+c,d=mr("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),r+=d+a[2]+"/"+a[3],d=No(o[2],s),d.length<a[4].length&&(d=an(a[4].substr(a[4].length-d.length))+d),r+=d,r;if(a=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Ho(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Mc(o[1],s)+a[2]+"/"+a[3]+No(o[2],s):pi(" ",2*s+1+a[2].length+a[3].length));if(a=n.match(/^[#0?]+$/))return r=""+e,n.length<=r.length?r:an(n.substr(0,n.length-r.length))+r;if(a=n.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var h=n.indexOf(".")-s,_=n.length-r.length-h;return an(n.substr(0,h)+r+n.substr(n.length-_))}if(a=n.match(/^00,000\.([#0]*0)$/))return e<0?"-"+tr(t,n,-e):zr(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Gn(0,3-b.length):"")+b})+"."+Gn(0,a[1].length);switch(n){case"###,###":case"##,###":case"#,###":var v=zr(""+l);return v!=="0"?c+v:"";default:if(n.match(/\.[0#?]*$/))return tr(t,n.slice(0,n.lastIndexOf(".")),e)+an(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function mr(t,n,e){return(e|0)===e?tr(t,n,e):An(t,n,e)}function iT(t){for(var n=[],e=!1,i=0,r=0;i<t.length;++i)switch(t.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:n[n.length]=t.substr(r,i-r),r=i+1}if(n[n.length]=t.substr(r),e===!0)throw new Error("Format |"+t+"| unterminated string ");return n}var Bp=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ss(t){for(var n=0,e="",i="";n<t.length;)switch(e=t.charAt(n)){case"G":Uo(t,n)&&(n+=6),n++;break;case'"':for(;t.charCodeAt(++n)!==34&&n<t.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(t.charAt(n+1)==="1"||t.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(n,3).toUpperCase()==="A/P"||t.substr(n,5).toUpperCase()==="AM/PM"||t.substr(n,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++n;break;case"[":for(i=e;t.charAt(n++)!=="]"&&n<t.length;)i+=t.charAt(n);if(i.match(Bp))return!0;break;case".":case"0":case"#":for(;n<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++n))>-1||e=="\\"&&t.charAt(n+1)=="-"&&"0#".indexOf(t.charAt(n+2))>-1););break;case"?":for(;t.charAt(++n)===e;);break;case"*":++n,(t.charAt(n)==" "||t.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<t.length&&"0123456789".indexOf(t.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function nT(t,n,e,i){for(var r=[],a="",s=0,o="",l="t",c,d,h,_="H";s<t.length;)switch(o=t.charAt(s)){case"G":if(!Uo(t,s))throw new Error("unrecognized character "+o+" in "+t);r[r.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(h=t.charCodeAt(++s))!==34&&s<t.length;)a+=String.fromCharCode(h);r[r.length]={t:"t",v:a},++s;break;case"\\":var v=t.charAt(++s),b=v==="("||v===")"?v:"t";r[r.length]={t:b,v},++s;break;case"_":r[r.length]={t:"t",v:" "},s+=2;break;case"@":r[r.length]={t:"T",v:n},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(c==null&&(c=ia(n,e,t.charAt(s+1)==="2"),c==null))return"";r[r.length]={t:"X",v:t.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||c==null&&(c=ia(n,e),c==null))return"";for(a=o;++s<t.length&&t.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=_),r[r.length]={t:o,v:a},l=o;break;case"A":case"a":case"\u4E0A":var m={t:o,v:o};if(c==null&&(c=ia(n,e)),t.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",_="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",s+=5,_="h"):t.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(m.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),m.t="T",s+=5,_="h"):(m.t="t",++s),c==null&&m.t==="T")return"";r[r.length]=m,l=o;break;case"[":for(a=o;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Bp)){if(c==null&&(c=ia(n,e),c==null))return"";r[r.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",ss(t)||(r[r.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<t.length&&(o=t.charAt(s))==="0";)a+=o;r[r.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(s))>-1;)a+=o;r[r.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++s)===o;)a+=o;r[r.length]={t:o,v:a},l=o;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":r[r.length]={t:i===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)a+=t.charAt(s);r[r.length]={t:"D",v:a};break;case" ":r[r.length]={t:o,v:o},++s;break;case"$":r[r.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);r[r.length]={t:"t",v:o},++s;break}var y=0,k=0,F;for(s=r.length-1,l="t";s>=0;--s)switch(r[s].t){case"h":case"H":r[s].t=_,l="h",y<1&&(y=1);break;case"s":(F=r[s].v.match(/\.0+$/))&&(k=Math.max(k,F[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=r[s].t;break;case"m":l==="s"&&(r[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&r[s].v.match(/[Hh]/)&&(y=1),y<2&&r[s].v.match(/[Mm]/)&&(y=2),y<3&&r[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",W;for(s=0;s<r.length;++s)switch(r[s].t){case"t":case"T":case" ":case"D":break;case"X":r[s].v="",r[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[s].v=$3(r[s].t.charCodeAt(0),r[s].v,c,k),r[s].t="t";break;case"n":case"?":for(W=s+1;r[W]!=null&&((o=r[W].t)==="?"||o==="D"||(o===" "||o==="t")&&r[W+1]!=null&&(r[W+1].t==="?"||r[W+1].t==="t"&&r[W+1].v==="/")||r[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(r[W].v==="/"||r[W].v===" "&&r[W+1]!=null&&r[W+1].t=="?"));)r[s].v+=r[W].v,r[W]={v:"",t:";"},++W;T+=r[s].v,s=W-1;break;case"G":r[s].t="t",r[s].v=oa(n,e);break}var X="",z,M;if(T.length>0){T.charCodeAt(0)==40?(z=n<0&&T.charCodeAt(0)===45?-n:n,M=mr("n",T,z)):(z=n<0&&i>1?-n:n,M=mr("n",T,z),z<0&&r[0]&&r[0].t=="t"&&(M=M.substr(1),r[0].v="-"+r[0].v)),W=M.length-1;var K=r.length;for(s=0;s<r.length;++s)if(r[s]!=null&&r[s].t!="t"&&r[s].v.indexOf(".")>-1){K=s;break}var j=r.length;if(K===r.length&&M.indexOf("E")===-1){for(s=r.length-1;s>=0;--s)r[s]==null||"n?".indexOf(r[s].t)===-1||(W>=r[s].v.length-1?(W-=r[s].v.length,r[s].v=M.substr(W+1,r[s].v.length)):W<0?r[s].v="":(r[s].v=M.substr(0,W+1),W=-1),r[s].t="t",j=s);W>=0&&j<r.length&&(r[j].v=M.substr(0,W+1)+r[j].v)}else if(K!==r.length&&M.indexOf("E")===-1){for(W=M.indexOf(".")-1,s=K;s>=0;--s)if(!(r[s]==null||"n?".indexOf(r[s].t)===-1)){for(d=r[s].v.indexOf(".")>-1&&s===K?r[s].v.indexOf(".")-1:r[s].v.length-1,X=r[s].v.substr(d+1);d>=0;--d)W>=0&&(r[s].v.charAt(d)==="0"||r[s].v.charAt(d)==="#")&&(X=M.charAt(W--)+X);r[s].v=X,r[s].t="t",j=s}for(W>=0&&j<r.length&&(r[j].v=M.substr(0,W+1)+r[j].v),W=M.indexOf(".")+1,s=K;s<r.length;++s)if(!(r[s]==null||"n?(".indexOf(r[s].t)===-1&&s!==K)){for(d=r[s].v.indexOf(".")>-1&&s===K?r[s].v.indexOf(".")+1:0,X=r[s].v.substr(0,d);d<r[s].v.length;++d)W<M.length&&(X+=M.charAt(W++));r[s].v=X,r[s].t="t",j=s}}}for(s=0;s<r.length;++s)r[s]!=null&&"n?".indexOf(r[s].t)>-1&&(z=i>1&&n<0&&s>0&&r[s-1].v==="-"?-n:n,r[s].v=mr(r[s].t,r[s].v,z),r[s].t="t");var ne="";for(s=0;s!==r.length;++s)r[s]!=null&&(ne+=r[s].v);return ne}var kd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ed(t,n){if(n==null)return!1;var e=parseFloat(n[2]);switch(n[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function rT(t,n){var e=iT(t),i=e.length,r=e[i-1].indexOf("@");if(i<4&&r>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof n!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var a=n>0?e[0]:n<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(kd),o=e[1].match(kd);return Ed(n,s)?[i,e[0]]:Ed(n,o)?[i,e[1]]:[i,e[s!=null&&o!=null?2:1]]}return[i,a]}function Nn(t,n,e){e==null&&(e={});var i="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?i=e.dateNF:i=t;break;case"number":t==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:lt)[t],i==null&&(i=e.table&&e.table[Td[t]]||lt[Td[t]]),i==null&&(i=U3[t]||"General");break}if(Uo(i,0))return oa(n,e);n instanceof Date&&(n=Dp(n,e.date1904));var r=rT(i,n);if(Uo(r[1]))return oa(n,e);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return nT(r[1],n,e,r[0])}function _r(t,n){if(typeof n!="number"){n=+n||-1;for(var e=0;e<392;++e){if(lt[e]==null){n<0&&(n=e);continue}if(lt[e]==t){n=e;break}}n<0&&(n=391)}return lt[n]=t,n}function Jo(t){for(var n=0;n!=392;++n)t[n]!==void 0&&_r(t[n],n)}function os(){lt=N3()}var aT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Np=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function sT(t){var n=typeof t=="number"?lt[t]:t;return n=n.replace(Np,"(\\d+)"),new RegExp("^"+n+"$")}function oT(t,n,e){var i=-1,r=-1,a=-1,s=-1,o=-1,l=-1;(n.match(Np)||[]).forEach(function(h,_){var v=parseInt(e[_+1],10);switch(h.toLowerCase().charAt(0)){case"y":i=v;break;case"d":a=v;break;case"h":s=v;break;case"s":l=v;break;case"m":s>=0?o=v:r=v;break}}),l>=0&&o==-1&&r>=0&&(o=r,r=-1);var c=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:i==-1&&r==-1&&a==-1?d:c+"T"+d}var lT=function(){var t={};t.version="1.2.0";function n(){for(var M=0,K=new Array(256),j=0;j!=256;++j)M=j,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,K[j]=M;return typeof Int32Array<"u"?new Int32Array(K):K}var e=n();function i(M){var K=0,j=0,ne=0,oe=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)oe[ne]=M[ne];for(ne=0;ne!=256;++ne)for(j=M[ne],K=256+ne;K<4096;K+=256)j=oe[K]=j>>>8^M[j&255];var q=[];for(ne=1;ne!=16;++ne)q[ne-1]=typeof Int32Array<"u"?oe.subarray(ne*256,ne*256+256):oe.slice(ne*256,ne*256+256);return q}var r=i(e),a=r[0],s=r[1],o=r[2],l=r[3],c=r[4],d=r[5],h=r[6],_=r[7],v=r[8],b=r[9],m=r[10],y=r[11],k=r[12],F=r[13],T=r[14];function W(M,K){for(var j=K^-1,ne=0,oe=M.length;ne<oe;)j=j>>>8^e[(j^M.charCodeAt(ne++))&255];return~j}function X(M,K){for(var j=K^-1,ne=M.length-15,oe=0;oe<ne;)j=T[M[oe++]^j&255]^F[M[oe++]^j>>8&255]^k[M[oe++]^j>>16&255]^y[M[oe++]^j>>>24]^m[M[oe++]]^b[M[oe++]]^v[M[oe++]]^_[M[oe++]]^h[M[oe++]]^d[M[oe++]]^c[M[oe++]]^l[M[oe++]]^o[M[oe++]]^s[M[oe++]]^a[M[oe++]]^e[M[oe++]];for(ne+=15;oe<ne;)j=j>>>8^e[(j^M[oe++])&255];return~j}function z(M,K){for(var j=K^-1,ne=0,oe=M.length,q=0,Se=0;ne<oe;)q=M.charCodeAt(ne++),q<128?j=j>>>8^e[(j^q)&255]:q<2048?(j=j>>>8^e[(j^(192|q>>6&31))&255],j=j>>>8^e[(j^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,Se=M.charCodeAt(ne++)&1023,j=j>>>8^e[(j^(240|q>>8&7))&255],j=j>>>8^e[(j^(128|q>>2&63))&255],j=j>>>8^e[(j^(128|Se>>6&15|(q&3)<<4))&255],j=j>>>8^e[(j^(128|Se&63))&255]):(j=j>>>8^e[(j^(224|q>>12&15))&255],j=j>>>8^e[(j^(128|q>>6&63))&255],j=j>>>8^e[(j^(128|q&63))&255]);return~j}return t.table=e,t.bstr=W,t.buf=X,t.str=z,t}(),et=function(){var n={};n.version="1.2.1";function e(C,O){for(var E=C.split("/"),D=O.split("/"),A=0,L=0,J=Math.min(E.length,D.length);A<J;++A){if(L=E[A].length-D[A].length)return L;if(E[A]!=D[A])return E[A]<D[A]?-1:1}return E.length-D.length}function i(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:i(C.slice(0,-1));var O=C.lastIndexOf("/");return O===-1?C:C.slice(0,O+1)}function r(C){if(C.charAt(C.length-1)=="/")return r(C.slice(0,-1));var O=C.lastIndexOf("/");return O===-1?C:C.slice(O+1)}function a(C,O){typeof O=="string"&&(O=new Date(O));var E=O.getHours();E=E<<6|O.getMinutes(),E=E<<5|O.getSeconds()>>>1,C.write_shift(2,E);var D=O.getFullYear()-1980;D=D<<4|O.getMonth()+1,D=D<<5|O.getDate(),C.write_shift(2,D)}function s(C){var O=C.read_shift(2)&65535,E=C.read_shift(2)&65535,D=new Date,A=E&31;E>>>=5;var L=E&15;E>>>=4,D.setMilliseconds(0),D.setFullYear(E+1980),D.setMonth(L-1),D.setDate(A);var J=O&31;O>>>=5;var de=O&63;return O>>>=6,D.setHours(O),D.setMinutes(de),D.setSeconds(J<<1),D}function o(C){Hi(C,0);for(var O={},E=0;C.l<=C.length-4;){var D=C.read_shift(2),A=C.read_shift(2),L=C.l+A,J={};switch(D){case 21589:E=C.read_shift(1),E&1&&(J.mtime=C.read_shift(4)),A>5&&(E&2&&(J.atime=C.read_shift(4)),E&4&&(J.ctime=C.read_shift(4))),J.mtime&&(J.mt=new Date(J.mtime*1e3));break}C.l=L,O[D]=J}return O}var l;function c(){return l||(l={})}function d(C,O){if(C[0]==80&&C[1]==75)return w0(C,O);if((C[0]|32)==109&&(C[1]|32)==105)return rh(C,O);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var E=3,D=512,A=0,L=0,J=0,de=0,ie=0,ee=[],re=C.slice(0,512);Hi(re,0);var we=h(re);switch(E=we[0],E){case 3:D=512;break;case 4:D=4096;break;case 0:if(we[1]==0)return w0(C,O);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}D!==512&&(re=C.slice(0,D),Hi(re,28));var Me=C.slice(0,D);_(re,E);var je=re.read_shift(4,"i");if(E===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);re.l+=4,J=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),de=re.read_shift(4,"i"),A=re.read_shift(4,"i"),ie=re.read_shift(4,"i"),L=re.read_shift(4,"i");for(var Oe=-1,Ve=0;Ve<109&&(Oe=re.read_shift(4,"i"),!(Oe<0));++Ve)ee[Ve]=Oe;var mt=v(C,D);y(ie,L,mt,D,ee);var Zt=F(mt,J,ee,D);Zt[J].name="!Directory",A>0&&de!==Se&&(Zt[de].name="!MiniFAT"),Zt[ee[0]].name="!FAT",Zt.fat_addrs=ee,Zt.ssz=D;var on={},bi=[],mn=[],fs=[];T(J,Zt,mt,bi,A,on,mn,de),b(mn,fs,bi),bi.shift();var hs={FileIndex:mn,FullPaths:fs};return O&&O.raw&&(hs.raw={header:Me,sectors:mt}),hs}function h(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Ne,"Header Signature: "),C.l+=16;var O=C.read_shift(2,"u");return[C.read_shift(2,"u"),O]}function _(C,O){var E=9;switch(C.l+=2,E=C.read_shift(2)){case 9:if(O!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(O!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function v(C,O){for(var E=Math.ceil(C.length/O)-1,D=[],A=1;A<E;++A)D[A-1]=C.slice(A*O,(A+1)*O);return D[E-1]=C.slice(E*O),D}function b(C,O,E){for(var D=0,A=0,L=0,J=0,de=0,ie=E.length,ee=[],re=[];D<ie;++D)ee[D]=re[D]=D,O[D]=E[D];for(;de<re.length;++de)D=re[de],A=C[D].L,L=C[D].R,J=C[D].C,ee[D]===D&&(A!==-1&&ee[A]!==A&&(ee[D]=ee[A]),L!==-1&&ee[L]!==L&&(ee[D]=ee[L])),J!==-1&&(ee[J]=D),A!==-1&&D!=ee[D]&&(ee[A]=ee[D],re.lastIndexOf(A)<de&&re.push(A)),L!==-1&&D!=ee[D]&&(ee[L]=ee[D],re.lastIndexOf(L)<de&&re.push(L));for(D=1;D<ie;++D)ee[D]===D&&(L!==-1&&ee[L]!==L?ee[D]=ee[L]:A!==-1&&ee[A]!==A&&(ee[D]=ee[A]));for(D=1;D<ie;++D)if(C[D].type!==0){if(de=D,de!=ee[de])do de=ee[de],O[D]=O[de]+"/"+O[D];while(de!==0&&ee[de]!==-1&&de!=ee[de]);ee[D]=-1}for(O[0]+="/",D=1;D<ie;++D)C[D].type!==2&&(O[D]+="/")}function m(C,O,E){for(var D=C.start,A=C.size,L=[],J=D;E&&A>0&&J>=0;)L.push(O.slice(J*q,J*q+q)),A-=q,J=ta(E,J*4);return L.length===0?ce(0):Pi(L).slice(0,C.size)}function y(C,O,E,D,A){var L=Se;if(C===Se){if(O!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var J=E[C],de=(D>>>2)-1;if(!J)return;for(var ie=0;ie<de&&(L=ta(J,ie*4))!==Se;++ie)A.push(L);y(ta(J,D-4),O-1,E,D,A)}}function k(C,O,E,D,A){var L=[],J=[];A||(A=[]);var de=D-1,ie=0,ee=0;for(ie=O;ie>=0;){A[ie]=!0,L[L.length]=ie,J.push(C[ie]);var re=E[Math.floor(ie*4/D)];if(ee=ie*4&de,D<4+ee)throw new Error("FAT boundary crossed: "+ie+" 4 "+D);if(!C[re])break;ie=ta(C[re],ee)}return{nodes:L,data:Ud([J])}}function F(C,O,E,D){var A=C.length,L=[],J=[],de=[],ie=[],ee=D-1,re=0,we=0,Me=0,je=0;for(re=0;re<A;++re)if(de=[],Me=re+O,Me>=A&&(Me-=A),!J[Me]){ie=[];var Oe=[];for(we=Me;we>=0;){Oe[we]=!0,J[we]=!0,de[de.length]=we,ie.push(C[we]);var Ve=E[Math.floor(we*4/D)];if(je=we*4&ee,D<4+je)throw new Error("FAT boundary crossed: "+we+" 4 "+D);if(!C[Ve]||(we=ta(C[Ve],je),Oe[we]))break}L[Me]={nodes:de,data:Ud([ie])}}return L}function T(C,O,E,D,A,L,J,de){for(var ie=0,ee=D.length?2:0,re=O[C].data,we=0,Me=0,je;we<re.length;we+=128){var Oe=re.slice(we,we+128);Hi(Oe,64),Me=Oe.read_shift(2),je=nl(Oe,0,Me-ee),D.push(je);var Ve={name:je,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},mt=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);mt!==0&&(Ve.ct=W(Oe,Oe.l-8));var Zt=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Zt!==0&&(Ve.mt=W(Oe,Oe.l-8)),Ve.start=Oe.read_shift(4,"i"),Ve.size=Oe.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=Se,Ve.name=""),Ve.type===5?(ie=Ve.start,A>0&&ie!==Se&&(O[ie].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",O[Ve.start]===void 0&&(O[Ve.start]=k(E,Ve.start,O.fat_addrs,O.ssz)),O[Ve.start].name=Ve.name,Ve.content=O[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:ie!==Se&&Ve.start!==Se&&O[ie]&&(Ve.content=m(Ve,O[ie].data,(O[de]||{}).data))),Ve.content&&Hi(Ve.content,0),L[je]=Ve,J.push(Ve)}}function W(C,O){return new Date((Vi(C,O+4)/1e7*Math.pow(2,32)+Vi(C,O)/1e7-11644473600)*1e3)}function X(C,O){return c(),d(l.readFileSync(C),O)}function z(C,O){var E=O&&O.type;switch(E||kt&&Buffer.isBuffer(C)&&(E="buffer"),E||"base64"){case"file":return X(C,O);case"base64":return d(bn(wn(C)),O);case"binary":return d(bn(C),O)}return d(C,O)}function M(C,O){var E=O||{},D=E.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=D+"/",C.FileIndex[0]={name:D,type:5}),E.CLSID&&(C.FileIndex[0].clsid=E.CLSID),K(C)}function K(C){var O="Sh33tJ5";if(!et.find(C,"/"+O)){var E=ce(4);E[0]=55,E[1]=E[3]=50,E[2]=54,C.FileIndex.push({name:O,type:2,content:E,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+O),j(C)}}function j(C,O){M(C);for(var E=!1,D=!1,A=C.FullPaths.length-1;A>=0;--A){var L=C.FileIndex[A];switch(L.type){case 0:D?E=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(L.R*L.L*L.C)&&(E=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!O)){var J=new Date(1987,1,19),de=0,ie=Object.create?Object.create(null):{},ee=[];for(A=0;A<C.FullPaths.length;++A)ie[C.FullPaths[A]]=!0,C.FileIndex[A].type!==0&&ee.push([C.FullPaths[A],C.FileIndex[A]]);for(A=0;A<ee.length;++A){var re=i(ee[A][0]);D=ie[re],D||(ee.push([re,{name:r(re).replace("/",""),type:1,clsid:Ye,ct:J,mt:J,content:null}]),ie[re]=!0)}for(ee.sort(function(je,Oe){return e(je[0],Oe[0])}),C.FullPaths=[],C.FileIndex=[],A=0;A<ee.length;++A)C.FullPaths[A]=ee[A][0],C.FileIndex[A]=ee[A][1];for(A=0;A<ee.length;++A){var we=C.FileIndex[A],Me=C.FullPaths[A];if(we.name=r(Me).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||Ye,A===0)we.C=ee.length>1?1:-1,we.size=0,we.type=5;else if(Me.slice(-1)=="/"){for(de=A+1;de<ee.length&&i(C.FullPaths[de])!=Me;++de);for(we.C=de>=ee.length?-1:de,de=A+1;de<ee.length&&i(C.FullPaths[de])!=i(Me);++de);we.R=de>=ee.length?-1:de,we.type=1}else i(C.FullPaths[A+1]||"")==i(Me)&&(we.R=A+1),we.type=2}}}function ne(C,O){var E=O||{};if(E.fileType=="mad")return ah(C,E);switch(j(C),E.fileType){case"zip":return Qf(C,E)}var D=function(je){for(var Oe=0,Ve=0,mt=0;mt<je.FileIndex.length;++mt){var Zt=je.FileIndex[mt];if(Zt.content){var on=Zt.content.length;on>0&&(on<4096?Oe+=on+63>>6:Ve+=on+511>>9)}}for(var bi=je.FullPaths.length+3>>2,mn=Oe+7>>3,fs=Oe+127>>7,hs=mn+Ve+bi+fs,Zr=hs+127>>7,ml=Zr<=109?0:Math.ceil((Zr-109)/127);hs+Zr+ml+127>>7>Zr;)ml=++Zr<=109?0:Math.ceil((Zr-109)/127);var cr=[1,ml,Zr,fs,bi,Ve,Oe,0];return je.FileIndex[0].size=Oe<<6,cr[7]=(je.FileIndex[0].start=cr[0]+cr[1]+cr[2]+cr[3]+cr[4]+cr[5])+(cr[6]+7>>3),cr}(C),A=ce(D[7]<<9),L=0,J=0;{for(L=0;L<8;++L)A.write_shift(1,Ie[L]);for(L=0;L<8;++L)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),L=0;L<3;++L)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,D[2]),A.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:Se),A.write_shift(4,D[3]),A.write_shift(-4,D[1]?D[0]-1:Se),A.write_shift(4,D[1]),L=0;L<109;++L)A.write_shift(-4,L<D[2]?D[1]+L:-1)}if(D[1])for(J=0;J<D[1];++J){for(;L<236+J*127;++L)A.write_shift(-4,L<D[2]?D[1]+L:-1);A.write_shift(-4,J===D[1]-1?Se:J+1)}var de=function(je){for(J+=je;L<J-1;++L)A.write_shift(-4,L+1);je&&(++L,A.write_shift(-4,Se))};for(J=L=0,J+=D[1];L<J;++L)A.write_shift(-4,ze.DIFSECT);for(J+=D[2];L<J;++L)A.write_shift(-4,ze.FATSECT);de(D[3]),de(D[4]);for(var ie=0,ee=0,re=C.FileIndex[0];ie<C.FileIndex.length;++ie)re=C.FileIndex[ie],re.content&&(ee=re.content.length,!(ee<4096)&&(re.start=J,de(ee+511>>9)));for(de(D[6]+7>>3);A.l&511;)A.write_shift(-4,ze.ENDOFCHAIN);for(J=L=0,ie=0;ie<C.FileIndex.length;++ie)re=C.FileIndex[ie],re.content&&(ee=re.content.length,!(!ee||ee>=4096)&&(re.start=J,de(ee+63>>6)));for(;A.l&511;)A.write_shift(-4,ze.ENDOFCHAIN);for(L=0;L<D[4]<<2;++L){var we=C.FullPaths[L];if(!we||we.length===0){for(ie=0;ie<17;++ie)A.write_shift(4,0);for(ie=0;ie<3;++ie)A.write_shift(4,-1);for(ie=0;ie<12;++ie)A.write_shift(4,0);continue}re=C.FileIndex[L],L===0&&(re.start=re.size?re.start-1:Se);var Me=L===0&&E.root||re.name;if(ee=2*(Me.length+1),A.write_shift(64,Me,"utf16le"),A.write_shift(2,ee),A.write_shift(1,re.type),A.write_shift(1,re.color),A.write_shift(-4,re.L),A.write_shift(-4,re.R),A.write_shift(-4,re.C),re.clsid)A.write_shift(16,re.clsid,"hex");else for(ie=0;ie<4;++ie)A.write_shift(4,0);A.write_shift(4,re.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,re.start),A.write_shift(4,re.size),A.write_shift(4,0)}for(L=1;L<C.FileIndex.length;++L)if(re=C.FileIndex[L],re.size>=4096)if(A.l=re.start+1<<9,kt&&Buffer.isBuffer(re.content))re.content.copy(A,A.l,0,re.size),A.l+=re.size+511&-512;else{for(ie=0;ie<re.size;++ie)A.write_shift(1,re.content[ie]);for(;ie&511;++ie)A.write_shift(1,0)}for(L=1;L<C.FileIndex.length;++L)if(re=C.FileIndex[L],re.size>0&&re.size<4096)if(kt&&Buffer.isBuffer(re.content))re.content.copy(A,A.l,0,re.size),A.l+=re.size+63&-64;else{for(ie=0;ie<re.size;++ie)A.write_shift(1,re.content[ie]);for(;ie&63;++ie)A.write_shift(1,0)}if(kt)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function oe(C,O){var E=C.FullPaths.map(function(ie){return ie.toUpperCase()}),D=E.map(function(ie){var ee=ie.split("/");return ee[ee.length-(ie.slice(-1)=="/"?2:1)]}),A=!1;O.charCodeAt(0)===47?(A=!0,O=E[0].slice(0,-1)+O):A=O.indexOf("/")!==-1;var L=O.toUpperCase(),J=A===!0?E.indexOf(L):D.indexOf(L);if(J!==-1)return C.FileIndex[J];var de=!L.match(Is);for(L=L.replace(Qi,""),de&&(L=L.replace(Is,"!")),J=0;J<E.length;++J)if((de?E[J].replace(Is,"!"):E[J]).replace(Qi,"")==L||(de?D[J].replace(Is,"!"):D[J]).replace(Qi,"")==L)return C.FileIndex[J];return null}var q=64,Se=-2,Ne="d0cf11e0a1b11ae1",Ie=[208,207,17,224,161,177,26,225],Ye="00000000000000000000000000000000",ze={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Se,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ye,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Et(C,O,E){c();var D=ne(C,E);l.writeFileSync(O,D)}function Pe(C){for(var O=new Array(C.length),E=0;E<C.length;++E)O[E]=String.fromCharCode(C[E]);return O.join("")}function Ke(C,O){var E=ne(C,O);switch(O&&O.type||"buffer"){case"file":return c(),l.writeFileSync(O.filename,E),E;case"binary":return typeof E=="string"?E:Pe(E);case"base64":return Ps(typeof E=="string"?E:Pe(E));case"buffer":if(kt)return Buffer.isBuffer(E)?E:vr(E);case"array":return typeof E=="string"?bn(E):E}return E}var me;function B(C){try{var O=C.InflateRaw,E=new O;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)me=C;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function te(C,O){if(!me)return b0(C,O);var E=me.InflateRaw,D=new E,A=D._processChunk(C.slice(C.l),D._finishFlushFlag);return C.l+=D.bytesRead,A}function H(C){return me?me.deflateRawSync(C):Ft(C)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],pe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(C){var O=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(O>>16|O>>8|O)&255}for(var Te=typeof Uint8Array<"u",xe=Te?new Uint8Array(256):[],gt=0;gt<256;++gt)xe[gt]=Ce(gt);function P(C,O){var E=xe[C&255];return O<=8?E>>>8-O:(E=E<<8|xe[C>>8&255],O<=16?E>>>16-O:(E=E<<8|xe[C>>16&255],E>>>24-O))}function zt(C,O){var E=O&7,D=O>>>3;return(C[D]|(E<=6?0:C[D+1]<<8))>>>E&3}function Dt(C,O){var E=O&7,D=O>>>3;return(C[D]|(E<=5?0:C[D+1]<<8))>>>E&7}function Wt(C,O){var E=O&7,D=O>>>3;return(C[D]|(E<=4?0:C[D+1]<<8))>>>E&15}function Mt(C,O){var E=O&7,D=O>>>3;return(C[D]|(E<=3?0:C[D+1]<<8))>>>E&31}function Be(C,O){var E=O&7,D=O>>>3;return(C[D]|(E<=1?0:C[D+1]<<8))>>>E&127}function mi(C,O,E){var D=O&7,A=O>>>3,L=(1<<E)-1,J=C[A]>>>D;return E<8-D||(J|=C[A+1]<<8-D,E<16-D)||(J|=C[A+2]<<16-D,E<24-D)||(J|=C[A+3]<<24-D),J&L}function Cn(C,O,E){var D=O&7,A=O>>>3;return D<=5?C[A]|=(E&7)<<D:(C[A]|=E<<D&255,C[A+1]=(E&7)>>8-D),O+3}function Xn(C,O,E){var D=O&7,A=O>>>3;return E=(E&1)<<D,C[A]|=E,O+1}function or(C,O,E){var D=O&7,A=O>>>3;return E<<=D,C[A]|=E&255,E>>>=8,C[A+1]=E,O+8}function ps(C,O,E){var D=O&7,A=O>>>3;return E<<=D,C[A]|=E&255,E>>>=8,C[A+1]=E&255,C[A+2]=E>>>8,O+16}function wr(C,O){var E=C.length,D=2*E>O?2*E:O+5,A=0;if(E>=O)return C;if(kt){var L=yd(D);if(C.copy)C.copy(L);else for(;A<C.length;++A)L[A]=C[A];return L}else if(Te){var J=new Uint8Array(D);if(J.set)J.set(C);else for(;A<E;++A)J[A]=C[A];return J}return C.length=D,C}function hn(C){for(var O=new Array(C),E=0;E<C;++E)O[E]=0;return O}function lr(C,O,E){var D=1,A=0,L=0,J=0,de=0,ie=C.length,ee=Te?new Uint16Array(32):hn(32);for(L=0;L<32;++L)ee[L]=0;for(L=ie;L<E;++L)C[L]=0;ie=C.length;var re=Te?new Uint16Array(ie):hn(ie);for(L=0;L<ie;++L)ee[A=C[L]]++,D<A&&(D=A),re[L]=0;for(ee[0]=0,L=1;L<=D;++L)ee[L+16]=de=de+ee[L-1]<<1;for(L=0;L<ie;++L)de=C[L],de!=0&&(re[L]=ee[de+16]++);var we=0;for(L=0;L<ie;++L)if(we=C[L],we!=0)for(de=P(re[L],D)>>D-we,J=(1<<D+4-we)-1;J>=0;--J)O[de|J<<we]=we&15|L<<4;return D}var Cr=Te?new Uint16Array(512):hn(512),us=Te?new Uint16Array(32):hn(32);if(!Te){for(var nn=0;nn<512;++nn)Cr[nn]=0;for(nn=0;nn<32;++nn)us[nn]=0}(function(){for(var C=[],O=0;O<32;O++)C.push(5);lr(C,us,32);var E=[];for(O=0;O<=143;O++)E.push(8);for(;O<=255;O++)E.push(9);for(;O<=279;O++)E.push(7);for(;O<=287;O++)E.push(8);lr(E,Cr,288)})();var qn=function(){for(var O=Te?new Uint8Array(32768):[],E=0,D=0;E<Ae.length-1;++E)for(;D<Ae[E+1];++D)O[D]=E;for(;D<32768;++D)O[D]=29;var A=Te?new Uint8Array(259):[];for(E=0,D=0;E<pe.length-1;++E)for(;D<pe[E+1];++D)A[D]=E;function L(de,ie){for(var ee=0;ee<de.length;){var re=Math.min(65535,de.length-ee),we=ee+re==de.length;for(ie.write_shift(1,+we),ie.write_shift(2,re),ie.write_shift(2,~re&65535);re-- >0;)ie[ie.l++]=de[ee++]}return ie.l}function J(de,ie){for(var ee=0,re=0,we=Te?new Uint16Array(32768):[];re<de.length;){var Me=Math.min(65535,de.length-re);if(Me<10){for(ee=Cn(ie,ee,+(re+Me==de.length)),ee&7&&(ee+=8-(ee&7)),ie.l=ee/8|0,ie.write_shift(2,Me),ie.write_shift(2,~Me&65535);Me-- >0;)ie[ie.l++]=de[re++];ee=ie.l*8;continue}ee=Cn(ie,ee,+(re+Me==de.length)+2);for(var je=0;Me-- >0;){var Oe=de[re];je=(je<<5^Oe)&32767;var Ve=-1,mt=0;if((Ve=we[je])&&(Ve|=re&-32768,Ve>re&&(Ve-=32768),Ve<re))for(;de[Ve+mt]==de[re+mt]&&mt<250;)++mt;if(mt>2){Oe=A[mt],Oe<=22?ee=or(ie,ee,xe[Oe+1]>>1)-1:(or(ie,ee,3),ee+=5,or(ie,ee,xe[Oe-23]>>5),ee+=3);var Zt=Oe<8?0:Oe-4>>2;Zt>0&&(ps(ie,ee,mt-pe[Oe]),ee+=Zt),Oe=O[re-Ve],ee=or(ie,ee,xe[Oe]>>3),ee-=3;var on=Oe<4?0:Oe-2>>1;on>0&&(ps(ie,ee,re-Ve-Ae[Oe]),ee+=on);for(var bi=0;bi<mt;++bi)we[je]=re&32767,je=(je<<5^de[re])&32767,++re;Me-=mt-1}else Oe<=143?Oe=Oe+48:ee=Xn(ie,ee,1),ee=or(ie,ee,xe[Oe]),we[je]=re&32767,++re}ee=or(ie,ee,0)-1}return ie.l=(ee+7)/8|0,ie.l}return function(ie,ee){return ie.length<8?L(ie,ee):J(ie,ee)}}();function Ft(C){var O=ce(50+Math.floor(C.length*1.1)),E=qn(C,O);return O.slice(0,E)}var _i=Te?new Uint16Array(32768):hn(32768),Tn=Te?new Uint16Array(32768):hn(32768),Ei=Te?new Uint16Array(128):hn(128),qr=1,v0=1;function Xf(C,O){var E=Mt(C,O)+257;O+=5;var D=Mt(C,O)+1;O+=5;var A=Wt(C,O)+4;O+=4;for(var L=0,J=Te?new Uint8Array(19):hn(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ee=Te?new Uint8Array(8):hn(8),re=Te?new Uint8Array(8):hn(8),we=J.length,Me=0;Me<A;++Me)J[U[Me]]=L=Dt(C,O),ie<L&&(ie=L),ee[L]++,O+=3;var je=0;for(ee[0]=0,Me=1;Me<=ie;++Me)re[Me]=je=je+ee[Me-1]<<1;for(Me=0;Me<we;++Me)(je=J[Me])!=0&&(de[Me]=re[je]++);var Oe=0;for(Me=0;Me<we;++Me)if(Oe=J[Me],Oe!=0){je=xe[de[Me]]>>8-Oe;for(var Ve=(1<<7-Oe)-1;Ve>=0;--Ve)Ei[je|Ve<<Oe]=Oe&7|Me<<3}var mt=[];for(ie=1;mt.length<E+D;)switch(je=Ei[Be(C,O)],O+=je&7,je>>>=3){case 16:for(L=3+zt(C,O),O+=2,je=mt[mt.length-1];L-- >0;)mt.push(je);break;case 17:for(L=3+Dt(C,O),O+=3;L-- >0;)mt.push(0);break;case 18:for(L=11+Be(C,O),O+=7;L-- >0;)mt.push(0);break;default:mt.push(je),ie<je&&(ie=je);break}var Zt=mt.slice(0,E),on=mt.slice(E);for(Me=E;Me<286;++Me)Zt[Me]=0;for(Me=D;Me<30;++Me)on[Me]=0;return qr=lr(Zt,_i,286),v0=lr(on,Tn,30),O}function qf(C,O){if(C[0]==3&&!(C[1]&3))return[Wr(O),2];for(var E=0,D=0,A=yd(O||1<<18),L=0,J=A.length>>>0,de=0,ie=0;!(D&1);){if(D=Dt(C,E),E+=3,D>>>1)D>>1==1?(de=9,ie=5):(E=Xf(C,E),de=qr,ie=v0);else{E&7&&(E+=8-(E&7));var ee=C[E>>>3]|C[(E>>>3)+1]<<8;if(E+=32,ee>0)for(!O&&J<L+ee&&(A=wr(A,L+ee),J=A.length);ee-- >0;)A[L++]=C[E>>>3],E+=8;continue}for(;;){!O&&J<L+32767&&(A=wr(A,L+32767),J=A.length);var re=mi(C,E,de),we=D>>>1==1?Cr[re]:_i[re];if(E+=we&15,we>>>=4,!(we>>>8&255))A[L++]=we;else{if(we==256)break;we-=257;var Me=we<8?0:we-4>>2;Me>5&&(Me=0);var je=L+pe[we];Me>0&&(je+=mi(C,E,Me),E+=Me),re=mi(C,E,ie),we=D>>>1==1?us[re]:Tn[re],E+=we&15,we>>>=4;var Oe=we<4?0:we-2>>1,Ve=Ae[we];for(Oe>0&&(Ve+=mi(C,E,Oe),E+=Oe),!O&&J<je&&(A=wr(A,je+100),J=A.length);L<je;)A[L]=A[L-Ve],++L}}}return O?[A,E+7>>>3]:[A.slice(0,L),E+7>>>3]}function b0(C,O){var E=C.slice(C.l||0),D=qf(E,O);return C.l+=D[1],D[0]}function y0(C,O){if(C)typeof console<"u"&&console.error(O);else throw new Error(O)}function w0(C,O){var E=C;Hi(E,0);var D=[],A=[],L={FileIndex:D,FullPaths:A};M(L,{root:O.root});for(var J=E.length-4;(E[J]!=80||E[J+1]!=75||E[J+2]!=5||E[J+3]!=6)&&J>=0;)--J;E.l=J+4,E.l+=4;var de=E.read_shift(2);E.l+=6;var ie=E.read_shift(4);for(E.l=ie,J=0;J<de;++J){E.l+=20;var ee=E.read_shift(4),re=E.read_shift(4),we=E.read_shift(2),Me=E.read_shift(2),je=E.read_shift(2);E.l+=8;var Oe=E.read_shift(4),Ve=o(E.slice(E.l+we,E.l+we+Me));E.l+=we+Me+je;var mt=E.l;E.l=Oe+4,Zf(E,ee,re,L,Ve),E.l=mt}return L}function Zf(C,O,E,D,A){C.l+=2;var L=C.read_shift(2),J=C.read_shift(2),de=s(C);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var ie=C.read_shift(4),ee=C.read_shift(4),re=C.read_shift(4),we=C.read_shift(2),Me=C.read_shift(2),je="",Oe=0;Oe<we;++Oe)je+=String.fromCharCode(C[C.l++]);if(Me){var Ve=o(C.slice(C.l,C.l+Me));(Ve[21589]||{}).mt&&(de=Ve[21589].mt),((A||{})[21589]||{}).mt&&(de=A[21589].mt)}C.l+=Me;var mt=C.slice(C.l,C.l+ee);switch(J){case 8:mt=te(C,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+J)}var Zt=!1;L&8&&(ie=C.read_shift(4),ie==134695760&&(ie=C.read_shift(4),Zt=!0),ee=C.read_shift(4),re=C.read_shift(4)),ee!=O&&y0(Zt,"Bad compressed size: "+O+" != "+ee),re!=E&&y0(Zt,"Bad uncompressed size: "+E+" != "+re),hl(D,je,mt,{unsafe:!0,mt:de})}function Qf(C,O){var E=O||{},D=[],A=[],L=ce(1),J=E.compression?8:0,de=0,ie=!1;ie&&(de|=8);var ee=0,re=0,we=0,Me=0,je=C.FullPaths[0],Oe=je,Ve=C.FileIndex[0],mt=[],Zt=0;for(ee=1;ee<C.FullPaths.length;++ee)if(Oe=C.FullPaths[ee].slice(je.length),Ve=C.FileIndex[ee],!(!Ve.size||!Ve.content||Oe=="Sh33tJ5")){var on=we,bi=ce(Oe.length);for(re=0;re<Oe.length;++re)bi.write_shift(1,Oe.charCodeAt(re)&127);bi=bi.slice(0,bi.l),mt[Me]=lT.buf(Ve.content,0);var mn=Ve.content;J==8&&(mn=H(mn)),L=ce(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,de),L.write_shift(2,J),Ve.mt?a(L,Ve.mt):L.write_shift(4,0),L.write_shift(-4,de&8?0:mt[Me]),L.write_shift(4,de&8?0:mn.length),L.write_shift(4,de&8?0:Ve.content.length),L.write_shift(2,bi.length),L.write_shift(2,0),we+=L.length,D.push(L),we+=bi.length,D.push(bi),we+=mn.length,D.push(mn),de&8&&(L=ce(12),L.write_shift(-4,mt[Me]),L.write_shift(4,mn.length),L.write_shift(4,Ve.content.length),we+=L.l,D.push(L)),L=ce(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,de),L.write_shift(2,J),L.write_shift(4,0),L.write_shift(-4,mt[Me]),L.write_shift(4,mn.length),L.write_shift(4,Ve.content.length),L.write_shift(2,bi.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,on),Zt+=L.l,A.push(L),Zt+=bi.length,A.push(bi),++Me}return L=ce(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,Me),L.write_shift(2,Me),L.write_shift(4,Zt),L.write_shift(4,we),L.write_shift(2,0),Pi([Pi(D),Pi(A),L])}var ao={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Jf(C,O){if(C.ctype)return C.ctype;var E=C.name||"",D=E.match(/\.([^\.]+)$/);return D&&ao[D[1]]||O&&(D=(E=O).match(/[\.\\]([^\.\\])+$/),D&&ao[D[1]])?ao[D[1]]:"application/octet-stream"}function eh(C){for(var O=Ps(C),E=[],D=0;D<O.length;D+=76)E.push(O.slice(D,D+76));return E.join(`\r
`)+`\r
`}function th(C){var O=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var re=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});O=O.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),O.charAt(0)==`
`&&(O="=0D"+O.slice(1)),O=O.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],D=O.split(`\r
`),A=0;A<D.length;++A){var L=D[A];if(L.length==0){E.push("");continue}for(var J=0;J<L.length;){var de=76,ie=L.slice(J,J+de);ie.charAt(de-1)=="="?de--:ie.charAt(de-2)=="="?de-=2:ie.charAt(de-3)=="="&&(de-=3),ie=L.slice(J,J+de),J+=de,J<L.length&&(ie+="="),E.push(ie)}}return E.join(`\r
`)}function ih(C){for(var O=[],E=0;E<C.length;++E){for(var D=C[E];E<=C.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+C[++E];O.push(D)}for(var A=0;A<O.length;++A)O[A]=O[A].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return bn(O.join(`\r
`))}function nh(C,O,E){for(var D="",A="",L="",J,de=0;de<10;++de){var ie=O[de];if(!ie||ie.match(/^\s*$/))break;var ee=ie.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":D=ee[2].trim();break;case"content-type":L=ee[2].trim();break;case"content-transfer-encoding":A=ee[2].trim();break}}switch(++de,A.toLowerCase()){case"base64":J=bn(wn(O.slice(de).join("")));break;case"quoted-printable":J=ih(O.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var re=hl(C,D.slice(E.length),J,{unsafe:!0});L&&(re.ctype=L)}function rh(C,O){if(Pe(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=O&&O.root||"",D=(kt&&Buffer.isBuffer(C)?C.toString("binary"):Pe(C)).split(`\r
`),A=0,L="";for(A=0;A<D.length;++A)if(L=D[A],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),E||(E=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),L.slice(0,E.length)!=E););var J=(D[1]||"").match(/boundary="(.*?)"/);if(!J)throw new Error("MAD cannot find boundary");var de="--"+(J[1]||""),ie=[],ee=[],re={FileIndex:ie,FullPaths:ee};M(re);var we,Me=0;for(A=0;A<D.length;++A){var je=D[A];je!==de&&je!==de+"--"||(Me++&&nh(re,D.slice(we,A),E),we=A)}return re}function ah(C,O){var E=O||{},D=E.boundary||"SheetJS";D="------="+D;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],L=C.FullPaths[0],J=L,de=C.FileIndex[0],ie=1;ie<C.FullPaths.length;++ie)if(J=C.FullPaths[ie].slice(L.length),de=C.FileIndex[ie],!(!de.size||!de.content||J=="Sh33tJ5")){J=J.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var ee=de.content,re=kt&&Buffer.isBuffer(ee)?ee.toString("binary"):Pe(ee),we=0,Me=Math.min(1024,re.length),je=0,Oe=0;Oe<=Me;++Oe)(je=re.charCodeAt(Oe))>=32&&je<128&&++we;var Ve=we>=Me*4/5;A.push(D),A.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+J),A.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),A.push("Content-Type: "+Jf(de,J)),A.push(""),A.push(Ve?th(re):eh(re))}return A.push(D+`--\r
`),A.join(`\r
`)}function sh(C){var O={};return M(O,C),O}function hl(C,O,E,D){var A=D&&D.unsafe;A||M(C);var L=!A&&et.find(C,O);if(!L){var J=C.FullPaths[0];O.slice(0,J.length)==J?J=O:(J.slice(-1)!="/"&&(J+="/"),J=(J+O).replace("//","/")),L={name:r(O),type:2},C.FileIndex.push(L),C.FullPaths.push(J),A||et.utils.cfb_gc(C)}return L.content=E,L.size=E?E.length:0,D&&(D.CLSID&&(L.clsid=D.CLSID),D.mt&&(L.mt=D.mt),D.ct&&(L.ct=D.ct)),L}function oh(C,O){M(C);var E=et.find(C,O);if(E){for(var D=0;D<C.FileIndex.length;++D)if(C.FileIndex[D]==E)return C.FileIndex.splice(D,1),C.FullPaths.splice(D,1),!0}return!1}function lh(C,O,E){M(C);var D=et.find(C,O);if(D){for(var A=0;A<C.FileIndex.length;++A)if(C.FileIndex[A]==D)return C.FileIndex[A].name=r(E),C.FullPaths[A]=E,!0}return!1}function ch(C){j(C,!0)}return n.find=oe,n.read=z,n.parse=d,n.write=Ke,n.writeFile=Et,n.utils={cfb_new:sh,cfb_add:hl,cfb_del:oh,cfb_mov:lh,cfb_gc:ch,ReadShift:Es,CheckField:nu,prep_blob:Hi,bconcat:Pi,use_zlib:B,_deflateRaw:Ft,_inflateRaw:b0,consts:ze},n}(),qa;function cT(t){return typeof t=="string"?Qo(t):Array.isArray(t)?R3(t):t}function qs(t,n,e){if(typeof qa<"u"&&qa.writeFileSync)return e?qa.writeFileSync(t,n,e):qa.writeFileSync(t,n);if(typeof Deno<"u"){if(e&&typeof n=="string")switch(e){case"utf8":n=new TextEncoder(e).encode(n);break;case"binary":n=Qo(n);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,n)}var i=e=="utf8"?nr(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,t);if(typeof Blob<"u"){var r=new Blob([cT(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,t);if(typeof saveAs<"u")return saveAs(r,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=t,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(n)&&(n=$r(n)),o.write(n),o.close(),n}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function dT(t){if(typeof qa<"u")return qa.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(t);n.open("r"),n.encoding="binary";var e=n.read();return n.close(),e}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+t)}function hi(t){for(var n=Object.keys(t),e=[],i=0;i<n.length;++i)Object.prototype.hasOwnProperty.call(t,n[i])&&e.push(n[i]);return e}function Fd(t,n){for(var e=[],i=hi(t),r=0;r!==i.length;++r)e[t[i[r]][n]]==null&&(e[t[i[r]][n]]=i[r]);return e}function el(t){for(var n=[],e=hi(t),i=0;i!==e.length;++i)n[t[e[i]]]=e[i];return n}function tl(t){for(var n=[],e=hi(t),i=0;i!==e.length;++i)n[t[e[i]]]=parseInt(e[i],10);return n}function pT(t){for(var n=[],e=hi(t),i=0;i!==e.length;++i)n[t[e[i]]]==null&&(n[t[e[i]]]=[]),n[t[e[i]]].push(e[i]);return n}var zo=new Date(1899,11,30,0,0,0);function Oi(t,n){var e=t.getTime();n&&(e-=1462*24*60*60*1e3);var i=zo.getTime()+(t.getTimezoneOffset()-zo.getTimezoneOffset())*6e4;return(e-i)/(24*60*60*1e3)}var Up=new Date,uT=zo.getTime()+(Up.getTimezoneOffset()-zo.getTimezoneOffset())*6e4,Dd=Up.getTimezoneOffset();function il(t){var n=new Date;return n.setTime(t*24*60*60*1e3+uT),n.getTimezoneOffset()!==Dd&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Dd)*6e4),n}function fT(t){var n=0,e=0,i=!1,r=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=r.length;++a)if(r[a]){switch(e=1,a>3&&(i=!0),r[a].slice(r[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[a].slice(r[a].length-1));case"D":e*=24;case"H":e*=60;case"M":if(i)e*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}n+=e*parseInt(r[a],10)}return n}var Md=new Date("2017-02-19T19:06:09.000Z"),Hp=isNaN(Md.getFullYear())?new Date("2/19/17"):Md,hT=Hp.getFullYear()==2017;function ei(t,n){var e=new Date(t);if(hT)return n>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):n<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(Hp.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return t.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var r=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function la(t,n){if(kt&&Buffer.isBuffer(t)){if(n){if(t[0]==255&&t[1]==254)return nr(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return nr(Ep(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(t[0]==255&&t[1]==254)return nr(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return nr(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return e[a]||a})}catch{}for(var i=[],r=0;r!=t.length;++r)i.push(String.fromCharCode(t[r]));return i.join("")}function ti(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=ti(t[e]));return n}function pi(t,n){for(var e="";e.length<n;)e+=t;return e}function $n(t){var n=Number(t);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(t))return n;var e=1,i=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(n=Number(i))||(i=i.replace(/[(](.*)[)]/,function(r,a){return e=-e,a}),!isNaN(n=Number(i)))?n/e:n}var mT=["january","february","march","april","may","june","july","august","september","october","november","december"];function ns(t){var n=new Date(t),e=new Date(NaN),i=n.getYear(),r=n.getMonth(),a=n.getDate();if(isNaN(a))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&mT.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return i<0||i>8099?e:(r>0||a>1)&&i!=101?n:t.match(/[^-0-9:,\/\\]/)?e:n}var _T=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,i,r){if(t||typeof i=="string")return e.split(i);for(var a=e.split(i),s=[a[0]],o=1;o<a.length;++o)s.push(r),s.push(a[o]);return s}}();function zp(t){return t?t.content&&t.type?la(t.content,!0):t.data?Ss(t.data):t.asNodeBuffer&&kt?Ss(t.asNodeBuffer().toString("binary")):t.asBinary?Ss(t.asBinary()):t._data&&t._data.getContent?Ss(la(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Wp(t){if(!t)return null;if(t.data)return mc(t.data);if(t.asNodeBuffer&&kt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var n=t._data.getContent();return typeof n=="string"?mc(n):Array.prototype.slice.call(n)}return t.content&&t.type?t.content:null}function gT(t){return t&&t.name.slice(-4)===".bin"?Wp(t):zp(t)}function Vn(t,n){for(var e=t.FullPaths||hi(t.files),i=n.toLowerCase().replace(/[\/]/g,"\\"),r=i.replace(/\\/g,"/"),a=0;a<e.length;++a){var s=e[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==s||r==s)return t.files?t.files[e[a]]:t.FileIndex[a]}return null}function Ac(t,n){var e=Vn(t,n);if(e==null)throw new Error("Cannot find file "+n+" in zip");return e}function Ii(t,n,e){if(!e)return gT(Ac(t,n));if(!n)return null;try{return Ii(t,n)}catch{return null}}function yn(t,n,e){if(!e)return zp(Ac(t,n));if(!n)return null;try{return yn(t,n)}catch{return null}}function jp(t,n,e){if(!e)return Wp(Ac(t,n));if(!n)return null;try{return jp(t,n)}catch{return null}}function Od(t){for(var n=t.FullPaths||hi(t.files),e=[],i=0;i<n.length;++i)n[i].slice(-1)!="/"&&e.push(n[i].replace(/^Root Entry[\/]/,""));return e.sort()}function wt(t,n,e){if(t.FullPaths){if(typeof e=="string"){var i;return kt?i=vr(e):i=V3(e),et.utils.cfb_add(t,n,i)}et.utils.cfb_add(t,n,e)}else t.file(n,e)}function Lc(){return et.utils.cfb_new()}function Kp(t,n){switch(n.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ks(t,n){if(t.charAt(0)=="/")return t.slice(1);var e=n.split("/");n.slice(-1)!="/"&&e.pop();for(var i=t.split("/");i.length!==0;){var r=i.shift();r===".."?e.pop():r!=="."&&e.push(r)}return e.join("/")}var vi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ad=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,vT=/<[^>]*>/g,tn=vi.match(Ad)?Ad:vT,bT=/<\w*:/,yT=/<(\/?)\w+:/;function ut(t,n,e){for(var i={},r=0,a=0;r!==t.length&&!((a=t.charCodeAt(r))===32||a===10||a===13);++r);if(n||(i[0]=t.slice(0,r)),r===t.length)return i;var s=t.match(xT),o=0,l="",c=0,d="",h="",_=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(d=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(_=(r=h.charCodeAt(a+1))==34||r==39?1:0,l=h.slice(a+1+_,h.length-_),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),i[d]=l,e||(i[d.toLowerCase()]=l);else{var v=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(i[v]&&d.slice(o-3,o)=="ext")continue;i[v]=l,e||(i[v.toLowerCase()]=l)}}return i}function ar(t){return t.replace(yT,"<$1")}var Gp={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rc=el(Gp),Vt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function e(i){var r=i+"",a=r.indexOf("<![CDATA[");if(a==-1)return r.replace(t,function(o,l){return Gp[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(n,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=r.indexOf("]]>");return e(r.slice(0,a))+r.slice(a+9,s)+e(r.slice(s+3))}}(),Vc=/[&<>'"]/g,wT=/[\u0000-\u0008\u000b-\u001f]/g;function Gt(t){var n=t+"";return n.replace(Vc,function(e){return Rc[e]}).replace(wT,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ld(t){return Gt(t).replace(/ /g,"_x0020_")}var $p=/[\u0000-\u001f]/g;function Pc(t){var n=t+"";return n.replace(Vc,function(e){return Rc[e]}).replace(/\n/g,"<br/>").replace($p,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function CT(t){var n=t+"";return n.replace(Vc,function(e){return Rc[e]}).replace($p,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var Rd=function(){var t=/&#(\d+);/g;function n(e,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(t,n)}}();function TT(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Jt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ic(t){for(var n="",e=0,i=0,r=0,a=0,s=0,o=0;e<t.length;){if(i=t.charCodeAt(e++),i<128){n+=String.fromCharCode(i);continue}if(r=t.charCodeAt(e++),i>191&&i<224){s=(i&31)<<6,s|=r&63,n+=String.fromCharCode(s);continue}if(a=t.charCodeAt(e++),i<240){n+=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63);continue}s=t.charCodeAt(e++),o=((i&7)<<18|(r&63)<<12|(a&63)<<6|s&63)-65536,n+=String.fromCharCode(55296+(o>>>10&1023)),n+=String.fromCharCode(56320+(o&1023))}return n}function Vd(t){var n=Wr(2*t.length),e,i,r=1,a=0,s=0,o;for(i=0;i<t.length;i+=r)r=1,(o=t.charCodeAt(i))<128?e=o:o<224?(e=(o&31)*64+(t.charCodeAt(i+1)&63),r=2):o<240?(e=(o&15)*4096+(t.charCodeAt(i+1)&63)*64+(t.charCodeAt(i+2)&63),r=3):(r=4,e=(o&7)*262144+(t.charCodeAt(i+1)&63)*4096+(t.charCodeAt(i+2)&63)*64+(t.charCodeAt(i+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(n[a++]=s&255,n[a++]=s>>>8,s=0),n[a++]=e%256,n[a++]=e>>>8;return n.slice(0,a).toString("ucs2")}function Pd(t){return vr(t,"binary").toString("utf8")}var Fo="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Xt=kt&&(Pd(Fo)==ic(Fo)&&Pd||Vd(Fo)==ic(Fo)&&Vd)||ic,nr=kt?function(t){return vr(t,"utf8").toString("binary")}:function(t){for(var n=[],e=0,i=0,r=0;e<t.length;)switch(i=t.charCodeAt(e++),!0){case i<128:n.push(String.fromCharCode(i));break;case i<2048:n.push(String.fromCharCode(192+(i>>6))),n.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=t.charCodeAt(e++)-56320+(i<<10),n.push(String.fromCharCode(240+(r>>18&7))),n.push(String.fromCharCode(144+(r>>12&63))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)));break;default:n.push(String.fromCharCode(224+(i>>12))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)))}return n.join("")},Ns=function(){var t={};return function(e,i){var r=e+"|"+(i||"");return t[r]?t[r]:t[r]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",i||"")}}(),Yp=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<t.length;++r)i=i.replace(t[r][0],t[r][1]);return i}}(),ST=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),IT=/<\/?(?:vt:)?variant>/g,kT=/<(?:vt:)([^>]*)>([\s\S]*)</;function Bd(t,n){var e=ut(t),i=t.match(ST(e.baseType))||[],r=[];if(i.length!=e.size){if(n.WTF)throw new Error("unexpected vector length "+i.length+" != "+e.size);return r}return i.forEach(function(a){var s=a.replace(IT,"").match(kT);s&&r.push({v:Xt(s[2]),t:s[1]})}),r}var Xp=/(^\s|\s$|\n)/;function zi(t,n){return"<"+t+(n.match(Xp)?' xml:space="preserve"':"")+">"+n+"</"+t+">"}function Us(t){return hi(t).map(function(n){return" "+n+'="'+t[n]+'"'}).join("")}function ke(t,n,e){return"<"+t+(e!=null?Us(e):"")+(n!=null?(n.match(Xp)?' xml:space="preserve"':"")+">"+n+"</"+t:"/")+">"}function _c(t,n){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(n)throw e}return""}function ET(t,n){switch(typeof t){case"string":var e=ke("vt:lpwstr",Gt(t));return n&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return ke((t|0)==t?"vt:i4":"vt:r8",Gt(String(t)));case"boolean":return ke("vt:bool",t?"true":"false")}if(t instanceof Date)return ke("vt:filetime",_c(t));throw new Error("Unable to serialize "+t)}function Bc(t){if(kt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Xt($r(Dc(t)));throw new Error("Bad input format: expected Buffer or string")}var Hs=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Mi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],vn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function FT(t,n){for(var e=1-2*(t[n+7]>>>7),i=((t[n+7]&127)<<4)+(t[n+6]>>>4&15),r=t[n+6]&15,a=5;a>=0;--a)r=r*256+t[n+a];return i==2047?r==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),e*Math.pow(2,i-52)*r)}function DT(t,n,e){var i=(n<0||1/n==-1/0?1:0)<<7,r=0,a=0,s=i?-n:n;isFinite(s)?s==0?r=a=0:(r=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(n)?26985:0);for(var o=0;o<=5;++o,a/=256)t[e+o]=a&255;t[e+6]=(r&15)<<4|a&15,t[e+7]=r>>4|i}var Nd=function(t){for(var n=[],e=10240,i=0;i<t[0].length;++i)if(t[0][i])for(var r=0,a=t[0][i].length;r<a;r+=e)n.push.apply(n,t[0][i].slice(r,r+e));return n},Ud=kt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(n){return Buffer.isBuffer(n)?n:vr(n)})):Nd(t)}:Nd,Hd=function(t,n,e){for(var i=[],r=n;r<e;r+=2)i.push(String.fromCharCode(hr(t,r)));return i.join("").replace(Qi,"")},nl=kt?function(t,n,e){return Buffer.isBuffer(t)?t.toString("utf16le",n,e).replace(Qi,""):Hd(t,n,e)}:Hd,zd=function(t,n,e){for(var i=[],r=n;r<n+e;++r)i.push(("0"+t[r].toString(16)).slice(-2));return i.join("")},qp=kt?function(t,n,e){return Buffer.isBuffer(t)?t.toString("hex",n,n+e):zd(t,n,e)}:zd,Wd=function(t,n,e){for(var i=[],r=n;r<e;r++)i.push(String.fromCharCode(Xa(t,r)));return i.join("")},ls=kt?function(n,e,i){return Buffer.isBuffer(n)?n.toString("utf8",e,i):Wd(n,e,i)}:Wd,Zp=function(t,n){var e=Vi(t,n);return e>0?ls(t,n+4,n+4+e-1):""},Nc=Zp,Qp=function(t,n){var e=Vi(t,n);return e>0?ls(t,n+4,n+4+e-1):""},Uc=Qp,Jp=function(t,n){var e=2*Vi(t,n);return e>0?ls(t,n+4,n+4+e-1):""},Hc=Jp,eu=function(n,e){var i=Vi(n,e);return i>0?nl(n,e+4,e+4+i):""},zc=eu,tu=function(t,n){var e=Vi(t,n);return e>0?ls(t,n+4,n+4+e):""},Wc=tu,iu=function(t,n){return FT(t,n)},Wo=iu,jc=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};kt&&(Nc=function(n,e){if(!Buffer.isBuffer(n))return Zp(n,e);var i=n.readUInt32LE(e);return i>0?n.toString("utf8",e+4,e+4+i-1):""},Uc=function(n,e){if(!Buffer.isBuffer(n))return Qp(n,e);var i=n.readUInt32LE(e);return i>0?n.toString("utf8",e+4,e+4+i-1):""},Hc=function(n,e){if(!Buffer.isBuffer(n))return Jp(n,e);var i=2*n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+i-1)},zc=function(n,e){if(!Buffer.isBuffer(n))return eu(n,e);var i=n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+i)},Wc=function(n,e){if(!Buffer.isBuffer(n))return tu(n,e);var i=n.readUInt32LE(e);return n.toString("utf8",e+4,e+4+i)},Wo=function(n,e){return Buffer.isBuffer(n)?n.readDoubleLE(e):iu(n,e)},jc=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function MT(){nl=function(t,n,e){return Ht.utils.decode(1200,t.slice(n,e)).replace(Qi,"")},ls=function(t,n,e){return Ht.utils.decode(65001,t.slice(n,e))},Nc=function(t,n){var e=Vi(t,n);return e>0?Ht.utils.decode(is,t.slice(n+4,n+4+e-1)):""},Uc=function(t,n){var e=Vi(t,n);return e>0?Ht.utils.decode(rr,t.slice(n+4,n+4+e-1)):""},Hc=function(t,n){var e=2*Vi(t,n);return e>0?Ht.utils.decode(1200,t.slice(n+4,n+4+e-1)):""},zc=function(t,n){var e=Vi(t,n);return e>0?Ht.utils.decode(1200,t.slice(n+4,n+4+e)):""},Wc=function(t,n){var e=Vi(t,n);return e>0?Ht.utils.decode(65001,t.slice(n+4,n+4+e)):""}}typeof Ht<"u"&&MT();var Xa=function(t,n){return t[n]},hr=function(t,n){return t[n+1]*256+t[n]},OT=function(t,n){var e=t[n+1]*256+t[n];return e<32768?e:(65535-e+1)*-1},Vi=function(t,n){return t[n+3]*(1<<24)+(t[n+2]<<16)+(t[n+1]<<8)+t[n]},ta=function(t,n){return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]},AT=function(t,n){return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]};function Es(t,n){var e="",i,r,a=[],s,o,l,c;switch(n){case"dbcs":if(c=this.l,kt&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)e+=String.fromCharCode(hr(this,c)),c+=2;t*=2;break;case"utf8":e=ls(this,this.l,this.l+t);break;case"utf16le":t*=2,e=nl(this,this.l,this.l+t);break;case"wstr":if(typeof Ht<"u")e=Ht.utils.decode(rr,this.slice(this.l,this.l+2*t));else return Es.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":e=Nc(this,this.l),t=4+Vi(this,this.l);break;case"lpstr-cp":e=Uc(this,this.l),t=4+Vi(this,this.l);break;case"lpwstr":e=Hc(this,this.l),t=4+2*Vi(this,this.l);break;case"lpp4":t=4+Vi(this,this.l),e=zc(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Vi(this,this.l),e=Wc(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(s=Xa(this,this.l+t++))!==0;)a.push(Eo(s));e=a.join("");break;case"_wstr":for(t=0,e="";(s=hr(this,this.l+t))!==0;)a.push(Eo(s)),t+=2;t+=2,e=a.join("");break;case"dbcs-cont":for(e="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Xa(this,c),this.l=c+1,o=Es.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Eo(hr(this,c))),c+=2}e=a.join(""),t*=2;break;case"cpstr":if(typeof Ht<"u"){e=Ht.utils.decode(rr,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(e="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Xa(this,c),this.l=c+1,o=Es.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Eo(Xa(this,c))),c+=1}e=a.join("");break;default:switch(t){case 1:return i=Xa(this,this.l),this.l++,i;case 2:return i=(n==="i"?OT:hr)(this,this.l),this.l+=2,i;case 4:case-4:return n==="i"||!(this[this.l+3]&128)?(i=(t>0?ta:AT)(this,this.l),this.l+=4,i):(r=Vi(this,this.l),this.l+=4,r);case 8:case-8:if(n==="f")return t==8?r=Wo(this,this.l):r=Wo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;t=8;case 16:e=qp(this,this.l,t);break}}return this.l+=t,e}var LT=function(t,n,e){t[e]=n&255,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24&255},RT=function(t,n,e){t[e]=n&255,t[e+1]=n>>8&255,t[e+2]=n>>16&255,t[e+3]=n>>24&255},VT=function(t,n,e){t[e]=n&255,t[e+1]=n>>>8&255};function PT(t,n,e){var i=0,r=0;if(e==="dbcs"){for(r=0;r!=n.length;++r)VT(this,n.charCodeAt(r),this.l+2*r);i=2*n.length}else if(e==="sbcs"){if(typeof Ht<"u"&&is==874)for(r=0;r!=n.length;++r){var a=Ht.utils.encode(is,n.charAt(r));this[this.l+r]=a[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=n.length;++r)this[this.l+r]=n.charCodeAt(r)&255;i=n.length}else if(e==="hex"){for(;r<t;++r)this[this.l++]=parseInt(n.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+t,this.length);for(r=0;r<Math.min(n.length,t);++r){var o=n.charCodeAt(r);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:i=1,this[this.l]=n&255;break;case 2:i=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:i=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:i=4,LT(this,n,this.l);break;case 8:if(i=8,e==="f"){DT(this,n,this.l);break}case 16:break;case-4:i=4,RT(this,n,this.l);break}return this.l+=i,this}function nu(t,n){var e=qp(this,this.l,t.length>>1);if(e!==t)throw new Error(n+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Hi(t,n){t.l=n,t.read_shift=Es,t.chk=nu,t.write_shift=PT}function en(t,n){t.l+=n}function ce(t){var n=Wr(t);return Hi(n,0),n}function br(t,n,e){if(t){var i,r,a;Hi(t,t.l||0);for(var s=t.length,o=0,l=0;t.l<s;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=$s[o]||$s[65535];for(i=t.read_shift(1),a=i&127,r=1;r<4&&i&128;++r)a+=((i=t.read_shift(1))&127)<<7*r;l=t.l+a;var d=c.f&&c.f(t,a,e);if(t.l=l,n(d,c,o))return}}}function un(){var t=[],n=kt?256:2048,e=function(c){var d=ce(c);return Hi(d,0),d},i=e(n),r=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&t.push(i),i=null)},a=function(c){return i&&c<i.length-i.l?i:(r(),i=e(Math.max(c+1,n)))},s=function(){return r(),Pi(t)},o=function(c){r(),i=c,i.l==null&&(i.l=i.length),a(n)};return{next:a,push:o,end:s,_bufs:t}}function ve(t,n,e,i){var r=+n,a;if(!isNaN(r)){i||(i=$s[r].p||(e||[]).length||0),a=1+(r>=128?1:0)+1,i>=128&&++a,i>=16384&&++a,i>=2097152&&++a;var s=t.next(a);r<=127?s.write_shift(1,r):(s.write_shift(1,(r&127)+128),s.write_shift(1,r>>7));for(var o=0;o!=4;++o)if(i>=128)s.write_shift(1,(i&127)+128),i>>=7;else{s.write_shift(1,i);break}i>0&&jc(e)&&t.push(e)}}function Fs(t,n,e){var i=ti(t);if(n.s?(i.cRel&&(i.c+=n.s.c),i.rRel&&(i.r+=n.s.r)):(i.cRel&&(i.c+=n.c),i.rRel&&(i.r+=n.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function jd(t,n,e){var i=ti(t);return i.s=Fs(i.s,n.s,e),i.e=Fs(i.e,n.s,e),i}function Ds(t,n){if(t.cRel&&t.c<0)for(t=ti(t);t.c<0;)t.c+=n>8?16384:256;if(t.rRel&&t.r<0)for(t=ti(t);t.r<0;)t.r+=n>8?1048576:n>5?65536:16384;var e=dt(t);return!t.cRel&&t.cRel!=null&&(e=UT(e)),!t.rRel&&t.rRel!=null&&(e=BT(e)),e}function nc(t,n){return t.s.r==0&&!t.s.rRel&&t.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ci(t.s.c)+":"+(t.e.cRel?"":"$")+ci(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(n.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+xi(t.s.r)+":"+(t.e.rRel?"":"$")+xi(t.e.r):Ds(t.s,n.biff)+":"+Ds(t.e,n.biff)}function Kc(t){return parseInt(NT(t),10)-1}function xi(t){return""+(t+1)}function BT(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function NT(t){return t.replace(/\$(\d+)$/,"$1")}function Gc(t){for(var n=HT(t),e=0,i=0;i!==n.length;++i)e=26*e+n.charCodeAt(i)-64;return e-1}function ci(t){if(t<0)throw new Error("invalid column "+t);var n="";for(++t;t;t=Math.floor((t-1)/26))n=String.fromCharCode((t-1)%26+65)+n;return n}function UT(t){return t.replace(/^([A-Z])/,"$$$1")}function HT(t){return t.replace(/^\$([A-Z])/,"$1")}function zT(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function di(t){for(var n=0,e=0,i=0;i<t.length;++i){var r=t.charCodeAt(i);r>=48&&r<=57?n=10*n+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:n-1}}function dt(t){for(var n=t.c+1,e="";n;n=(n-1)/26|0)e=String.fromCharCode((n-1)%26+65)+e;return e+(t.r+1)}function fn(t){var n=t.indexOf(":");return n==-1?{s:di(t),e:di(t)}:{s:di(t.slice(0,n)),e:di(t.slice(n+1))}}function yt(t,n){return typeof n>"u"||typeof n=="number"?yt(t.s,t.e):(typeof t!="string"&&(t=dt(t)),typeof n!="string"&&(n=dt(n)),t==n?t:t+":"+n)}function Pt(t){var n={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,r=0,a=t.length;for(e=0;i<a&&!((r=t.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(n.s.c=--e,e=0;i<a&&!((r=t.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;if(n.s.r=--e,i===a||r!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++i,e=0;i!=a&&!((r=t.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(n.e.c=--e,e=0;i!=a&&!((r=t.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;return n.e.r=--e,n}function Kd(t,n){var e=t.t=="d"&&n instanceof Date;if(t.z!=null)try{return t.w=Nn(t.z,e?Oi(n):n)}catch{}try{return t.w=Nn((t.XF||{}).numFmtId||(e?14:0),e?Oi(n):n)}catch{return""+n}}function xr(t,n,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?yr[t.v]||t.v:n==null?Kd(t,t.v):Kd(t,n))}function Yr(t,n){var e=n&&n.sheet?n.sheet:"Sheet1",i={};return i[e]=t,{SheetNames:[e],Sheets:i}}function ru(t,n,e){var i=e||{},r=t?Array.isArray(t):i.dense;fi!=null&&r==null&&(r=fi);var a=t||(r?[]:{}),s=0,o=0;if(a&&i.origin!=null){if(typeof i.origin=="number")s=i.origin;else{var l=typeof i.origin=="string"?di(i.origin):i.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=Pt(a["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),s==-1&&(c.e.r=s=d.e.r+1)}for(var h=0;h!=n.length;++h)if(n[h]){if(!Array.isArray(n[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=n[h].length;++_)if(!(typeof n[h][_]>"u")){var v={v:n[h][_]},b=s+h,m=o+_;if(c.s.r>b&&(c.s.r=b),c.s.c>m&&(c.s.c=m),c.e.r<b&&(c.e.r=b),c.e.c<m&&(c.e.c=m),n[h][_]&&typeof n[h][_]=="object"&&!Array.isArray(n[h][_])&&!(n[h][_]instanceof Date))v=n[h][_];else if(Array.isArray(v.v)&&(v.f=n[h][_][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(i.nullError)v.t="e",v.v=0;else if(i.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=i.dateNF||lt[14],i.cellDates?(v.t="d",v.w=Nn(v.z,Oi(v.v))):(v.t="n",v.v=Oi(v.v),v.w=Nn(v.z,v.v))):v.t="s";if(r)a[b]||(a[b]=[]),a[b][m]&&a[b][m].z&&(v.z=a[b][m].z),a[b][m]=v;else{var y=dt({c:m,r:b});a[y]&&a[y].z&&(v.z=a[y].z),a[y]=v}}}return c.s.c<1e7&&(a["!ref"]=yt(c)),a}function cs(t,n){return ru(null,t,n)}function WT(t){return t.read_shift(4,"i")}function Yn(t,n){return n||(n=ce(4)),n.write_shift(4,t),n}function Ji(t){var n=t.read_shift(4);return n===0?"":t.read_shift(n,"dbcs")}function Bi(t,n){var e=!1;return n==null&&(e=!0,n=ce(4+2*t.length)),n.write_shift(4,t.length),t.length>0&&n.write_shift(0,t,"dbcs"),e?n.slice(0,n.l):n}function jT(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function KT(t,n){return n||(n=ce(4)),n.write_shift(2,t.ich||0),n.write_shift(2,t.ifnt||0),n}function $c(t,n){var e=t.l,i=t.read_shift(1),r=Ji(t),a=[],s={t:r,h:r};if(i&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(jT(t));s.r=a}else s.r=[{ich:0,ifnt:0}];return t.l=e+n,s}function GT(t,n){var e=!1;return n==null&&(e=!0,n=ce(15+4*t.t.length)),n.write_shift(1,0),Bi(t.t,n),e?n.slice(0,n.l):n}var $T=$c;function YT(t,n){var e=!1;return n==null&&(e=!0,n=ce(23+4*t.t.length)),n.write_shift(1,1),Bi(t.t,n),n.write_shift(4,1),KT({ich:0,ifnt:0},n),e?n.slice(0,n.l):n}function Un(t){var n=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:n,iStyleRef:e}}function ha(t,n){return n==null&&(n=ce(8)),n.write_shift(-4,t.c),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}function ma(t){var n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:n}}function _a(t,n){return n==null&&(n=ce(4)),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}var XT=Ji,au=Bi;function Yc(t){var n=t.read_shift(4);return n===0||n===4294967295?"":t.read_shift(n,"dbcs")}function jo(t,n){var e=!1;return n==null&&(e=!0,n=ce(127)),n.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&n.write_shift(0,t,"dbcs"),e?n.slice(0,n.l):n}var qT=Ji,gc=Yc,Xc=jo;function qc(t){var n=t.slice(t.l,t.l+4),e=n[0]&1,i=n[0]&2;t.l+=4;var r=i===0?Wo([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):ta(n,0)>>2;return e?r/100:r}function su(t,n){n==null&&(n=ce(4));var e=0,i=0,r=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?i=1:r==(r|0)&&r>=-(1<<29)&&r<1<<29&&(i=1,e=1),i)n.write_shift(-4,((e?r:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function ou(t){var n={s:{},e:{}};return n.s.r=t.read_shift(4),n.e.r=t.read_shift(4),n.s.c=t.read_shift(4),n.e.c=t.read_shift(4),n}function ZT(t,n){return n||(n=ce(16)),n.write_shift(4,t.s.r),n.write_shift(4,t.e.r),n.write_shift(4,t.s.c),n.write_shift(4,t.e.c),n}var ga=ou,ds=ZT;function Zi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ca(t,n){return(n||ce(8)).write_shift(8,t,"f")}function QT(t){var n={},e=t.read_shift(1),i=e>>>1,r=t.read_shift(1),a=t.read_shift(2,"i"),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,i){case 0:n.auto=1;break;case 1:n.index=r;var c=na[r];c&&(n.rgb=Ws(c));break;case 2:n.rgb=Ws([s,o,l]);break;case 3:n.theme=r;break}return a!=0&&(n.tint=a>0?a/32767:a/32768),n}function Ko(t,n){if(n||(n=ce(8)),!t||t.auto)return n.write_shift(4,0),n.write_shift(4,0),n;t.index!=null?(n.write_shift(1,2),n.write_shift(1,t.index)):t.theme!=null?(n.write_shift(1,6),n.write_shift(1,t.theme)):(n.write_shift(1,5),n.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),n.write_shift(2,e),!t.rgb||t.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var i=t.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),n.write_shift(1,parseInt(i.slice(0,2),16)),n.write_shift(1,parseInt(i.slice(2,4),16)),n.write_shift(1,parseInt(i.slice(4,6),16)),n.write_shift(1,255)}return n}function JT(t){var n=t.read_shift(1);t.l++;var e={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return e}function e4(t,n){n||(n=ce(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return n.write_shift(1,e),n.write_shift(1,0),n}function lu(t,n){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=t.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return t.l-=4,t.read_shift(0,n==1?"lpstr":"lpwstr")}function t4(t){return lu(t,1)}function i4(t){return lu(t,2)}var Zc=2,pn=3,Do=11,Gd=12,Go=19;var Mo=64,n4=65,r4=71;var a4=4108,s4=4126,Ri=80,cu=81,o4=[Ri,cu],xc={1:{n:"CodePage",t:Zc},2:{n:"Category",t:Ri},3:{n:"PresentationFormat",t:Ri},4:{n:"ByteCount",t:pn},5:{n:"LineCount",t:pn},6:{n:"ParagraphCount",t:pn},7:{n:"SlideCount",t:pn},8:{n:"NoteCount",t:pn},9:{n:"HiddenCount",t:pn},10:{n:"MultimediaClipCount",t:pn},11:{n:"ScaleCrop",t:Do},12:{n:"HeadingPairs",t:a4},13:{n:"TitlesOfParts",t:s4},14:{n:"Manager",t:Ri},15:{n:"Company",t:Ri},16:{n:"LinksUpToDate",t:Do},17:{n:"CharacterCount",t:pn},19:{n:"SharedDoc",t:Do},22:{n:"HyperlinksChanged",t:Do},23:{n:"AppVersion",t:pn,p:"version"},24:{n:"DigSig",t:n4},26:{n:"ContentType",t:Ri},27:{n:"ContentStatus",t:Ri},28:{n:"Language",t:Ri},29:{n:"Version",t:Ri},255:{},2147483648:{n:"Locale",t:Go},2147483651:{n:"Behavior",t:Go},1919054434:{}},vc={1:{n:"CodePage",t:Zc},2:{n:"Title",t:Ri},3:{n:"Subject",t:Ri},4:{n:"Author",t:Ri},5:{n:"Keywords",t:Ri},6:{n:"Comments",t:Ri},7:{n:"Template",t:Ri},8:{n:"LastAuthor",t:Ri},9:{n:"RevNumber",t:Ri},10:{n:"EditTime",t:Mo},11:{n:"LastPrinted",t:Mo},12:{n:"CreatedDate",t:Mo},13:{n:"ModifiedDate",t:Mo},14:{n:"PageCount",t:pn},15:{n:"WordCount",t:pn},16:{n:"CharCount",t:pn},17:{n:"Thumbnail",t:r4},18:{n:"Application",t:Ri},19:{n:"DocSecurity",t:pn},255:{},2147483648:{n:"Locale",t:Go},2147483651:{n:"Behavior",t:Go},1919054434:{}},$d={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},l4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function c4(t){return t.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var d4=c4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),na=ti(d4),yr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},du={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},bc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Oo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Qc(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function p4(t){var n=Qc();if(!t||!t.match)return n;var e={};if((t.match(tn)||[]).forEach(function(i){var r=ut(i);switch(r[0].replace(bT,"<")){case"<?xml":break;case"<Types":n.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[r.Extension]=r.ContentType;break;case"<Override":n[bc[r.ContentType]]!==void 0&&n[bc[r.ContentType]].push(r.PartName);break}}),n.xmlns!==Mi.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=e,delete n.calcchains,n}function pu(t,n){var e=pT(bc),i=[],r;i[i.length]=vi,i[i.length]=ke("Types",null,{xmlns:Mi.CT,"xmlns:xsd":Mi.xsd,"xmlns:xsi":Mi.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ke("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){t[l]&&t[l].length>0&&(r=t[l][0],i[i.length]=ke("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:Oo[l][n.bookType]||Oo[l].xlsx}))},s=function(l){(t[l]||[]).forEach(function(c){i[i.length]=ke("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Oo[l][n.bookType]||Oo[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){i[i.length]=ke("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:e[l][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zs(t){var n=t.lastIndexOf("/");return t.slice(0,n+1)+"_rels/"+t.slice(n+1)+".rels"}function Ms(t,n){var e={"!id":{}};if(!t)return e;n.charAt(0)!=="/"&&(n="/"+n);var i={};return(t.match(tn)||[]).forEach(function(r){var a=ut(r);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:ks(a.Target,n);e[o]=s,i[a.Id]=s}}),e["!id"]=i,e}function Ja(t){var n=[vi,ke("Relationships",null,{xmlns:Mi.RELS})];return hi(t["!id"]).forEach(function(e){n[n.length]=ke("Relationship",null,t["!id"][e])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function Kt(t,n,e,i,r,a){if(r||(r={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),n<0)for(n=t["!idx"];t["!id"]["rId"+n];++n);if(t["!idx"]=n+1,r.Id="rId"+n,r.Type=i,r.Target=e,a?r.TargetMode=a:[Ct.HLINK,Ct.XPATH,Ct.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),t["!id"][r.Id])throw new Error("Cannot rewrite rId "+n);return t["!id"][r.Id]=r,t[("/"+r.Target).replace("//","/")]=r,n}var u4="application/vnd.oasis.opendocument.spreadsheet";function f4(t,n){for(var e=Bc(t),i,r;i=Hs.exec(e);)switch(i[3]){case"manifest":break;case"file-entry":if(r=ut(i[0],!1),r.path=="/"&&r.type!==u4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw i}}function h4(t){var n=[vi];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)n.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function Yd(t,n,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function m4(t,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function _4(t){var n=[vi];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)n.push(Yd(t[e][0],t[e][1])),n.push(m4("",t[e][0]));return n.push(Yd("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function uu(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Vs.version+"</meta:generator></office:meta></office:document-meta>"}var Bn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],g4=function(){for(var t=new Array(Bn.length),n=0;n<Bn.length;++n){var e=Bn[n],i="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[n]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return t}();function fu(t){var n={};t=Xt(t);for(var e=0;e<Bn.length;++e){var i=Bn[e],r=t.match(g4[e]);r!=null&&r.length>0&&(n[i[1]]=Vt(r[1])),i[2]==="date"&&n[i[1]]&&(n[i[1]]=ei(n[i[1]]))}return n}function rc(t,n,e,i,r){r[t]!=null||n==null||n===""||(r[t]=n,n=Gt(n),i[i.length]=e?ke(t,n,e):zi(t,n))}function hu(t,n){var e=n||{},i=[vi,ke("cp:coreProperties",null,{"xmlns:cp":Mi.CORE_PROPS,"xmlns:dc":Mi.dc,"xmlns:dcterms":Mi.dcterms,"xmlns:dcmitype":Mi.dcmitype,"xmlns:xsi":Mi.xsi})],r={};if(!t&&!e.Props)return i.join("");t&&(t.CreatedDate!=null&&rc("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:_c(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),t.ModifiedDate!=null&&rc("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:_c(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var a=0;a!=Bn.length;++a){var s=Bn[a],o=e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:t?t[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&rc(s[0],o,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var ra=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mu=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _u(t,n,e,i){var r=[];if(typeof t=="string")r=Bd(t,i);else for(var a=0;a<t.length;++a)r=r.concat(t[a].map(function(d){return{v:d}}));var s=typeof n=="string"?Bd(n,i).map(function(d){return d.v}):n,o=0,l=0;if(s.length>0)for(var c=0;c!==r.length;c+=2){switch(l=+r[c+1].v,r[c].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":e.Worksheets=l,e.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":e.NamedRanges=l,e.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":e.Chartsheets=l,e.ChartNames=s.slice(o,o+l);break}o+=l}}function x4(t,n,e){var i={};return n||(n={}),t=Xt(t),ra.forEach(function(r){var a=(t.match(Ns(r[0]))||[])[1];switch(r[2]){case"string":a&&(n[r[1]]=Vt(a));break;case"bool":n[r[1]]=a==="true";break;case"raw":var s=t.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(i[r[1]]=s[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&_u(i.HeadingPairs,i.TitlesOfParts,n,e),n}function gu(t){var n=[],e=ke;return t||(t={}),t.Application="SheetJS",n[n.length]=vi,n[n.length]=ke("Properties",null,{xmlns:Mi.EXT_PROPS,"xmlns:vt":Mi.vt}),ra.forEach(function(i){if(t[i[1]]!==void 0){var r;switch(i[2]){case"string":r=Gt(String(t[i[1]]));break;case"bool":r=t[i[1]]?"true":"false";break}r!==void 0&&(n[n.length]=e(i[0],r))}}),n[n.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(i){return"<vt:lpstr>"+Gt(i)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var v4=/<[^>]+>[^<]*/g;function b4(t,n){var e={},i="",r=t.match(v4);if(r)for(var a=0;a!=r.length;++a){var s=r[a],o=ut(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":i=Vt(o.name);break;case"</property>":i=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":e[i]=Vt(d);break;case"bool":e[i]=Jt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[i]=parseInt(d,10);break;case"r4":case"r8":case"decimal":e[i]=parseFloat(d);break;case"filetime":case"date":e[i]=ei(d);break;case"cy":case"error":e[i]=Vt(d);break;default:if(c.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(n.WTF)throw new Error(s)}}}return e}function xu(t){var n=[vi,ke("Properties",null,{xmlns:Mi.CUST_PROPS,"xmlns:vt":Mi.vt})];if(!t)return n.join("");var e=1;return hi(t).forEach(function(r){++e,n[n.length]=ke("property",ET(t[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Gt(r)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var yc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ac;function y4(t,n,e){ac||(ac=el(yc)),n=ac[n]||n,t[n]=e}function w4(t,n){var e=[];return hi(yc).map(function(i){for(var r=0;r<Bn.length;++r)if(Bn[r][1]==i)return Bn[r];for(r=0;r<ra.length;++r)if(ra[r][1]==i)return ra[r];throw i}).forEach(function(i){if(t[i[1]]!=null){var r=n&&n.Props&&n.Props[i[1]]!=null?n.Props[i[1]]:t[i[1]];switch(i[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),e.push(zi(yc[i[1]]||i[1],r))}}),ke("DocumentProperties",e.join(""),{xmlns:vn.o})}function C4(t,n){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return t&&hi(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var s=0;s<Bn.length;++s)if(a==Bn[s][1])return;for(s=0;s<ra.length;++s)if(a==ra[s][1])return;for(s=0;s<e.length;++s)if(a==e[s])return;var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),r.push(ke(Ld(a),o,{"dt:dt":l}))}}),n&&hi(n).forEach(function(a){if(Object.prototype.hasOwnProperty.call(n,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var s=n[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),r.push(ke(Ld(a),s,{"dt:dt":o}))}}),"<"+i+' xmlns="'+vn.o+'">'+r.join("")+"</"+i+">"}function Jc(t){var n=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function T4(t){var n=typeof t=="string"?new Date(Date.parse(t)):t,e=n.getTime()/1e3+11644473600,i=e%Math.pow(2,32),r=(e-i)/Math.pow(2,32);i*=1e7,r*=1e7;var a=i/Math.pow(2,32)|0;a>0&&(i=i%Math.pow(2,32),r+=a);var s=ce(8);return s.write_shift(4,i),s.write_shift(4,r),s}function vu(t,n,e){var i=t.l,r=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-i&3;)++t.l;return r}function bu(t,n,e){var i=t.read_shift(0,"lpwstr");return e&&(t.l+=4-(i.length+1&3)&3),i}function yu(t,n,e){return n===31?bu(t):vu(t,n,e)}function wc(t,n,e){return yu(t,n,e===!1?0:4)}function S4(t,n){if(!n)throw new Error("VtUnalignedString must have positive length");return yu(t,n,0)}function I4(t){for(var n=t.read_shift(4),e=[],i=0;i!=n;++i){var r=t.l;e[i]=t.read_shift(0,"lpwstr").replace(Qi,""),t.l-r&2&&(t.l+=2)}return e}function k4(t){for(var n=t.read_shift(4),e=[],i=0;i!=n;++i)e[i]=t.read_shift(0,"lpstr-cp").replace(Qi,"");return e}function E4(t){var n=t.l,e=$o(t,cu);t[t.l]==0&&t[t.l+1]==0&&t.l-n&2&&(t.l+=2);var i=$o(t,pn);return[e,i]}function F4(t){for(var n=t.read_shift(4),e=[],i=0;i<n/2;++i)e.push(E4(t));return e}function Xd(t,n){for(var e=t.read_shift(4),i={},r=0;r!=e;++r){var a=t.read_shift(4),s=t.read_shift(4);i[a]=t.read_shift(s,n===1200?"utf16le":"utf8").replace(Qi,"").replace(Is,"!"),n===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),i}function wu(t){var n=t.read_shift(4),e=t.slice(t.l,t.l+n);return t.l+=n,(n&3)>0&&(t.l+=4-(n&3)&3),e}function D4(t){var n={};return n.Size=t.read_shift(4),t.l+=n.Size+3-(n.Size-1)%4,n}function $o(t,n,e){var i=t.read_shift(2),r,a=e||{};if(t.l+=2,n!==Gd&&i!==n&&o4.indexOf(n)===-1&&!((n&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+n+" saw "+i);switch(n===Gd?i:n){case 2:return r=t.read_shift(2,"i"),a.raw||(t.l+=2),r;case 3:return r=t.read_shift(4,"i"),r;case 11:return t.read_shift(4)!==0;case 19:return r=t.read_shift(4),r;case 30:return vu(t,i,4).replace(Qi,"");case 31:return bu(t);case 64:return Jc(t);case 65:return wu(t);case 71:return D4(t);case 80:return wc(t,i,!a.raw).replace(Qi,"");case 81:return S4(t,i).replace(Qi,"");case 4108:return F4(t);case 4126:case 4127:return i==4127?I4(t):k4(t);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+i)}}function qd(t,n){var e=ce(4),i=ce(4);switch(e.write_shift(4,t==80?31:t),t){case 3:i.write_shift(-4,n);break;case 5:i=ce(8),i.write_shift(8,n,"f");break;case 11:i.write_shift(4,n?1:0);break;case 64:i=T4(n);break;case 31:case 80:for(i=ce(4+2*(n.length+1)+(n.length%2?0:2)),i.write_shift(4,n.length+1),i.write_shift(0,n,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}return Pi([e,i])}function Zd(t,n){var e=t.l,i=t.read_shift(4),r=t.read_shift(4),a=[],s=0,o=0,l=-1,c={};for(s=0;s!=r;++s){var d=t.read_shift(4),h=t.read_shift(4);a[s]=[d,h+e]}a.sort(function(F,T){return F[1]-T[1]});var _={};for(s=0;s!=r;++s){if(t.l!==a[s][1]){var v=!0;if(s>0&&n)switch(n[a[s-1][0]].t){case 2:t.l+2===a[s][1]&&(t.l+=2,v=!1);break;case 80:t.l<=a[s][1]&&(t.l=a[s][1],v=!1);break;case 4108:t.l<=a[s][1]&&(t.l=a[s][1],v=!1);break}if((!n||s==0)&&t.l<=a[s][1]&&(v=!1,t.l=a[s][1]),v)throw new Error("Read Error: Expected address "+a[s][1]+" at "+t.l+" :"+s)}if(n){var b=n[a[s][0]];if(_[b.n]=$o(t,b.t,{raw:!0}),b.p==="version"&&(_[b.n]=String(_[b.n]>>16)+"."+("0000"+String(_[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(_[b.n]){case 0:_[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Kn(o=_[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[b.n])}}else if(a[s][0]===1){if(o=_.CodePage=$o(t,Zc),Kn(o),l!==-1){var m=t.l;t.l=a[l][1],c=Xd(t,o),t.l=m}}else if(a[s][0]===0){if(o===0){l=s,t.l=a[s+1][1];continue}c=Xd(t,o)}else{var y=c[a[s][0]],k;switch(t[t.l]){case 65:t.l+=4,k=wu(t);break;case 30:t.l+=4,k=wc(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=wc(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=gi(t,4);break;case 64:t.l+=4,k=ei(Jc(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[y]=k}}return t.l=e+i,_}var Cu=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function M4(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Qd(t,n,e){var i=ce(8),r=[],a=[],s=8,o=0,l=ce(8),c=ce(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),r.push(c),s+=8+l.length,!n){c=ce(8),c.write_shift(4,0),r.unshift(c);var d=[ce(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=ce(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Pi(d),a.unshift(l),s+=8+l.length}for(o=0;o<t.length;++o)if(!(n&&!n[t[o][0]])&&!(Cu.indexOf(t[o][0])>-1||mu.indexOf(t[o][0])>-1)&&t[o][1]!=null){var _=t[o][1],v=0;if(n){v=+n[t[o][0]];var b=e[v];if(b.p=="version"&&typeof _=="string"){var m=_.split(".");_=(+m[0]<<16)+(+m[1]||0)}l=qd(b.t,_)}else{var y=M4(_);y==-1&&(y=31,_=String(_)),l=qd(y,_)}a.push(l),c=ce(8),c.write_shift(4,n?v:2+o),r.push(c),s+=8+l.length}var k=8*(a.length+1);for(o=0;o<a.length;++o)r[o].write_shift(4,k),k+=a[o].length;return i.write_shift(4,s),i.write_shift(4,a.length),Pi([i].concat(r).concat(a))}function Jd(t,n,e){var i=t.content;if(!i)return{};Hi(i,0);var r,a,s,o,l=0;i.chk("feff","Byte Order: "),i.read_shift(2);var c=i.read_shift(4),d=i.read_shift(16);if(d!==et.utils.consts.HEADER_CLSID&&d!==e)throw new Error("Bad PropertySet CLSID "+d);if(r=i.read_shift(4),r!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(a=i.read_shift(16),o=i.read_shift(4),r===1&&o!==i.l)throw new Error("Length mismatch: "+o+" !== "+i.l);r===2&&(s=i.read_shift(16),l=i.read_shift(4));var h=Zd(i,n),_={SystemIdentifier:c};for(var v in h)_[v]=h[v];if(_.FMTID=a,r===1)return _;if(l-i.l==2&&(i.l+=2),i.l!==l)throw new Error("Length mismatch 2: "+i.l+" !== "+l);var b;try{b=Zd(i,null)}catch{}for(v in b)_[v]=b[v];return _.FMTID=[a,s],_}function ep(t,n,e,i,r,a){var s=ce(r?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,r?2:1),s.write_shift(16,n,"hex"),s.write_shift(4,r?68:48);var l=Qd(t,e,i);if(o.push(l),r){var c=Qd(r,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(c)}return Pi(o)}function Ur(t,n){return t.read_shift(n),null}function O4(t,n){n||(n=ce(t));for(var e=0;e<t;++e)n.write_shift(1,0);return n}function A4(t,n,e){for(var i=[],r=t.l+n;t.l<r;)i.push(e(t,r-t.l));if(r!==t.l)throw new Error("Slurp error");return i}function gi(t,n){return t.read_shift(n)===1}function sn(t,n){return n||(n=ce(2)),n.write_shift(2,+!!t),n}function ki(t){return t.read_shift(2,"u")}function Pn(t,n){return n||(n=ce(2)),n.write_shift(2,t),n}function Tu(t,n){return A4(t,n,ki)}function L4(t){var n=t.read_shift(1),e=t.read_shift(1);return e===1?n:n===1}function Su(t,n,e){return e||(e=ce(2)),e.write_shift(1,n=="e"?+t:+!!t),e.write_shift(1,n=="e"?1:0),e}function Zs(t,n,e){var i=t.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont",a=rr;if(e&&e.biff>=8&&(rr=1200),!e||e.biff==8){var s=t.read_shift(1);s&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var o=i?t.read_shift(i,r):"";return rr=a,o}function R4(t){var n=rr;rr=1200;var e=t.read_shift(2),i=t.read_shift(1),r=i&4,a=i&8,s=1+(i&1),o=0,l,c={};a&&(o=t.read_shift(2)),r&&(l=t.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",h=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*o),r&&(t.l+=l),c.t=h,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),rr=n,c}function V4(t){var n=t.t||"",e=1,i=ce(3+(e>1?2:0));i.write_shift(2,n.length),i.write_shift(1,(e>1?8:0)|1),e>1&&i.write_shift(2,e);var r=ce(2*n.length);r.write_shift(2*n.length,n,"utf16le");var a=[i,r];return Pi(a)}function da(t,n,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(n,"cpstr");if(e.biff>=12)return t.read_shift(n,"dbcs-cont")}var r=t.read_shift(1);return r===0?i=t.read_shift(n,"sbcs-cont"):i=t.read_shift(n,"dbcs-cont"),i}function Qs(t,n,e){var i=t.read_shift(e&&e.biff==2?1:2);return i===0?(t.l++,""):da(t,i,e)}function xa(t,n,e){if(e.biff>5)return Qs(t,n,e);var i=t.read_shift(1);return i===0?(t.l++,""):t.read_shift(i,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Iu(t,n,e){return e||(e=ce(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function P4(t){var n=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[n,e]}function B4(t){var n=t.read_shift(4),e=t.l,i=!1;n>24&&(t.l+=n-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),t.l=e);var r=t.read_shift((i?n-24:n)>>1,"utf16le").replace(Qi,"");return i&&(t.l+=24),r}function N4(t){for(var n=t.read_shift(2),e="";n-- >0;)e+="../";var i=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var r=t.read_shift(4);if(r===0)return e+i.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(a>>1,"utf16le").replace(Qi,"");return e+s}function U4(t,n){var e=t.read_shift(16);switch(n-=16,e){case"e0c9ea79f9bace118c8200aa004ba90b":return B4(t,n);case"0303000000000000c000000000000046":return N4(t,n);default:throw new Error("Unsupported Moniker "+e)}}function Ao(t){var n=t.read_shift(4),e=n>0?t.read_shift(n,"utf16le").replace(Qi,""):"";return e}function tp(t,n){n||(n=ce(6+t.length*2)),n.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)n.write_shift(2,t.charCodeAt(e));return n.write_shift(2,0),n}function H4(t,n){var e=t.l+n,i=t.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var r=t.read_shift(2);t.l+=2;var a,s,o,l,c="",d,h;r&16&&(a=Ao(t,e-t.l)),r&128&&(s=Ao(t,e-t.l)),(r&257)===257&&(o=Ao(t,e-t.l)),(r&257)===1&&(l=U4(t,e-t.l)),r&8&&(c=Ao(t,e-t.l)),r&32&&(d=t.read_shift(16)),r&64&&(h=Jc(t)),t.l=e;var _=s||o||l||"";_&&c&&(_+="#"+c),_||(_="#"+c),r&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var v={Target:_};return d&&(v.guid=d),h&&(v.time=h),a&&(v.Tooltip=a),v}function z4(t){var n=ce(512),e=0,i=t.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),a=r>-1?31:23;switch(i.charAt(0)){case"#":a=28;break;case".":a&=-3;break}n.write_shift(4,2),n.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(e=0;e<s.length;++e)n.write_shift(4,s[e]);if(a==28)i=i.slice(1),tp(i,n);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<s.length;++e)n.write_shift(1,parseInt(s[e],16));var o=r>-1?i.slice(0,r):i;for(n.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)n.write_shift(2,o.charCodeAt(e));n.write_shift(2,0),a&8&&tp(r>-1?i.slice(r+1):"",n)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<s.length;++e)n.write_shift(1,parseInt(s[e],16));for(var l=0;i.slice(l*3,l*3+3)=="../"||i.slice(l*3,l*3+3)=="..\\";)++l;for(n.write_shift(2,l),n.write_shift(4,i.length-3*l+1),e=0;e<i.length-3*l;++e)n.write_shift(1,i.charCodeAt(e+3*l)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),e=0;e<6;++e)n.write_shift(4,0)}return n.slice(0,n.l)}function ku(t){var n=t.read_shift(1),e=t.read_shift(1),i=t.read_shift(1),r=t.read_shift(1);return[n,e,i,r]}function Eu(t,n){var e=ku(t,n);return e[3]=0,e}function sr(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2);return{r:n,c:e,ixfe:i}}function pa(t,n,e,i){return i||(i=ce(6)),i.write_shift(2,t),i.write_shift(2,n),i.write_shift(2,e||0),i}function W4(t){var n=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:n,flags:e}}function j4(t,n,e){return n===0?"":xa(t,n,e)}function K4(t,n,e){var i=e.biff>8?4:2,r=t.read_shift(i),a=t.read_shift(i,"i"),s=t.read_shift(i,"i");return[r,a,s]}function Fu(t){var n=t.read_shift(2),e=qc(t);return[n,e]}function G4(t,n,e){t.l+=4,n-=4;var i=t.l+n,r=Zs(t,n,e),a=t.read_shift(2);if(i-=t.l,a!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+a);return t.l+=a,r}function rl(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2),r=t.read_shift(2);return{s:{c:i,r:n},e:{c:r,r:e}}}function Du(t,n){return n||(n=ce(8)),n.write_shift(2,t.s.r),n.write_shift(2,t.e.r),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c),n}function Mu(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(1),r=t.read_shift(1);return{s:{c:i,r:n},e:{c:r,r:e}}}var $4=Mu;function Ou(t){t.l+=4;var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2);return t.l+=12,[e,n,i]}function Y4(t){var n={};return t.l+=4,t.l+=16,n.fSharedNote=t.read_shift(2),t.l+=4,n}function X4(t){var n={};return t.l+=4,t.cf=t.read_shift(2),n}function $i(t){t.l+=2,t.l+=t.read_shift(2)}var q4={0:$i,4:$i,5:$i,6:$i,7:X4,8:$i,9:$i,10:$i,11:$i,12:$i,13:Y4,14:$i,15:$i,16:$i,17:$i,18:$i,19:$i,20:$i,21:Ou};function Z4(t,n){for(var e=t.l+n,i=[];t.l<e;){var r=t.read_shift(2);t.l-=2;try{i.push(q4[r](t,e-t.l))}catch{return t.l=e,i}}return t.l!=e&&(t.l=e),i}function Lo(t,n){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),n-=2,n>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(n),e}function e0(t,n,e){var i=1536,r=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ce(r);return a.write_shift(2,i),a.write_shift(2,n),r>4&&a.write_shift(2,29282),r>6&&a.write_shift(2,1997),r>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Q4(t,n){return n===0||t.read_shift(2),1200}function J4(t,n,e){if(e.enc)return t.l+=n,"";var i=t.l,r=xa(t,0,e);return t.read_shift(n+i-t.l),r}function eS(t,n){var e=!n||n.biff==8,i=ce(e?112:54);for(i.write_shift(n.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function tS(t,n,e){var i=e&&e.biff==8||n==2?t.read_shift(2):(t.l+=n,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function iS(t,n,e){var i=t.read_shift(4),r=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=Zs(t,0,e);return s.length===0&&(s="Sheet1"),{pos:i,hs:r,dt:a,name:s}}function nS(t,n){var e=!n||n.biff>=8?2:1,i=ce(8+e*t.name.length);i.write_shift(4,t.pos),i.write_shift(1,t.hs||0),i.write_shift(1,t.dt),i.write_shift(1,t.name.length),n.biff>=8&&i.write_shift(1,1),i.write_shift(e*t.name.length,t.name,n.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function rS(t,n){for(var e=t.l+n,i=t.read_shift(4),r=t.read_shift(4),a=[],s=0;s!=r&&t.l<e;++s)a.push(R4(t));return a.Count=i,a.Unique=r,a}function aS(t,n){var e=ce(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var i=[],r=0;r<t.length;++r)i[r]=V4(t[r],n);var a=Pi([e].concat(i));return a.parts=[e.length].concat(i.map(function(s){return s.length})),a}function sS(t,n){var e={};return e.dsst=t.read_shift(2),t.l+=n-2,e}function oS(t){var n={};n.r=t.read_shift(2),n.c=t.read_shift(2),n.cnt=t.read_shift(2)-n.c;var e=t.read_shift(2);t.l+=4;var i=t.read_shift(1);return t.l+=3,i&7&&(n.level=i&7),i&32&&(n.hidden=!0),i&64&&(n.hpt=e/20),n}function lS(t){var n=W4(t);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var e=t.read_shift(4);return e!==0}function cS(t){return t.read_shift(2),t.read_shift(4)}function ip(t,n,e){var i=0;e&&e.biff==2||(i=t.read_shift(2));var r=t.read_shift(2);e&&e.biff==2&&(i=1-(r>>15),r&=32767);var a={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[a,r]}function dS(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[n,e],Dim:[i,r],Flags:a,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function pS(){var t=ce(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function uS(t,n,e){if(e&&e.biff>=2&&e.biff<5)return{};var i=t.read_shift(2);return{RTL:i&64}}function fS(t){var n=ce(18),e=1718;return t&&t.RTL&&(e|=64),n.write_shift(2,e),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function hS(){}function mS(t,n,e){var i={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return i.name=Zs(t,0,e),i}function _S(t,n){var e=t.name||"Arial",i=n&&n.biff==5,r=i?15+e.length:16+2*e.length,a=ce(r);return a.write_shift(2,(t.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,e.length),i||a.write_shift(1,1),a.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),a}function gS(t){var n=sr(t);return n.isst=t.read_shift(4),n}function xS(t,n,e,i){var r=ce(10);return pa(t,n,i,r),r.write_shift(4,e),r}function vS(t,n,e){e.biffguess&&e.biff==2&&(e.biff=5);var i=t.l+n,r=sr(t,6);e.biff==2&&t.l++;var a=Qs(t,i-t.l,e);return r.val=a,r}function bS(t,n,e,i,r){var a=!r||r.biff==8,s=ce(8+ +a+(1+a)*e.length);return pa(t,n,i,s),s.write_shift(2,e.length),a&&s.write_shift(1,1),s.write_shift((1+a)*e.length,e,a?"utf16le":"sbcs"),s}function yS(t,n,e){var i=t.read_shift(2),r=xa(t,0,e);return[i,r]}function wS(t,n,e,i){var r=e&&e.biff==5;i||(i=ce(r?3+n.length:5+2*n.length)),i.write_shift(2,t),i.write_shift(r?1:2,n.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le");var a=i.length>i.l?i.slice(0,i.l):i;return a.l==null&&(a.l=a.length),a}var CS=xa;function np(t,n,e){var i=t.l+n,r=e.biff==8||!e.biff?4:2,a=t.read_shift(r),s=t.read_shift(r),o=t.read_shift(2),l=t.read_shift(2);return t.l=i,{s:{r:a,c:o},e:{r:s,c:l}}}function TS(t,n){var e=n.biff==8||!n.biff?4:2,i=ce(2*e+6);return i.write_shift(e,t.s.r),i.write_shift(e,t.e.r+1),i.write_shift(2,t.s.c),i.write_shift(2,t.e.c+1),i.write_shift(2,0),i}function SS(t){var n=t.read_shift(2),e=t.read_shift(2),i=Fu(t);return{r:n,c:e,ixfe:i[0],rknum:i[1]}}function IS(t,n){for(var e=t.l+n-2,i=t.read_shift(2),r=t.read_shift(2),a=[];t.l<e;)a.push(Fu(t));if(t.l!==e)throw new Error("MulRK read error");var s=t.read_shift(2);if(a.length!=s-r+1)throw new Error("MulRK length mismatch");return{r:i,c:r,C:s,rkrec:a}}function kS(t,n){for(var e=t.l+n-2,i=t.read_shift(2),r=t.read_shift(2),a=[];t.l<e;)a.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var s=t.read_shift(2);if(a.length!=s-r+1)throw new Error("MulBlank length mismatch");return{r:i,c:r,C:s,ixfe:a}}function ES(t,n,e,i){var r={},a=t.read_shift(4),s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return r.patternType=l4[o>>26],i.cellStyles&&(r.alc=a&7,r.fWrap=a>>3&1,r.alcV=a>>4&7,r.fJustLast=a>>7&1,r.trot=a>>8&255,r.cIndent=a>>16&15,r.fShrinkToFit=a>>20&1,r.iReadOrder=a>>22&2,r.fAtrNum=a>>26&1,r.fAtrFnt=a>>27&1,r.fAtrAlc=a>>28&1,r.fAtrBdr=a>>29&1,r.fAtrPat=a>>30&1,r.fAtrProt=a>>31&1,r.dgLeft=s&15,r.dgRight=s>>4&15,r.dgTop=s>>8&15,r.dgBottom=s>>12&15,r.icvLeft=s>>16&127,r.icvRight=s>>23&127,r.grbitDiag=s>>30&3,r.icvTop=o&127,r.icvBottom=o>>7&127,r.icvDiag=o>>14&127,r.dgDiag=o>>21&15,r.icvFore=l&127,r.icvBack=l>>7&127,r.fsxButton=l>>14&1),r}function FS(t,n,e){var i={};return i.ifnt=t.read_shift(2),i.numFmtId=t.read_shift(2),i.flags=t.read_shift(2),i.fStyle=i.flags>>2&1,n-=6,i.data=ES(t,n,i.fStyle,e),i}function rp(t,n,e,i){var r=e&&e.biff==5;i||(i=ce(r?16:20)),i.write_shift(2,0),t.style?(i.write_shift(2,t.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,t.numFmtId||0),i.write_shift(2,n<<4));var a=0;return t.numFmtId>0&&r&&(a|=1024),i.write_shift(4,a),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function DS(t){t.l+=4;var n=[t.read_shift(2),t.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function MS(t){var n=ce(8);return n.write_shift(4,0),n.write_shift(2,t[0]?t[0]+1:0),n.write_shift(2,t[1]?t[1]+1:0),n}function ap(t,n,e){var i=sr(t,6);(e.biff==2||n==9)&&++t.l;var r=L4(t,2);return i.val=r,i.t=r===!0||r===!1?"b":"e",i}function OS(t,n,e,i,r,a){var s=ce(8);return pa(t,n,i,s),Su(e,a,s),s}function AS(t,n,e){e.biffguess&&e.biff==2&&(e.biff=5);var i=sr(t,6),r=Zi(t,8);return i.val=r,i}function LS(t,n,e,i){var r=ce(14);return pa(t,n,i,r),ca(e,r),r}var sp=j4;function RS(t,n,e){var i=t.l+n,r=t.read_shift(2),a=t.read_shift(2);if(e.sbcch=a,a==1025||a==14849)return[a,r];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=da(t,a),o=[];i>t.l;)o.push(Qs(t));return[a,r,s,o]}function op(t,n,e){var i=t.read_shift(2),r,a={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return e.sbcch===14849&&(r=G4(t,n-2,e)),a.body=r||t.read_shift(n-2),typeof r=="string"&&(a.Name=r),a}var VS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function lp(t,n,e){var i=t.l+n,r=t.read_shift(2),a=t.read_shift(1),s=t.read_shift(1),o=t.read_shift(e&&e.biff==2?1:2),l=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),l=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var c=da(t,s,e);r&32&&(c=VS[c.charCodeAt(0)]);var d=i-t.l;e&&e.biff==2&&--d;var h=i==t.l||o===0||!(d>0)?[]:Z6(t,d,e,o);return{chKey:a,Name:c,itab:l,rgce:h}}function Au(t,n,e){if(e.biff<8)return PS(t,n,e);for(var i=[],r=t.l+n,a=t.read_shift(e.biff>8?4:2);a--!==0;)i.push(K4(t,e.biff>8?12:6,e));if(t.l!=r)throw new Error("Bad ExternSheet: "+t.l+" != "+r);return i}function PS(t,n,e){t[t.l+1]==3&&t[t.l]++;var i=Zs(t,n,e);return i.charCodeAt(0)==3?i.slice(1):i}function BS(t,n,e){if(e.biff<8){t.l+=n;return}var i=t.read_shift(2),r=t.read_shift(2),a=da(t,i,e),s=da(t,r,e);return[a,s]}function NS(t,n,e){var i=Mu(t,6);t.l++;var r=t.read_shift(1);return n-=8,[Q6(t,n,e),r,i]}function cp(t,n,e){var i=$4(t,6);switch(e.biff){case 2:t.l++,n-=7;break;case 3:case 4:t.l+=2,n-=8;break;default:t.l+=6,n-=12}return[i,X6(t,n,e,i)]}function US(t){var n=t.read_shift(4)!==0,e=t.read_shift(4)!==0,i=t.read_shift(4);return[n,e,i]}function HS(t,n,e){if(!(e.biff<8)){var i=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=xa(t,0,e);return e.biff<8&&t.read_shift(1),[{r:i,c:r},o,s,a]}}function zS(t,n,e){return HS(t,n,e)}function WS(t,n){for(var e=[],i=t.read_shift(2);i--;)e.push(rl(t,n));return e}function jS(t){var n=ce(2+t.length*8);n.write_shift(2,t.length);for(var e=0;e<t.length;++e)Du(t[e],n);return n}function KS(t,n,e){if(e&&e.biff<8)return $S(t,n,e);var i=Ou(t,22),r=Z4(t,n-22,i[1]);return{cmo:i,ft:r}}var GS={8:function(t,n){var e=t.l+n;t.l+=10;var i=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var r=t.read_shift(1);return t.l+=r,t.l=e,{fmt:i}}};function $S(t,n,e){t.l+=4;var i=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,n-=36;var s=[];return s.push((GS[i]||en)(t,n,e)),{cmo:[r,i,a],ft:s}}function YS(t,n,e){var i=t.l,r="";try{t.l+=4;var a=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:s=P4(t,6,e);var o=t.read_shift(2);t.read_shift(2),ki(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-i!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],h=da(t,t.lens[c+1]-t.lens[c]-1);if(r+=h,r.length>=(d?o:2*o))break}if(r.length!==o&&r.length!==o*2)throw new Error("cchText: "+o+" != "+r.length);return t.l=i+n,{t:r}}catch{return t.l=i+n,{t:r}}}function XS(t,n){var e=rl(t,8);t.l+=16;var i=H4(t,n-24);return[e,i]}function qS(t){var n=ce(24),e=di(t[0]);n.write_shift(2,e.r),n.write_shift(2,e.r),n.write_shift(2,e.c),n.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)n.write_shift(1,parseInt(i[r],16));return Pi([n,z4(t[1])])}function ZS(t,n){t.read_shift(2);var e=rl(t,8),i=t.read_shift((n-10)/2,"dbcs-cont");return i=i.replace(Qi,""),[e,i]}function QS(t){var n=t[1].Tooltip,e=ce(10+2*(n.length+1));e.write_shift(2,2048);var i=di(t[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var r=0;r<n.length;++r)e.write_shift(2,n.charCodeAt(r));return e.write_shift(2,0),e}function JS(t){var n=[0,0],e;return e=t.read_shift(2),n[0]=$d[e]||e,e=t.read_shift(2),n[1]=$d[e]||e,n}function eI(t){return t||(t=ce(4)),t.write_shift(2,1),t.write_shift(2,1),t}function tI(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(Eu(t,8));return e}function iI(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(Eu(t,8));return e}function nI(t){t.l+=2;var n={cxfs:0,crc:0};return n.cxfs=t.read_shift(2),n.crc=t.read_shift(4),n}function Lu(t,n,e){if(!e.cellStyles)return en(t,n);var i=e&&e.biff>=12?4:2,r=t.read_shift(i),a=t.read_shift(i),s=t.read_shift(i),o=t.read_shift(i),l=t.read_shift(2);i==2&&(t.l+=2);var c={s:r,e:a,w:s,ixfe:o,flags:l};return(e.biff>=5||!e.biff)&&(c.level=l>>8&7),c}function rI(t,n){var e=ce(12);e.write_shift(2,n),e.write_shift(2,n),e.write_shift(2,t.width*256),e.write_shift(2,0);var i=0;return t.hidden&&(i|=1),e.write_shift(1,i),i=t.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function aI(t,n){var e={};return n<32||(t.l+=16,e.header=Zi(t,8),e.footer=Zi(t,8),t.l+=2),e}function sI(t,n,e){var i={area:!1};if(e.biff!=5)return t.l+=n,i;var r=t.read_shift(1);return t.l+=3,r&16&&(i.area=!0),i}function oI(t){for(var n=ce(2*t),e=0;e<t;++e)n.write_shift(2,e+1);return n}var lI=sr,cI=Tu,dI=Qs;function pI(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(4),r={fmt:n,env:e,len:i,data:t.slice(t.l,t.l+i)};return t.l+=i,r}function uI(t,n,e){e.biffguess&&e.biff==5&&(e.biff=2);var i=sr(t,6);++t.l;var r=xa(t,n-7,e);return i.t="str",i.val=r,i}function fI(t){var n=sr(t,6);++t.l;var e=Zi(t,8);return n.t="n",n.val=e,n}function hI(t,n,e){var i=ce(15);return io(i,t,n),i.write_shift(8,e,"f"),i}function mI(t){var n=sr(t,6);++t.l;var e=t.read_shift(2);return n.t="n",n.val=e,n}function _I(t,n,e){var i=ce(9);return io(i,t,n),i.write_shift(2,e),i}function gI(t){var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,"sbcs-cont")}function xI(t,n){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=n-13}function vI(t,n,e){var i=t.l+n,r=sr(t,6),a=t.read_shift(2),s=da(t,a,e);return t.l=i,r.t="str",r.val=s,r}var bI=[2,3,48,49,131,139,140,245],Cc=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=el({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,l){var c=[],d=Wr(1);switch(l.type){case"base64":d=bn(wn(o));break;case"binary":d=bn(o);break;case"buffer":case"array":d=o;break}Hi(d,0);var h=d.read_shift(1),_=!!(h&136),v=!1,b=!1;switch(h){case 2:break;case 3:break;case 48:v=!0,_=!0;break;case 49:v=!0,_=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,y=521;h==2&&(m=d.read_shift(2)),d.l+=3,h!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(y=d.read_shift(2));var k=d.read_shift(2),F=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(F=t[d[d.l]]),d.l+=1,d.l+=2),b&&(d.l+=36);for(var T=[],W={},X=Math.min(d.length,h==2?521:y-10-(v?264:0)),z=b?32:11;d.l<X&&d[d.l]!=13;)switch(W={},W.name=Ht.utils.decode(F,d.slice(d.l,d.l+z)).replace(/[\u0000\r\n].*$/g,""),d.l+=z,W.type=String.fromCharCode(d.read_shift(1)),h!=2&&!b&&(W.offset=d.read_shift(4)),W.len=d.read_shift(1),h==2&&(W.offset=d.read_shift(2)),W.dec=d.read_shift(1),W.name.length&&T.push(W),h!=2&&(d.l+=b?13:14),W.type){case"B":(!v||W.len!=8)&&l.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var M=0,K=0;for(c[0]=[],K=0;K!=T.length;++K)c[0][K]=T[K].name;for(;m-- >0;){if(d[d.l]===42){d.l+=k;continue}for(++d.l,c[++M]=[],K=0,K=0;K!=T.length;++K){var j=d.slice(d.l,d.l+T[K].len);d.l+=T[K].len,Hi(j,0);var ne=Ht.utils.decode(F,j);switch(T[K].type){case"C":ne.trim().length&&(c[M][K]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?c[M][K]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):c[M][K]=ne;break;case"F":c[M][K]=parseFloat(ne.trim());break;case"+":case"I":c[M][K]=b?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":c[M][K]=!0;break;case"N":case"F":c[M][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[M][K]="##MEMO##"+(b?parseInt(ne.trim(),10):j.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(c[M][K]=+ne||0);break;case"@":c[M][K]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":c[M][K]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":c[M][K]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[M][K]=-j.read_shift(-8,"f");break;case"B":if(v&&T[K].len==8){c[M][K]=j.read_shift(8,"f");break}case"G":case"P":j.l+=T[K].len;break;case"0":if(T[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[K].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=T,c}function i(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=cs(e(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function r(o,l){try{return Yr(i(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&Kn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=un(),h=Zo(o,{header:1,raw:!0,cellDates:!0}),_=h[0],v=h.slice(1),b=o["!cols"]||[],m=0,y=0,k=0,F=1;for(m=0;m<_.length;++m){if(((b[m]||{}).DBF||{}).name){_[m]=b[m].DBF.name,++k;continue}if(_[m]!=null){if(++k,typeof _[m]=="number"&&(_[m]=_[m].toString(10)),typeof _[m]!="string")throw new Error("DBF Invalid column name "+_[m]+" |"+typeof _[m]+"|");if(_.indexOf(_[m])!==m){for(y=0;y<1024;++y)if(_.indexOf(_[m]+"_"+y)==-1){_[m]+="_"+y;break}}}}var T=Pt(o["!ref"]),W=[],X=[],z=[];for(m=0;m<=T.e.c-T.s.c;++m){var M="",K="",j=0,ne=[];for(y=0;y<v.length;++y)v[y][m]!=null&&ne.push(v[y][m]);if(ne.length==0||_[m]==null){W[m]="?";continue}for(y=0;y<ne.length;++y){switch(typeof ne[y]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=ne[y]instanceof Date?"D":"C";break;default:K="C"}j=Math.max(j,String(ne[y]).length),M=M&&M!=K?"C":K}j>250&&(j=250),K=((b[m]||{}).DBF||{}).type,K=="C"&&b[m].DBF.len>j&&(j=b[m].DBF.len),M=="B"&&K=="N"&&(M="N",z[m]=b[m].DBF.dec,j=b[m].DBF.len),X[m]=M=="C"||K=="N"?j:a[M]||0,F+=X[m],W[m]=M}var oe=d.next(32);for(oe.write_shift(4,318902576),oe.write_shift(4,v.length),oe.write_shift(2,296+32*k),oe.write_shift(2,F),m=0;m<4;++m)oe.write_shift(4,0);for(oe.write_shift(4,0|(+n[is]||3)<<8),m=0,y=0;m<_.length;++m)if(_[m]!=null){var q=d.next(32),Se=(_[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,Se,"sbcs"),q.write_shift(1,W[m]=="?"?"C":W[m],"sbcs"),q.write_shift(4,y),q.write_shift(1,X[m]||a[W[m]]||0),q.write_shift(1,z[m]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),y+=X[m]||a[W[m]]||0}var Ne=d.next(264);for(Ne.write_shift(4,13),m=0;m<65;++m)Ne.write_shift(4,0);for(m=0;m<v.length;++m){var Ie=d.next(F);for(Ie.write_shift(1,0),y=0;y<_.length;++y)if(_[y]!=null)switch(W[y]){case"L":Ie.write_shift(1,v[m][y]==null?63:v[m][y]?84:70);break;case"B":Ie.write_shift(8,v[m][y]||0,"f");break;case"N":var Ye="0";for(typeof v[m][y]=="number"&&(Ye=v[m][y].toFixed(z[y]||0)),k=0;k<X[y]-Ye.length;++k)Ie.write_shift(1,32);Ie.write_shift(1,Ye,"sbcs");break;case"D":v[m][y]?(Ie.write_shift(4,("0000"+v[m][y].getFullYear()).slice(-4),"sbcs"),Ie.write_shift(2,("00"+(v[m][y].getMonth()+1)).slice(-2),"sbcs"),Ie.write_shift(2,("00"+v[m][y].getDate()).slice(-2),"sbcs")):Ie.write_shift(8,"00000000","sbcs");break;case"C":var ze=String(v[m][y]!=null?v[m][y]:"").slice(0,X[y]);for(Ie.write_shift(1,ze,"sbcs"),k=0;k<X[y]-ze.length;++k)Ie.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:r,to_sheet:i,from_sheet:s}}(),Ru=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+hi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(_,v){var b=t[v];return typeof b=="number"?bd(b):b},i=function(_,v,b){var m=v.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return m==59?_:bd(m)};t["|"]=254;function r(_,v){switch(v.type){case"base64":return a(wn(_),v);case"binary":return a(_,v);case"buffer":return a(kt&&Buffer.isBuffer(_)?_.toString("binary"):$r(_),v);case"array":return a(la(_),v)}throw new Error("Unrecognized type "+v.type)}function a(_,v){var b=_.split(/[\n\r]+/),m=-1,y=-1,k=0,F=0,T=[],W=[],X=null,z={},M=[],K=[],j=[],ne=0,oe;for(+v.codepage>=0&&Kn(+v.codepage);k!==b.length;++k){ne=0;var q=b[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(n,e),Se=q.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),Ne=Se[0],Ie;if(q.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Se[1].charAt(0)=="P"&&W.push(q.slice(3).replace(/;;/g,";"));break;case"C":var Ye=!1,ze=!1,Et=!1,Pe=!1,Ke=-1,me=-1;for(F=1;F<Se.length;++F)switch(Se[F].charAt(0)){case"A":break;case"X":y=parseInt(Se[F].slice(1))-1,ze=!0;break;case"Y":for(m=parseInt(Se[F].slice(1))-1,ze||(y=0),oe=T.length;oe<=m;++oe)T[oe]=[];break;case"K":Ie=Se[F].slice(1),Ie.charAt(0)==='"'?Ie=Ie.slice(1,Ie.length-1):Ie==="TRUE"?Ie=!0:Ie==="FALSE"?Ie=!1:isNaN($n(Ie))?isNaN(ns(Ie).getDate())||(Ie=ei(Ie)):(Ie=$n(Ie),X!==null&&ss(X)&&(Ie=il(Ie))),typeof Ht<"u"&&typeof Ie=="string"&&(v||{}).type!="string"&&(v||{}).codepage&&(Ie=Ht.utils.decode(v.codepage,Ie)),Ye=!0;break;case"E":Pe=!0;var B=es(Se[F].slice(1),{r:m,c:y});T[m][y]=[T[m][y],B];break;case"S":Et=!0,T[m][y]=[T[m][y],"S5S"];break;case"G":break;case"R":Ke=parseInt(Se[F].slice(1))-1;break;case"C":me=parseInt(Se[F].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+q)}if(Ye&&(T[m][y]&&T[m][y].length==2?T[m][y][0]=Ie:T[m][y]=Ie,X=null),Et){if(Pe)throw new Error("SYLK shared formula cannot have own formula");var te=Ke>-1&&T[Ke][me];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");T[m][y][1]=Ju(te[1],{r:m-Ke,c:y-me})}break;case"F":var H=0;for(F=1;F<Se.length;++F)switch(Se[F].charAt(0)){case"X":y=parseInt(Se[F].slice(1))-1,++H;break;case"Y":for(m=parseInt(Se[F].slice(1))-1,oe=T.length;oe<=m;++oe)T[oe]=[];break;case"M":ne=parseInt(Se[F].slice(1))/20;break;case"F":break;case"G":break;case"P":X=W[parseInt(Se[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=Se[F].slice(1).split(" "),oe=parseInt(j[0],10);oe<=parseInt(j[1],10);++oe)ne=parseInt(j[2],10),K[oe-1]=ne===0?{hidden:!0}:{wch:ne},jr(K[oe-1]);break;case"C":y=parseInt(Se[F].slice(1))-1,K[y]||(K[y]={});break;case"R":m=parseInt(Se[F].slice(1))-1,M[m]||(M[m]={}),ne>0?(M[m].hpt=ne,M[m].hpx=as(ne)):ne===0&&(M[m].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+q)}H<1&&(X=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+q)}}return M.length>0&&(z["!rows"]=M),K.length>0&&(z["!cols"]=K),v&&v.sheetRows&&(T=T.slice(0,v.sheetRows)),[T,z]}function s(_,v){var b=r(_,v),m=b[0],y=b[1],k=cs(m,v);return hi(y).forEach(function(F){k[F]=y[F]}),k}function o(_,v){return Yr(s(_,v),v)}function l(_,v,b,m){var y="C;Y"+(b+1)+";X"+(m+1)+";K";switch(_.t){case"n":y+=_.v||0,_.f&&!_.F&&(y+=";E"+s0(_.f,{r:b,c:m}));break;case"b":y+=_.v?"TRUE":"FALSE";break;case"e":y+=_.w||_.v;break;case"d":y+='"'+(_.w||_.v)+'"';break;case"s":y+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(_,v){v.forEach(function(b,m){var y="F;W"+(m+1)+" "+(m+1)+" ";b.hidden?y+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=js(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Ks(b.wpx)),typeof b.wch=="number"&&(y+=Math.round(b.wch))),y.charAt(y.length-1)!=" "&&_.push(y)})}function d(_,v){v.forEach(function(b,m){var y="F;";b.hidden?y+="M0;":b.hpt?y+="M"+20*b.hpt+";":b.hpx&&(y+="M"+20*Gs(b.hpx)+";"),y.length>2&&_.push(y+"R"+(m+1))})}function h(_,v){var b=["ID;PWXL;N;E"],m=[],y=Pt(_["!ref"]),k,F=Array.isArray(_),T=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),_["!cols"]&&c(b,_["!cols"]),_["!rows"]&&d(b,_["!rows"]),b.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var W=y.s.r;W<=y.e.r;++W)for(var X=y.s.c;X<=y.e.c;++X){var z=dt({r:W,c:X});k=F?(_[W]||[])[X]:_[z],!(!k||k.v==null&&(!k.f||k.F))&&m.push(l(k,_,W,X,v))}return b.join(T)+T+m.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),Vu=function(){function t(a,s){switch(s.type){case"base64":return n(wn(a),s);case"binary":return n(a,s);case"buffer":return n(kt&&Buffer.isBuffer(a)?a.toString("binary"):$r(a),s);case"array":return n(la(a),s)}throw new Error("Unrecognized type "+s.type)}function n(a,s){for(var o=a.split(`
`),l=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var _=o[d].trim().split(","),v=_[0],b=_[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+v){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN($n(b))?isNaN(ns(b).getDate())?h[l][c]=b:h[l][c]=ei(b):h[l][c]=$n(b),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),Cs&&m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function e(a,s){return cs(t(a,s),s)}function i(a,s){return Yr(e(a,s),s)}var r=function(){var a=function(l,c,d,h,_){l.push(c),l.push(d+","+h),l.push('"'+_.replace(/"/g,'""')+'"')},s=function(l,c,d,h){l.push(c+","+d),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],d=Pt(l["!ref"]),h,_=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,d.e.r-d.s.r+1,""),a(c,"TUPLES",0,d.e.c-d.s.c+1,""),a(c,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){s(c,-1,0,"BOT");for(var b=d.s.c;b<=d.e.c;++b){var m=dt({r:v,c:b});if(h=_?(l[v]||[])[b]:l[m],!h){s(c,1,0,"");continue}switch(h.t){case"n":var y=Cs?h.w:h.v;!y&&h.v!=null&&(y=h.v),y==null?Cs&&h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,y,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,!Cs||isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Nn(h.z||lt[14],Oi(ei(h.v)))),Cs?s(c,0,h.w,"V"):s(c,1,0,h.w);break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var k=`\r
`,F=c.join(k);return F}}();return{to_workbook:i,to_sheet:e,from_sheet:r}}(),Pu=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(h,_){for(var v=h.split(`
`),b=-1,m=-1,y=0,k=[];y!==v.length;++y){var F=v[y].trim().split(":");if(F[0]==="cell"){var T=di(F[1]);if(k.length<=T.r)for(b=k.length;b<=T.r;++b)k[b]||(k[b]=[]);switch(b=T.r,m=T.c,F[2]){case"t":k[b][m]=t(F[3]);break;case"v":k[b][m]=+F[3];break;case"vtf":var W=F[F.length-1];case"vtc":switch(F[3]){case"nl":k[b][m]=!!+F[4];break;default:k[b][m]=+F[4];break}F[2]=="vtf"&&(k[b][m]=[k[b][m],W])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function i(h,_){return cs(e(h,_),_)}function r(h,_){return Yr(i(h,_),_)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var _=[],v=[],b,m="",y=fn(h["!ref"]),k=Array.isArray(h),F=y.s.r;F<=y.e.r;++F)for(var T=y.s.c;T<=y.e.c;++T)if(m=dt({r:F,c:T}),b=k?(h[F]||[])[T]:h[m],!(!b||b.v==null||b.t==="z")){switch(v=["cell",m,"t"],b.t){case"s":case"str":v.push(n(b.v));break;case"n":b.f?(v[2]="vtf",v[3]="n",v[4]=b.v,v[5]=n(b.f)):(v[2]="v",v[3]=b.v);break;case"b":v[2]="vt"+(b.f?"f":"c"),v[3]="nl",v[4]=b.v?"1":"0",v[5]=n(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var W=Oi(ei(b.v));v[2]="vtc",v[3]="nd",v[4]=""+W,v[5]=b.w||Nn(b.z||lt[14],W);break;case"e":continue}_.push(v.join(":"))}return _.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function d(h){return[a,s,o,s,c(h),l].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:d}}(),rs=function(){function t(d,h,_,v,b){b.raw?h[_][v]=d:d===""||(d==="TRUE"?h[_][v]=!0:d==="FALSE"?h[_][v]=!1:isNaN($n(d))?isNaN(ns(d).getDate())?h[_][v]=d:h[_][v]=ei(d):h[_][v]=$n(d))}function n(d,h){var _=h||{},v=[];if(!d||d.length===0)return v;for(var b=d.split(/[\r\n]/),m=b.length-1;m>=0&&b[m].length===0;)--m;for(var y=10,k=0,F=0;F<=m;++F)k=b[F].indexOf(" "),k==-1?k=b[F].length:k++,y=Math.max(y,k);for(F=0;F<=m;++F){v[F]=[];var T=0;for(t(b[F].slice(0,y).trim(),v,F,T,_),T=1;T<=(b[F].length-y)/10+1;++T)t(b[F].slice(y+(T-1)*10,y+T*10).trim(),v,F,T,_)}return _.sheetRows&&(v=v.slice(0,_.sheetRows)),v}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(d){for(var h={},_=!1,v=0,b=0;v<d.length;++v)(b=d.charCodeAt(v))==34?_=!_:!_&&b in e&&(h[b]=(h[b]||0)+1);b=[];for(v in h)Object.prototype.hasOwnProperty.call(h,v)&&b.push([h[v],v]);if(!b.length){h=i;for(v in h)Object.prototype.hasOwnProperty.call(h,v)&&b.push([h[v],v])}return b.sort(function(m,y){return m[0]-y[0]||i[m[1]]-i[y[1]]}),e[b.pop()[1]]||44}function a(d,h){var _=h||{},v="";fi!=null&&_.dense==null&&(_.dense=fi);var b=_.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=r(d.slice(0,1024)):_&&_.FS?v=_.FS:v=r(d.slice(0,1024));var y=0,k=0,F=0,T=0,W=0,X=v.charCodeAt(0),z=!1,M=0,K=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=_.dateNF!=null?sT(_.dateNF):null;function ne(){var oe=d.slice(T,W),q={};if(oe.charAt(0)=='"'&&oe.charAt(oe.length-1)=='"'&&(oe=oe.slice(1,-1).replace(/""/g,'"')),oe.length===0)q.t="z";else if(_.raw)q.t="s",q.v=oe;else if(oe.trim().length===0)q.t="s",q.v=oe;else if(oe.charCodeAt(0)==61)oe.charCodeAt(1)==34&&oe.charCodeAt(oe.length-1)==34?(q.t="s",q.v=oe.slice(2,-1).replace(/""/g,'"')):RE(oe)?(q.t="n",q.f=oe.slice(1)):(q.t="s",q.v=oe);else if(oe=="TRUE")q.t="b",q.v=!0;else if(oe=="FALSE")q.t="b",q.v=!1;else if(!isNaN(F=$n(oe)))q.t="n",_.cellText!==!1&&(q.w=oe),q.v=F;else if(!isNaN(ns(oe).getDate())||j&&oe.match(j)){q.z=_.dateNF||lt[14];var Se=0;j&&oe.match(j)&&(oe=oT(oe,_.dateNF,oe.match(j)||[]),Se=1),_.cellDates?(q.t="d",q.v=ei(oe,Se)):(q.t="n",q.v=Oi(ei(oe,Se))),_.cellText!==!1&&(q.w=Nn(q.z,q.v instanceof Date?Oi(q.v):q.v)),_.cellNF||delete q.z}else q.t="s",q.v=oe;if(q.t=="z"||(_.dense?(b[y]||(b[y]=[]),b[y][k]=q):b[dt({c:k,r:y})]=q),T=W+1,K=d.charCodeAt(T),m.e.c<k&&(m.e.c=k),m.e.r<y&&(m.e.r=y),M==X)++k;else if(k=0,++y,_.sheetRows&&_.sheetRows<=y)return!0}e:for(;W<d.length;++W)switch(M=d.charCodeAt(W)){case 34:K===34&&(z=!z);break;case X:case 10:case 13:if(!z&&ne())break e;break;default:break}return W-T>0&&ne(),b["!ref"]=yt(m),b}function s(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,h):cs(n(d,h),h)}function o(d,h){var _="",v=h.type=="string"?[0,0,0,0]:h0(d,h);switch(h.type){case"base64":_=wn(d);break;case"binary":_=d;break;case"buffer":h.codepage==65001?_=d.toString("utf8"):h.codepage&&typeof Ht<"u"?_=Ht.utils.decode(h.codepage,d):_=kt&&Buffer.isBuffer(d)?d.toString("binary"):$r(d);break;case"array":_=la(d);break;case"string":_=d;break;default:throw new Error("Unrecognized type "+h.type)}return v[0]==239&&v[1]==187&&v[2]==191?_=Xt(_.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?_=Xt(_):h.type=="binary"&&typeof Ht<"u"&&h.codepage&&(_=Ht.utils.decode(h.codepage,Ht.utils.encode(28591,_))),_.slice(0,19)=="socialcalc:version:"?Pu.to_sheet(h.type=="string"?_:Xt(_),h):s(_,h)}function l(d,h){return Yr(o(d,h),h)}function c(d){for(var h=[],_=Pt(d["!ref"]),v,b=Array.isArray(d),m=_.s.r;m<=_.e.r;++m){for(var y=[],k=_.s.c;k<=_.e.c;++k){var F=dt({r:m,c:k});if(v=b?(d[m]||[])[k]:d[F],!v||v.v==null){y.push("          ");continue}for(var T=(v.w||(xr(v),v.w)||"").slice(0,10);T.length<10;)T+=" ";y.push(T+(k===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function yI(t,n){var e=n||{},i=!!e.WTF;e.WTF=!0;try{var r=Ru.to_workbook(t,e);return e.WTF=i,r}catch(a){if(e.WTF=i,!a.message.match(/SYLK bad record ID/)&&i)throw a;return rs.to_workbook(t,n)}}var aa=function(){function t(B,te,H){if(B){Hi(B,B.l||0);for(var U=H.Enum||Ke;B.l<B.length;){var pe=B.read_shift(2),Ae=U[pe]||U[65535],Ce=B.read_shift(2),Te=B.l+Ce,xe=Ae.f&&Ae.f(B,Ce,H);if(B.l=Te,te(xe,Ae,pe))return}}}function n(B,te){switch(te.type){case"base64":return e(bn(wn(B)),te);case"binary":return e(bn(B),te);case"buffer":case"array":return e(B,te)}throw"Unsupported type "+te.type}function e(B,te){if(!B)return B;var H=te||{};fi!=null&&H.dense==null&&(H.dense=fi);var U=H.dense?[]:{},pe="Sheet1",Ae="",Ce=0,Te={},xe=[],gt=[],P={s:{r:0,c:0},e:{r:0,c:0}},zt=H.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)H.Enum=Ke,t(B,function(Be,mi,Cn){switch(Cn){case 0:H.vers=Be,Be>=4096&&(H.qpro=!0);break;case 6:P=Be;break;case 204:Be&&(Ae=Be);break;case 222:Ae=Be;break;case 15:case 51:H.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:Cn==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=H.dateNF||lt[14],H.cellDates&&(Be[1].t="d",Be[1].v=il(Be[1].v))),H.qpro&&Be[3]>Ce&&(U["!ref"]=yt(P),Te[pe]=U,xe.push(pe),U=H.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},Ce=Be[3],pe=Ae||"Sheet"+(Ce+1),Ae="");var Xn=H.dense?(U[Be[0].r]||[])[Be[0].c]:U[dt(Be[0])];if(Xn){Xn.t=Be[1].t,Xn.v=Be[1].v,Be[1].z!=null&&(Xn.z=Be[1].z),Be[1].f!=null&&(Xn.f=Be[1].f);break}H.dense?(U[Be[0].r]||(U[Be[0].r]=[]),U[Be[0].r][Be[0].c]=Be[1]):U[dt(Be[0])]=Be[1];break;default:}},H);else if(B[2]==26||B[2]==14)H.Enum=me,B[2]==14&&(H.qpro=!0,B.l=0),t(B,function(Be,mi,Cn){switch(Cn){case 204:pe=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>Ce&&(U["!ref"]=yt(P),Te[pe]=U,xe.push(pe),U=H.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},Ce=Be[3],pe="Sheet"+(Ce+1)),zt>0&&Be[0].r>=zt)break;H.dense?(U[Be[0].r]||(U[Be[0].r]=[]),U[Be[0].r][Be[0].c]=Be[1]):U[dt(Be[0])]=Be[1],P.e.c<Be[0].c&&(P.e.c=Be[0].c),P.e.r<Be[0].r&&(P.e.r=Be[0].r);break;case 27:Be[14e3]&&(gt[Be[14e3][0]]=Be[14e3][1]);break;case 1537:gt[Be[0]]=Be[1],Be[0]==Ce&&(pe=Be[1]);break;default:break}},H);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(U["!ref"]=yt(P),Te[Ae||pe]=U,xe.push(Ae||pe),!gt.length)return{SheetNames:xe,Sheets:Te};for(var Dt={},Wt=[],Mt=0;Mt<gt.length;++Mt)Te[xe[Mt]]?(Wt.push(gt[Mt]||xe[Mt]),Dt[gt[Mt]]=Te[gt[Mt]]||Te[xe[Mt]]):(Wt.push(gt[Mt]),Dt[gt[Mt]]={"!ref":"A1"});return{SheetNames:Wt,Sheets:Dt}}function i(B,te){var H=te||{};if(+H.codepage>=0&&Kn(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var U=un(),pe=Pt(B["!ref"]),Ae=Array.isArray(B),Ce=[];De(U,0,a(1030)),De(U,6,l(pe));for(var Te=Math.min(pe.e.r,8191),xe=pe.s.r;xe<=Te;++xe)for(var gt=xi(xe),P=pe.s.c;P<=pe.e.c;++P){xe===pe.s.r&&(Ce[P]=ci(P));var zt=Ce[P]+gt,Dt=Ae?(B[xe]||[])[P]:B[zt];if(!(!Dt||Dt.t=="z"))if(Dt.t=="n")(Dt.v|0)==Dt.v&&Dt.v>=-32768&&Dt.v<=32767?De(U,13,v(xe,P,Dt.v)):De(U,14,m(xe,P,Dt.v));else{var Wt=xr(Dt);De(U,15,h(xe,P,Wt.slice(0,239)))}}return De(U,1),U.end()}function r(B,te){var H=te||{};if(+H.codepage>=0&&Kn(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var U=un();De(U,0,s(B));for(var pe=0,Ae=0;pe<B.SheetNames.length;++pe)(B.Sheets[B.SheetNames[pe]]||{})["!ref"]&&De(U,27,Pe(B.SheetNames[pe],Ae++));var Ce=0;for(pe=0;pe<B.SheetNames.length;++pe){var Te=B.Sheets[B.SheetNames[pe]];if(!(!Te||!Te["!ref"])){for(var xe=Pt(Te["!ref"]),gt=Array.isArray(Te),P=[],zt=Math.min(xe.e.r,8191),Dt=xe.s.r;Dt<=zt;++Dt)for(var Wt=xi(Dt),Mt=xe.s.c;Mt<=xe.e.c;++Mt){Dt===xe.s.r&&(P[Mt]=ci(Mt));var Be=P[Mt]+Wt,mi=gt?(Te[Dt]||[])[Mt]:Te[Be];if(!(!mi||mi.t=="z"))if(mi.t=="n")De(U,23,ne(Dt,Mt,Ce,mi.v));else{var Cn=xr(mi);De(U,22,M(Dt,Mt,Ce,Cn.slice(0,239)))}}++Ce}}return De(U,1),U.end()}function a(B){var te=ce(2);return te.write_shift(2,B),te}function s(B){var te=ce(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var H=0,U=0,pe=0,Ae=0;Ae<B.SheetNames.length;++Ae){var Ce=B.SheetNames[Ae],Te=B.Sheets[Ce];if(!(!Te||!Te["!ref"])){++pe;var xe=fn(Te["!ref"]);H<xe.e.r&&(H=xe.e.r),U<xe.e.c&&(U=xe.e.c)}}return H>8191&&(H=8191),te.write_shift(2,H),te.write_shift(1,pe),te.write_shift(1,U),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function o(B,te,H){var U={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&H.qpro?(U.s.c=B.read_shift(1),B.l++,U.s.r=B.read_shift(2),U.e.c=B.read_shift(1),B.l++,U.e.r=B.read_shift(2),U):(U.s.c=B.read_shift(2),U.s.r=B.read_shift(2),te==12&&H.qpro&&(B.l+=2),U.e.c=B.read_shift(2),U.e.r=B.read_shift(2),te==12&&H.qpro&&(B.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(B){var te=ce(8);return te.write_shift(2,B.s.c),te.write_shift(2,B.s.r),te.write_shift(2,B.e.c),te.write_shift(2,B.e.r),te}function c(B,te,H){var U=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(U[0].c=B.read_shift(1),U[3]=B.read_shift(1),U[0].r=B.read_shift(2),B.l+=2):(U[2]=B.read_shift(1),U[0].c=B.read_shift(2),U[0].r=B.read_shift(2)),U}function d(B,te,H){var U=B.l+te,pe=c(B,te,H);if(pe[1].t="s",H.vers==20768){B.l++;var Ae=B.read_shift(1);return pe[1].v=B.read_shift(Ae,"utf8"),pe}return H.qpro&&B.l++,pe[1].v=B.read_shift(U-B.l,"cstr"),pe}function h(B,te,H){var U=ce(7+H.length);U.write_shift(1,255),U.write_shift(2,te),U.write_shift(2,B),U.write_shift(1,39);for(var pe=0;pe<U.length;++pe){var Ae=H.charCodeAt(pe);U.write_shift(1,Ae>=128?95:Ae)}return U.write_shift(1,0),U}function _(B,te,H){var U=c(B,te,H);return U[1].v=B.read_shift(2,"i"),U}function v(B,te,H){var U=ce(7);return U.write_shift(1,255),U.write_shift(2,te),U.write_shift(2,B),U.write_shift(2,H,"i"),U}function b(B,te,H){var U=c(B,te,H);return U[1].v=B.read_shift(8,"f"),U}function m(B,te,H){var U=ce(13);return U.write_shift(1,255),U.write_shift(2,te),U.write_shift(2,B),U.write_shift(8,H,"f"),U}function y(B,te,H){var U=B.l+te,pe=c(B,te,H);if(pe[1].v=B.read_shift(8,"f"),H.qpro)B.l=U;else{var Ae=B.read_shift(2);W(B.slice(B.l,B.l+Ae),pe),B.l+=Ae}return pe}function k(B,te,H){var U=te&32768;return te&=-32769,te=(U?B:0)+(te>=8192?te-16384:te),(U?"":"$")+(H?ci(te):xi(te))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function W(B,te){Hi(B,0);for(var H=[],U=0,pe="",Ae="",Ce="",Te="";B.l<B.length;){var xe=B[B.l++];switch(xe){case 0:H.push(B.read_shift(8,"f"));break;case 1:Ae=k(te[0].c,B.read_shift(2),!0),pe=k(te[0].r,B.read_shift(2),!1),H.push(Ae+pe);break;case 2:{var gt=k(te[0].c,B.read_shift(2),!0),P=k(te[0].r,B.read_shift(2),!1);Ae=k(te[0].c,B.read_shift(2),!0),pe=k(te[0].r,B.read_shift(2),!1),H.push(gt+P+":"+Ae+pe)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(B.read_shift(2));break;case 6:{for(var zt="";xe=B[B.l++];)zt+=String.fromCharCode(xe);H.push('"'+zt.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:Te=H.pop(),Ce=H.pop(),H.push(["AND","OR"][xe-20]+"("+Ce+","+Te+")");break;default:if(xe<32&&T[xe])Te=H.pop(),Ce=H.pop(),H.push(Ce+T[xe]+Te);else if(F[xe]){if(U=F[xe][1],U==69&&(U=B[B.l++]),U>H.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+H.join("|")+"|");return}var Dt=H.slice(-U);H.length-=U,H.push(F[xe][0]+"("+Dt.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}H.length==1?te[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function X(B){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=B.read_shift(2),te[3]=B[B.l++],te[0].c=B[B.l++],te}function z(B,te){var H=X(B,te);return H[1].t="s",H[1].v=B.read_shift(te-4,"cstr"),H}function M(B,te,H,U){var pe=ce(6+U.length);pe.write_shift(2,B),pe.write_shift(1,H),pe.write_shift(1,te),pe.write_shift(1,39);for(var Ae=0;Ae<U.length;++Ae){var Ce=U.charCodeAt(Ae);pe.write_shift(1,Ce>=128?95:Ce)}return pe.write_shift(1,0),pe}function K(B,te){var H=X(B,te);H[1].v=B.read_shift(2);var U=H[1].v>>1;if(H[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return H[1].v=U,H}function j(B,te){var H=X(B,te),U=B.read_shift(4),pe=B.read_shift(4),Ae=B.read_shift(2);if(Ae==65535)return U===0&&pe===3221225472?(H[1].t="e",H[1].v=15):U===0&&pe===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var Ce=Ae&32768;return Ae=(Ae&32767)-16446,H[1].v=(1-Ce*2)*(pe*Math.pow(2,Ae+32)+U*Math.pow(2,Ae)),H}function ne(B,te,H,U){var pe=ce(14);if(pe.write_shift(2,B),pe.write_shift(1,H),pe.write_shift(1,te),U==0)return pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(2,65535),pe;var Ae=0,Ce=0,Te=0,xe=0;return U<0&&(Ae=1,U=-U),Ce=Math.log2(U)|0,U/=Math.pow(2,Ce-31),xe=U>>>0,xe&2147483648||(U/=2,++Ce,xe=U>>>0),U-=xe,xe|=2147483648,xe>>>=0,U*=Math.pow(2,32),Te=U>>>0,pe.write_shift(4,Te),pe.write_shift(4,xe),Ce+=16383+(Ae?32768:0),pe.write_shift(2,Ce),pe}function oe(B,te){var H=j(B,14);return B.l+=te-14,H}function q(B,te){var H=X(B,te),U=B.read_shift(4);return H[1].v=U>>6,H}function Se(B,te){var H=X(B,te),U=B.read_shift(8,"f");return H[1].v=U,H}function Ne(B,te){var H=Se(B,14);return B.l+=te-10,H}function Ie(B,te){return B[B.l+te-1]==0?B.read_shift(te,"cstr"):""}function Ye(B,te){var H=B[B.l++];H>te-1&&(H=te-1);for(var U="";U.length<H;)U+=String.fromCharCode(B[B.l++]);return U}function ze(B,te,H){if(!(!H.qpro||te<21)){var U=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var pe=B.read_shift(te-21,"cstr");return[U,pe]}}function Et(B,te){for(var H={},U=B.l+te;B.l<U;){var pe=B.read_shift(2);if(pe==14e3){for(H[pe]=[0,""],H[pe][0]=B.read_shift(2);B[B.l];)H[pe][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return H}function Pe(B,te){var H=ce(5+B.length);H.write_shift(2,14e3),H.write_shift(2,te);for(var U=0;U<B.length;++U){var pe=B.charCodeAt(U);H[H.l++]=pe>127?95:pe}return H[H.l++]=0,H}var Ke={0:{n:"BOF",f:ki},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ie},222:{n:"SHEETNAMELP",f:Ye},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:oe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Et},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:Se},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ze},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:r,to_workbook:n}}();function wI(t){var n={},e=t.match(tn),i=0,r=!1;if(e)for(;i!=e.length;++i){var a=ut(e[i]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;n.cp=kc[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=a.val;break;case"<sz":n.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":a.rgb&&(n.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(a[0].charCodeAt(1)!==47&&!r)throw new Error("Unrecognized rich format "+a[0])}}return n}var CI=function(){var t=Ns("t"),n=Ns("rPr");function e(a){var s=a.match(t);if(!s)return{t:"s",v:""};var o={t:"s",v:Vt(s[1])},l=a.match(n);return l&&(o.s=wI(l[1])),o}var i=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(s){return s.replace(i,"").split(r).map(e).filter(function(o){return o.v})}}(),TI=function(){var n=/(\r\n|\n)/g;function e(r,a,s){var o=[];r.u&&o.push("text-decoration: underline;"),r.uval&&o.push("text-underline-style:"+r.uval+";"),r.sz&&o.push("font-size:"+r.sz+"pt;"),r.outline&&o.push("text-effect: outline;"),r.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),r.b&&(a.push("<b>"),s.push("</b>")),r.i&&(a.push("<i>"),s.push("</i>")),r.strike&&(a.push("<s>"),s.push("</s>"));var l=r.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),r}function i(r){var a=[[],r.v,[]];return r.v?(r.s&&e(r.s,a[0],a[2]),a[0].join("")+a[1].replace(n,"<br/>")+a[2].join("")):""}return function(a){return a.map(i).join("")}}(),SI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,II=/<(?:\w+:)?r>/,kI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function t0(t,n){var e=n?n.cellHTML:!0,i={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=Vt(Xt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=Xt(t),e&&(i.h=Pc(i.t))):t.match(II)&&(i.r=Xt(t),i.t=Vt(Xt((t.replace(kI,"").match(SI)||[]).join("").replace(tn,""))),e&&(i.h=TI(CI(i.r)))),i):{t:""}}var EI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,FI=/<(?:\w+:)?(?:si|sstItem)>/g,DI=/<\/(?:\w+:)?(?:si|sstItem)>/;function MI(t,n){var e=[],i="";if(!t)return e;var r=t.match(EI);if(r){i=r[2].replace(FI,"").split(DI);for(var a=0;a!=i.length;++a){var s=t0(i[a].trim(),n);s!=null&&(e[e.length]=s)}r=ut(r[1]),e.Count=r.count,e.Unique=r.uniqueCount}return e}var OI=/^\s|\s$|[\t\n\r]/;function Bu(t,n){if(!n.bookSST)return"";var e=[vi];e[e.length]=ke("sst",null,{xmlns:fa[0],count:t.Count,uniqueCount:t.Unique});for(var i=0;i!=t.length;++i)if(t[i]!=null){var r=t[i],a="<si>";r.r?a+=r.r:(a+="<t",r.t||(r.t=""),r.t.match(OI)&&(a+=' xml:space="preserve"'),a+=">"+Gt(r.t)+"</t>"),a+="</si>",e[e.length]=a}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function AI(t){return[t.read_shift(4),t.read_shift(4)]}function LI(t,n){var e=[],i=!1;return br(t,function(a,s,o){switch(o){case 159:e.Count=a[0],e.Unique=a[1];break;case 19:e.push(a);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(s.T,!i||n.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),e}function RI(t,n){return n||(n=ce(8)),n.write_shift(4,t.Count),n.write_shift(4,t.Unique),n}var VI=GT;function PI(t){var n=un();ve(n,159,RI(t));for(var e=0;e<t.length;++e)ve(n,19,VI(t[e]));return ve(n,160),n.end()}function Nu(t){if(typeof Ht<"u")return Ht.utils.encode(is,t);for(var n=[],e=t.split(""),i=0;i<e.length;++i)n[i]=e[i].charCodeAt(0);return n}function gr(t,n){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),n>=4&&(t.l+=n-4),e}function BI(t){var n={};return n.id=t.read_shift(0,"lpp4"),n.R=gr(t,4),n.U=gr(t,4),n.W=gr(t,4),n}function NI(t){for(var n=t.read_shift(4),e=t.l+n-4,i={},r=t.read_shift(4),a=[];r-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(i.name=t.read_shift(0,"lpp4"),i.comps=a,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return i}function UI(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(NI(t));return n}function HI(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(t.read_shift(0,"lpp4"));return n}function zI(t){var n={};return t.read_shift(4),t.l+=4,n.id=t.read_shift(0,"lpp4"),n.name=t.read_shift(0,"lpp4"),n.R=gr(t,4),n.U=gr(t,4),n.W=gr(t,4),n}function WI(t){var n=zI(t);if(n.ename=t.read_shift(0,"8lpp4"),n.blksz=t.read_shift(4),n.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Uu(t,n){var e=t.l+n,i={};i.Flags=t.read_shift(4)&63,t.l+=4,i.AlgID=t.read_shift(4);var r=!1;switch(i.AlgID){case 26126:case 26127:case 26128:r=i.Flags==36;break;case 26625:r=i.Flags==4;break;case 0:r=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=t.read_shift(4),i.KeySize=t.read_shift(4),i.ProviderType=t.read_shift(4),t.l+=8,i.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,i}function Hu(t,n){var e={},i=t.l+n;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,i),t.l=i,e}function jI(t){var n=gr(t);switch(n.Minor){case 2:return[n.Minor,KI(t,n)];case 3:return[n.Minor,GI(t,n)];case 4:return[n.Minor,$I(t,n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function KI(t){var n=t.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),i=Uu(t,e),r=Hu(t,t.length-t.l);return{t:"Std",h:i,v:r}}function GI(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $I(t){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),i={};return e.replace(tn,function(a){var s=ut(a);switch(ar(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(o){i[o]=s[o]});break;case"<dataIntegrity":i.encryptedHmacKey=s.encryptedHmacKey,i.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(s);break;default:throw s[0]}}),i}function YI(t,n){var e={},i=e.EncryptionVersionInfo=gr(t,4);if(n-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);e.Flags=t.read_shift(4),n-=4;var r=t.read_shift(4);return n-=4,e.EncryptionHeader=Uu(t,r),n-=r,e.EncryptionVerifier=Hu(t,n),e}function XI(t){var n={},e=n.EncryptionVersionInfo=gr(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return n.Salt=t.read_shift(16),n.EncryptedVerifier=t.read_shift(16),n.EncryptedVerifierHash=t.read_shift(16),n}function i0(t){var n=0,e,i=Nu(t),r=i.length+1,a,s,o,l,c;for(e=Wr(r),e[0]=i.length,a=1;a!=r;++a)e[a]=i[a-1];for(a=r-1;a>=0;--a)s=e[a],o=n&16384?1:0,l=n<<1&32767,c=o|l,n=c^s;return n^52811}var zu=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(s){return(s/2|s*128)&255},r=function(s,o){return i(s^o)},a=function(s){for(var o=n[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var d=s[c],h=0;h!=7;++h)d&64&&(o^=e[l]),d*=2,--l;return o};return function(s){for(var o=Nu(s),l=a(o),c=o.length,d=Wr(16),h=0;h!=16;++h)d[h]=0;var _,v,b;for((c&1)===1&&(_=l>>8,d[c]=r(t[0],_),--c,_=l&255,v=o[o.length-1],d[c]=r(v,_));c>0;)--c,_=l>>8,d[c]=r(o[c],_),--c,_=l&255,d[c]=r(o[c],_);for(c=15,b=15-o.length;b>0;)_=l>>8,d[c]=r(t[b],_),--c,--b,_=l&255,d[c]=r(o[c],_),--c,--b;return d}}(),qI=function(t,n,e,i,r){r||(r=n),i||(i=zu(t));var a,s;for(a=0;a!=n.length;++a)s=n[a],s^=i[e],s=(s>>5|s<<3)&255,r[a]=s,++e;return[r,e,i]},ZI=function(t){var n=0,e=zu(t);return function(i){var r=qI("",i,n,e);return n=r[1],r[0]}};function QI(t,n,e,i){var r={key:ki(t),verificationBytes:ki(t)};return e.password&&(r.verifier=i0(e.password)),i.valid=r.verificationBytes===r.verifier,i.valid&&(i.insitu=ZI(e.password)),r}function JI(t,n,e){var i=e||{};return i.Info=t.read_shift(2),t.l-=2,i.Info===1?i.Data=XI(t,n):i.Data=YI(t,n),i}function ek(t,n,e){var i={Type:e.biff>=8?t.read_shift(2):0};return i.Type?JI(t,n-2,i):QI(t,e.biff>=8?n:n-2,e,i),i}var Wu=function(){function t(r,a){switch(a.type){case"base64":return n(wn(r),a);case"binary":return n(r,a);case"buffer":return n(kt&&Buffer.isBuffer(r)?r.toString("binary"):$r(r),a);case"array":return n(la(r),a)}throw new Error("Unrecognized type "+a.type)}function n(r,a){var s=a||{},o=s.dense?[]:{},l=r.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var _=/\\\w+\b/g,v=0,b,m=-1;b=_.exec(d);){switch(b[0]){case"\\cell":var y=d.slice(v,_.lastIndex-b[0].length);if(y[0]==" "&&(y=y.slice(1)),++m,y.length){var k={v:y,t:"s"};Array.isArray(o)?o[h][m]=k:o[dt({r:h,c:m})]=k}break}v=_.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=yt(c),o}function e(r,a){return Yr(t(r,a),a)}function i(r){for(var a=["{\\rtf1\\ansi"],s=Pt(r["!ref"]),o,l=Array.isArray(r),c=s.s.r;c<=s.e.r;++c){a.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var h=dt({r:c,c:d});o=l?(r[c]||[])[d]:r[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(xr(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:i}}();function tk(t){var n=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function Ws(t){for(var n=0,e=1;n!=3;++n)e=e*256+(t[n]>255?255:t[n]<0?0:t[n]);return e.toString(16).toUpperCase().slice(1)}function ik(t){var n=t[0]/255,e=t[1]/255,i=t[2]/255,r=Math.max(n,e,i),a=Math.min(n,e,i),s=r-a;if(s===0)return[0,0,n];var o=0,l=0,c=r+a;switch(l=s/(c>1?2-c:c),r){case n:o=((e-i)/s+6)%6;break;case e:o=(i-n)/s+2;break;case i:o=(n-e)/s+4;break}return[o/6,l,c/2]}function nk(t){var n=t[0],e=t[1],i=t[2],r=e*2*(i<.5?i:1-i),a=i-r/2,s=[a,a,a],o=6*n,l;if(e!==0)switch(o|0){case 0:case 6:l=r*o,s[0]+=r,s[1]+=l;break;case 1:l=r*(2-o),s[0]+=l,s[1]+=r;break;case 2:l=r*(o-2),s[1]+=r,s[2]+=l;break;case 3:l=r*(4-o),s[1]+=l,s[2]+=r;break;case 4:l=r*(o-4),s[2]+=r,s[0]+=l;break;case 5:l=r*(6-o),s[2]+=l,s[0]+=r;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function Yo(t,n){if(n===0)return t;var e=ik(tk(t));return n<0?e[2]=e[2]*(1+n):e[2]=1-(1-e[2])*(1-n),Ws(nk(e))}var ju=6,rk=15,ak=1,qi=ju;function js(t){return Math.floor((t+Math.round(128/qi)/256)*qi)}function Ks(t){return Math.floor((t-5)/qi*100+.5)/100}function Xo(t){return Math.round((t*qi+5)/qi*256)/256}function sc(t){return Xo(Ks(js(t)))}function n0(t){var n=Math.abs(t-sc(t)),e=qi;if(n>.005)for(qi=ak;qi<rk;++qi)Math.abs(t-sc(t))<=n&&(n=Math.abs(t-sc(t)),e=qi);qi=e}function jr(t){t.width?(t.wpx=js(t.width),t.wch=Ks(t.wpx),t.MDW=qi):t.wpx?(t.wch=Ks(t.wpx),t.width=Xo(t.wch),t.MDW=qi):typeof t.wch=="number"&&(t.width=Xo(t.wch),t.wpx=js(t.width),t.MDW=qi),t.customWidth&&delete t.customWidth}var sk=96,Ku=sk;function Gs(t){return t*96/Ku}function as(t){return t*Ku/96}var ok={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lk(t,n,e,i){n.Borders=[];var r={},a=!1;(t[0].match(tn)||[]).forEach(function(s){var o=ut(s);switch(ar(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":r={},o.diagonalUp&&(r.diagonalUp=Jt(o.diagonalUp)),o.diagonalDown&&(r.diagonalDown=Jt(o.diagonalDown)),n.Borders.push(r);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function ck(t,n,e,i){n.Fills=[];var r={},a=!1;(t[0].match(tn)||[]).forEach(function(s){var o=ut(s);switch(ar(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":r={},n.Fills.push(r);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":o.patternType&&(r.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":r.bgColor||(r.bgColor={}),o.indexed&&(r.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(r.bgColor.theme=parseInt(o.theme,10)),o.tint&&(r.bgColor.tint=parseFloat(o.tint)),o.rgb&&(r.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":r.fgColor||(r.fgColor={}),o.theme&&(r.fgColor.theme=parseInt(o.theme,10)),o.tint&&(r.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(r.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function dk(t,n,e,i){n.Fonts=[];var r={},a=!1;(t[0].match(tn)||[]).forEach(function(s){var o=ut(s);switch(ar(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(r),r={};break;case"<name":o.val&&(r.name=Xt(o.val));break;case"<name/>":case"</name>":break;case"<b":r.bold=o.val?Jt(o.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=o.val?Jt(o.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(o.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34;break}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=o.val?Jt(o.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=o.val?Jt(o.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=o.val?Jt(o.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=o.val?Jt(o.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=o.val?Jt(o.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":o.val&&(r.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(r.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(r.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(r.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=kc[parseInt(o.val,10)];break;case"<color":if(r.color||(r.color={}),o.auto&&(r.color.auto=Jt(o.auto)),o.rgb)r.color.rgb=o.rgb.slice(-6);else if(o.indexed){r.color.index=parseInt(o.indexed,10);var l=na[r.color.index];r.color.index==81&&(l=na[1]),l||(l=na[1]),r.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(r.color.theme=parseInt(o.theme,10),o.tint&&(r.color.tint=parseFloat(o.tint)),o.theme&&e.themeElements&&e.themeElements.clrScheme&&(r.color.rgb=Yo(e.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function pk(t,n,e){n.NumberFmt=[];for(var i=hi(lt),r=0;r<i.length;++r)n.NumberFmt[i[r]]=lt[i[r]];var a=t[0].match(tn);if(a)for(r=0;r<a.length;++r){var s=ut(a[r]);switch(ar(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Vt(Xt(s.formatCode)),l=parseInt(s.numFmtId,10);if(n.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&n.NumberFmt[l]!=null;--l);n.NumberFmt[l]=o}_r(o,l)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function uk(t){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)t[i]!=null&&(n[n.length]=ke("numFmt",null,{numFmtId:i,formatCode:Gt(t[i])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=ke("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var Ro=["numFmtId","fillId","fontId","borderId","xfId"],Vo=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function fk(t,n,e){n.CellXf=[];var i,r=!1;(t[0].match(tn)||[]).forEach(function(a){var s=ut(a),o=0;switch(ar(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=s,delete i[0],o=0;o<Ro.length;++o)i[Ro[o]]&&(i[Ro[o]]=parseInt(i[Ro[o]],10));for(o=0;o<Vo.length;++o)i[Vo[o]]&&(i[Vo[o]]=Jt(i[Vo[o]]));if(n.NumberFmt&&i.numFmtId>392){for(o=392;o>60;--o)if(n.NumberFmt[i.numFmtId]==n.NumberFmt[o]){i.numFmtId=o;break}}n.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Jt(s.wrapText)),i.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":r=!0;break;case"</AlternateContent>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(e&&e.WTF&&!r)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function hk(t){var n=[];return n[n.length]=ke("cellXfs",null),t.forEach(function(e){n[n.length]=ke("xf",null,e)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=ke("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var mk=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(n))&&pk(h,d,c),(h=o.match(r))&&dk(h,d,l,c),(h=o.match(i))&&ck(h,d,l,c),(h=o.match(a))&&lk(h,d,l,c),(h=o.match(e))&&fk(h,d,c),d}}();function Gu(t,n){var e=[vi,ke("styleSheet",null,{xmlns:fa[0],"xmlns:vt":Mi.vt})],i;return t.SSF&&(i=uk(t.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=hk(n.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function _k(t,n){var e=t.read_shift(2),i=Ji(t,n-2);return[e,i]}function gk(t,n,e){e||(e=ce(6+4*n.length)),e.write_shift(2,t),Bi(n,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function xk(t,n,e){var i={};i.sz=t.read_shift(2)/20;var r=JT(t,2,e);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var a=t.read_shift(2);switch(a===700&&(i.bold=1),t.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(i.underline=s);var o=t.read_shift(1);o>0&&(i.family=o);var l=t.read_shift(1);switch(l>0&&(i.charset=l),t.l++,i.color=QT(t,8),t.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Ji(t,n-21),i}function vk(t,n){n||(n=ce(25+4*32)),n.write_shift(2,t.sz*20),e4(t,n),n.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),n.write_shift(2,e),n.write_shift(1,t.underline||0),n.write_shift(1,t.family||0),n.write_shift(1,t.charset||0),n.write_shift(1,0),Ko(t.color,n);var i=0;return t.scheme=="major"&&(i=1),t.scheme=="minor"&&(i=2),n.write_shift(1,i),Bi(t.name,n),n.length>n.l?n.slice(0,n.l):n}var bk=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],oc,yk=en;function dp(t,n){n||(n=ce(4*3+8*7+16*1)),oc||(oc=el(bk));var e=oc[t.patternType];e==null&&(e=40),n.write_shift(4,e);var i=0;if(e!=40)for(Ko({auto:1},n),Ko({auto:1},n);i<12;++i)n.write_shift(4,0);else{for(;i<4;++i)n.write_shift(4,0);for(;i<12;++i)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function wk(t,n){var e=t.l+n,i=t.read_shift(2),r=t.read_shift(2);return t.l=e,{ixfe:i,numFmtId:r}}function $u(t,n,e){e||(e=ce(16)),e.write_shift(2,n||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Ts(t,n){return n||(n=ce(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var Ck=en;function Tk(t,n){return n||(n=ce(51)),n.write_shift(1,0),Ts(null,n),Ts(null,n),Ts(null,n),Ts(null,n),Ts(null,n),n.length>n.l?n.slice(0,n.l):n}function Sk(t,n){return n||(n=ce(12+4*10)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),jo(t.name||"",n),n.length>n.l?n.slice(0,n.l):n}function Ik(t,n,e){var i=ce(2052);return i.write_shift(4,t),jo(n,i),jo(e,i),i.length>i.l?i.slice(0,i.l):i}function kk(t,n,e){var i={};i.NumberFmt=[];for(var r in lt)i.NumberFmt[r]=lt[r];i.CellXf=[],i.Fonts=[];var a=[],s=!1;return br(t,function(l,c,d){switch(d){case 44:i.NumberFmt[l[0]]=l[1],_r(l[1],l[0]);break;case 43:i.Fonts.push(l),l.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(l.color.rgb=Yo(n.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&i.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;default:if(c.T>0)a.push(d);else if(c.T<0)a.pop();else if(!s||e.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),i}function Ek(t,n){if(n){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)n[r]!=null&&++e}),e!=0&&(ve(t,615,Yn(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)n[r]!=null&&ve(t,44,gk(r,n[r]))}),ve(t,616))}}function Fk(t){var n=1;n!=0&&(ve(t,611,Yn(n)),ve(t,43,vk({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ve(t,612))}function Dk(t){var n=2;n!=0&&(ve(t,603,Yn(n)),ve(t,45,dp({patternType:"none"})),ve(t,45,dp({patternType:"gray125"})),ve(t,604))}function Mk(t){var n=1;n!=0&&(ve(t,613,Yn(n)),ve(t,46,Tk({})),ve(t,614))}function Ok(t){var n=1;ve(t,626,Yn(n)),ve(t,47,$u({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ve(t,627)}function Ak(t,n){ve(t,617,Yn(n.length)),n.forEach(function(e){ve(t,47,$u(e,0))}),ve(t,618)}function Lk(t){var n=1;ve(t,619,Yn(n)),ve(t,48,Sk({xfId:0,builtinId:0,name:"Normal"})),ve(t,620)}function Rk(t){var n=0;ve(t,505,Yn(n)),ve(t,506)}function Vk(t){var n=0;ve(t,508,Ik(n,"TableStyleMedium9","PivotStyleMedium4")),ve(t,509)}function Pk(t,n){var e=un();return ve(e,278),Ek(e,t.SSF),Fk(e,t),Dk(e,t),Mk(e,t),Ok(e,t),Ak(e,n.cellXfs),Lk(e,t),Rk(e,t),Vk(e,t),ve(e,279),e.end()}var Bk=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Nk(t,n,e){n.themeElements.clrScheme=[];var i={};(t[0].match(tn)||[]).forEach(function(r){var a=ut(r);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=a.val;break;case"<a:sysClr":i.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(n.themeElements.clrScheme[Bk.indexOf(a[0])]=i,i={}):i.name=a[0].slice(3,a[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Uk(){}function Hk(){}var zk=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Wk=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,jk=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Kk(t,n,e){n.themeElements={};var i;[["clrScheme",zk,Nk],["fontScheme",Wk,Uk],["fmtScheme",jk,Hk]].forEach(function(r){if(!(i=t.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](i,n,e)})}var Gk=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Yu(t,n){(!t||t.length===0)&&(t=r0());var e,i={};if(!(e=t.match(Gk)))throw new Error("themeElements not found in theme");return Kk(e[0],i,n),i.raw=t,i}function r0(t,n){if(n&&n.themeXLSX)return n.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[vi];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function $k(t,n,e){var i=t.l+n,r=t.read_shift(4);if(r!==124226){if(!e.cellStyles){t.l=i;return}var a=t.slice(t.l);t.l=i;var s;try{s=Kp(a,{type:"array"})}catch{return}var o=yn(s,"theme/theme/theme1.xml",!0);if(o)return Yu(o,e)}}function Yk(t){return t.read_shift(4)}function Xk(t){var n={};switch(n.xclrType=t.read_shift(2),n.nTintShade=t.read_shift(2),n.xclrType){case 0:t.l+=4;break;case 1:n.xclrValue=qk(t,4);break;case 2:n.xclrValue=ku(t,4);break;case 3:n.xclrValue=Yk(t,4);break;case 4:t.l+=4;break}return t.l+=8,n}function qk(t,n){return en(t,n)}function Zk(t,n){return en(t,n)}function Qk(t){var n=t.read_shift(2),e=t.read_shift(2)-4,i=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=Xk(t,e);break;case 6:i[1]=Zk(t,e);break;case 14:case 15:i[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+e)}return i}function Jk(t,n){var e=t.l+n;t.l+=2;var i=t.read_shift(2);t.l+=2;for(var r=t.read_shift(2),a=[];r-- >0;)a.push(Qk(t,e-t.l));return{ixfe:i,ext:a}}function eE(t,n){n.forEach(function(e){switch(e[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function tE(t,n){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ji(t,n-8)}}function iE(t){var n=ce(12+2*t.name.length);return n.write_shift(4,t.flags),n.write_shift(4,t.version),Bi(t.name,n),n.slice(0,n.l)}function nE(t){for(var n=[],e=t.read_shift(4);e-- >0;)n.push([t.read_shift(4),t.read_shift(4)]);return n}function rE(t){var n=ce(4+8*t.length);n.write_shift(4,t.length);for(var e=0;e<t.length;++e)n.write_shift(4,t[e][0]),n.write_shift(4,t[e][1]);return n}function aE(t,n){var e=ce(8+2*n.length);return e.write_shift(4,t),Bi(n,e),e.slice(0,e.l)}function sE(t){return t.l+=4,t.read_shift(4)!=0}function oE(t,n){var e=ce(8);return e.write_shift(4,t),e.write_shift(4,n?1:0),e}function lE(t,n,e){var i={Types:[],Cell:[],Value:[]},r=e||{},a=[],s=!1,o=2;return br(t,function(l,c,d){switch(d){case 335:i.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?i.Cell.push({type:i.Types[h[0]-1].name,index:h[1]}):o==0&&i.Value.push({type:i.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!c.T){if(!s||r.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),i}function cE(){var t=un();return ve(t,332),ve(t,334,Yn(1)),ve(t,335,iE({name:"XLDAPR",version:12e4,flags:3496657072})),ve(t,336),ve(t,339,aE(1,"XLDAPR")),ve(t,52),ve(t,35,Yn(514)),ve(t,4096,Yn(0)),ve(t,4097,Pn(1)),ve(t,36),ve(t,53),ve(t,340),ve(t,337,oE(1,!0)),ve(t,51,rE([[1,0]])),ve(t,338),ve(t,333),t.end()}function dE(t,n,e){var i={Types:[],Cell:[],Value:[]};if(!t)return i;var r=!1,a=2,s;return t.replace(tn,function(o){var l=ut(o);switch(ar(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<i.Types.length;++c)i.Types[c].name==l.name&&(s=i.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?i.Cell.push({type:i.Types[l.t-1].name,index:+l.v}):a==0&&i.Value.push({type:i.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),i}function Xu(){var t=[vi];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function pE(t){var n=[];if(!t)return n;var e=1;return(t.match(tn)||[]).forEach(function(i){var r=ut(i);switch(r[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?e=r.i:r.i=e,n.push(r);break}}),n}function uE(t){var n={};n.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),n.r=dt(e);var i=t.read_shift(1);return i&2&&(n.l="1"),i&8&&(n.a="1"),n}function fE(t,n,e){var i=[],r=!1;return br(t,function(s,o,l){switch(l){case 63:i.push(s);break;default:if(!o.T){if(!r||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),i}function hE(t,n,e,i){if(!t)return t;var r=i||{},a=!1,s=!1;br(t,function(l,c,d){if(!s)switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},r)}function mE(t,n){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][e].Target}var Za=1024;function qu(t,n){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),r=[ke("xml",null,{"xmlns:v":vn.v,"xmlns:o":vn.o,"xmlns:x":vn.x,"xmlns:mv":vn.mv}).replace(/\/>/,">"),ke("o:shapelayout",ke("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ke("v:shapetype",[ke("v:stroke",null,{joinstyle:"miter"}),ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];Za<t*1e3;)Za+=1e3;return n.forEach(function(a){var s=di(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ke("v:fill",l,o),d={on:"t",obscured:"t"};++Za,r=r.concat(["<v:shape"+Us({id:"_x0000_s"+Za,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ke("v:shadow",null,d),ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zi("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),zi("x:AutoFill","False"),zi("x:Row",String(s.r)),zi("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function pp(t,n,e,i){var r=Array.isArray(t),a;n.forEach(function(s){var o=di(s.ref);if(r?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[s.ref],!a){a={t:"z"},r?t[o.r][o.c]=a:t[s.ref]=a;var l=Pt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=yt(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var d={a:s.author,t:s.t,r:s.r,T:e};s.h&&(d.h=s.h);for(var h=a.c.length-1;h>=0;--h){if(!e&&a.c[h].T)return;e&&!a.c[h].T&&a.c.splice(h,1)}if(e&&i){for(h=0;h<i.length;++h)if(d.a==i[h].id){d.a=i[h].name||d.a;break}}a.c.push(d)})}function _E(t,n){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],i=[],r=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&e.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ut(o[0]),c={author:l.authorId&&e[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=di(l.ref);if(!(n.sheetRows&&n.sheetRows<=d.r)){var h=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!h&&!!h[1]&&t0(h[1])||{r:"",t:"",h:""};c.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),c.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(c.h=_.h),i.push(c)}}}}),i}function Zu(t){var n=[vi,ke("comments",null,{xmlns:fa[0]})],e=[];return n.push("<authors>"),t.forEach(function(i){i[1].forEach(function(r){var a=Gt(r.a);e.indexOf(a)==-1&&(e.push(a),n.push("<author>"+a+"</author>")),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),n.push("<author>tc="+r.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),t.forEach(function(i){var r=0,a=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?r=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(l){l.a&&(r=e.indexOf(Gt(l.a))),a.push(l.t||"")}),n.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>'),a.length<=1)n.push(zi("t",Gt(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;n.push(zi("t",Gt(s)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function gE(t,n){var e=[],i=!1,r={},a=0;return t.replace(tn,function(o,l){var c=ut(o);switch(ar(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":r={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":r.t!=null&&e.push(r);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":r.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&n.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),e}function xE(t,n,e){var i=[vi,ke("ThreadedComments",null,{xmlns:Mi.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(r){var a="";(r[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&n.indexOf(s.a)==-1&&n.push(s.a);var l={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(s.a)).slice(-12)+"}"),i.push(ke("threadedComment",zi("text",s.t||""),l))})}),i.push("</ThreadedComments>"),i.join("")}function vE(t,n){var e=[],i=!1;return t.replace(tn,function(a){var s=ut(a);switch(ar(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&n.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),e}function bE(t){var n=[vi,ke("personList",null,{xmlns:Mi.TCMNT,"xmlns:x":fa[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,i){n.push(ke("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),n.push("</personList>"),n.join("")}function yE(t){var n={};n.iauthor=t.read_shift(4);var e=ga(t,16);return n.rfx=e.s,n.ref=dt(e.s),t.l+=16,n}function wE(t,n){return n==null&&(n=ce(36)),n.write_shift(4,t[1].iauthor),ds(t[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var CE=Ji;function TE(t){return Bi(t.slice(0,54))}function SE(t,n){var e=[],i=[],r={},a=!1;return br(t,function(o,l,c){switch(c){case 632:i.push(o);break;case 635:r=o;break;case 637:r.t=o.t,r.h=o.h,r.r=o.r;break;case 636:if(r.author=i[r.iauthor],delete r.iauthor,n.sheetRows&&r.rfx&&n.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,e.push(r);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),e}function IE(t){var n=un(),e=[];return ve(n,628),ve(n,630),t.forEach(function(i){i[1].forEach(function(r){e.indexOf(r.a)>-1||(e.push(r.a.slice(0,54)),ve(n,632,TE(r.a)))})}),ve(n,631),ve(n,633),t.forEach(function(i){i[1].forEach(function(r){r.iauthor=e.indexOf(r.a);var a={s:di(i[0]),e:di(i[0])};ve(n,635,wE([a,r])),r.t&&r.t.length>0&&ve(n,637,YT(r)),ve(n,636),delete r.iauthor})}),ve(n,634),ve(n,629),n.end()}var kE="application/vnd.ms-office.vbaProject";function EE(t){var n=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,i){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var r=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(n,r,t.FileIndex[i].content)}}),et.write(n)}function FE(t,n){n.FullPaths.forEach(function(e,i){if(i!=0){var r=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&et.utils.cfb_add(t,r,n.FileIndex[i].content)}})}var Qu=["xlsb","xlsm","xlam","biff8","xla"];function DE(){return{"!type":"dialog"}}function ME(){return{"!type":"dialog"}}function OE(){return{"!type":"macro"}}function AE(){return{"!type":"macro"}}var es=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function e(i,r,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=n.c:--d,l?c+=n.r:--c,r+(o?"":"$")+ci(d)+(l?"":"$")+xi(c)}return function(r,a){return n=a,r.replace(t,e)}}(),a0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,s0=function(){return function(n,e){return n.replace(a0,function(i,r,a,s,o,l){var c=Gc(s)-(a?0:e.c),d=Kc(l)-(o?0:e.r),h=d==0?"":o?d+1:"["+d+"]",_=c==0?"":a?c+1:"["+c+"]";return r+"R"+h+"C"+_})}}();function Ju(t,n){return t.replace(a0,function(e,i,r,a,s,o){return i+(r=="$"?r+a:ci(Gc(a)+n.c))+(s=="$"?s+o:xi(Kc(o)+n.r))})}function LE(t,n,e){var i=fn(n),r=i.s,a=di(e),s={r:a.r-r.r,c:a.c-r.c};return Ju(t,s)}function RE(t){return t.length!=1}function up(t){return t.replace(/_xlfn\./g,"")}function Si(t){t.l+=1}function Kr(t,n){var e=t.read_shift(n==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function ef(t,n,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return tf(t,n,e);e.biff==12&&(i=4)}var r=t.read_shift(i),a=t.read_shift(i),s=Kr(t,2),o=Kr(t,2);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function tf(t){var n=Kr(t,2),e=Kr(t,2),i=t.read_shift(1),r=t.read_shift(1);return{s:{r:n[0],c:i,cRel:n[1],rRel:n[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function VE(t,n,e){if(e.biff<8)return tf(t,n,e);var i=t.read_shift(e.biff==12?4:2),r=t.read_shift(e.biff==12?4:2),a=Kr(t,2),s=Kr(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r,c:s[0],cRel:s[1],rRel:s[2]}}}function nf(t,n,e){if(e&&e.biff>=2&&e.biff<=5)return PE(t,n,e);var i=t.read_shift(e&&e.biff==12?4:2),r=Kr(t,2);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function PE(t){var n=Kr(t,2),e=t.read_shift(1);return{r:n[0],c:e,cRel:n[1],rRel:n[2]}}function BE(t){var n=t.read_shift(2),e=t.read_shift(2);return{r:n,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function NE(t,n,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return UE(t,n,e);var r=t.read_shift(i>=12?4:2),a=t.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;r>524287;)r-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r,c:a,cRel:s,rRel:o}}function UE(t){var n=t.read_shift(2),e=t.read_shift(1),i=(n&32768)>>15,r=(n&16384)>>14;return n&=16383,i==1&&n>=8192&&(n=n-16384),r==1&&e>=128&&(e=e-256),{r:n,c:e,cRel:r,rRel:i}}function HE(t,n,e){var i=(t[t.l++]&96)>>5,r=ef(t,e.biff>=2&&e.biff<=5?6:8,e);return[i,r]}function zE(t,n,e){var i=(t[t.l++]&96)>>5,r=t.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var s=ef(t,a,e);return[i,r,s]}function WE(t,n,e){var i=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function jE(t,n,e){var i=(t[t.l++]&96)>>5,r=t.read_shift(2),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[i,r]}function KE(t,n,e){var i=(t[t.l++]&96)>>5,r=VE(t,n-1,e);return[i,r]}function GE(t,n,e){var i=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[i]}function fp(t){var n=t[t.l+1]&1,e=1;return t.l+=4,[n,e]}function $E(t,n,e){t.l+=2;for(var i=t.read_shift(e&&e.biff==2?1:2),r=[],a=0;a<=i;++a)r.push(t.read_shift(e&&e.biff==2?1:2));return r}function YE(t,n,e){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(e&&e.biff==2?1:2)]}function XE(t,n,e){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(e&&e.biff==2?1:2)]}function qE(t){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(2)]}function ZE(t,n,e){var i=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[i]}function rf(t){var n=t.read_shift(1),e=t.read_shift(1);return[n,e]}function QE(t){return t.read_shift(2),rf(t,2)}function JE(t){return t.read_shift(2),rf(t,2)}function e6(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=nf(t,0,e);return[i,r]}function t6(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=NE(t,0,e);return[i,r]}function i6(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var a=nf(t,0,e);return[i,r,a]}function n6(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=t.read_shift(e&&e.biff<=3?1:2);return[s8[r],of[r],i]}function r6(t,n,e){var i=t[t.l++],r=t.read_shift(1),a=e&&e.biff<=3?[i==88?-1:0,t.read_shift(1)]:a6(t);return[r,(a[0]===0?of:a8)[a[1]]]}function a6(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function s6(t,n,e){t.l+=e&&e.biff==2?3:4}function o6(t,n,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var i=t.read_shift(2),r=t.read_shift(e&&e.biff==2?1:2);return[i,r]}function l6(t){return t.l++,yr[t.read_shift(1)]}function c6(t){return t.l++,t.read_shift(2)}function d6(t){return t.l++,t.read_shift(1)!==0}function p6(t){return t.l++,Zi(t,8)}function u6(t,n,e){return t.l++,Zs(t,n-1,e)}function f6(t,n){var e=[t.read_shift(1)];if(n==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=gi(t,1)?"TRUE":"FALSE",n!=12&&(t.l+=7);break;case 37:case 16:e[1]=yr[t[t.l]],t.l+=n==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=Zi(t,8);break;case 2:e[1]=xa(t,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function h6(t,n,e){for(var i=t.read_shift(e.biff==12?4:2),r=[],a=0;a!=i;++a)r.push((e.biff==12?ga:rl)(t,8));return r}function m6(t,n,e){var i=0,r=0;e.biff==12?(i=t.read_shift(4),r=t.read_shift(4)):(r=1+t.read_shift(1),i=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--r==0&&(r=256));for(var a=0,s=[];a!=i&&(s[a]=[]);++a)for(var o=0;o!=r;++o)s[a][o]=f6(t,e.biff);return s}function _6(t,n,e){var i=t.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,a=t.read_shift(r);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[i,0,a]}function g6(t,n,e){if(e.biff==5)return x6(t,n,e);var i=t.read_shift(1)>>>5&3,r=t.read_shift(2),a=t.read_shift(4);return[i,r,a]}function x6(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var i=t.read_shift(2);return t.l+=12,[n,e,i]}function v6(t,n,e){var i=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var r=t.read_shift(e&&e.biff==2?1:2);return[i,r]}function b6(t,n,e){var i=t.read_shift(1)>>>5&3,r=t.read_shift(e&&e.biff==2?1:2);return[i,r]}function y6(t,n,e){var i=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[i]}function w6(t,n,e){var i=(t[t.l++]&96)>>5,r=t.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[i,r]}var C6=en,T6=en,S6=en;function Js(t,n,e){return t.l+=2,[BE(t,4,e)]}function o0(t){return t.l+=6,[]}var I6=Js,k6=o0,E6=o0,F6=Js;function af(t){return t.l+=2,[ki(t),t.read_shift(2)&1]}var D6=Js,M6=af,O6=o0,A6=Js,L6=Js,R6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function V6(t){t.l+=2;var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(4),r=t.read_shift(2),a=t.read_shift(2),s=R6[e>>2&31];return{ixti:n,coltype:e&3,rt:s,idx:i,c:r,C:a}}function P6(t){return t.l+=2,[t.read_shift(4)]}function B6(t,n,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function N6(t,n,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function U6(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[n,e]}function H6(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[n,e]}function z6(t){return t.l+=4,[0,0]}var hp={1:{n:"PtgExp",f:o6},2:{n:"PtgTbl",f:S6},3:{n:"PtgAdd",f:Si},4:{n:"PtgSub",f:Si},5:{n:"PtgMul",f:Si},6:{n:"PtgDiv",f:Si},7:{n:"PtgPower",f:Si},8:{n:"PtgConcat",f:Si},9:{n:"PtgLt",f:Si},10:{n:"PtgLe",f:Si},11:{n:"PtgEq",f:Si},12:{n:"PtgGe",f:Si},13:{n:"PtgGt",f:Si},14:{n:"PtgNe",f:Si},15:{n:"PtgIsect",f:Si},16:{n:"PtgUnion",f:Si},17:{n:"PtgRange",f:Si},18:{n:"PtgUplus",f:Si},19:{n:"PtgUminus",f:Si},20:{n:"PtgPercent",f:Si},21:{n:"PtgParen",f:Si},22:{n:"PtgMissArg",f:Si},23:{n:"PtgStr",f:u6},26:{n:"PtgSheet",f:B6},27:{n:"PtgEndSheet",f:N6},28:{n:"PtgErr",f:l6},29:{n:"PtgBool",f:d6},30:{n:"PtgInt",f:c6},31:{n:"PtgNum",f:p6},32:{n:"PtgArray",f:GE},33:{n:"PtgFunc",f:n6},34:{n:"PtgFuncVar",f:r6},35:{n:"PtgName",f:_6},36:{n:"PtgRef",f:e6},37:{n:"PtgArea",f:HE},38:{n:"PtgMemArea",f:v6},39:{n:"PtgMemErr",f:C6},40:{n:"PtgMemNoMem",f:T6},41:{n:"PtgMemFunc",f:b6},42:{n:"PtgRefErr",f:y6},43:{n:"PtgAreaErr",f:WE},44:{n:"PtgRefN",f:t6},45:{n:"PtgAreaN",f:KE},46:{n:"PtgMemAreaN",f:U6},47:{n:"PtgMemNoMemN",f:H6},57:{n:"PtgNameX",f:g6},58:{n:"PtgRef3d",f:i6},59:{n:"PtgArea3d",f:zE},60:{n:"PtgRefErr3d",f:w6},61:{n:"PtgAreaErr3d",f:jE},255:{}},W6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},j6={1:{n:"PtgElfLel",f:af},2:{n:"PtgElfRw",f:A6},3:{n:"PtgElfCol",f:I6},6:{n:"PtgElfRwV",f:L6},7:{n:"PtgElfColV",f:F6},10:{n:"PtgElfRadical",f:D6},11:{n:"PtgElfRadicalS",f:O6},13:{n:"PtgElfColS",f:k6},15:{n:"PtgElfColSV",f:E6},16:{n:"PtgElfRadicalLel",f:M6},25:{n:"PtgList",f:V6},29:{n:"PtgSxName",f:P6},255:{}},K6={0:{n:"PtgAttrNoop",f:z6},1:{n:"PtgAttrSemi",f:ZE},2:{n:"PtgAttrIf",f:XE},4:{n:"PtgAttrChoose",f:$E},8:{n:"PtgAttrGoto",f:YE},16:{n:"PtgAttrSum",f:s6},32:{n:"PtgAttrBaxcel",f:fp},33:{n:"PtgAttrBaxcel",f:fp},64:{n:"PtgAttrSpace",f:QE},65:{n:"PtgAttrSpaceSemi",f:JE},128:{n:"PtgAttrIfError",f:qE},255:{}};function eo(t,n,e,i){if(i.biff<8)return en(t,n);for(var r=t.l+n,a=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=m6(t,0,i),a.push(e[s][1]);break;case"PtgMemArea":e[s][2]=h6(t,e[s][1],i),a.push(e[s][2]);break;case"PtgExp":i&&i.biff==12&&(e[s][1][1]=t.read_shift(4),a.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0];default:break}return n=r-t.l,n!==0&&a.push(en(t,n)),a}function to(t,n,e){for(var i=t.l+n,r,a,s=[];i!=t.l;)n=i-t.l,a=t[t.l],r=hp[a]||hp[W6[a]],(a===24||a===25)&&(r=(a===24?j6:K6)[t[t.l+1]]),!r||!r.f?en(t,n):s.push([r.n,r.f(t,n,e)]);return s}function G6(t){for(var n=[],e=0;e<t.length;++e){for(var i=t[e],r=[],a=0;a<i.length;++a){var s=i[a];if(s)switch(s[0]){case 2:r.push('"'+s[1].replace(/"/g,'""')+'"');break;default:r.push(s[1])}else r.push("")}n.push(r.join(","))}return n.join(";")}var $6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Y6(t,n){if(!t&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function sf(t,n,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[n]))return t.SheetNames[n];if(!t.XTI)return"SH33TJSERR6";var i=t.XTI[n];if(e.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":t.XTI[n-1];if(!i)return"SH33TJSERR1";var r="";if(e.biff>8)switch(t[i[0]][0]){case 357:return r=i[1]==-1?"#REF":t.SheetNames[i[1]],i[1]==i[2]?r:r+":"+t.SheetNames[i[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[i[0]][0];case 355:default:return"SH33TJSSRC"+t[i[0]][0]}switch(t[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":t.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+t.SheetNames[i[2]];case 14849:return t[i[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[i[0]][0][3]?(r=i[1]==-1?"#REF":t[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+t[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function mp(t,n,e){var i=sf(t,n,e);return i=="#REF"?i:Y6(i,e)}function Xi(t,n,e,i,r){var a=r&&r.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,d,h=0,_=0,v,b="";if(!t[0]||!t[0][0])return"";for(var m=-1,y="",k=0,F=t[0].length;k<F;++k){var T=t[0][k];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:y=pi(" ",t[0][m][1][1]);break;case 1:y=pi("\r",t[0][m][1][1]);break;default:if(y="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+y,m=-1}o.push(c+$6[T[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Fs(T[1][1],s,r),o.push(Ds(d,a));break;case"PtgRefN":d=e?Fs(T[1][1],e,r):T[1][1],o.push(Ds(d,a));break;case"PtgRef3d":h=T[1][1],d=Fs(T[1][2],s,r),b=mp(i,h,r);var W=b;o.push(b+"!"+Ds(d,a));break;case"PtgFunc":case"PtgFuncVar":var X=T[1][0],z=T[1][1];X||(X=0),X&=127;var M=X==0?[]:o.slice(-X);o.length-=X,z==="User"&&(z=M.shift()),o.push(z+"("+M.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":v=jd(T[1][1],e?{s:e}:s,r),o.push(nc(v,r));break;case"PtgArea":v=jd(T[1][1],s,r),o.push(nc(v,r));break;case"PtgArea3d":h=T[1][1],v=T[1][2],b=mp(i,h,r),o.push(b+"!"+nc(v,r));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=T[1][2];var K=(i.names||[])[_-1]||(i[0]||[])[_],j=K?K.Name:"SH33TJSNAME"+String(_);j&&j.slice(0,6)=="_xlfn."&&!r.xlfn&&(j=j.slice(6)),o.push(j);break;case"PtgNameX":var ne=T[1][1];_=T[1][2];var oe;if(r.biff<=5)ne<0&&(ne=-ne),i[ne]&&(oe=i[ne][_]);else{var q="";if(((i[ne]||[])[0]||[])[0]==14849||(((i[ne]||[])[0]||[])[0]==1025?i[ne][_]&&i[ne][_].itab>0&&(q=i.SheetNames[i[ne][_].itab-1]+"!"):q=i.SheetNames[_-1]+"!"),i[ne]&&i[ne][_])q+=i[ne][_].Name;else if(i[0]&&i[0][_])q+=i[0][_].Name;else{var Se=(sf(i,ne,r)||"").split(";;");Se[_-1]?q=Se[_-1]:q+="SH33TJSERRX"}o.push(q);break}oe||(oe={Name:"SH33TJSERRY"}),o.push(oe.Name);break;case"PtgParen":var Ne="(",Ie=")";if(m>=0){switch(y="",t[0][m][1][0]){case 2:Ne=pi(" ",t[0][m][1][1])+Ne;break;case 3:Ne=pi("\r",t[0][m][1][1])+Ne;break;case 4:Ie=pi(" ",t[0][m][1][1])+Ie;break;case 5:Ie=pi("\r",t[0][m][1][1])+Ie;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(Ne+o.pop()+Ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var Ye={c:e.c,r:e.r};if(i.sharedf[dt(d)]){var ze=i.sharedf[dt(d)];o.push(Xi(ze,s,Ye,i,r))}else{var Et=!1;for(l=0;l!=i.arrayf.length;++l)if(c=i.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Xi(c[1],s,Ye,i,r)),Et=!0;break}Et||o.push(T[1])}break;case"PtgArray":o.push("{"+G6(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&m>=0&&Pe.indexOf(t[0][k][0])==-1){T=t[0][m];var Ke=!0;switch(T[1][0]){case 4:Ke=!1;case 0:y=pi(" ",T[1][1]);break;case 5:Ke=!1;case 1:y=pi("\r",T[1][1]);break;default:if(y="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((Ke?y:"")+o.pop()+(Ke?"":y)),m=-1}}if(o.length>1&&r.WTF)throw new Error("bad formula stack");return o[0]}function X6(t,n,e){var i=t.l+n,r=e.biff==2?1:2,a,s=t.read_shift(r);if(s==65535)return[[],en(t,n-2)];var o=to(t,s,e);return n!==s+r&&(a=eo(t,n-s-r,o,e)),t.l=i,[o,a]}function q6(t,n,e){var i=t.l+n,r=e.biff==2?1:2,a,s=t.read_shift(r);if(s==65535)return[[],en(t,n-2)];var o=to(t,s,e);return n!==s+r&&(a=eo(t,n-s-r,o,e)),t.l=i,[o,a]}function Z6(t,n,e,i){var r=t.l+n,a=to(t,i,e),s;return r!==t.l&&(s=eo(t,r-t.l,a,e)),[a,s]}function Q6(t,n,e){var i=t.l+n,r,a=t.read_shift(2),s=to(t,a,e);return a==65535?[[],en(t,n-2)]:(n!==a+2&&(r=eo(t,i-a-2,s,e)),[s,r])}function J6(t){var n;if(hr(t,t.l+6)!==65535)return[Zi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return n=t[t.l+2]===1,t.l+=8,[n,"b"];case 2:return n=t[t.l+2],t.l+=8,[n,"e"];case 3:return t.l+=8,["","s"]}return[]}function e8(t){if(t==null){var n=ce(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof t=="number")return ca(t);return ca(0)}function lc(t,n,e){var i=t.l+n,r=sr(t,6);e.biff==2&&++t.l;var a=J6(t,8),s=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var o=q6(t,i-t.l,e);return{cell:r,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function t8(t,n,e,i,r){var a=pa(n,e,r),s=e8(t.v),o=ce(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ce(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var h=Pi([a,s,o,c]);return h}function al(t,n,e){var i=t.read_shift(4),r=to(t,i,e),a=t.read_shift(4),s=a>0?eo(t,a,r,e):null;return[r,s]}var i8=al,sl=al,n8=al,r8=al,a8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},of={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},s8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _p(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function o8(t){var n="of:="+t.replace(a0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function cc(t){var n=t.split(":"),e=n[0].split(".")[0];return[e,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function l8(t){return t.replace(/\./,"!")}var Os={},ts={},As=typeof Map<"u";function l0(t,n,e){var i=0,r=t.length;if(e){if(As?e.has(n):Object.prototype.hasOwnProperty.call(e,n)){for(var a=As?e.get(n):e[n];i<a.length;++i)if(t[a[i]].t===n)return t.Count++,a[i]}}else for(;i<r;++i)if(t[i].t===n)return t.Count++,i;return t[r]={t:n},t.Count++,t.Unique++,e&&(As?(e.has(n)||e.set(n,[]),e.get(n).push(r)):(Object.prototype.hasOwnProperty.call(e,n)||(e[n]=[]),e[n].push(r))),r}function ol(t,n){var e={min:t+1,max:t+1},i=-1;return n.MDW&&(qi=n.MDW),n.width!=null?e.customWidth=1:n.wpx!=null?i=Ks(n.wpx):n.wch!=null&&(i=n.wch),i>-1?(e.width=Xo(i),e.customWidth=1):n.width!=null&&(e.width=n.width),n.hidden&&(e.hidden=!0),n.level!=null&&(e.outlineLevel=e.level=n.level),e}function sa(t,n){if(t){var e=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function Xr(t,n,e){var i=e.revssf[n.z!=null?n.z:"General"],r=60,a=t.length;if(i==null&&e.ssf){for(;r<392;++r)if(e.ssf[r]==null){_r(n.z,r),e.ssf[r]=n.z,e.revssf[n.z]=i=r;break}}for(r=0;r!=a;++r)if(t[r].numFmtId===i)return r;return t[a]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function lf(t,n,e,i,r,a){try{i.cellNF&&(t.z=lt[n])}catch(o){if(i.WTF)throw o}if(!(t.t==="z"&&!i.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=ei(t.v)),(!i||i.cellText!==!1)&&t.t!=="z")try{if(lt[n]==null&&_r(aT[n]||"General",n),t.t==="e")t.w=t.w||yr[t.v];else if(n===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bs(t.v);else if(t.t==="d"){var s=Oi(t.v);(s|0)===s?t.w=s.toString(10):t.w=Bs(s)}else{if(t.v===void 0)return"";t.w=oa(t.v,ts)}else t.t==="d"?t.w=Nn(n,Oi(t.v),ts):t.w=Nn(n,t.v,ts)}catch(o){if(i.WTF)throw o}if(i.cellStyles&&e!=null)try{t.s=a.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Yo(r.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),i.WTF&&(t.s.fgColor.raw_rgb=r.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Yo(r.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),i.WTF&&(t.s.bgColor.raw_rgb=r.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(i.WTF&&a.Fills)throw o}}}function c8(t,n,e){if(t&&t["!ref"]){var i=Pt(t["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function d8(t,n){var e=Pt(n);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=yt(e))}var p8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,u8=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,f8=/<(?:\w:)?hyperlink [^>]*>/mg,h8=/"(\w*:\w*)"/,m8=/<(?:\w:)?col\b[^>]*[\/]?>/g,_8=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,g8=/<(?:\w:)?pageMargins[^>]*\/>/g,cf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,x8=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,v8=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function b8(t,n,e,i,r,a,s){if(!t)return t;i||(i={"!id":{}}),fi!=null&&n.dense==null&&(n.dense=fi);var o=n.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=t.match(u8);h?(c=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):c=d=t;var _=c.match(cf);_?c0(_[0],o,r,e):(_=c.match(x8))&&w8(_[0],_[1]||"",o,r,e,s,a);var v=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var b=c.slice(v,v+50).match(h8);b&&d8(o,b[1])}var m=c.match(v8);m&&m[1]&&R8(m[1],r);var y=[];if(n.cellStyles){var k=c.match(m8);k&&D8(y,k)}h&&B8(h[1],o,n,l,a,s);var F=d.match(_8);F&&(o["!autofilter"]=O8(F[0]));var T=[],W=d.match(p8);if(W)for(v=0;v!=W.length;++v)T[v]=Pt(W[v].slice(W[v].indexOf('"')+1));var X=d.match(f8);X&&k8(o,X,i);var z=d.match(g8);if(z&&(o["!margins"]=E8(ut(z[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=yt(l)),n.sheetRows>0&&o["!ref"]){var M=Pt(o["!ref"]);n.sheetRows<=+M.e.r&&(M.e.r=n.sheetRows-1,M.e.r>l.e.r&&(M.e.r=l.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>l.e.c&&(M.e.c=l.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),o["!fullref"]=o["!ref"],o["!ref"]=yt(M))}return y.length>0&&(o["!cols"]=y),T.length>0&&(o["!merges"]=T),o}function y8(t){if(t.length===0)return"";for(var n='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)n+='<mergeCell ref="'+yt(t[e])+'"/>';return n+"</mergeCells>"}function c0(t,n,e,i){var r=ut(t);e.Sheets[i]||(e.Sheets[i]={}),r.codeName&&(e.Sheets[i].CodeName=Vt(Xt(r.codeName)))}function w8(t,n,e,i,r){c0(t.slice(0,t.indexOf(">")),e,i,r)}function C8(t,n,e,i,r){var a=!1,s={},o=null;if(i.bookType!=="xlsx"&&n.vbaraw){var l=n.SheetNames[e];try{n.Workbook&&(l=n.Workbook.Sheets[e].CodeName||l)}catch{}a=!0,s.codeName=nr(Gt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+ke("outlinePr",null,c)}!a&&!o||(r[r.length]=ke("sheetPr",o,s))}var T8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],S8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function I8(t){var n={sheet:1};return T8.forEach(function(e){t[e]!=null&&t[e]&&(n[e]="1")}),S8.forEach(function(e){t[e]!=null&&!t[e]&&(n[e]="0")}),t.password&&(n.password=i0(t.password).toString(16).toUpperCase()),ke("sheetProtection",null,n)}function k8(t,n,e){for(var i=Array.isArray(t),r=0;r!=n.length;++r){var a=ut(Xt(n[r]),!0);if(!a.ref)return;var s=((e||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+Vt(a.location))):(a.Target="#"+Vt(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Pt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=dt({c,r:l});i?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function E8(t){var n={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(n[e]=parseFloat(t[e]))}),n}function F8(t){return sa(t),ke("pageMargins",null,t)}function D8(t,n){for(var e=!1,i=0;i!=n.length;++i){var r=ut(n[i],!0);r.hidden&&(r.hidden=Jt(r.hidden));var a=parseInt(r.min,10)-1,s=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!e&&r.width&&(e=!0,n0(r.width)),jr(r);a<=s;)t[a++]=ti(r)}}function M8(t,n){for(var e=["<cols>"],i,r=0;r!=n.length;++r)(i=n[r])&&(e[e.length]=ke("col",null,ol(r,i)));return e[e.length]="</cols>",e.join("")}function O8(t){var n={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return n}function A8(t,n,e,i){var r=typeof t.ref=="string"?t.ref:yt(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,s=fn(r);s.s.r==s.e.r&&(s.e.r=fn(n["!ref"]).e.r,r=yt(s));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i){l.Ref="'"+e.SheetNames[i]+"'!"+r;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+r}),ke("autoFilter",null,{ref:r})}var L8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function R8(t,n){n.Views||(n.Views=[{}]),(t.match(L8)||[]).forEach(function(e,i){var r=ut(e);n.Views[i]||(n.Views[i]={}),+r.zoomScale&&(n.Views[i].zoom=+r.zoomScale),Jt(r.rightToLeft)&&(n.Views[i].RTL=!0)})}function V8(t,n,e,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),ke("sheetViews",ke("sheetView",null,r),{})}function P8(t,n,e,i){if(t.c&&e["!comments"].push([n,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var r="",a=t.t,s=t.v;if(t.t!=="z")switch(t.t){case"b":r=t.v?"1":"0";break;case"n":r=""+t.v;break;case"e":r=yr[t.v];break;case"d":i&&i.cellDates?r=ei(t.v,-1).toISOString():(t=ti(t),t.t="n",r=""+(t.v=Oi(ei(t.v)))),typeof t.z>"u"&&(t.z=lt[14]);break;default:r=t.v;break}var o=zi("v",Gt(r)),l={r:n},c=Xr(i.cellXfs,t,i);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){o=zi("v",""+l0(i.Strings,t.v,i.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=a&&(t.t=a,t.v=s),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,n.length)==n?{t:"array",ref:t.F}:null;o=ke("f",Gt(t.f),d)+(t.v!=null?o:"")}return t.l&&e["!links"].push([n,t.l]),t.D&&(l.cm=1),ke("c",o,l)}var B8=function(){var t=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,a=Ns("v"),s=Ns("f");return function(l,c,d,h,_,v){for(var b=0,m="",y=[],k=[],F=0,T=0,W=0,X="",z,M,K=0,j=0,ne,oe,q=0,Se=0,Ne=Array.isArray(v.CellXf),Ie,Ye=[],ze=[],Et=Array.isArray(c),Pe=[],Ke={},me=!1,B=!!d.sheetStubs,te=l.split(n),H=0,U=te.length;H!=U;++H){m=te[H].trim();var pe=m.length;if(pe!==0){var Ae=0;e:for(b=0;b<pe;++b)switch(m[b]){case">":if(m[b-1]!="/"){++b;break e}if(d&&d.cellStyles){if(M=ut(m.slice(Ae,b),!0),K=M.r!=null?parseInt(M.r,10):K+1,j=-1,d.sheetRows&&d.sheetRows<K)continue;Ke={},me=!1,M.ht&&(me=!0,Ke.hpt=parseFloat(M.ht),Ke.hpx=as(Ke.hpt)),M.hidden=="1"&&(me=!0,Ke.hidden=!0),M.outlineLevel!=null&&(me=!0,Ke.level=+M.outlineLevel),me&&(Pe[K-1]=Ke)}break;case"<":Ae=b;break}if(Ae>=b)break;if(M=ut(m.slice(Ae,b),!0),K=M.r!=null?parseInt(M.r,10):K+1,j=-1,!(d.sheetRows&&d.sheetRows<K)){h.s.r>K-1&&(h.s.r=K-1),h.e.r<K-1&&(h.e.r=K-1),d&&d.cellStyles&&(Ke={},me=!1,M.ht&&(me=!0,Ke.hpt=parseFloat(M.ht),Ke.hpx=as(Ke.hpt)),M.hidden=="1"&&(me=!0,Ke.hidden=!0),M.outlineLevel!=null&&(me=!0,Ke.level=+M.outlineLevel),me&&(Pe[K-1]=Ke)),y=m.slice(b).split(t);for(var Ce=0;Ce!=y.length&&y[Ce].trim().charAt(0)=="<";++Ce);for(y=y.slice(Ce),b=0;b!=y.length;++b)if(m=y[b].trim(),m.length!==0){if(k=m.match(e),F=b,T=0,W=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,k!=null&&k.length===2){for(F=0,X=k[1],T=0;T!=X.length&&!((W=X.charCodeAt(T)-64)<1||W>26);++T)F=26*F+W;--F,j=F}else++j;for(T=0;T!=m.length&&m.charCodeAt(T)!==62;++T);if(++T,M=ut(m.slice(0,T),!0),M.r||(M.r=dt({r:K-1,c:j})),X=m.slice(T),z={t:""},(k=X.match(a))!=null&&k[1]!==""&&(z.v=Vt(k[1])),d.cellFormula){if((k=X.match(s))!=null&&k[1]!==""){if(z.f=Vt(Xt(k[1])).replace(/\r\n/g,`
`),d.xlfn||(z.f=up(z.f)),k[0].indexOf('t="array"')>-1)z.F=(X.match(r)||[])[1],z.F.indexOf(":")>-1&&Ye.push([Pt(z.F),z.F]);else if(k[0].indexOf('t="shared"')>-1){oe=ut(k[0]);var Te=Vt(Xt(k[1]));d.xlfn||(Te=up(Te)),ze[parseInt(oe.si,10)]=[oe,Te,M.r]}}else(k=X.match(/<f[^>]*\/>/))&&(oe=ut(k[0]),ze[oe.si]&&(z.f=LE(ze[oe.si][1],ze[oe.si][2],M.r)));var xe=di(M.r);for(T=0;T<Ye.length;++T)xe.r>=Ye[T][0].s.r&&xe.r<=Ye[T][0].e.r&&xe.c>=Ye[T][0].s.c&&xe.c<=Ye[T][0].e.c&&(z.F=Ye[T][1])}if(M.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(B)z.t="z";else continue;else z.t=M.t||"n";switch(h.s.c>j&&(h.s.c=j),h.e.c<j&&(h.e.c=j),z.t){case"n":if(z.v==""||z.v==null){if(!B)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!B)continue;z.t="z"}else ne=Os[parseInt(z.v,10)],z.v=ne.t,z.r=ne.r,d.cellHTML&&(z.h=ne.h);break;case"str":z.t="s",z.v=z.v!=null?Xt(z.v):"",d.cellHTML&&(z.h=Pc(z.v));break;case"inlineStr":k=X.match(i),z.t="s",k!=null&&(ne=t0(k[1]))?(z.v=ne.t,d.cellHTML&&(z.h=ne.h)):z.v="";break;case"b":z.v=Jt(z.v);break;case"d":d.cellDates?z.v=ei(z.v,1):(z.v=Oi(ei(z.v,1)),z.t="n");break;case"e":(!d||d.cellText!==!1)&&(z.w=z.v),z.v=du[z.v];break}if(q=Se=0,Ie=null,Ne&&M.s!==void 0&&(Ie=v.CellXf[M.s],Ie!=null&&(Ie.numFmtId!=null&&(q=Ie.numFmtId),d.cellStyles&&Ie.fillId!=null&&(Se=Ie.fillId))),lf(z,q,Se,d,_,v),d.cellDates&&Ne&&z.t=="n"&&ss(lt[q])&&(z.t="d",z.v=il(z.v)),M.cm&&d.xlmeta){var gt=(d.xlmeta.Cell||[])[+M.cm-1];gt&&gt.type=="XLDAPR"&&(z.D=!0)}if(Et){var P=di(M.r);c[P.r]||(c[P.r]=[]),c[P.r][P.c]=z}else c[M.r]=z}}}}Pe.length>0&&(c["!rows"]=Pe)}}();function N8(t,n,e,i){var r=[],a=[],s=Pt(t["!ref"]),o="",l,c="",d=[],h=0,_=0,v=t["!rows"],b=Array.isArray(t),m={r:c},y,k=-1;for(_=s.s.c;_<=s.e.c;++_)d[_]=ci(_);for(h=s.s.r;h<=s.e.r;++h){for(a=[],c=xi(h),_=s.s.c;_<=s.e.c;++_){l=d[_]+c;var F=b?(t[h]||[])[_]:t[l];F!==void 0&&(o=P8(F,l,t,n,e,i))!=null&&a.push(o)}(a.length>0||v&&v[h])&&(m={r:c},v&&v[h]&&(y=v[h],y.hidden&&(m.hidden=1),k=-1,y.hpx?k=Gs(y.hpx):y.hpt&&(k=y.hpt),k>-1&&(m.ht=k,m.customHeight=1),y.level&&(m.outlineLevel=y.level)),r[r.length]=ke("row",a.join(""),m))}if(v)for(;h<v.length;++h)v&&v[h]&&(m={r:h+1},y=v[h],y.hidden&&(m.hidden=1),k=-1,y.hpx?k=Gs(y.hpx):y.hpt&&(k=y.hpt),k>-1&&(m.ht=k,m.customHeight=1),y.level&&(m.outlineLevel=y.level),r[r.length]=ke("row","",m));return r.join("")}function df(t,n,e,i){var r=[vi,ke("worksheet",null,{xmlns:fa[0],"xmlns:r":Mi.r})],a=e.SheetNames[t],s=0,o="",l=e.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",d=Pt(c);if(d.e.c>16383||d.e.r>1048575){if(n.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=yt(d)}i||(i={}),l["!comments"]=[];var h=[];C8(l,e,t,n,r),r[r.length]=ke("dimension",null,{ref:c}),r[r.length]=V8(l,n,t,e),n.sheetFormat&&(r[r.length]=ke("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(r[r.length]=M8(l,l["!cols"])),r[s=r.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=N8(l,n,t,e,i),o.length>0&&(r[r.length]=o)),r.length>s+1&&(r[r.length]="</sheetData>",r[s]=r[s].replace("/>",">")),l["!protect"]&&(r[r.length]=I8(l["!protect"])),l["!autofilter"]!=null&&(r[r.length]=A8(l["!autofilter"],l,e,t)),l["!merges"]!=null&&l["!merges"].length>0&&(r[r.length]=y8(l["!merges"]));var _=-1,v,b=-1;return l["!links"].length>0&&(r[r.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(v={ref:m[0]},m[1].Target.charAt(0)!="#"&&(b=Kt(i,-1,Gt(m[1].Target).replace(/#.*$/,""),Ct.HLINK),v["r:id"]="rId"+b),(_=m[1].Target.indexOf("#"))>-1&&(v.location=Gt(m[1].Target.slice(_+1))),m[1].Tooltip&&(v.tooltip=Gt(m[1].Tooltip)),r[r.length]=ke("hyperlink",null,v))}),r[r.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(r[r.length]=F8(l["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(r[r.length]=zi("ignoredErrors",ke("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(b=Kt(i,-1,"../drawings/drawing"+(t+1)+".xml",Ct.DRAW),r[r.length]=ke("drawing",null,{"r:id":"rId"+b}),l["!drawing"]=h),l["!comments"].length>0&&(b=Kt(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ct.VML),r[r.length]=ke("legacyDrawing",null,{"r:id":"rId"+b}),l["!legacy"]=b),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function U8(t,n){var e={},i=t.l+n;e.r=t.read_shift(4),t.l+=4;var r=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=i,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=r/20),e}function H8(t,n,e){var i=ce(145),r=(e["!rows"]||[])[t]||{};i.write_shift(4,t),i.write_shift(4,0);var a=320;r.hpx?a=Gs(r.hpx)*20:r.hpt&&(a=r.hpt*20),i.write_shift(2,a),i.write_shift(1,0);var s=0;r.level&&(s|=r.level),r.hidden&&(s|=16),(r.hpx||r.hpt)&&(s|=32),i.write_shift(1,s),i.write_shift(1,0);var o=0,l=i.l;i.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(n.s.c>d+1<<10||n.e.c<d<<10)){for(var h=-1,_=-1,v=d<<10;v<d+1<<10;++v){c.c=v;var b=Array.isArray(e)?(e[c.r]||[])[c.c]:e[dt(c)];b&&(h<0&&(h=v),_=v)}h<0||(++o,i.write_shift(4,h),i.write_shift(4,_))}var m=i.l;return i.l=l,i.write_shift(4,o),i.l=m,i.length>i.l?i.slice(0,i.l):i}function z8(t,n,e,i){var r=H8(i,e,n);(r.length>17||(n["!rows"]||[])[i])&&ve(t,0,r)}var W8=ga,j8=ds;function K8(){}function G8(t,n){var e={},i=t[t.l];return++t.l,e.above=!(i&64),e.left=!(i&128),t.l+=18,e.name=XT(t,n-19),e}function $8(t,n,e){e==null&&(e=ce(84+4*t.length));var i=192;n&&(n.above&&(i&=-65),n.left&&(i&=-129)),e.write_shift(1,i);for(var r=1;r<3;++r)e.write_shift(1,0);return Ko({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),au(t,e),e.slice(0,e.l)}function Y8(t){var n=Un(t);return[n]}function X8(t,n,e){return e==null&&(e=ce(8)),ha(n,e)}function q8(t){var n=ma(t);return[n]}function Z8(t,n,e){return e==null&&(e=ce(4)),_a(n,e)}function Q8(t){var n=Un(t),e=t.read_shift(1);return[n,e,"b"]}function J8(t,n,e){return e==null&&(e=ce(9)),ha(n,e),e.write_shift(1,t.v?1:0),e}function e5(t){var n=ma(t),e=t.read_shift(1);return[n,e,"b"]}function t5(t,n,e){return e==null&&(e=ce(5)),_a(n,e),e.write_shift(1,t.v?1:0),e}function i5(t){var n=Un(t),e=t.read_shift(1);return[n,e,"e"]}function n5(t,n,e){return e==null&&(e=ce(9)),ha(n,e),e.write_shift(1,t.v),e}function r5(t){var n=ma(t),e=t.read_shift(1);return[n,e,"e"]}function a5(t,n,e){return e==null&&(e=ce(8)),_a(n,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function s5(t){var n=Un(t),e=t.read_shift(4);return[n,e,"s"]}function o5(t,n,e){return e==null&&(e=ce(12)),ha(n,e),e.write_shift(4,n.v),e}function l5(t){var n=ma(t),e=t.read_shift(4);return[n,e,"s"]}function c5(t,n,e){return e==null&&(e=ce(8)),_a(n,e),e.write_shift(4,n.v),e}function d5(t){var n=Un(t),e=Zi(t);return[n,e,"n"]}function p5(t,n,e){return e==null&&(e=ce(16)),ha(n,e),ca(t.v,e),e}function pf(t){var n=ma(t),e=Zi(t);return[n,e,"n"]}function u5(t,n,e){return e==null&&(e=ce(12)),_a(n,e),ca(t.v,e),e}function f5(t){var n=Un(t),e=qc(t);return[n,e,"n"]}function h5(t,n,e){return e==null&&(e=ce(12)),ha(n,e),su(t.v,e),e}function m5(t){var n=ma(t),e=qc(t);return[n,e,"n"]}function _5(t,n,e){return e==null&&(e=ce(8)),_a(n,e),su(t.v,e),e}function g5(t){var n=Un(t),e=$c(t);return[n,e,"is"]}function x5(t){var n=Un(t),e=Ji(t);return[n,e,"str"]}function v5(t,n,e){return e==null&&(e=ce(12+4*t.v.length)),ha(n,e),Bi(t.v,e),e.length>e.l?e.slice(0,e.l):e}function b5(t){var n=ma(t),e=Ji(t);return[n,e,"str"]}function y5(t,n,e){return e==null&&(e=ce(8+4*t.v.length)),_a(n,e),Bi(t.v,e),e.length>e.l?e.slice(0,e.l):e}function w5(t,n,e){var i=t.l+n,r=Un(t);r.r=e["!row"];var a=t.read_shift(1),s=[r,a,"b"];if(e.cellFormula){t.l+=2;var o=sl(t,i-t.l,e);s[3]=Xi(o,null,r,e.supbooks,e)}else t.l=i;return s}function C5(t,n,e){var i=t.l+n,r=Un(t);r.r=e["!row"];var a=t.read_shift(1),s=[r,a,"e"];if(e.cellFormula){t.l+=2;var o=sl(t,i-t.l,e);s[3]=Xi(o,null,r,e.supbooks,e)}else t.l=i;return s}function T5(t,n,e){var i=t.l+n,r=Un(t);r.r=e["!row"];var a=Zi(t),s=[r,a,"n"];if(e.cellFormula){t.l+=2;var o=sl(t,i-t.l,e);s[3]=Xi(o,null,r,e.supbooks,e)}else t.l=i;return s}function S5(t,n,e){var i=t.l+n,r=Un(t);r.r=e["!row"];var a=Ji(t),s=[r,a,"str"];if(e.cellFormula){t.l+=2;var o=sl(t,i-t.l,e);s[3]=Xi(o,null,r,e.supbooks,e)}else t.l=i;return s}var I5=ga,k5=ds;function E5(t,n){return n==null&&(n=ce(4)),n.write_shift(4,t),n}function F5(t,n){var e=t.l+n,i=ga(t,16),r=Yc(t),a=Ji(t),s=Ji(t),o=Ji(t);t.l=e;var l={rfx:i,relId:r,loc:a,display:o};return s&&(l.Tooltip=s),l}function D5(t,n){var e=ce(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));ds({s:di(t[0]),e:di(t[0])},e),Xc("rId"+n,e);var i=t[1].Target.indexOf("#"),r=i==-1?"":t[1].Target.slice(i+1);return Bi(r||"",e),Bi(t[1].Tooltip||"",e),Bi("",e),e.slice(0,e.l)}function M5(){}function O5(t,n,e){var i=t.l+n,r=ou(t,16),a=t.read_shift(1),s=[r];if(s[2]=a,e.cellFormula){var o=i8(t,i-t.l,e);s[1]=o}else t.l=i;return s}function A5(t,n,e){var i=t.l+n,r=ga(t,16),a=[r];if(e.cellFormula){var s=r8(t,i-t.l,e);a[1]=s,t.l=i}else t.l=i;return a}function L5(t,n,e){e==null&&(e=ce(18));var i=ol(t,n);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var r=0;return n.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),n.level&&(r|=n.level<<8),e.write_shift(2,r),e}var uf=["left","right","top","bottom","header","footer"];function R5(t){var n={};return uf.forEach(function(e){n[e]=Zi(t,8)}),n}function V5(t,n){return n==null&&(n=ce(6*8)),sa(t),uf.forEach(function(e){ca(t[e],n)}),n}function P5(t){var n=t.read_shift(2);return t.l+=28,{RTL:n&32}}function B5(t,n,e){e==null&&(e=ce(30));var i=924;return(((n||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function N5(t){var n=ce(24);return n.write_shift(4,4),n.write_shift(4,1),ds(t,n),n}function U5(t,n){return n==null&&(n=ce(16*4+2)),n.write_shift(2,t.password?i0(t.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?n.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):n.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),n}function H5(){}function z5(){}function W5(t,n,e,i,r,a,s){if(!t)return t;var o=n||{};i||(i={"!id":{}}),fi!=null&&o.dense==null&&(o.dense=fi);var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=[],_=!1,v=!1,b,m,y,k,F,T,W,X,z,M=[];o.biff=12,o["!row"]=0;var K=0,j=!1,ne=[],oe={},q=o.supbooks||r.supbooks||[[]];if(q.sharedf=oe,q.arrayf=ne,q.SheetNames=r.SheetNames||r.Sheets.map(function(Ke){return Ke.name}),!o.supbooks&&(o.supbooks=q,r.Names))for(var Se=0;Se<r.Names.length;++Se)q[0][Se+1]=r.Names[Se];var Ne=[],Ie=[],Ye=!1;$s[16]={n:"BrtShortReal",f:pf};var ze,Et;if(br(t,function(me,B,te){if(!v)switch(te){case 148:c=me;break;case 0:b=me,o.sheetRows&&o.sheetRows<=b.r&&(v=!0),X=xi(k=b.r),o["!row"]=b.r,(me.hidden||me.hpt||me.level!=null)&&(me.hpt&&(me.hpx=as(me.hpt)),Ie[me.r]=me);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:me[2]},me[2]){case"n":m.v=me[1];break;case"s":W=Os[me[1]],m.v=W.t,m.r=W.r;break;case"b":m.v=!!me[1];break;case"e":m.v=me[1],o.cellText!==!1&&(m.w=yr[m.v]);break;case"str":m.t="s",m.v=me[1];break;case"is":m.t="s",m.v=me[1].t;break}if((y=s.CellXf[me[0].iStyleRef])&&lf(m,y.numFmtId,null,o,a,s),F=me[0].c==-1?F+1:me[0].c,o.dense?(l[k]||(l[k]=[]),l[k][F]=m):l[ci(F)+X]=m,o.cellFormula){for(j=!1,K=0;K<ne.length;++K){var H=ne[K];b.r>=H[0].s.r&&b.r<=H[0].e.r&&F>=H[0].s.c&&F<=H[0].e.c&&(m.F=yt(H[0]),j=!0)}!j&&me.length>3&&(m.f=me[3])}if(d.s.r>b.r&&(d.s.r=b.r),d.s.c>F&&(d.s.c=F),d.e.r<b.r&&(d.e.r=b.r),d.e.c<F&&(d.e.c=F),o.cellDates&&y&&m.t=="n"&&ss(lt[y.numFmtId])){var U=ia(m.v);U&&(m.t="d",m.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}ze&&(ze.type=="XLDAPR"&&(m.D=!0),ze=void 0),Et&&(Et=void 0);break;case 1:case 12:if(!o.sheetStubs||_)break;m={t:"z",v:void 0},F=me[0].c==-1?F+1:me[0].c,o.dense?(l[k]||(l[k]=[]),l[k][F]=m):l[ci(F)+X]=m,d.s.r>b.r&&(d.s.r=b.r),d.s.c>F&&(d.s.c=F),d.e.r<b.r&&(d.e.r=b.r),d.e.c<F&&(d.e.c=F),ze&&(ze.type=="XLDAPR"&&(m.D=!0),ze=void 0),Et&&(Et=void 0);break;case 176:M.push(me);break;case 49:ze=((o.xlmeta||{}).Cell||[])[me-1];break;case 494:var pe=i["!id"][me.relId];for(pe?(me.Target=pe.Target,me.loc&&(me.Target+="#"+me.loc),me.Rel=pe):me.relId==""&&(me.Target="#"+me.loc),k=me.rfx.s.r;k<=me.rfx.e.r;++k)for(F=me.rfx.s.c;F<=me.rfx.e.c;++F)o.dense?(l[k]||(l[k]=[]),l[k][F]||(l[k][F]={t:"z",v:void 0}),l[k][F].l=me):(T=dt({c:F,r:k}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=me);break;case 426:if(!o.cellFormula)break;ne.push(me),z=o.dense?l[k][F]:l[ci(F)+X],z.f=Xi(me[1],d,{r:b.r,c:F},q,o),z.F=yt(me[0]);break;case 427:if(!o.cellFormula)break;oe[dt(me[0].s)]=me[1],z=o.dense?l[k][F]:l[ci(F)+X],z.f=Xi(me[1],d,{r:b.r,c:F},q,o);break;case 60:if(!o.cellStyles)break;for(;me.e>=me.s;)Ne[me.e--]={width:me.w/256,hidden:!!(me.flags&1),level:me.level},Ye||(Ye=!0,n0(me.w/256)),jr(Ne[me.e+1]);break;case 161:l["!autofilter"]={ref:yt(me)};break;case 476:l["!margins"]=me;break;case 147:r.Sheets[e]||(r.Sheets[e]={}),me.name&&(r.Sheets[e].CodeName=me.name),(me.above||me.left)&&(l["!outline"]={above:me.above,left:me.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),me.RTL&&(r.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:h.push(te),_=!0;break;case 38:h.pop(),_=!1;break;default:if(!B.T){if(!_||o.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=yt(c||d)),o.sheetRows&&l["!ref"]){var Pe=Pt(l["!ref"]);o.sheetRows<=+Pe.e.r&&(Pe.e.r=o.sheetRows-1,Pe.e.r>d.e.r&&(Pe.e.r=d.e.r),Pe.e.r<Pe.s.r&&(Pe.s.r=Pe.e.r),Pe.e.c>d.e.c&&(Pe.e.c=d.e.c),Pe.e.c<Pe.s.c&&(Pe.s.c=Pe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=yt(Pe))}return M.length>0&&(l["!merges"]=M),Ne.length>0&&(l["!cols"]=Ne),Ie.length>0&&(l["!rows"]=Ie),l}function j5(t,n,e,i,r,a,s){if(n.v===void 0)return!1;var o="";switch(n.t){case"b":o=n.v?"1":"0";break;case"d":n=ti(n),n.z=n.z||lt[14],n.v=Oi(ei(n.v)),n.t="n";break;case"n":case"e":o=""+n.v;break;default:o=n.v;break}var l={r:e,c:i};switch(l.s=Xr(r.cellXfs,n,r),n.l&&a["!links"].push([dt(l),n.l]),n.c&&a["!comments"].push([dt(l),n.c]),n.t){case"s":case"str":return r.bookSST?(o=l0(r.Strings,n.v,r.revStrings),l.t="s",l.v=o,s?ve(t,18,c5(n,l)):ve(t,7,o5(n,l))):(l.t="str",s?ve(t,17,y5(n,l)):ve(t,6,v5(n,l))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?s?ve(t,13,_5(n,l)):ve(t,2,h5(n,l)):s?ve(t,16,u5(n,l)):ve(t,5,p5(n,l)),!0;case"b":return l.t="b",s?ve(t,15,t5(n,l)):ve(t,4,J8(n,l)),!0;case"e":return l.t="e",s?ve(t,14,a5(n,l)):ve(t,3,n5(n,l)),!0}return s?ve(t,12,Z8(n,l)):ve(t,1,X8(n,l)),!0}function K5(t,n,e,i){var r=Pt(n["!ref"]||"A1"),a,s="",o=[];ve(t,145);var l=Array.isArray(n),c=r.e.r;n["!rows"]&&(c=Math.max(r.e.r,n["!rows"].length-1));for(var d=r.s.r;d<=c;++d){s=xi(d),z8(t,n,r,d);var h=!1;if(d<=r.e.r)for(var _=r.s.c;_<=r.e.c;++_){d===r.s.r&&(o[_]=ci(_)),a=o[_]+s;var v=l?(n[d]||[])[_]:n[a];if(!v){h=!1;continue}h=j5(t,v,d,_,i,n,h)}}ve(t,146)}function G5(t,n){!n||!n["!merges"]||(ve(t,177,E5(n["!merges"].length)),n["!merges"].forEach(function(e){ve(t,176,k5(e))}),ve(t,178))}function $5(t,n){!n||!n["!cols"]||(ve(t,390),n["!cols"].forEach(function(e,i){e&&ve(t,60,L5(i,e))}),ve(t,391))}function Y5(t,n){!n||!n["!ref"]||(ve(t,648),ve(t,649,N5(Pt(n["!ref"]))),ve(t,650))}function X5(t,n,e){n["!links"].forEach(function(i){if(i[1].Target){var r=Kt(e,-1,i[1].Target.replace(/#.*$/,""),Ct.HLINK);ve(t,494,D5(i,r))}}),delete n["!links"]}function q5(t,n,e,i){if(n["!comments"].length>0){var r=Kt(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ct.VML);ve(t,551,Xc("rId"+r)),n["!legacy"]=r}}function Z5(t,n,e,i){if(n["!autofilter"]){var r=n["!autofilter"],a=typeof r.ref=="string"?r.ref:yt(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,o=fn(a);o.s.r==o.e.r&&(o.e.r=fn(n["!ref"]).e.r,a=yt(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==i){c.Ref="'"+e.SheetNames[i]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+a}),ve(t,161,ds(Pt(a))),ve(t,162)}}function Q5(t,n,e){ve(t,133),ve(t,137,B5(n,e)),ve(t,138),ve(t,134)}function J5(t,n){n["!protect"]&&ve(t,535,U5(n["!protect"]))}function e7(t,n,e,i){var r=un(),a=e.SheetNames[t],s=e.Sheets[a]||{},o=a;try{e&&e.Workbook&&(o=e.Workbook.Sheets[t].CodeName||o)}catch{}var l=Pt(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(n.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],ve(r,129),(e.vbaraw||s["!outline"])&&ve(r,147,$8(o,s["!outline"])),ve(r,148,j8(l)),Q5(r,s,e.Workbook),$5(r,s,t,n,e),K5(r,s,t,n,e),J5(r,s),Z5(r,s,e,t),G5(r,s),X5(r,s,i),s["!margins"]&&ve(r,476,V5(s["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&Y5(r,s),q5(r,s,t,i),ve(r,130),r.end()}function t7(t){var n=[],e=t.match(/^<c:numCache>/),i;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(n[+s[1]]=e?+s[2]:s[2])});var r=Vt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){i=a.replace(/<.*?>/g,"")}),[n,r,i]}function i7(t,n,e,i,r,a){var s=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var _=t7(h);d.s.r=d.s.c=0,d.e.c=o,c=ci(o),_[0].forEach(function(v,b){s[c+xi(b)]={t:"n",v,z:_[1]},l=b}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(s["!ref"]=yt(d)),s}function n7(t,n,e,i,r){if(!t)return t;i||(i={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=t.match(cf);return o&&c0(o[0],a,r,e),(s=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),i["!id"][a["!rel"]]&&(a["!drawel"]=i["!id"][a["!rel"]]),a}function r7(t,n){t.l+=10;var e=Ji(t,n-10);return{name:e}}function a7(t,n,e,i,r){if(!t)return t;i||(i={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return br(t,function(c,d,h){switch(h){case 550:a["!rel"]=c;break;case 651:r.Sheets[e]||(r.Sheets[e]={}),c.name&&(r.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h);break;case 38:s.pop();break;default:if(d.T>0)s.push(h);else if(d.T<0)s.pop();else if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}},n),i["!id"][a["!rel"]]&&(a["!drawel"]=i["!id"][a["!rel"]]),a}var d0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],s7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],o7=[],l7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function gp(t,n){for(var e=0;e!=t.length;++e)for(var i=t[e],r=0;r!=n.length;++r){var a=n[r];if(i[a[0]]==null)i[a[0]]=a[1];else switch(a[2]){case"bool":typeof i[a[0]]=="string"&&(i[a[0]]=Jt(i[a[0]]));break;case"int":typeof i[a[0]]=="string"&&(i[a[0]]=parseInt(i[a[0]],10));break}}}function xp(t,n){for(var e=0;e!=n.length;++e){var i=n[e];if(t[i[0]]==null)t[i[0]]=i[1];else switch(i[2]){case"bool":typeof t[i[0]]=="string"&&(t[i[0]]=Jt(t[i[0]]));break;case"int":typeof t[i[0]]=="string"&&(t[i[0]]=parseInt(t[i[0]],10));break}}}function ff(t){xp(t.WBProps,d0),xp(t.CalcPr,l7),gp(t.WBView,s7),gp(t.Sheets,o7),ts.date1904=Jt(t.WBProps.date1904)}function c7(t){return!t.Workbook||!t.Workbook.WBProps?"false":Jt(t.Workbook.WBProps.date1904)?"true":"false"}var d7="][*?/\\".split("");function hf(t,n){if(t.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return d7.forEach(function(i){if(t.indexOf(i)!=-1){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function p7(t,n,e){t.forEach(function(i,r){hf(i);for(var a=0;a<r;++a)if(i==t[a])throw new Error("Duplicate Sheet Name: "+i);if(e){var s=n&&n[r]&&n[r].CodeName||i;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function u7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var n=t.Workbook&&t.Workbook.Sheets||[];p7(t.SheetNames,n,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)c8(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e)}var f7=/<\w+:workbook/;function h7(t,n){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,r="xmlns",a={},s=0;if(t.replace(tn,function(l,c){var d=ut(l);switch(ar(d[0])){case"<?xml":break;case"<workbook":l.match(f7)&&(r="xmlns"+l.match(/<(\w+):/)[1]),e.xmlns=d[r];break;case"</workbook>":break;case"<fileVersion":delete d[0],e.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":d0.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":e.WBProps[h[0]]=Jt(d[h[0]]);break;case"int":e.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:e.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(e.WBProps.CodeName=Xt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],e.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Vt(Xt(d.name)),delete d[0],e.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":a={},a.Name=Xt(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Jt(d.hidden||"0")&&(a.Hidden=!0),s=c+l.length;break;case"</definedName>":a.Ref=Vt(Xt(t.slice(s,c))),e.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],e.CalcPr=d;break;case"<calcPr/>":delete d[0],e.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&n.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),fa.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return ff(e),e}function mf(t){var n=[vi];n[n.length]=ke("workbook",null,{xmlns:fa[0],"xmlns:r":Mi.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(d0.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(i[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(i.codeName=t.Workbook.WBProps.CodeName,delete i.CodeName)),n[n.length]=ke("workbookPr",null,i);var r=t.Workbook&&t.Workbook.Sheets||[],a=0;if(r&&r[0]&&r[0].Hidden){for(n[n.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!r[a]||!r[a].Hidden);++a);a==t.SheetNames.length&&(a=0),n[n.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var s={name:Gt(t.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),r[a])switch(r[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}n[n.length]=ke("sheet",null,s)}return n[n.length]="</sheets>",e&&(n[n.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(n[n.length]=ke("definedName",Gt(o.Ref),l))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function m7(t,n){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=gc(t,n-8),e.name=Ji(t),e}function _7(t,n){return n||(n=ce(127)),n.write_shift(4,t.Hidden),n.write_shift(4,t.iTabID),Xc(t.strRelID,n),Bi(t.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function g7(t,n){var e={},i=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var r=n>8?Ji(t):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function x7(t,n){n||(n=ce(72));var e=0;return t&&t.filterPrivacy&&(e|=8),n.write_shift(4,e),n.write_shift(4,0),au(t&&t.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function v7(t,n){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=n-8,e}function b7(t,n,e){var i=t.l+n;t.l+=4,t.l+=1;var r=t.read_shift(4),a=qT(t),s=n8(t,0,e),o=Yc(t);t.l=i;var l={Name:a,Ptg:s};return r<268435455&&(l.Sheet=r),o&&(l.Comment=o),l}function y7(t,n){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],r=!1;n||(n={}),n.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],$s[16]={n:"BrtFRTArchID$",f:v7},br(t,function(l,c,d){switch(d){case 156:s.SheetNames.push(l.name),e.Sheets.push(l);break;case 153:e.WBProps=l;break;case 39:l.Sheet!=null&&(n.SID=l.Sheet),l.Ref=Xi(l.Ptg,null,null,s,n),delete n.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,l]):s[0]=[d,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(d),r=!0;break;case 36:i.pop(),r=!1;break;case 37:i.push(d),r=!0;break;case 38:i.pop(),r=!1;break;case 16:break;default:if(!c.T){if(!r||n.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},n),ff(e),e.Names=a,e.supbooks=s,e}function w7(t,n){ve(t,143);for(var e=0;e!=n.SheetNames.length;++e){var i=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e]&&n.Workbook.Sheets[e].Hidden||0,r={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:n.SheetNames[e]};ve(t,156,_7(r))}ve(t,144)}function C7(t,n){n||(n=ce(127));for(var e=0;e!=4;++e)n.write_shift(4,0);return Bi("SheetJS",n),Bi(Vs.version,n),Bi(Vs.version,n),Bi("7262",n),n.length>n.l?n.slice(0,n.l):n}function T7(t,n){n||(n=ce(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,t),n.write_shift(4,t);var e=120;return n.write_shift(1,e),n.length>n.l?n.slice(0,n.l):n}function S7(t,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var e=n.Workbook.Sheets,i=0,r=-1,a=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&r==-1?r=i:e[i].Hidden==1&&a==-1&&(a=i);a>r||(ve(t,135),ve(t,158,T7(r)),ve(t,136))}}function I7(t,n){var e=un();return ve(e,131),ve(e,128,C7()),ve(e,153,x7(t.Workbook&&t.Workbook.WBProps||null)),S7(e,t,n),w7(e,t,n),ve(e,132),e.end()}function k7(t,n,e){return n.slice(-4)===".bin"?y7(t,e):h7(t,e)}function E7(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?W5(t,i,e,r,a,s,o):b8(t,i,e,r,a,s,o)}function F7(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?a7(t,i,e,r,a,s,o):n7(t,i,e,r,a,s,o)}function D7(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?OE(t,i,e,r,a,s,o):AE(t,i,e,r,a,s,o)}function M7(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?DE(t,i,e,r,a,s,o):ME(t,i,e,r,a,s,o)}function O7(t,n,e,i){return n.slice(-4)===".bin"?kk(t,e,i):mk(t,e,i)}function A7(t,n,e){return Yu(t,e)}function L7(t,n,e){return n.slice(-4)===".bin"?LI(t,e):MI(t,e)}function R7(t,n,e){return n.slice(-4)===".bin"?SE(t,e):_E(t,e)}function V7(t,n,e){return n.slice(-4)===".bin"?fE(t,n,e):pE(t,n,e)}function P7(t,n,e,i){return e.slice(-4)===".bin"?hE(t,n,e,i):void 0}function B7(t,n,e){return n.slice(-4)===".bin"?lE(t,n,e):dE(t,n,e)}function N7(t,n,e){return(n.slice(-4)===".bin"?I7:mf)(t,e)}function U7(t,n,e,i,r){return(n.slice(-4)===".bin"?e7:df)(t,e,i,r)}function H7(t,n,e){return(n.slice(-4)===".bin"?Pk:Gu)(t,e)}function z7(t,n,e){return(n.slice(-4)===".bin"?PI:Bu)(t,e)}function W7(t,n,e){return(n.slice(-4)===".bin"?IE:Zu)(t,e)}function j7(t){return(t.slice(-4)===".bin"?cE:Xu)()}var _f=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jn(t,n){var e=t.split(/\s+/),i=[];if(n||(i[0]=e[0]),e.length===1)return i;var r=t.match(_f),a,s,o,l;if(r)for(l=0;l!=r.length;++l)a=r[l].match(gf),(s=a[1].indexOf(":"))===-1?i[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),i[o]=a[2].slice(1,a[2].length-1));return i}function K7(t){var n=t.split(/\s+/),e={};if(n.length===1)return e;var i=t.match(_f),r,a,s,o;if(i)for(o=0;o!=i.length;++o)r=i[o].match(gf),(a=r[1].indexOf(":"))===-1?e[r[1]]=r[2].slice(1,r[2].length-1):(r[1].slice(0,6)==="xmlns:"?s="xmlns"+r[1].slice(6):s=r[1].slice(a+1),e[s]=r[2].slice(1,r[2].length-1));return e}var Ls;function G7(t,n){var e=Ls[t]||Vt(t);return e==="General"?oa(n):Nn(e,n)}function $7(t,n,e,i){var r=i;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=Jt(i);break;case"i2":case"int":r=parseInt(i,10);break;case"r4":case"float":r=parseFloat(i);break;case"date":case"dateTime.tz":r=ei(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[Vt(n)]=r}function Y7(t,n,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||yr[t.v]:n==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bs(t.v):t.w=oa(t.v):t.w=G7(n||"General",t.v)}catch(a){if(e.WTF)throw a}try{var i=Ls[n]||n||"General";if(e.cellNF&&(t.z=i),e.cellDates&&t.t=="n"&&ss(i)){var r=ia(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(a){if(e.WTF)throw a}}}function X7(t,n,e){if(e.cellStyles&&n.Interior){var i=n.Interior;i.Pattern&&(i.patternType=ok[i.Pattern]||i.Pattern)}t[n.ID]=n}function q7(t,n,e,i,r,a,s,o,l,c){var d="General",h=i.StyleID,_={};c=c||{};var v=[],b=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);a[h]!==void 0&&(a[h].nf&&(d=a[h].nf),a[h].Interior&&v.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(e.Type){case"Boolean":i.t="b",i.v=Jt(t);break;case"String":i.t="s",i.r=Rd(Vt(t)),i.v=t.indexOf("<")>-1?Vt(n||t).replace(/<.*?>/g,""):i.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),i.v=(ei(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),i.v!==i.v?i.v=Vt(t):i.v<60&&(i.v=i.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+t),i.t||(i.t="n");break;case"Error":i.t="e",i.v=du[t],c.cellText!==!1&&(i.w=t);break;default:t==""&&n==""?i.t="z":(i.t="s",i.v=Rd(n||t));break}if(Y7(i,d,c),c.cellFormula!==!1)if(i.Formula){var m=Vt(i.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),i.f=es(m,r),delete i.Formula,i.ArrayRange=="RC"?i.F=es("RC:RC",r):i.ArrayRange&&(i.F=es(i.ArrayRange,r),l.push([Pt(i.F),i.F]))}else for(b=0;b<l.length;++b)r.r>=l[b][0].s.r&&r.r<=l[b][0].e.r&&r.c>=l[b][0].s.c&&r.c<=l[b][0].e.c&&(i.F=l[b][1]);c.cellStyles&&(v.forEach(function(y){!_.patternType&&y.patternType&&(_.patternType=y.patternType)}),i.s=_),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function Z7(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function dc(t,n){var e=n||{};os();var i=Ss(Bc(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(typeof Ht<"u"?i=Ht.utils.decode(65001,mc(i)):i=Xt(i));var r=i.slice(0,1024).toLowerCase(),a=!1;if(r=r.replace(/".*?"/g,""),(r.indexOf(">")&1023)>Math.min(r.indexOf(",")&1023,r.indexOf(";")&1023)){var s=ti(e);return s.type="string",rs.to_workbook(i,s)}if(r.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(mi){r.indexOf("<"+mi)>=0&&(a=!0)}),a)return V9(i,e);Ls={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c;fi!=null&&e.dense==null&&(e.dense=fi);var d={},h=[],_=e.dense?[]:{},v="",b={},m={},y=jn('<Data ss:Type="String">'),k=0,F=0,T=0,W={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},z={},M="",K=0,j=[],ne={},oe={},q=0,Se=[],Ne=[],Ie={},Ye=[],ze,Et=!1,Pe=[],Ke=[],me={},B=0,te=0,H={Sheets:[],WBProps:{date1904:!1}},U={};Hs.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var pe="";o=Hs.exec(i);)switch(o[3]=(pe=o[3]).toLowerCase()){case"data":if(pe=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?q7(i.slice(k,o.index),M,y,l[l.length-1][0]=="comment"?Ie:b,{c:F,r:T},X,Ye[F],m,Pe,e):(M="",y=jn(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ne.length>0&&(b.c=Ne),(!e.sheetRows||e.sheetRows>T)&&b.v!==void 0&&(e.dense?(_[T]||(_[T]=[]),_[T][F]=b):_[ci(F)+xi(T)]=b),b.HRef&&(b.l={Target:Vt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(B=F+(parseInt(b.MergeAcross,10)|0),te=T+(parseInt(b.MergeDown,10)|0),j.push({s:{c:F,r:T},e:{c:B,r:te}})),!e.sheetStubs)b.MergeAcross?F=B+1:++F;else if(b.MergeAcross||b.MergeDown){for(var Ae=F;Ae<=B;++Ae)for(var Ce=T;Ce<=te;++Ce)(Ae>F||Ce>T)&&(e.dense?(_[Ce]||(_[Ce]=[]),_[Ce][Ae]={t:"z"}):_[ci(Ae)+xi(Ce)]={t:"z"});F=B+1}else++F;else b=K7(o[0]),b.Index&&(F=+b.Index-1),F<W.s.c&&(W.s.c=F),F>W.e.c&&(W.e.c=F),o[0].slice(-2)==="/>"&&++F,Ne=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(T<W.s.r&&(W.s.r=T),T>W.e.r&&(W.e.r=T),o[0].slice(-2)==="/>"&&(m=jn(o[0]),m.Index&&(T=+m.Index-1)),F=0,++T):(m=jn(o[0]),m.Index&&(T=+m.Index-1),me={},(m.AutoFitHeight=="0"||m.Height)&&(me.hpx=parseInt(m.Height,10),me.hpt=Gs(me.hpx),Ke[T]=me),m.Hidden=="1"&&(me.hidden=!0,Ke[T]=me));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(v),W.s.r<=W.e.r&&W.s.c<=W.e.c&&(_["!ref"]=yt(W),e.sheetRows&&e.sheetRows<=W.e.r&&(_["!fullref"]=_["!ref"],W.e.r=e.sheetRows-1,_["!ref"]=yt(W))),j.length&&(_["!merges"]=j),Ye.length>0&&(_["!cols"]=Ye),Ke.length>0&&(_["!rows"]=Ke),d[v]=_}else W={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=F=0,l.push([o[3],!1]),c=jn(o[0]),v=Vt(c.Name),_=e.dense?[]:{},j=[],Pe=[],Ke=[],U={name:v,Hidden:0},H.Sheets.push(U);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ye=[],Et=!1}break;case"style":o[1]==="/"?X7(X,z,e):z=jn(o[0]);break;case"numberformat":z.nf=Vt(jn(o[0]).Format||"General"),Ls[z.nf]&&(z.nf=Ls[z.nf]);for(var Te=0;Te!=392&&lt[Te]!=z.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(lt[Te]==null){_r(z.nf,Te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ze=jn(o[0]),ze.Hidden&&(ze.hidden=!0,delete ze.Hidden),ze.Width&&(ze.wpx=parseInt(ze.Width,10)),!Et&&ze.wpx>10){Et=!0,qi=ju;for(var xe=0;xe<Ye.length;++xe)Ye[xe]&&jr(Ye[xe])}Et&&jr(ze),Ye[ze.Index-1||Ye.length]=ze;for(var gt=0;gt<+ze.Span;++gt)Ye[Ye.length]=ti(ze);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var P=ut(o[0]),zt={Name:P.Name,Ref:es(P.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(zt.Sheet=H.Sheets.length-1),H.Names.push(zt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?M+=i.slice(K,o.index):K=o.index+o[0].length;break;case"interior":if(!e.cellStyles)break;z.Interior=jn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y4(ne,pe,i.slice(q,o.index)):q=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));Z7(Ie),Ne.push(Ie)}else l.push([o[3],!1]),c=jn(o[0]),Ie={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Dt=jn(o[0]);_["!autofilter"]={ref:es(Dt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Cp(i,e);var Wt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Wt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Wt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Wt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Wt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(i.slice(q,o.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else q=o.index+o[0].length;break;case"header":_["!margins"]||sa(_["!margins"]={},"xlml"),isNaN(+ut(o[0]).Margin)||(_["!margins"].header=+ut(o[0]).Margin);break;case"footer":_["!margins"]||sa(_["!margins"]={},"xlml"),isNaN(+ut(o[0]).Margin)||(_["!margins"].footer=+ut(o[0]).Margin);break;case"pagemargins":var Mt=ut(o[0]);_["!margins"]||sa(_["!margins"]={},"xlml"),isNaN(+Mt.Top)||(_["!margins"].top=+Mt.Top),isNaN(+Mt.Left)||(_["!margins"].left=+Mt.Left),isNaN(+Mt.Right)||(_["!margins"].right=+Mt.Right),isNaN(+Mt.Bottom)||(_["!margins"].bottom=+Mt.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Wt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Wt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Wt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Wt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Wt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Wt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Wt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Wt=!1}break;case"smarttags":break;default:Wt=!1;break}if(Wt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$7(oe,pe,Se,i.slice(q,o.index)):(Se=o,q=o.index+o[0].length);break}if(e.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Be={};return!e.bookSheets&&!e.bookProps&&(Be.Sheets=d),Be.SheetNames=h,Be.Workbook=H,Be.SSF=ti(lt),Be.Props=ne,Be.Custprops=oe,Be}function Tc(t,n){switch(u0(n=n||{}),n.type||"base64"){case"base64":return dc(wn(t),n);case"binary":case"buffer":case"file":return dc(t,n);case"array":return dc($r(t),n)}}function Q7(t,n){var e=[];return t.Props&&e.push(w4(t.Props,n)),t.Custprops&&e.push(C4(t.Props,t.Custprops,n)),e.join("")}function J7(){return""}function e9(t,n){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(i,r){var a=[];a.push(ke("NumberFormat",null,{"ss:Format":Gt(lt[i.numFmtId])}));var s={"ss:ID":"s"+(21+r)};e.push(ke("Style",a.join(""),s))}),ke("Styles",e.join(""))}function xf(t){return ke("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+s0(t.Ref,{r:0,c:0})})}function t9(t){if(!((t||{}).Workbook||{}).Names)return"";for(var n=t.Workbook.Names,e=[],i=0;i<n.length;++i){var r=n[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||e.push(xf(r)))}return ke("Names",e.join(""))}function i9(t,n,e,i){if(!t||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,a=[],s=0;s<r.length;++s){var o=r[s];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||a.push(xf(o)))}return a.join("")}function n9(t,n,e,i){if(!t)return"";var r=[];if(t["!margins"]&&(r.push("<PageSetup>"),t["!margins"].header&&r.push(ke("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&r.push(ke("Footer",null,{"x:Margin":t["!margins"].footer})),r.push(ke("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)r.push(ke("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<e&&!(i.Workbook.Sheets[a]&&!i.Workbook.Sheets[a].Hidden);++a);a==e&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),t["!protect"]&&(r.push(zi("ProtectContents","True")),t["!protect"].objects&&r.push(zi("ProtectObjects","True")),t["!protect"].scenarios&&r.push(zi("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?r.push(zi("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&r.push(zi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){t["!protect"][s[0]]&&r.push("<"+s[1]+"/>")})),r.length==0?"":ke("WorksheetOptions",r.join(""),{xmlns:vn.x})}function r9(t){return t.map(function(n){var e=TT(n.t||""),i=ke("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ke("Comment",i,{"ss:Author":n.a})}).join("")}function a9(t,n,e,i,r,a,s){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Gt(s0(t.f,s))),t.F&&t.F.slice(0,n.length)==n){var l=di(t.F.slice(n.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Gt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Gt(t.l.Tooltip))),e["!merges"])for(var c=e["!merges"],d=0;d!=c.length;++d)c[d].s.c!=s.c||c[d].s.r!=s.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",_="";switch(t.t){case"z":if(!i.sheetStubs)return"";break;case"n":h="Number",_=String(t.v);break;case"b":h="Boolean",_=t.v?"1":"0";break;case"e":h="Error",_=yr[t.v];break;case"d":h="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||lt[14]);break;case"s":h="String",_=CT(t.v||"");break}var v=Xr(i.cellXfs,t,i);o["ss:StyleID"]="s"+(21+v),o["ss:Index"]=s.c+1;var b=t.v!=null?_:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+b+"</Data>";return(t.c||[]).length>0&&(m+=r9(t.c)),ke("Cell",m,o)}function s9(t,n){var e='<Row ss:Index="'+(t+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=as(n.hpt)),n.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(e+=' ss:Hidden="1"')),e+">"}function o9(t,n,e,i){if(!t["!ref"])return"";var r=Pt(t["!ref"]),a=t["!merges"]||[],s=0,o=[];t["!cols"]&&t["!cols"].forEach(function(y,k){jr(y);var F=!!y.width,T=ol(k,y),W={"ss:Index":k+1};F&&(W["ss:Width"]=js(T.width)),y.hidden&&(W["ss:Hidden"]="1"),o.push(ke("Column",null,W))});for(var l=Array.isArray(t),c=r.s.r;c<=r.e.r;++c){for(var d=[s9(c,(t["!rows"]||[])[c])],h=r.s.c;h<=r.e.c;++h){var _=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>h)&&!(a[s].s.r>c)&&!(a[s].e.c<h)&&!(a[s].e.r<c)){(a[s].s.c!=h||a[s].s.r!=c)&&(_=!0);break}if(!_){var v={r:c,c:h},b=dt(v),m=l?(t[c]||[])[h]:t[b];d.push(a9(m,b,t,n,e,i,v))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function l9(t,n,e){var i=[],r=e.SheetNames[t],a=e.Sheets[r],s=a?i9(a,n,t,e):"";return s.length>0&&i.push("<Names>"+s+"</Names>"),s=a?o9(a,n,t,e):"",s.length>0&&i.push("<Table>"+s+"</Table>"),i.push(n9(a,n,t,e)),i.join("")}function c9(t,n){n||(n={}),t.SSF||(t.SSF=ti(lt)),t.SSF&&(os(),Jo(t.SSF),n.revssf=tl(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF,n.cellXfs=[],Xr(n.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(Q7(t,n)),e.push(J7(t,n)),e.push(""),e.push("");for(var i=0;i<t.SheetNames.length;++i)e.push(ke("Worksheet",l9(i,n,t),{"ss:Name":Gt(t.SheetNames[i])}));return e[2]=e9(t,n),e[3]=t9(t,n),vi+ke("Workbook",e.join(""),{xmlns:vn.ss,"xmlns:o":vn.o,"xmlns:x":vn.x,"xmlns:ss":vn.ss,"xmlns:dt":vn.dt,"xmlns:html":vn.html})}function d9(t){var n={},e=t.content;if(e.l=28,n.AnsiUserType=e.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=t4(e),e.length-e.l<=4)return n;var i=e.read_shift(4);if(i==0||i>40||(e.l-=4,n.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(i=e.read_shift(4),i!==1907505652)||(n.UnicodeClipboardFormat=i4(e),i=e.read_shift(4),i==0||i>40))return n;e.l-=4,n.Reserved2=e.read_shift(0,"lpwstr")}var p9=[60,1084,2066,2165,2175];function u9(t,n,e,i,r){var a=i,s=[],o=e.slice(e.l,e.l+a);if(r&&r.enc&&r.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:r.enc.insitu(o)}s.push(o),e.l+=a;for(var l=hr(e,e.l),c=Sc[l],d=0;c!=null&&p9.indexOf(l)>-1;)a=hr(e,e.l+2),d=e.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=e.slice(d,e.l+4+a),s.push(o),e.l+=4+a,c=Sc[l=hr(e,e.l)];var h=Pi(s);Hi(h,0);var _=0;h.lens=[];for(var v=0;v<s.length;++v)h.lens.push(_),_+=s[v].length;if(h.length<i)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+i;return n.f(h,h.length,r)}function er(t,n,e){if(t.t!=="z"&&t.XF){var i=0;try{i=t.z||t.XF.numFmtId||0,n.cellNF&&(t.z=lt[i])}catch(a){if(n.WTF)throw a}if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||yr[t.v]:i===0||i=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bs(t.v):t.w=oa(t.v):t.w=Nn(i,t.v,{date1904:!!e,dateNF:n&&n.dateNF})}catch(a){if(n.WTF)throw a}if(n.cellDates&&i&&t.t=="n"&&ss(lt[i]||String(i))){var r=ia(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function Po(t,n,e){return{v:t,ixfe:n,t:e}}function f9(t,n){var e={opts:{}},i={};fi!=null&&n.dense==null&&(n.dense=fi);var r=n.dense?[]:{},a={},s={},o=null,l=[],c="",d={},h,_="",v,b,m,y,k={},F=[],T,W,X=[],z=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},j=function(Ft){return Ft<8?na[Ft]:Ft<64&&z[Ft-8]||na[Ft]},ne=function(Ft,_i,Tn){var Ei=_i.XF.data;if(!(!Ei||!Ei.patternType||!Tn||!Tn.cellStyles)){_i.s={},_i.s.patternType=Ei.patternType;var qr;(qr=Ws(j(Ei.icvFore)))&&(_i.s.fgColor={rgb:qr}),(qr=Ws(j(Ei.icvBack)))&&(_i.s.bgColor={rgb:qr})}},oe=function(Ft,_i,Tn){if(!(me>1)&&!(Tn.sheetRows&&Ft.r>=Tn.sheetRows)){if(Tn.cellStyles&&_i.XF&&_i.XF.data&&ne(Ft,_i,Tn),delete _i.ixfe,delete _i.XF,h=Ft,_=dt(Ft),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ft.r<s.s.r&&(s.s.r=Ft.r),Ft.c<s.s.c&&(s.s.c=Ft.c),Ft.r+1>s.e.r&&(s.e.r=Ft.r+1),Ft.c+1>s.e.c&&(s.e.c=Ft.c+1),Tn.cellFormula&&_i.f){for(var Ei=0;Ei<F.length;++Ei)if(!(F[Ei][0].s.c>Ft.c||F[Ei][0].s.r>Ft.r)&&!(F[Ei][0].e.c<Ft.c||F[Ei][0].e.r<Ft.r)){_i.F=yt(F[Ei][0]),(F[Ei][0].s.c!=Ft.c||F[Ei][0].s.r!=Ft.r)&&delete _i.f,_i.f&&(_i.f=""+Xi(F[Ei][1],s,Ft,Pe,q));break}}Tn.dense?(r[Ft.r]||(r[Ft.r]=[]),r[Ft.r][Ft.c]=_i):r[_]=_i}},q={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(q.password=n.password);var Se,Ne=[],Ie=[],Ye=[],ze=[],Et=!1,Pe=[];Pe.SheetNames=q.snames,Pe.sharedf=q.sharedf,Pe.arrayf=q.arrayf,Pe.names=[],Pe.XTI=[];var Ke=0,me=0,B=0,te=[],H=[],U;q.codepage=1200,Kn(1200);for(var pe=!1;t.l<t.length-1;){var Ae=t.l,Ce=t.read_shift(2);if(Ce===0&&Ke===10)break;var Te=t.l===t.length?0:t.read_shift(2),xe=Sc[Ce];if(xe&&xe.f){if(n.bookSheets&&Ke===133&&Ce!==133)break;if(Ke=Ce,xe.r===2||xe.r==12){var gt=t.read_shift(2);if(Te-=2,!q.enc&&gt!==Ce&&((gt&255)<<8|gt>>8)!==Ce)throw new Error("rt mismatch: "+gt+"!="+Ce);xe.r==12&&(t.l+=10,Te-=10)}var P={};if(Ce===10?P=xe.f(t,Te,q):P=u9(Ce,xe,t,Te,q),me==0&&[9,521,1033,2057].indexOf(Ke)===-1)continue;switch(Ce){case 34:e.opts.Date1904=M.WBProps.date1904=P;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(q.enc||(t.l=0),q.enc=P,!n.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:q.lastuser=P;break;case 66:var zt=Number(P);switch(zt){case 21010:zt=1200;break;case 32768:zt=1e4;break;case 32769:zt=1252;break}Kn(q.codepage=zt),pe=!0;break;case 317:q.rrtabid=P;break;case 25:q.winlocked=P;break;case 439:e.opts.RefreshAll=P;break;case 12:e.opts.CalcCount=P;break;case 16:e.opts.CalcDelta=P;break;case 17:e.opts.CalcIter=P;break;case 13:e.opts.CalcMode=P;break;case 14:e.opts.CalcPrecision=P;break;case 95:e.opts.CalcSaveRecalc=P;break;case 15:q.CalcRefMode=P;break;case 2211:e.opts.FullCalc=P;break;case 129:P.fDialog&&(r["!type"]="dialog"),P.fBelow||((r["!outline"]||(r["!outline"]={})).above=!0),P.fRight||((r["!outline"]||(r["!outline"]={})).left=!0);break;case 224:X.push(P);break;case 430:Pe.push([P]),Pe[Pe.length-1].XTI=[];break;case 35:case 547:Pe[Pe.length-1].push(P);break;case 24:case 536:U={Name:P.Name,Ref:Xi(P.rgce,s,null,Pe,q)},P.itab>0&&(U.Sheet=P.itab-1),Pe.names.push(U),Pe[0]||(Pe[0]=[],Pe[0].XTI=[]),Pe[Pe.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(H[P.itab-1]={ref:yt(P.rgce[0][0][1][2])});break;case 22:q.ExternCount=P;break;case 23:Pe.length==0&&(Pe[0]=[],Pe[0].XTI=[]),Pe[Pe.length-1].XTI=Pe[Pe.length-1].XTI.concat(P),Pe.XTI=Pe.XTI.concat(P);break;case 2196:if(q.biff<8)break;U!=null&&(U.Comment=P[1]);break;case 18:r["!protect"]=P;break;case 19:P!==0&&q.WTF&&console.error("Password verifier: "+P);break;case 133:a[P.pos]=P,q.snames.push(P.name);break;case 10:{if(--me)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,r["!ref"]=yt(s),n.sheetRows&&n.sheetRows<=s.e.r){var Dt=s.e.r;s.e.r=n.sheetRows-1,r["!fullref"]=r["!ref"],r["!ref"]=yt(s),s.e.r=Dt}s.e.r++,s.e.c++}Ne.length>0&&(r["!merges"]=Ne),Ie.length>0&&(r["!objects"]=Ie),Ye.length>0&&(r["!cols"]=Ye),ze.length>0&&(r["!rows"]=ze),M.Sheets.push(K)}c===""?d=r:i[c]=r,r=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(q.biff===8&&(q.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),q.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(q.biff=5,pe=!0,Kn(q.codepage=28591)),q.biff==8&&P.BIFFVer==0&&P.dt==16&&(q.biff=2),me++)break;if(r=n.dense?[]:{},q.biff<8&&!pe&&(pe=!0,Kn(q.codepage=n.codepage||1252)),q.biff<5||P.BIFFVer==0&&P.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Wt={pos:t.l-Te,name:c};a[Wt.pos]=Wt,q.snames.push(c)}else c=(a[Ae]||{name:""}).name;P.dt==32&&(r["!type"]="chart"),P.dt==64&&(r["!type"]="macro"),Ne=[],Ie=[],q.arrayf=F=[],Ye=[],ze=[],Et=!1,K={Hidden:(a[Ae]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:r["!type"]=="chart"&&(n.dense?(r[P.r]||[])[P.c]:r[dt({c:P.c,r:P.r})])&&++P.c,T={ixfe:P.ixfe,XF:X[P.ixfe]||{},v:P.val,t:"n"},B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:P.c,r:P.r},T,n);break;case 5:case 517:T={ixfe:P.ixfe,XF:X[P.ixfe],v:P.val,t:P.t},B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:P.c,r:P.r},T,n);break;case 638:T={ixfe:P.ixfe,XF:X[P.ixfe],v:P.rknum,t:"n"},B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:P.c,r:P.r},T,n);break;case 189:for(var Mt=P.c;Mt<=P.C;++Mt){var Be=P.rkrec[Mt-P.c][0];T={ixfe:Be,XF:X[Be],v:P.rkrec[Mt-P.c][1],t:"n"},B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:Mt,r:P.r},T,n)}break;case 6:case 518:case 1030:{if(P.val=="String"){o=P;break}if(T=Po(P.val,P.cell.ixfe,P.tt),T.XF=X[T.ixfe],n.cellFormula){var mi=P.formula;if(mi&&mi[0]&&mi[0][0]&&mi[0][0][0]=="PtgExp"){var Cn=mi[0][0][1][0],Xn=mi[0][0][1][1],or=dt({r:Cn,c:Xn});k[or]?T.f=""+Xi(P.formula,s,P.cell,Pe,q):T.F=((n.dense?(r[Cn]||[])[Xn]:r[or])||{}).F}else T.f=""+Xi(P.formula,s,P.cell,Pe,q)}B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe(P.cell,T,n),o=P}break;case 7:case 519:if(o)o.val=P,T=Po(P,o.cell.ixfe,"s"),T.XF=X[T.ixfe],n.cellFormula&&(T.f=""+Xi(o.formula,s,o.cell,Pe,q)),B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe(o.cell,T,n),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(P);var ps=dt(P[0].s);if(v=n.dense?(r[P[0].s.r]||[])[P[0].s.c]:r[ps],n.cellFormula&&v){if(!o||!ps||!v)break;v.f=""+Xi(P[1],s,P[0],Pe,q),v.F=yt(P[0])}}break;case 1212:{if(!n.cellFormula)break;if(_){if(!o)break;k[dt(o.cell)]=P[0],v=n.dense?(r[o.cell.r]||[])[o.cell.c]:r[dt(o.cell)],(v||{}).f=""+Xi(P[0],s,h,Pe,q)}}break;case 253:T=Po(l[P.isst].t,P.ixfe,"s"),l[P.isst].h&&(T.h=l[P.isst].h),T.XF=X[T.ixfe],B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:P.c,r:P.r},T,n);break;case 513:n.sheetStubs&&(T={ixfe:P.ixfe,XF:X[P.ixfe],t:"z"},B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:P.c,r:P.r},T,n));break;case 190:if(n.sheetStubs)for(var wr=P.c;wr<=P.C;++wr){var hn=P.ixfe[wr-P.c];T={ixfe:hn,XF:X[hn],t:"z"},B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:wr,r:P.r},T,n)}break;case 214:case 516:case 4:T=Po(P.val,P.ixfe,"s"),T.XF=X[T.ixfe],B>0&&(T.z=te[T.ixfe>>8&63]),er(T,n,e.opts.Date1904),oe({c:P.c,r:P.r},T,n);break;case 0:case 512:me===1&&(s=P);break;case 252:l=P;break;case 1054:if(q.biff==4){te[B++]=P[1];for(var lr=0;lr<B+163&&lt[lr]!=P[1];++lr);lr>=163&&_r(P[1],B+163)}else _r(P[1],P[0]);break;case 30:{te[B++]=P;for(var Cr=0;Cr<B+163&&lt[Cr]!=P;++Cr);Cr>=163&&_r(P,B+163)}break;case 229:Ne=Ne.concat(P);break;case 93:Ie[P.cmo[0]]=q.lastobj=P;break;case 438:q.lastobj.TxO=P;break;case 127:q.lastobj.ImData=P;break;case 440:for(y=P[0].s.r;y<=P[0].e.r;++y)for(m=P[0].s.c;m<=P[0].e.c;++m)v=n.dense?(r[y]||[])[m]:r[dt({c:m,r:y})],v&&(v.l=P[1]);break;case 2048:for(y=P[0].s.r;y<=P[0].e.r;++y)for(m=P[0].s.c;m<=P[0].e.c;++m)v=n.dense?(r[y]||[])[m]:r[dt({c:m,r:y})],v&&v.l&&(v.l.Tooltip=P[1]);break;case 28:{if(q.biff<=5&&q.biff>=2)break;v=n.dense?(r[P[0].r]||[])[P[0].c]:r[dt(P[0])];var us=Ie[P[2]];v||(n.dense?(r[P[0].r]||(r[P[0].r]=[]),v=r[P[0].r][P[0].c]={t:"z"}):v=r[dt(P[0])]={t:"z"},s.e.r=Math.max(s.e.r,P[0].r),s.s.r=Math.min(s.s.r,P[0].r),s.e.c=Math.max(s.e.c,P[0].c),s.s.c=Math.min(s.s.c,P[0].c)),v.c||(v.c=[]),b={a:P[1],t:us.TxO.t},v.c.push(b)}break;case 2173:eE(X[P.ixfe],P.ext);break;case 125:{if(!q.cellStyles)break;for(;P.e>=P.s;)Ye[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},Et||(Et=!0,n0(P.w/256)),jr(Ye[P.e+1])}break;case 520:{var nn={};P.level!=null&&(ze[P.r]=nn,nn.level=P.level),P.hidden&&(ze[P.r]=nn,nn.hidden=!0),P.hpt&&(ze[P.r]=nn,nn.hpt=P.hpt,nn.hpx=as(P.hpt))}break;case 38:case 39:case 40:case 41:r["!margins"]||sa(r["!margins"]={}),r["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=P;break;case 161:r["!margins"]||sa(r["!margins"]={}),r["!margins"].header=P.header,r["!margins"].footer=P.footer;break;case 574:P.RTL&&(M.Views[0].RTL=!0);break;case 146:z=P;break;case 2198:Se=P;break;case 140:W=P;break;case 442:c?K.CodeName=P||K.name:M.WBProps.CodeName=P||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),t.l+=Te}return e.SheetNames=hi(a).sort(function(qn,Ft){return Number(qn)-Number(Ft)}).map(function(qn){return a[qn].name}),n.bookSheets||(e.Sheets=i),!e.SheetNames.length&&d["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=d)):e.Preamble=d,e.Sheets&&H.forEach(function(qn,Ft){e.Sheets[e.SheetNames[Ft]]["!autofilter"]=qn}),e.Strings=l,e.SSF=ti(lt),q.enc&&(e.Encryption=q.enc),Se&&(e.Themes=Se),e.Metadata={},W!==void 0&&(e.Metadata.Country=W),Pe.names.length>0&&(M.Names=Pe.names),e.Workbook=M,e}var Rs={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function h9(t,n,e){var i=et.find(t,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var r=Jd(i,xc,Rs.DSI);for(var a in r)n[a]=r[a]}catch(c){if(e.WTF)throw c}var s=et.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var o=Jd(s,vc,Rs.SI);for(var l in o)n[l]==null&&(n[l]=o[l])}catch(c){if(e.WTF)throw c}n.HeadingPairs&&n.TitlesOfParts&&(_u(n.HeadingPairs,n.TitlesOfParts,n,e),delete n.HeadingPairs,delete n.TitlesOfParts)}function m9(t,n){var e=[],i=[],r=[],a=0,s,o=Fd(xc,"n"),l=Fd(vc,"n");if(t.Props)for(s=hi(t.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?e:Object.prototype.hasOwnProperty.call(l,s[a])?i:r).push([s[a],t.Props[s[a]]]);if(t.Custprops)for(s=hi(t.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?e:Object.prototype.hasOwnProperty.call(l,s[a])?i:r).push([s[a],t.Custprops[s[a]]]);var c=[];for(a=0;a<r.length;++a)Cu.indexOf(r[a][0])>-1||mu.indexOf(r[a][0])>-1||r[a][1]!=null&&c.push(r[a]);i.length&&et.utils.cfb_add(n,"/SummaryInformation",ep(i,Rs.SI,l,vc)),(e.length||c.length)&&et.utils.cfb_add(n,"/DocumentSummaryInformation",ep(e,Rs.DSI,o,xc,c.length?c:null,Rs.UDI))}function vf(t,n){n||(n={}),u0(n),Fc(),n.codepage&&Ec(n.codepage);var e,i;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");e=et.find(t,"!CompObj"),i=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(n.type){case"base64":t=bn(wn(t));break;case"binary":t=bn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Hi(t,0),i={content:t}}var r,a;if(e&&d9(e),n.bookProps&&!n.bookSheets)r={};else{var s=kt?"buffer":"array";if(i&&i.content)r=f9(i.content,n);else if((a=et.find(t,"PerfectOffice_MAIN"))&&a.content)r=aa.to_workbook(a.content,(n.type=s,n));else if((a=et.find(t,"NativeContent_MAIN"))&&a.content)r=aa.to_workbook(a.content,(n.type=s,n));else throw(a=et.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=EE(t))}var o={};return t.FullPaths&&h9(t,o,n),r.Props=r.Custprops=o,n.bookFiles&&(r.cfb=t),r}function _9(t,n){var e=n||{},i=et.utils.cfb_new({root:"R"}),r="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":r="/Workbook",e.biff=8;break;case"biff5":r="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return et.utils.cfb_add(i,r,bf(t,e)),e.biff==8&&(t.Props||t.Custprops)&&m9(t,i),e.biff==8&&t.vbaraw&&FE(i,et.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),i}var $s={0:{f:U8},1:{f:Y8},2:{f:f5},3:{f:i5},4:{f:Q8},5:{f:d5},6:{f:x5},7:{f:s5},8:{f:S5},9:{f:T5},10:{f:w5},11:{f:C5},12:{f:q8},13:{f:m5},14:{f:r5},15:{f:e5},16:{f:pf},17:{f:b5},18:{f:l5},19:{f:$c},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:b7},40:{},42:{},43:{f:xk},44:{f:_k},45:{f:yk},46:{f:Ck},47:{f:wk},48:{},49:{f:WT},50:{},51:{f:nE},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Lu},62:{f:g5},63:{f:uE},64:{f:H5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:en,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:P5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:G8},148:{f:W8,p:16},151:{f:M5},152:{},153:{f:g7},154:{},155:{},156:{f:m7},157:{},158:{},159:{T:1,f:AI},160:{T:-1},161:{T:1,f:ga},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:I5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:tE},336:{T:-1},337:{f:sE,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:gc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Au},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:O5},427:{f:A5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:R5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:K8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:F5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:gc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:CE},633:{T:1},634:{T:-1},635:{T:1,f:yE},636:{T:-1},637:{f:$T},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:r7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:z5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Sc={6:{f:lc},10:{f:Ur},12:{f:ki},13:{f:ki},14:{f:gi},15:{f:gi},16:{f:Zi},17:{f:gi},18:{f:gi},19:{f:ki},20:{f:sp},21:{f:sp},23:{f:Au},24:{f:lp},25:{f:gi},26:{},27:{},28:{f:zS},29:{},34:{f:gi},35:{f:op},38:{f:Zi},39:{f:Zi},40:{f:Zi},41:{f:Zi},42:{f:gi},43:{f:gi},47:{f:ek},49:{f:mS},51:{f:ki},60:{},61:{f:dS},64:{f:gi},65:{f:hS},66:{f:ki},77:{},80:{},81:{},82:{},85:{f:ki},89:{},90:{},91:{},92:{f:J4},93:{f:KS},94:{},95:{f:gi},96:{},97:{},99:{f:gi},125:{f:Lu},128:{f:DS},129:{f:tS},130:{f:ki},131:{f:gi},132:{f:gi},133:{f:iS},134:{},140:{f:JS},141:{f:ki},144:{},146:{f:iI},151:{},152:{},153:{},154:{},155:{},156:{f:ki},157:{},158:{},160:{f:cI},161:{f:aI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:IS},190:{f:kS},193:{f:Ur},197:{},198:{},199:{},200:{},201:{},202:{f:gi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ki},220:{},221:{f:gi},222:{},224:{f:FS},225:{f:Q4},226:{f:Ur},227:{},229:{f:WS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:rS},253:{f:gS},255:{f:sS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Tu},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gi},353:{f:Ur},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:RS},431:{f:gi},432:{},433:{},434:{},437:{},438:{f:YS},439:{f:gi},440:{f:XS},441:{},442:{f:Qs},443:{},444:{f:ki},445:{},446:{},448:{f:Ur},449:{f:cS,r:2},450:{f:Ur},512:{f:np},513:{f:lI},515:{f:AS},516:{f:vS},517:{f:ap},519:{f:dI},520:{f:oS},523:{},545:{f:cp},549:{f:ip},566:{},574:{f:uS},638:{f:SS},659:{},1048:{},1054:{f:yS},1084:{},1212:{f:NS},2048:{f:ZS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Lo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ur},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nI,r:12},2173:{f:Jk,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:BS,r:12},2197:{},2198:{f:$k,r:12},2199:{},2200:{},2201:{},2202:{f:US,r:12},2203:{f:Ur},2204:{},2205:{},2206:{},2207:{},2211:{f:lS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ki},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:sI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:tI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:np},1:{},2:{f:mI},3:{f:fI},4:{f:uI},5:{f:ap},7:{f:gI},8:{},9:{f:Lo},11:{},22:{f:ki},30:{f:CS},31:{},32:{},33:{f:cp},36:{},37:{f:ip},50:{f:xI},62:{},52:{},67:{},68:{f:ki},69:{},86:{},126:{},127:{f:pI},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vI},223:{},234:{},354:{},421:{},518:{f:lc},521:{f:Lo},536:{f:lp},547:{f:op},561:{},579:{},1030:{f:lc},1033:{f:Lo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function De(t,n,e,i){var r=n;if(!isNaN(r)){var a=i||(e||[]).length||0,s=t.next(4);s.write_shift(2,r),s.write_shift(2,a),a>0&&jc(e)&&t.push(e)}}function g9(t,n,e,i){var r=i||(e||[]).length||0;if(r<=8224)return De(t,n,e,r);var a=n;if(!isNaN(a)){for(var s=e.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,a),d.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c;l<r;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;d.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c}}}function io(t,n,e){return t||(t=ce(7)),t.write_shift(2,n),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function x9(t,n,e,i){var r=ce(9);return io(r,t,n),Su(e,i||"b",r),r}function v9(t,n,e){var i=ce(8+2*e.length);return io(i,t,n),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function b9(t,n,e,i){if(n.v!=null)switch(n.t){case"d":case"n":var r=n.t=="d"?Oi(ei(n.v)):n.v;r==(r|0)&&r>=0&&r<65536?De(t,2,_I(e,i,r)):De(t,3,hI(e,i,r));return;case"b":case"e":De(t,5,x9(e,i,n.v,n.t));return;case"s":case"str":De(t,4,v9(e,i,(n.v||"").slice(0,255)));return}De(t,1,io(null,e,i))}function y9(t,n,e,i){var r=Array.isArray(n),a=Pt(n["!ref"]||"A1"),s,o="",l=[];if(a.e.c>255||a.e.r>16383){if(i.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=yt(a)}for(var c=a.s.r;c<=a.e.r;++c){o=xi(c);for(var d=a.s.c;d<=a.e.c;++d){c===a.s.r&&(l[d]=ci(d)),s=l[d]+o;var h=r?(n[c]||[])[d]:n[s];h&&b9(t,h,c,d,i)}}}function w9(t,n){var e=n||{};fi!=null&&e.dense==null&&(e.dense=fi);for(var i=un(),r=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==e.sheet&&(r=a);if(r==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return De(i,e.biff==4?1033:e.biff==3?521:9,e0(t,16,e)),y9(i,t.Sheets[t.SheetNames[r]],r,e,t),De(i,10),i.end()}function C9(t,n,e){De(t,49,_S({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function T9(t,n,e){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)n[r]!=null&&De(t,1054,wS(r,n[r],e))})}function S9(t,n){var e=ce(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),De(t,2151,e),e=ce(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Du(Pt(n["!ref"]||"A1"),e),e.write_shift(4,4),De(t,2152,e)}function I9(t,n){for(var e=0;e<16;++e)De(t,224,rp({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(i){De(t,224,rp(i,0,n))})}function k9(t,n){for(var e=0;e<n["!links"].length;++e){var i=n["!links"][e];De(t,440,qS(i)),i[1].Tooltip&&De(t,2048,QS(i))}delete n["!links"]}function E9(t,n){if(n){var e=0;n.forEach(function(i,r){++e<=256&&i&&De(t,125,rI(ol(r,i),r))})}}function F9(t,n,e,i,r){var a=16+Xr(r.cellXfs,n,r);if(n.v==null&&!n.bf){De(t,513,pa(e,i,a));return}if(n.bf)De(t,6,t8(n,e,i,r,a));else switch(n.t){case"d":case"n":var s=n.t=="d"?Oi(ei(n.v)):n.v;De(t,515,LS(e,i,s,a,r));break;case"b":case"e":De(t,517,OS(e,i,n.v,a,r,n.t));break;case"s":case"str":if(r.bookSST){var o=l0(r.Strings,n.v,r.revStrings);De(t,253,xS(e,i,o,a,r))}else De(t,516,bS(e,i,(n.v||"").slice(0,255),a,r));break;default:De(t,513,pa(e,i,a))}}function D9(t,n,e){var i=un(),r=e.SheetNames[t],a=e.Sheets[r]||{},s=(e||{}).Workbook||{},o=(s.Sheets||[])[t]||{},l=Array.isArray(a),c=n.biff==8,d,h="",_=[],v=Pt(a["!ref"]||"A1"),b=c?65536:16384;if(v.e.c>255||v.e.r>=b){if(n.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,b-1)}De(i,2057,e0(e,16,n)),De(i,13,Pn(1)),De(i,12,Pn(100)),De(i,15,sn(!0)),De(i,17,sn(!1)),De(i,16,ca(.001)),De(i,95,sn(!0)),De(i,42,sn(!1)),De(i,43,sn(!1)),De(i,130,Pn(1)),De(i,128,MS([0,0])),De(i,131,sn(!1)),De(i,132,sn(!1)),c&&E9(i,a["!cols"]),De(i,512,TS(v,n)),c&&(a["!links"]=[]);for(var m=v.s.r;m<=v.e.r;++m){h=xi(m);for(var y=v.s.c;y<=v.e.c;++y){m===v.s.r&&(_[y]=ci(y)),d=_[y]+h;var k=l?(a[m]||[])[y]:a[d];k&&(F9(i,k,m,y,n),c&&k.l&&a["!links"].push([d,k.l]))}}var F=o.CodeName||o.name||r;return c&&De(i,574,fS((s.Views||[])[0])),c&&(a["!merges"]||[]).length&&De(i,229,jS(a["!merges"])),c&&k9(i,a),De(i,442,Iu(F,n)),c&&S9(i,a),De(i,10),i.end()}function M9(t,n,e){var i=un(),r=(t||{}).Workbook||{},a=r.Sheets||[],s=r.WBProps||{},o=e.biff==8,l=e.biff==5;if(De(i,2057,e0(t,5,e)),e.bookType=="xla"&&De(i,135),De(i,225,o?Pn(1200):null),De(i,193,O4(2)),l&&De(i,191),l&&De(i,192),De(i,226),De(i,92,eS("SheetJS",e)),De(i,66,Pn(o?1200:1252)),o&&De(i,353,Pn(0)),o&&De(i,448),De(i,317,oI(t.SheetNames.length)),o&&t.vbaraw&&De(i,211),o&&t.vbaraw){var c=s.CodeName||"ThisWorkbook";De(i,442,Iu(c,e))}De(i,156,Pn(17)),De(i,25,sn(!1)),De(i,18,sn(!1)),De(i,19,Pn(0)),o&&De(i,431,sn(!1)),o&&De(i,444,Pn(0)),De(i,61,pS(e)),De(i,64,sn(!1)),De(i,141,Pn(0)),De(i,34,sn(c7(t)=="true")),De(i,14,sn(!0)),o&&De(i,439,sn(!1)),De(i,218,Pn(0)),C9(i,t,e),T9(i,t.SSF,e),I9(i,e),o&&De(i,352,sn(!1));var d=i.end(),h=un();o&&De(h,140,eI()),o&&e.Strings&&g9(h,252,aS(e.Strings,e)),De(h,10);var _=h.end(),v=un(),b=0,m=0;for(m=0;m<t.SheetNames.length;++m)b+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var y=d.length+b+_.length;for(m=0;m<t.SheetNames.length;++m){var k=a[m]||{};De(v,133,nS({pos:y,hs:k.Hidden||0,dt:0,name:t.SheetNames[m]},e)),y+=n[m].length}var F=v.end();if(b!=F.length)throw new Error("BS8 "+b+" != "+F.length);var T=[];return d.length&&T.push(d),F.length&&T.push(F),_.length&&T.push(_),Pi(T)}function O9(t,n){var e=n||{},i=[];t&&!t.SSF&&(t.SSF=ti(lt)),t&&t.SSF&&(os(),Jo(t.SSF),e.revssf=tl(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,f0(e),e.cellXfs=[],Xr(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var r=0;r<t.SheetNames.length;++r)i[i.length]=D9(r,e,t);return i.unshift(M9(t,i,e)),Pi(i)}function bf(t,n){for(var e=0;e<=t.SheetNames.length;++e){var i=t.Sheets[t.SheetNames[e]];if(!(!i||!i["!ref"])){var r=fn(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var a=n||{};switch(a.biff||2){case 8:case 5:return O9(t,n);case 4:case 3:case 2:return w9(t,n)}throw new Error("invalid type "+a.bookType+" for BIFF")}function vp(t,n){var e=n||{};fi!=null&&e.dense==null&&(e.dense=fi);var i=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var r=t.match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),s=r.index,o=a&&a.index||t.length,l=_T(t.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,_=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(s=0;s<l.length;++s){var m=l[s].trim(),y=m.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,e.sheetRows&&e.sheetRows<=c){--c;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var k=m.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var F=k[o].trim();if(F.match(/<t[dh]/i)){for(var T=F,W=0;T.charAt(0)=="<"&&(W=T.indexOf(">"))>-1;)T=T.slice(W+1);for(var X=0;X<b.length;++X){var z=b[X];z.s.c==d&&z.s.r<c&&c<=z.e.r&&(d=z.e.c+1,X=-1)}var M=ut(F.slice(0,F.indexOf(">")));_=M.colspan?+M.colspan:1,((h=+M.rowspan)>1||_>1)&&b.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+_-1}});var K=M.t||M["data-t"]||"";if(!T.length){d+=_;continue}if(T=Yp(T),v.s.r>c&&(v.s.r=c),v.e.r<c&&(v.e.r=c),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!T.length){d+=_;continue}var j={t:"s",v:T};e.raw||!T.trim().length||K=="s"||(T==="TRUE"?j={t:"b",v:!0}:T==="FALSE"?j={t:"b",v:!1}:isNaN($n(T))?isNaN(ns(T).getDate())||(j={t:"d",v:ei(T)},e.cellDates||(j={t:"n",v:Oi(j.v)}),j.z=e.dateNF||lt[14]):j={t:"n",v:$n(T)}),e.dense?(i[c]||(i[c]=[]),i[c][d]=j):i[dt({r:c,c:d})]=j,d+=_}}}}return i["!ref"]=yt(v),b.length&&(i["!merges"]=b),i}function A9(t,n,e,i){for(var r=t["!merges"]||[],a=[],s=n.s.c;s<=n.e.c;++s){for(var o=0,l=0,c=0;c<r.length;++c)if(!(r[c].s.r>e||r[c].s.c>s)&&!(r[c].e.r<e||r[c].e.c<s)){if(r[c].s.r<e||r[c].s.c<s){o=-1;break}o=r[c].e.r-r[c].s.r+1,l=r[c].e.c-r[c].s.c+1;break}if(!(o<0)){var d=dt({r:e,c:s}),h=i.dense?(t[e]||[])[s]:t[d],_=h&&h.v!=null&&(h.h||Pc(h.w||(xr(h),h.w)||""))||"",v={};o>1&&(v.rowspan=o),l>1&&(v.colspan=l),i.editable?_='<span contenteditable="true">'+_+"</span>":h&&(v["data-t"]=h&&h.t||"z",h.v!=null&&(v["data-v"]=h.v),h.z!=null&&(v["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+h.l.Target+'">'+_+"</a>")),v.id=(i.id||"sjs")+"-"+d,a.push(ke("td",_,v))}}var b="<tr>";return b+a.join("")+"</tr>"}var L9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',R9="</body></html>";function V9(t,n){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return Yr(vp(e[0],n),n);var i=_0();return e.forEach(function(r,a){g0(i,vp(r,n),"Sheet"+(a+1))}),i}function P9(t,n,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function yf(t,n){var e=n||{},i=e.header!=null?e.header:L9,r=e.footer!=null?e.footer:R9,a=[i],s=fn(t["!ref"]);e.dense=Array.isArray(t),a.push(P9(t,s,e));for(var o=s.s.r;o<=s.e.r;++o)a.push(A9(t,s,o,e));return a.push("</table>"+r),a.join("")}function wf(t,n,e){var i=e||{};fi!=null&&(i.dense=fi);var r=0,a=0;if(i.origin!=null)if(typeof i.origin=="number")r=i.origin;else{var s=typeof i.origin=="string"?di(i.origin):i.origin;r=s.r,a=s.c}var o=n.getElementsByTagName("tr"),l=Math.min(i.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r,c:a}};if(t["!ref"]){var d=fn(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),r==-1&&(c.e.r=r=d.e.r+1)}var h=[],_=0,v=t["!rows"]||(t["!rows"]=[]),b=0,m=0,y=0,k=0,F=0,T=0;for(t["!cols"]||(t["!cols"]=[]);b<o.length&&m<l;++b){var W=o[b];if(bp(W)){if(i.display)continue;v[m]={hidden:!0}}var X=W.children;for(y=k=0;y<X.length;++y){var z=X[y];if(!(i.display&&bp(z))){var M=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Yp(z.innerHTML),K=z.getAttribute("data-z")||z.getAttribute("z");for(_=0;_<h.length;++_){var j=h[_];j.s.c==k+a&&j.s.r<m+r&&m+r<=j.e.r&&(k=j.e.c+1-a,_=-1)}T=+z.getAttribute("colspan")||1,((F=+z.getAttribute("rowspan")||1)>1||T>1)&&h.push({s:{r:m+r,c:k+a},e:{r:m+r+(F||1)-1,c:k+a+(T||1)-1}});var ne={t:"s",v:M},oe=z.getAttribute("data-t")||z.getAttribute("t")||"";M!=null&&(M.length==0?ne.t=oe||"z":i.raw||M.trim().length==0||oe=="s"||(M==="TRUE"?ne={t:"b",v:!0}:M==="FALSE"?ne={t:"b",v:!1}:isNaN($n(M))?isNaN(ns(M).getDate())||(ne={t:"d",v:ei(M)},i.cellDates||(ne={t:"n",v:Oi(ne.v)}),ne.z=i.dateNF||lt[14]):ne={t:"n",v:$n(M)})),ne.z===void 0&&K!=null&&(ne.z=K);var q="",Se=z.getElementsByTagName("A");if(Se&&Se.length)for(var Ne=0;Ne<Se.length&&!(Se[Ne].hasAttribute("href")&&(q=Se[Ne].getAttribute("href"),q.charAt(0)!="#"));++Ne);q&&q.charAt(0)!="#"&&(ne.l={Target:q}),i.dense?(t[m+r]||(t[m+r]=[]),t[m+r][k+a]=ne):t[dt({c:k+a,r:m+r})]=ne,c.e.c<k+a&&(c.e.c=k+a),k+=T}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+r),t["!ref"]=yt(c),m>=l&&(t["!fullref"]=yt((c.e.r=o.length-b+m-1+r,c))),t}function Cf(t,n){var e=n||{},i=e.dense?[]:{};return wf(i,t,n)}function B9(t,n){return Yr(Cf(t,n),n)}function bp(t){var n="",e=N9(t);return e&&(n=e(t).getPropertyValue("display")),n||(n=t.style&&t.style.display),n==="none"}function N9(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function U9(t){var n=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,r){return Array(parseInt(r,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=Vt(n.replace(/<[^>]*>/g,""));return[e]}var yp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Tf(t,n){var e=n||{};fi!=null&&e.dense==null&&(e.dense=fi);var i=Bc(t),r=[],a,s,o={name:""},l="",c=0,d,h,_={},v=[],b=e.dense?[]:{},m,y,k={value:""},F="",T=0,W,X=[],z=-1,M=-1,K={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,ne={},oe=[],q={},Se=0,Ne=0,Ie=[],Ye=1,ze=1,Et=[],Pe={Names:[]},Ke={},me=["",""],B=[],te={},H="",U=0,pe=!1,Ae=!1,Ce=0;for(Hs.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Hs.exec(i);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":m[1]==="/"?(K.e.c>=K.s.c&&K.e.r>=K.s.r?b["!ref"]=yt(K):b["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=K.e.r&&(b["!fullref"]=b["!ref"],K.e.r=e.sheetRows-1,b["!ref"]=yt(K)),oe.length&&(b["!merges"]=oe),Ie.length&&(b["!rows"]=Ie),d.name=d.\u540D\u79F0||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),_[d.name]=b,Ae=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=ut(m[0],!1),z=M=-1,K.s.r=K.s.c=1e7,K.e.r=K.e.c=0,b=e.dense?[]:{},oe=[],Ie=[],Ae=!0);break;case"table-row-group":m[1]==="/"?--j:++j;break;case"table-row":case"\u884C":if(m[1]==="/"){z+=Ye,Ye=1;break}if(h=ut(m[0],!1),h.\u884C\u53F7?z=h.\u884C\u53F7-1:z==-1&&(z=0),Ye=+h["number-rows-repeated"]||1,Ye<10)for(Ce=0;Ce<Ye;++Ce)j>0&&(Ie[z+Ce]={level:j});M=-1;break;case"covered-table-cell":m[1]!=="/"&&++M,e.sheetStubs&&(e.dense?(b[z]||(b[z]=[]),b[z][M]={t:"z"}):b[dt({r:z,c:M})]={t:"z"}),F="",X=[];break;case"table-cell":case"\u6570\u636E":if(m[0].charAt(m[0].length-2)==="/")++M,k=ut(m[0],!1),ze=parseInt(k["number-columns-repeated"]||"1",10),y={t:"z",v:null},k.formula&&e.cellFormula!=!1&&(y.f=_p(Vt(k.formula))),(k.\u6570\u636E\u7C7B\u578B||k["value-type"])=="string"&&(y.t="s",y.v=Vt(k["string-value"]||""),e.dense?(b[z]||(b[z]=[]),b[z][M]=y):b[dt({r:z,c:M})]=y),M+=ze-1;else if(m[1]!=="/"){++M,F="",T=0,X=[],ze=1;var Te=Ye?z+Ye-1:z;if(M>K.e.c&&(K.e.c=M),M<K.s.c&&(K.s.c=M),z<K.s.r&&(K.s.r=z),Te>K.e.r&&(K.e.r=Te),k=ut(m[0],!1),B=[],te={},y={t:k.\u6570\u636E\u7C7B\u578B||k["value-type"],v:null},e.cellFormula)if(k.formula&&(k.formula=Vt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Se=parseInt(k["number-matrix-rows-spanned"],10)||0,Ne=parseInt(k["number-matrix-columns-spanned"],10)||0,q={s:{r:z,c:M},e:{r:z+Se-1,c:M+Ne-1}},y.F=yt(q),Et.push([q,y.F])),k.formula)y.f=_p(k.formula);else for(Ce=0;Ce<Et.length;++Ce)z>=Et[Ce][0].s.r&&z<=Et[Ce][0].e.r&&M>=Et[Ce][0].s.c&&M<=Et[Ce][0].e.c&&(y.F=Et[Ce][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Se=parseInt(k["number-rows-spanned"],10)||0,Ne=parseInt(k["number-columns-spanned"],10)||0,q={s:{r:z,c:M},e:{r:z+Se-1,c:M+Ne-1}},oe.push(q)),k["number-columns-repeated"]&&(ze=parseInt(k["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Jt(k["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(k.value);break;case"percentage":y.t="n",y.v=parseFloat(k.value);break;case"currency":y.t="n",y.v=parseFloat(k.value);break;case"date":y.t="d",y.v=ei(k["date-value"]),e.cellDates||(y.t="n",y.v=Oi(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=fT(k["time-value"])/86400,e.cellDates&&(y.t="d",y.v=il(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(k.\u6570\u636E\u6570\u503C);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",k["string-value"]!=null&&(F=Vt(k["string-value"]),X=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(pe=!1,y.t==="s"&&(y.v=F||"",X.length&&(y.R=X),pe=T==0),Ke.Target&&(y.l=Ke),B.length>0&&(y.c=B,B=[]),F&&e.cellText!==!1&&(y.w=F),pe&&(y.t="z",delete y.v),(!pe||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=z))for(var xe=0;xe<Ye;++xe){if(ze=parseInt(k["number-columns-repeated"]||"1",10),e.dense)for(b[z+xe]||(b[z+xe]=[]),b[z+xe][M]=xe==0?y:ti(y);--ze>0;)b[z+xe][M+ze]=ti(y);else for(b[dt({r:z+xe,c:M})]=y;--ze>0;)b[dt({r:z+xe,c:M+ze})]=ti(y);K.e.c<=M&&(K.e.c=M)}ze=parseInt(k["number-columns-repeated"]||"1",10),M+=ze-1,ze=0,y={},F="",X=[]}Ke={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((a=r.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&r.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((a=r.pop())[0]!==m[3])throw"Bad state: "+a;te.t=F,X.length&&(te.R=X),te.a=H,B.push(te)}else m[0].charAt(m[0].length-2)!=="/"&&r.push([m[3],!1]);H="",U=0,F="",T=0,X=[];break;case"creator":m[1]==="/"?H=i.slice(U,m.index):U=m.index+m[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((a=r.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&r.push([m[3],!1]);F="",T=0,X=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(ne[o.name]=l,(a=r.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=ut(m[0],!1),r.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(r[r.length-1][0]){case"time-style":case"date-style":s=ut(m[0],!1),l+=yp[m[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(r[r.length-1][0]){case"time-style":case"date-style":s=ut(m[0],!1),l+=yp[m[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(r[r.length-1][0]){case"number-style":case"date-style":case"time-style":l+=i.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":s=ut(m[0],!1),me=cc(s["cell-range-address"]);var gt={Name:s.name,Ref:me[0]+"!"+me[1]};Ae&&(gt.Sheet=v.length),Pe.Names.push(gt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(r[r.length-1][0])>-1)break;if(m[1]==="/"&&(!k||!k["string-value"])){var P=U9(i.slice(T,m.index),W);F=(F.length>0?F+`
`:"")+P[0]}else W=ut(m[0],!1),T=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{me=cc(ut(m[0])["target-range-address"]),_[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(Ke=ut(m[0],!1),!Ke.href)break;Ke.Target=Vt(Ke.href),delete Ke.href,Ke.Target.charAt(0)=="#"&&Ke.Target.indexOf(".")>-1?(me=cc(Ke.Target.slice(1)),Ke.Target="#"+me[0]+"!"+me[1]):Ke.Target.match(/^\.\.[\\\/]/)&&(Ke.Target=Ke.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(e.WTF)throw new Error(m)}}var zt={Sheets:_,SheetNames:v,Workbook:Pe};return e.bookSheets&&delete zt.Sheets,zt}function wp(t,n){n=n||{},Vn(t,"META-INF/manifest.xml")&&f4(Ii(t,"META-INF/manifest.xml"),n);var e=yn(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var i=Tf(Xt(e),n);return Vn(t,"meta.xml")&&(i.Props=fu(Ii(t,"meta.xml"))),i}function Cp(t,n){return Tf(t,n)}var H9=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+Us({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return vi+n}}(),Tp=function(){var t=function(a){return Gt(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,i=function(a,s,o){var l=[];l.push('      <table:table table:name="'+Gt(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=fn(a["!ref"]||"A1"),_=a["!merges"]||[],v=0,b=Array.isArray(a);if(a["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",y=a["!rows"]||[];for(c=0;c<h.s.r;++c)m=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),d=0;d<h.s.c;++d)l.push(n);for(;d<=h.e.c;++d){var k=!1,F={},T="";for(v=0;v!=_.length;++v)if(!(_[v].s.c>d)&&!(_[v].s.r>c)&&!(_[v].e.c<d)&&!(_[v].e.r<c)){(_[v].s.c!=d||_[v].s.r!=c)&&(k=!0),F["table:number-columns-spanned"]=_[v].e.c-_[v].s.c+1,F["table:number-rows-spanned"]=_[v].e.r-_[v].s.r+1;break}if(k){l.push(e);continue}var W=dt({r:c,c:d}),X=b?(a[c]||[])[d]:a[W];if(X&&X.f&&(F["table:formula"]=Gt(o8(X.f)),X.F&&X.F.slice(0,W.length)==W)){var z=fn(X.F);F["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,F["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!X){l.push(n);continue}switch(X.t){case"b":T=X.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=X.v?"true":"false";break;case"n":T=X.w||String(X.v||0),F["office:value-type"]="float",F["office:value"]=X.v||0;break;case"s":case"str":T=X.v==null?"":X.v,F["office:value-type"]="string";break;case"d":T=X.w||ei(X.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=ei(X.v).toISOString(),F["table:style-name"]="ce1";break;default:l.push(n);continue}var M=t(T);if(X.l&&X.l.Target){var K=X.l.Target;K=K.charAt(0)=="#"?"#"+l8(K.slice(1)):K,K.charAt(0)!="#"&&!K.match(/^\w+:/)&&(K="../"+K),M=ke("text:a",M,{"xlink:href":K.replace(/&/g,"&amp;")})}l.push("          "+ke("table:table-cell",ke("text:p",M,{}),F)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},r=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;jr(h),h.ods=o;var _=c["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var h=c["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var l=[vi],c=Us({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Us({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(uu().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),r(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(i(s.Sheets[s.SheetNames[h]],s,h,o));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Sf(t,n){if(n.bookType=="fods")return Tp(t,n);var e=Lc(),i="",r=[],a=[];return i="mimetype",wt(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",wt(e,i,Tp(t,n)),r.push([i,"text/xml"]),a.push([i,"ContentFile"]),i="styles.xml",wt(e,i,H9(t,n)),r.push([i,"text/xml"]),a.push([i,"StylesFile"]),i="meta.xml",wt(e,i,vi+uu()),r.push([i,"text/xml"]),a.push([i,"MetadataFile"]),i="manifest.rdf",wt(e,i,_4(a)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",wt(e,i,h4(r)),e}function ua(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ic(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Xt($r(t))}function z9(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):bn(nr(t))}function W9(t,n){e:for(var e=0;e<=t.length-n.length;++e){for(var i=0;i<n.length;++i)if(t[e+i]!=n[i])continue e;return!0}return!1}function Gr(t){var n=t.reduce(function(r,a){return r+a.length},0),e=new Uint8Array(n),i=0;return t.forEach(function(r){e.set(r,i),i+=r.length}),e}function Sp(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function j9(t,n){for(var e=(t[n+15]&127)<<7|t[n+14]>>1,i=t[n+14]&1,r=n+13;r>=n;--r)i=i*256+t[r];return(t[n+15]&128?-i:i)*Math.pow(10,e-6176)}function K9(t,n,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,r=e/Math.pow(10,i-6176);t[n+15]|=i>>7,t[n+14]|=(i&127)<<1;for(var a=0;r>=1;++a,r/=256)t[n+a]=r&255;t[n+15]|=e>=0?0:128}function Ys(t,n){var e=n?n[0]:0,i=t[e]&127;e:if(t[e++]>=128&&(i|=(t[e]&127)<<7,t[e++]<128||(i|=(t[e]&127)<<14,t[e++]<128)||(i|=(t[e]&127)<<21,t[e++]<128)||(i+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(i+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(i+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return n&&(n[0]=e),i}function jt(t){var n=new Uint8Array(7);n[0]=t&127;var e=1;e:if(t>127){if(n[e-1]|=128,n[e]=t>>7&127,++e,t<=16383||(n[e-1]|=128,n[e]=t>>14&127,++e,t<=2097151)||(n[e-1]|=128,n[e]=t>>21&127,++e,t<=268435455)||(n[e-1]|=128,n[e]=t/256>>>21&127,++e,t<=34359738367)||(n[e-1]|=128,n[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;n[e-1]|=128,n[e]=t/16777216>>>21&127,++e}return n.slice(0,e)}function ui(t){var n=0,e=t[n]&127;e:if(t[n++]>=128){if(e|=(t[n]&127)<<7,t[n++]<128||(e|=(t[n]&127)<<14,t[n++]<128)||(e|=(t[n]&127)<<21,t[n++]<128))break e;e|=(t[n]&127)<<28}return e}function Bt(t){for(var n=[],e=[0];e[0]<t.length;){var i=e[0],r=Ys(t,e),a=r&7;r=Math.floor(r/8);var s=0,o;if(r==0)break;switch(a){case 0:{for(var l=e[0];t[e[0]++]>=128;);o=t.slice(l,e[0])}break;case 5:s=4,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Ys(t,e),o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(r," at offset ").concat(i))}var c={data:o,type:a};n[r]==null?n[r]=[c]:n[r].push(c)}return n}function Ui(t){var n=[];return t.forEach(function(e,i){e.forEach(function(r){r.data&&(n.push(jt(i*8+r.type)),r.type==2&&n.push(jt(r.data.length)),n.push(r.data))})}),Gr(n)}function p0(t,n){return t?.map(function(e){return n(e.data)})||[]}function Ln(t){for(var n,e=[],i=[0];i[0]<t.length;){var r=Ys(t,i),a=Bt(t.slice(i[0],i[0]+r));i[0]+=r;var s={id:ui(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Bt(o.data),c=ui(l[3][0].data);s.messages.push({meta:l,data:t.slice(i[0],i[0]+c)}),i[0]+=c}),(n=a[3])!=null&&n[0]&&(s.merge=ui(a[3][0].data)>>>0>0),e.push(s)}return e}function $a(t){var n=[];return t.forEach(function(e){var i=[];i[1]=[{data:jt(e.id),type:0}],i[2]=[],e.merge!=null&&(i[3]=[{data:jt(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(s){r.push(s.data),s.meta[3]=[{type:0,data:jt(s.data.length)}],i[2].push({data:Ui(s.meta),type:2})});var a=Ui(i);n.push(jt(a.length)),n.push(a),r.forEach(function(s){return n.push(s)})}),Gr(n)}function G9(t,n){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],i=Ys(n,e),r=[];e[0]<n.length;){var a=n[e[0]]&3;if(a==0){var s=n[e[0]++]>>2;if(s<60)++s;else{var o=s-59;s=n[e[0]],o>1&&(s|=n[e[0]+1]<<8),o>2&&(s|=n[e[0]+2]<<16),o>3&&(s|=n[e[0]+3]<<24),s>>>=0,s++,e[0]+=o}r.push(n.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var l=0,c=0;if(a==1?(c=(n[e[0]]>>2&7)+4,l=(n[e[0]++]&224)<<3,l|=n[e[0]++]):(c=(n[e[0]++]>>2)+1,a==2?(l=n[e[0]]|n[e[0]+1]<<8,e[0]+=2):(l=(n[e[0]]|n[e[0]+1]<<8|n[e[0]+2]<<16|n[e[0]+3]<<24)>>>0,e[0]+=4)),r=[Gr(r)],l==0)throw new Error("Invalid offset 0");if(l>r[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(r.push(r[0].slice(-l)),c-=l;c>=r[r.length-1].length;)r.push(r[r.length-1]),c-=r[r.length-1].length;r.push(r[0].slice(-l,-l+c))}}var d=Gr(r);if(d.length!=i)throw new Error("Unexpected length: ".concat(d.length," != ").concat(i));return d}function Rn(t){for(var n=[],e=0;e<t.length;){var i=t[e++],r=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,n.push(G9(i,t.slice(e,e+r))),e+=r}if(e!==t.length)throw new Error("data is not a valid framed stream!");return Gr(n)}function Ya(t){for(var n=[],e=0;e<t.length;){var i=Math.min(t.length-e,268435455),r=new Uint8Array(4);n.push(r);var a=jt(i),s=a.length;n.push(a),i<=60?(s++,n.push(new Uint8Array([i-1<<2]))):i<=256?(s+=2,n.push(new Uint8Array([240,i-1&255]))):i<=65536?(s+=3,n.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(s+=4,n.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(s+=5,n.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),n.push(t.slice(e,e+i)),s+=i,r[0]=0,r[1]=s&255,r[2]=s>>8&255,r[3]=s>>16&255,e+=i}return Gr(n)}function $9(t,n,e,i){var r=ua(t),a=r.getUint32(4,!0),s=(i>1?12:8)+Sp(a&(i>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);a&512&&(o=r.getUint32(s,!0),s+=4),s+=Sp(a&(i>1?12288:4096))*4,a&16&&(l=r.getUint32(s,!0),s+=4),a&32&&(c=r.getFloat64(s,!0),s+=8),a&64&&(d.setTime(d.getTime()+r.getFloat64(s,!0)*1e3),s+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:n[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:e[o]};else if(l>-1)h={t:"s",v:n[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function Y9(t,n,e){var i=ua(t),r=i.getUint32(8,!0),a=12,s=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);r&1&&(l=j9(t,a),a+=16),r&2&&(c=i.getFloat64(a,!0),a+=8),r&4&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8),r&8&&(o=i.getUint32(a,!0),a+=4),r&16&&(s=i.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:n[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(s>-1)h={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(r&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(r&31," : ").concat(t.slice(0,4)))}return h}function pc(t,n){var e=new Uint8Array(32),i=ua(e),r=12,a=0;switch(e[0]=5,t.t){case"n":e[1]=2,K9(e,r,t.v),a|=1,r+=16;break;case"b":e[1]=6,i.setFloat64(r,t.v?1:0,!0),a|=2,r+=8;break;case"s":if(n.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,i.setUint32(r,n.indexOf(t.v),!0),a|=8,r+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(8,a,!0),e.slice(0,r)}function uc(t,n){var e=new Uint8Array(32),i=ua(e),r=12,a=0;switch(e[0]=3,t.t){case"n":e[2]=2,i.setFloat64(r,t.v,!0),a|=32,r+=8;break;case"b":e[2]=6,i.setFloat64(r,t.v?1:0,!0),a|=32,r+=8;break;case"s":if(n.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,i.setUint32(r,n.indexOf(t.v),!0),a|=16,r+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(4,a,!0),e.slice(0,r)}function X9(t,n,e){switch(t[0]){case 0:case 1:case 2:case 3:return $9(t,n,e,t[0]);case 5:return Y9(t,n,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Yi(t){var n=Bt(t);return Ys(n[1][0].data)}function Ip(t,n){var e=Bt(n.data),i=ui(e[1][0].data),r=e[3],a=[];return(r||[]).forEach(function(s){var o=Bt(s.data),l=ui(o[1][0].data)>>>0;switch(i){case 1:a[l]=Ic(o[3][0].data);break;case 8:{var c=t[Yi(o[9][0].data)][0],d=Bt(c.data),h=t[Yi(d[1][0].data)][0],_=ui(h.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var v=Bt(h.data);a[l]=v[3].map(function(b){return Ic(b.data)}).join("")}break}}),a}function q9(t,n){var e,i,r,a,s,o,l,c,d,h,_,v,b,m,y=Bt(t),k=ui(y[1][0].data)>>>0,F=ui(y[2][0].data)>>>0,T=((i=(e=y[8])==null?void 0:e[0])==null?void 0:i.data)&&ui(y[8][0].data)>0||!1,W,X;if((a=(r=y[7])==null?void 0:r[0])!=null&&a.data&&n!=0)W=(o=(s=y[7])==null?void 0:s[0])==null?void 0:o.data,X=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(d=y[4])==null?void 0:d[0])!=null&&h.data&&n!=1)W=(v=(_=y[4])==null?void 0:_[0])==null?void 0:v.data,X=(m=(b=y[3])==null?void 0:b[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var z=T?4:1,M=ua(W),K=[],j=0;j<W.length/2;++j){var ne=M.getUint16(j*2,!0);ne<65535&&K.push([j,ne])}if(K.length!=F)throw"Expected ".concat(F," cells, found ").concat(K.length);var oe=[];for(j=0;j<K.length-1;++j)oe[K[j][0]]=X.subarray(K[j][1]*z,K[j+1][1]*z);return K.length>=1&&(oe[K[K.length-1][0]]=X.subarray(K[K.length-1][1]*z)),{R:k,cells:oe}}function Z9(t,n){var e,i=Bt(n.data),r=(e=i?.[7])!=null&&e[0]?ui(i[7][0].data)>>>0>0?1:0:-1,a=p0(i[5],function(s){return q9(s,r)});return{nrows:ui(i[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function Q9(t,n,e){var i,r=Bt(n.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ui(r[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(a.e.c=(ui(r[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));e["!ref"]=yt(a);var s=Bt(r[4][0].data),o=Ip(t,t[Yi(s[4][0].data)][0]),l=(i=s[17])!=null&&i[0]?Ip(t,t[Yi(s[17][0].data)][0]):[],c=Bt(s[3][0].data),d=0;c[1].forEach(function(h){var _=Bt(h.data),v=t[Yi(_[2][0].data)][0],b=ui(v.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var m=Z9(t,v);m.data.forEach(function(y,k){y.forEach(function(F,T){var W=dt({r:d+k,c:T}),X=X9(F,o,l);X&&(e[W]=X)})}),d+=m.nrows})}function J9(t,n){var e=Bt(n.data),i={"!ref":"A1"},r=t[Yi(e[2][0].data)],a=ui(r[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Q9(t,r[0],i),i}function eF(t,n){var e,i=Bt(n.data),r={name:(e=i[1])!=null&&e[0]?Ic(i[1][0].data):"",sheets:[]},a=p0(i[2],Yi);return a.forEach(function(s){t[s].forEach(function(o){var l=ui(o.meta[1][0].data);l==6e3&&r.sheets.push(J9(t,o))})}),r}function tF(t,n){var e=_0(),i=Bt(n.data),r=p0(i[1],Yi);if(r.forEach(function(a){t[a].forEach(function(s){var o=ui(s.meta[1][0].data);if(o==2){var l=eF(t,s);l.sheets.forEach(function(c,d){g0(e,c,d==0?l.name:l.name+"_"+d,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function fc(t){var n,e,i,r,a={},s=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Rn(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=Ln(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){a[h.id]=h.messages,s.push(h.id)})}}),!s.length)throw new Error("File has no messages");var o=((r=(i=(e=(n=a?.[1])==null?void 0:n[0])==null?void 0:e.meta)==null?void 0:i[1])==null?void 0:r[0].data)&&ui(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(l){a[l].forEach(function(c){var d=ui(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tF(a,o)}function iF(t,n,e){var i,r,a,s;if(!((i=t[6])!=null&&i[0])||!((r=t[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=t[8])==null?void 0:a[0])==null?void 0:s.data)&&ui(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=ua(t[7][0].data),d=0,h=[],_=ua(t[4][0].data),v=0,b=[],m=0;m<n.length;++m){if(n[m]==null){c.setUint16(m*2,65535,!0),_.setUint16(m*2,65535);continue}c.setUint16(m*2,d,!0),_.setUint16(m*2,v,!0);var y,k;switch(typeof n[m]){case"string":y=pc({t:"s",v:n[m]},e),k=uc({t:"s",v:n[m]},e);break;case"number":y=pc({t:"n",v:n[m]},e),k=uc({t:"n",v:n[m]},e);break;case"boolean":y=pc({t:"b",v:n[m]},e),k=uc({t:"b",v:n[m]},e);break;default:throw new Error("Unsupported value "+n[m])}h.push(y),d+=y.length,b.push(k),v+=k.length,++l}for(t[2][0].data=jt(l);m<t[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),_.setUint16(m*2,65535,!0);return t[6][0].data=Gr(h),t[3][0].data=Gr(b),l}function nF(t,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=fn(e["!ref"]);i.s.r=i.s.c=0;var r=!1;i.e.c>9&&(r=!0,i.e.c=9),i.e.r>49&&(r=!0,i.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(yt(i)));var a=Zo(e,{range:i,header:1}),s=["~Sh33tJ5~"];a.forEach(function(H){return H.forEach(function(U){typeof U=="string"&&s.push(U)})});var o={},l=[],c=et.read(n.numbers,{type:"base64"});c.FileIndex.map(function(H,U){return[H,c.FullPaths[U]]}).forEach(function(H){var U=H[0],pe=H[1];if(U.type==2&&U.name.match(/\.iwa/)){var Ae=U.content,Ce=Rn(Ae),Te=Ln(Ce);Te.forEach(function(xe){l.push(xe.id),o[xe.id]={deps:[],location:pe,type:ui(xe.messages[0].meta[1][0].data)}})}}),l.sort(function(H,U){return H-U});var d=l.filter(function(H){return H>1}).map(function(H){return[H,jt(H)]});c.FileIndex.map(function(H,U){return[H,c.FullPaths[U]]}).forEach(function(H){var U=H[0],pe=H[1];if(U.name.match(/\.iwa/)){var Ae=Ln(Rn(U.content));Ae.forEach(function(Ce){Ce.messages.forEach(function(Te){d.forEach(function(xe){Ce.messages.some(function(gt){return ui(gt.meta[1][0].data)!=11006&&W9(gt.data,xe[1])})&&o[xe[0]].deps.push(Ce.id)})})})}});function h(){for(var H=927262;H<2e6;++H)if(!o[H])return H;throw new Error("Too many messages")}for(var _=et.find(c,o[1].location),v=Ln(Rn(_.content)),b,m=0;m<v.length;++m){var y=v[m];y.id==1&&(b=y)}var k=Yi(Bt(b.messages[0].data)[1][0].data);for(_=et.find(c,o[k].location),v=Ln(Rn(_.content)),m=0;m<v.length;++m)y=v[m],y.id==k&&(b=y);for(k=Yi(Bt(b.messages[0].data)[2][0].data),_=et.find(c,o[k].location),v=Ln(Rn(_.content)),m=0;m<v.length;++m)y=v[m],y.id==k&&(b=y);for(k=Yi(Bt(b.messages[0].data)[2][0].data),_=et.find(c,o[k].location),v=Ln(Rn(_.content)),m=0;m<v.length;++m)y=v[m],y.id==k&&(b=y);var F=Bt(b.messages[0].data);{F[6][0].data=jt(i.e.r+1),F[7][0].data=jt(i.e.c+1);var T=Yi(F[46][0].data),W=et.find(c,o[T].location),X=Ln(Rn(W.content));{for(var z=0;z<X.length&&X[z].id!=T;++z);if(X[z].id!=T)throw"Bad ColumnRowUIDMapArchive";var M=Bt(X[z].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var K=0;K<=i.e.c;++K){var j=[];j[1]=j[2]=[{type:0,data:jt(K+420690)}],M[1].push({type:2,data:Ui(j)}),M[2].push({type:0,data:jt(K)}),M[3].push({type:0,data:jt(K)})}M[4]=[],M[5]=[],M[6]=[];for(var ne=0;ne<=i.e.r;++ne)j=[],j[1]=j[2]=[{type:0,data:jt(ne+726270)}],M[4].push({type:2,data:Ui(j)}),M[5].push({type:0,data:jt(ne)}),M[6].push({type:0,data:jt(ne)});X[z].messages[0].data=Ui(M)}W.content=Ya($a(X)),W.size=W.content.length,delete F[46];var oe=Bt(F[4][0].data);{oe[7][0].data=jt(i.e.r+1);var q=Bt(oe[1][0].data),Se=Yi(q[2][0].data);W=et.find(c,o[Se].location),X=Ln(Rn(W.content));{if(X[0].id!=Se)throw"Bad HeaderStorageBucket";var Ne=Bt(X[0].messages[0].data);for(ne=0;ne<a.length;++ne){var Ie=Bt(Ne[2][0].data);Ie[1][0].data=jt(ne),Ie[4][0].data=jt(a[ne].length),Ne[2][ne]={type:Ne[2][0].type,data:Ui(Ie)}}X[0].messages[0].data=Ui(Ne)}W.content=Ya($a(X)),W.size=W.content.length;var Ye=Yi(oe[2][0].data);W=et.find(c,o[Ye].location),X=Ln(Rn(W.content));{if(X[0].id!=Ye)throw"Bad HeaderStorageBucket";for(Ne=Bt(X[0].messages[0].data),K=0;K<=i.e.c;++K)Ie=Bt(Ne[2][0].data),Ie[1][0].data=jt(K),Ie[4][0].data=jt(i.e.r+1),Ne[2][K]={type:Ne[2][0].type,data:Ui(Ie)};X[0].messages[0].data=Ui(Ne)}W.content=Ya($a(X)),W.size=W.content.length;var ze=Yi(oe[4][0].data);(function(){for(var H=et.find(c,o[ze].location),U=Ln(Rn(H.content)),pe,Ae=0;Ae<U.length;++Ae){var Ce=U[Ae];Ce.id==ze&&(pe=Ce)}var Te=Bt(pe.messages[0].data);{Te[3]=[];var xe=[];s.forEach(function(zt,Dt){xe[1]=[{type:0,data:jt(Dt)}],xe[2]=[{type:0,data:jt(1)}],xe[3]=[{type:2,data:z9(zt)}],Te[3].push({type:2,data:Ui(xe)})})}pe.messages[0].data=Ui(Te);var gt=$a(U),P=Ya(gt);H.content=P,H.size=H.content.length})();var Et=Bt(oe[3][0].data);{var Pe=Et[1][0];delete Et[2];var Ke=Bt(Pe.data);{var me=Yi(Ke[2][0].data);(function(){for(var H=et.find(c,o[me].location),U=Ln(Rn(H.content)),pe,Ae=0;Ae<U.length;++Ae){var Ce=U[Ae];Ce.id==me&&(pe=Ce)}var Te=Bt(pe.messages[0].data);{delete Te[6],delete Et[7];var xe=new Uint8Array(Te[5][0].data);Te[5]=[];for(var gt=0,P=0;P<=i.e.r;++P){var zt=Bt(xe);gt+=iF(zt,a[P],s),zt[1][0].data=jt(P),Te[5].push({data:Ui(zt),type:2})}Te[1]=[{type:0,data:jt(i.e.c+1)}],Te[2]=[{type:0,data:jt(i.e.r+1)}],Te[3]=[{type:0,data:jt(gt)}],Te[4]=[{type:0,data:jt(i.e.r+1)}]}pe.messages[0].data=Ui(Te);var Dt=$a(U),Wt=Ya(Dt);H.content=Wt,H.size=H.content.length})()}Pe.data=Ui(Ke)}oe[3][0].data=Ui(Et)}F[4][0].data=Ui(oe)}b.messages[0].data=Ui(F);var B=$a(v),te=Ya(B);return _.content=te,_.size=_.content.length,c}function If(t){return function(e){for(var i=0;i!=t.length;++i){var r=t[i];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function u0(t){If([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function f0(t){If([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function rF(t){return Ct.WS.indexOf(t)>-1?"sheet":Ct.CS&&t==Ct.CS?"chart":Ct.DS&&t==Ct.DS?"dialog":Ct.MS&&t==Ct.MS?"macro":t&&t.length?t:"sheet"}function aF(t,n){if(!t)return 0;try{t=n.map(function(i){return i.id||(i.id=i.strRelID),[i.name,t["!id"][i.id].Target,rF(t["!id"][i.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function sF(t,n,e,i,r,a,s,o,l,c,d,h){try{a[i]=Ms(yn(t,e,!0),n);var _=Ii(t,n),v;switch(o){case"sheet":v=E7(_,n,r,l,a[i],c,d,h);break;case"chart":if(v=F7(_,n,r,l,a[i],c,d,h),!v||!v["!drawel"])break;var b=ks(v["!drawel"].Target,n),m=zs(b),y=mE(yn(t,b,!0),Ms(yn(t,m,!0),b)),k=ks(y,b),F=zs(k);v=i7(yn(t,k,!0),k,l,Ms(yn(t,F,!0),k),c,v);break;case"macro":v=D7(_,n,r,l,a[i],c,d,h);break;case"dialog":v=M7(_,n,r,l,a[i],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}s[i]=v;var T=[];a&&a[i]&&hi(a[i]).forEach(function(W){var X="";if(a[i][W].Type==Ct.CMNT){X=ks(a[i][W].Target,n);var z=R7(Ii(t,X,!0),X,l);if(!z||!z.length)return;pp(v,z,!1)}a[i][W].Type==Ct.TCMNT&&(X=ks(a[i][W].Target,n),T=T.concat(gE(Ii(t,X,!0),l)))}),T&&T.length&&pp(v,T,!0,l.people||[])}catch(W){if(l.WTF)throw W}}function On(t){return t.charAt(0)=="/"?t.slice(1):t}function oF(t,n){if(os(),n=n||{},u0(n),Vn(t,"META-INF/manifest.xml")||Vn(t,"objectdata.xml"))return wp(t,n);if(Vn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fc<"u"){if(t.FileIndex)return fc(t);var e=et.utils.cfb_new();return Od(t).forEach(function(Ne){wt(e,Ne,jp(t,Ne))}),fc(e)}throw new Error("Unsupported NUMBERS file")}if(!Vn(t,"[Content_Types].xml"))throw Vn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=Od(t),r=p4(yn(t,"[Content_Types].xml")),a=!1,s,o;if(r.workbooks.length===0&&(o="xl/workbook.xml",Ii(t,o,!0)&&r.workbooks.push(o)),r.workbooks.length===0){if(o="xl/workbook.bin",!Ii(t,o,!0))throw new Error("Could not find workbook");r.workbooks.push(o),a=!0}r.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!n.bookSheets&&!n.bookProps){if(Os=[],r.sst)try{Os=L7(Ii(t,On(r.sst)),r.sst,n)}catch(Ne){if(n.WTF)throw Ne}n.cellStyles&&r.themes.length&&(l=A7(yn(t,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],n)),r.style&&(c=O7(Ii(t,On(r.style)),r.style,l,n))}r.links.map(function(Ne){try{var Ie=Ms(yn(t,zs(On(Ne))),Ne);return P7(Ii(t,On(Ne)),Ie,Ne,n)}catch{}});var d=k7(Ii(t,On(r.workbooks[0])),r.workbooks[0],n),h={},_="";r.coreprops.length&&(_=Ii(t,On(r.coreprops[0]),!0),_&&(h=fu(_)),r.extprops.length!==0&&(_=Ii(t,On(r.extprops[0]),!0),_&&x4(_,h,n)));var v={};(!n.bookSheets||n.bookProps)&&r.custprops.length!==0&&(_=yn(t,On(r.custprops[0]),!0),_&&(v=b4(_,n)));var b={};if((n.bookSheets||n.bookProps)&&(d.Sheets?s=d.Sheets.map(function(Ie){return Ie.name}):h.Worksheets&&h.SheetNames.length>0&&(s=h.SheetNames),n.bookProps&&(b.Props=h,b.Custprops=v),n.bookSheets&&typeof s<"u"&&(b.SheetNames=s),n.bookSheets?b.SheetNames:n.bookProps))return b;s={};var m={};n.bookDeps&&r.calcchain&&(m=V7(Ii(t,On(r.calcchain)),r.calcchain,n));var y=0,k={},F,T;{var W=d.Sheets;h.Worksheets=W.length,h.SheetNames=[];for(var X=0;X!=W.length;++X)h.SheetNames[X]=W[X].name}var z=a?"bin":"xml",M=r.workbooks[0].lastIndexOf("/"),K=(r.workbooks[0].slice(0,M+1)+"_rels/"+r.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");Vn(t,K)||(K="xl/_rels/workbook."+z+".rels");var j=Ms(yn(t,K,!0),K.replace(/_rels.*/,"s5s"));(r.metadata||[]).length>=1&&(n.xlmeta=B7(Ii(t,On(r.metadata[0])),r.metadata[0],n)),(r.people||[]).length>=1&&(n.people=vE(Ii(t,On(r.people[0])),n)),j&&(j=aF(j,d.Sheets));var ne=Ii(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var oe="sheet";if(j&&j[y]?(F="xl/"+j[y][1].replace(/[\/]?xl\//,""),Vn(t,F)||(F=j[y][1]),Vn(t,F)||(F=K.replace(/_rels\/.*$/,"")+j[y][1]),oe=j[y][2]):(F="xl/worksheets/sheet"+(y+1-ne)+"."+z,F=F.replace(/sheet0\./,"sheet.")),T=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(y!=n.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var q=!1,Se=0;Se!=n.sheets.length;++Se)typeof n.sheets[Se]=="number"&&n.sheets[Se]==y&&(q=1),typeof n.sheets[Se]=="string"&&n.sheets[Se].toLowerCase()==h.SheetNames[y].toLowerCase()&&(q=1);if(!q)continue e}}sF(t,F,T,h.SheetNames[y],y,k,s,oe,n,d,l,c)}return b={Directory:r,Workbook:d,Props:h,Custprops:v,Deps:m,Sheets:s,SheetNames:h.SheetNames,Strings:Os,Styles:c,Themes:l,SSF:ti(lt)},n&&n.bookFiles&&(t.files?(b.keys=i,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(Ne,Ie){Ne=Ne.replace(/^Root Entry[\/]/,""),b.keys.push(Ne),b.files[Ne]=t.FileIndex[Ie]}))),n&&n.bookVBA&&(r.vba.length>0?b.vbaraw=Ii(t,On(r.vba[0]),!0):r.defaults&&r.defaults.bin===kE&&(b.vbaraw=Ii(t,"xl/vbaProject.bin",!0))),b}function lF(t,n){var e=n||{},i="Workbook",r=et.find(t,i);try{if(i="/!DataSpaces/Version",r=et.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(BI(r.content),i="/!DataSpaces/DataSpaceMap",r=et.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var a=UI(r.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",r=et.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var s=HI(r.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",r=et.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);WI(r.content)}catch{}if(i="/EncryptionInfo",r=et.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=jI(r.content);if(i="/EncryptedPackage",r=et.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],r.content,e.password||"",e);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],r.content,e.password||"",e);throw new Error("File is password-protected")}function cF(t,n){return n.bookType=="ods"?Sf(t,n):n.bookType=="numbers"?nF(t,n):n.bookType=="xlsb"?dF(t,n):pF(t,n)}function dF(t,n){Za=1024,t&&!t.SSF&&(t.SSF=ti(lt)),t&&t.SSF&&(os(),Jo(t.SSF),n.revssf=tl(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,As?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var e=n.bookType=="xlsb"?"bin":"xml",i=Qu.indexOf(n.bookType)>-1,r=Qc();f0(n=n||{});var a=Lc(),s="",o=0;if(n.cellXfs=[],Xr(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",wt(a,s,hu(t.Props,n)),r.coreprops.push(s),Kt(n.rels,2,s,Ct.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,wt(a,s,gu(t.Props,n)),r.extprops.push(s),Kt(n.rels,3,s,Ct.EXT_PROPS),t.Custprops!==t.Props&&hi(t.Custprops||{}).length>0&&(s="docProps/custom.xml",wt(a,s,xu(t.Custprops,n)),r.custprops.push(s),Kt(n.rels,4,s,Ct.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],_=(h||{})["!type"]||"sheet";switch(_){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,wt(a,s,U7(o-1,s,n,t,d)),r.sheets.push(s),Kt(n.wbrels,-1,"worksheets/sheet"+o+"."+e,Ct.WS[0])}if(h){var v=h["!comments"],b=!1,m="";v&&v.length>0&&(m="xl/comments"+o+"."+e,wt(a,m,W7(v,m,n)),r.comments.push(m),Kt(d,-1,"../comments"+o+"."+e,Ct.CMNT),b=!0),h["!legacy"]&&b&&wt(a,"xl/drawings/vmlDrawing"+o+".vml",qu(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&wt(a,zs(s),Ja(d))}return n.Strings!=null&&n.Strings.length>0&&(s="xl/sharedStrings."+e,wt(a,s,z7(n.Strings,s,n)),r.strs.push(s),Kt(n.wbrels,-1,"sharedStrings."+e,Ct.SST)),s="xl/workbook."+e,wt(a,s,N7(t,s,n)),r.workbooks.push(s),Kt(n.rels,1,s,Ct.WB),s="xl/theme/theme1.xml",wt(a,s,r0(t.Themes,n)),r.themes.push(s),Kt(n.wbrels,-1,"theme/theme1.xml",Ct.THEME),s="xl/styles."+e,wt(a,s,H7(t,s,n)),r.styles.push(s),Kt(n.wbrels,-1,"styles."+e,Ct.STY),t.vbaraw&&i&&(s="xl/vbaProject.bin",wt(a,s,t.vbaraw),r.vba.push(s),Kt(n.wbrels,-1,"vbaProject.bin",Ct.VBA)),s="xl/metadata."+e,wt(a,s,j7(s)),r.metadata.push(s),Kt(n.wbrels,-1,"metadata."+e,Ct.XLMETA),wt(a,"[Content_Types].xml",pu(r,n)),wt(a,"_rels/.rels",Ja(n.rels)),wt(a,"xl/_rels/workbook."+e+".rels",Ja(n.wbrels)),delete n.revssf,delete n.ssf,a}function pF(t,n){Za=1024,t&&!t.SSF&&(t.SSF=ti(lt)),t&&t.SSF&&(os(),Jo(t.SSF),n.revssf=tl(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,As?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var e="xml",i=Qu.indexOf(n.bookType)>-1,r=Qc();f0(n=n||{});var a=Lc(),s="",o=0;if(n.cellXfs=[],Xr(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",wt(a,s,hu(t.Props,n)),r.coreprops.push(s),Kt(n.rels,2,s,Ct.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,wt(a,s,gu(t.Props,n)),r.extprops.push(s),Kt(n.rels,3,s,Ct.EXT_PROPS),t.Custprops!==t.Props&&hi(t.Custprops||{}).length>0&&(s="docProps/custom.xml",wt(a,s,xu(t.Custprops,n)),r.custprops.push(s),Kt(n.rels,4,s,Ct.CUST_PROPS));var d=["SheetJ5"];for(n.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},_=t.Sheets[t.SheetNames[o-1]],v=(_||{})["!type"]||"sheet";switch(v){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,wt(a,s,df(o-1,n,t,h)),r.sheets.push(s),Kt(n.wbrels,-1,"worksheets/sheet"+o+"."+e,Ct.WS[0])}if(_){var b=_["!comments"],m=!1,y="";if(b&&b.length>0){var k=!1;b.forEach(function(F){F[1].forEach(function(T){T.T==!0&&(k=!0)})}),k&&(y="xl/threadedComments/threadedComment"+o+"."+e,wt(a,y,xE(b,d,n)),r.threadedcomments.push(y),Kt(h,-1,"../threadedComments/threadedComment"+o+"."+e,Ct.TCMNT)),y="xl/comments"+o+"."+e,wt(a,y,Zu(b,n)),r.comments.push(y),Kt(h,-1,"../comments"+o+"."+e,Ct.CMNT),m=!0}_["!legacy"]&&m&&wt(a,"xl/drawings/vmlDrawing"+o+".vml",qu(o,_["!comments"])),delete _["!comments"],delete _["!legacy"]}h["!id"].rId1&&wt(a,zs(s),Ja(h))}return n.Strings!=null&&n.Strings.length>0&&(s="xl/sharedStrings."+e,wt(a,s,Bu(n.Strings,n)),r.strs.push(s),Kt(n.wbrels,-1,"sharedStrings."+e,Ct.SST)),s="xl/workbook."+e,wt(a,s,mf(t,n)),r.workbooks.push(s),Kt(n.rels,1,s,Ct.WB),s="xl/theme/theme1.xml",wt(a,s,r0(t.Themes,n)),r.themes.push(s),Kt(n.wbrels,-1,"theme/theme1.xml",Ct.THEME),s="xl/styles."+e,wt(a,s,Gu(t,n)),r.styles.push(s),Kt(n.wbrels,-1,"styles."+e,Ct.STY),t.vbaraw&&i&&(s="xl/vbaProject.bin",wt(a,s,t.vbaraw),r.vba.push(s),Kt(n.wbrels,-1,"vbaProject.bin",Ct.VBA)),s="xl/metadata."+e,wt(a,s,Xu()),r.metadata.push(s),Kt(n.wbrels,-1,"metadata."+e,Ct.XLMETA),d.length>1&&(s="xl/persons/person.xml",wt(a,s,bE(d,n)),r.people.push(s),Kt(n.wbrels,-1,"persons/person.xml",Ct.PEOPLE)),wt(a,"[Content_Types].xml",pu(r,n)),wt(a,"_rels/.rels",Ja(n.rels)),wt(a,"xl/_rels/workbook."+e+".rels",Ja(n.wbrels)),delete n.revssf,delete n.ssf,a}function h0(t,n){var e="";switch((n||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=wn(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function uF(t,n){return et.find(t,"EncryptedPackage")?lF(t,n):vf(t,n)}function fF(t,n){var e,i=t,r=n||{};return r.type||(r.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),e=Kp(i,r),oF(e,r)}function kf(t,n){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return Tc(t.slice(e),n);default:break e}return rs.to_workbook(t,n)}function hF(t,n){var e="",i=h0(t,n);switch(n.type){case"base64":e=wn(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=la(t);break;default:throw new Error("Unrecognized type "+n.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(e=Xt(e)),n.type="binary",kf(e,n)}function mF(t,n){var e=t;return n.type=="base64"&&(e=wn(e)),e=Ht.utils.decode(1200,e.slice(2),"str"),n.type="binary",kf(e,n)}function _F(t){return t.match(/[^\x00-\x7F]/)?nr(t):t}function hc(t,n,e,i){return i?(e.type="string",rs.to_workbook(t,e)):rs.to_workbook(n,e)}function qo(t,n){Fc();var e=n||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return qo(new Uint8Array(t),(e=ti(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var i=t,r=[0,0,0,0],a=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),ts={},e.dateNF&&(ts.dateNF=e.dateNF),e.type||(e.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=kt?"buffer":"binary",i=dT(t),typeof Uint8Array<"u"&&!kt&&(e.type="array")),e.type=="string"&&(a=!0,e.type="binary",e.codepage=65001,i=_F(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return e=ti(e),e.type="array",qo(Dc(i),e)}switch((r=h0(i,e))[0]){case 208:if(r[1]===207&&r[2]===17&&r[3]===224&&r[4]===161&&r[5]===177&&r[6]===26&&r[7]===225)return uF(et.read(i,e),e);break;case 9:if(r[1]<=8)return vf(i,e);break;case 60:return Tc(i,e);case 73:if(r[1]===73&&r[2]===42&&r[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(r[1]===68)return yI(i,e);break;case 84:if(r[1]===65&&r[2]===66&&r[3]===76)return Vu.to_workbook(i,e);break;case 80:return r[1]===75&&r[2]<9&&r[3]<9?fF(i,e):hc(t,i,e,a);case 239:return r[3]===60?Tc(i,e):hc(t,i,e,a);case 255:if(r[1]===254)return mF(i,e);if(r[1]===0&&r[2]===2&&r[3]===0)return aa.to_workbook(i,e);break;case 0:if(r[1]===0&&(r[2]>=2&&r[3]===0||r[2]===0&&(r[3]===8||r[3]===9)))return aa.to_workbook(i,e);break;case 3:case 131:case 139:case 140:return Cc.to_workbook(i,e);case 123:if(r[1]===92&&r[2]===114&&r[3]===116)return Wu.to_workbook(i,e);break;case 10:case 13:case 32:return hF(i,e);case 137:if(r[1]===80&&r[2]===78&&r[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bI.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?Cc.to_workbook(i,e):hc(t,i,e,a)}function Ef(t,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return qs(n.file,et.write(t,{type:kt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return et.write(t,n)}function gF(t,n){var e=ti(n||{}),i=cF(t,e);return xF(i,e)}function xF(t,n){var e={},i=kt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(e.compression="DEFLATE"),n.password)e.type=i;else switch(n.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+n.type)}var r=t.FullPaths?et.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!n.compression}):t.generate(e);if(typeof Deno<"u"&&typeof r=="string"){if(n.type=="binary"||n.type=="base64")return r;r=new Uint8Array(Qo(r))}return n.password&&typeof encrypt_agile<"u"?Ef(encrypt_agile(r,n.password),n):n.type==="file"?qs(n.file,r):n.type=="string"?Xt(r):r}function vF(t,n){var e=n||{},i=_9(t,e);return Ef(i,e)}function ir(t,n,e){e||(e="");var i=e+t;switch(n.type){case"base64":return Ps(nr(i));case"binary":return nr(i);case"string":return t;case"file":return qs(n.file,i,"utf8");case"buffer":return kt?vr(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):ir(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function bF(t,n){switch(n.type){case"base64":return Ps(t);case"binary":return t;case"string":return t;case"file":return qs(n.file,t,"binary");case"buffer":return kt?vr(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function Bo(t,n){switch(n.type){case"string":case"base64":case"binary":for(var e="",i=0;i<t.length;++i)e+=String.fromCharCode(t[i]);return n.type=="base64"?Ps(e):n.type=="string"?Xt(e):e;case"file":return qs(n.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+n.type)}}function Ff(t,n){Fc(),u7(t);var e=ti(n||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=Ff(t,e);return e.type="array",Qo(i)}var r=0;if(e.sheet&&(typeof e.sheet=="number"?r=e.sheet:r=t.SheetNames.indexOf(e.sheet),!t.SheetNames[r]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return ir(c9(t,e),e);case"slk":case"sylk":return ir(Ru.from_sheet(t.Sheets[t.SheetNames[r]],e),e);case"htm":case"html":return ir(yf(t.Sheets[t.SheetNames[r]],e),e);case"txt":return bF(Mf(t.Sheets[t.SheetNames[r]],e),e);case"csv":return ir(m0(t.Sheets[t.SheetNames[r]],e),e,"\uFEFF");case"dif":return ir(Vu.from_sheet(t.Sheets[t.SheetNames[r]],e),e);case"dbf":return Bo(Cc.from_sheet(t.Sheets[t.SheetNames[r]],e),e);case"prn":return ir(rs.from_sheet(t.Sheets[t.SheetNames[r]],e),e);case"rtf":return ir(Wu.from_sheet(t.Sheets[t.SheetNames[r]],e),e);case"eth":return ir(Pu.from_sheet(t.Sheets[t.SheetNames[r]],e),e);case"fods":return ir(Sf(t,e),e);case"wk1":return Bo(aa.sheet_to_wk1(t.Sheets[t.SheetNames[r]],e),e);case"wk3":return Bo(aa.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Bo(bf(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),vF(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return gF(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function yF(t){if(!t.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType=n[t.bookType]||t.bookType}}function Df(t,n,e){var i=e||{};return i.type="file",i.file=n,yF(i),Ff(t,i)}function wF(t,n,e,i,r,a,s,o){var l=xi(e),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,_=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:e,enumerable:!1})}catch{_.__rowNum__=e}else _.__rowNum__=e;if(!s||t[e])for(var v=n.s.c;v<=n.e.c;++v){var b=s?t[e][v]:t[i[v]+l];if(b===void 0||b.t===void 0){if(c===void 0)continue;a[v]!=null&&(_[a[v]]=c);continue}var m=b.v;switch(b.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(a[v]!=null){if(m==null)if(b.t=="e"&&m===null)_[a[v]]=null;else if(c!==void 0)_[a[v]]=c;else if(d&&m===null)_[a[v]]=null;else continue;else _[a[v]]=d&&(b.t!=="n"||b.t==="n"&&o.rawNumbers!==!1)?m:xr(b,m,o);m!=null&&(h=!1)}}return{row:_,isempty:h}}function Zo(t,n){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},i=0,r=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=n||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)?i=3:c.header==null&&(i=0),typeof d){case"string":l=Pt(d);break;case"number":l=Pt(t["!ref"]),l.s.r=d;break;default:l=d}i>0&&(r=0);var h=xi(l.s.r),_=[],v=[],b=0,m=0,y=Array.isArray(t),k=l.s.r,F=0,T={};y&&!t[k]&&(t[k]=[]);var W=c.skipHidden&&t["!cols"]||[],X=c.skipHidden&&t["!rows"]||[];for(F=l.s.c;F<=l.e.c;++F)if(!(W[F]||{}).hidden)switch(_[F]=ci(F),e=y?t[k][F]:t[_[F]+h],i){case 1:a[F]=F-l.s.c;break;case 2:a[F]=_[F];break;case 3:a[F]=c.header[F-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=s=xr(e,null,c),m=T[s]||0,!m)T[s]=1;else{do o=s+"_"+m++;while(T[o]);T[s]=m,T[o]=1}a[F]=o}for(k=l.s.r+r;k<=l.e.r;++k)if(!(X[k]||{}).hidden){var z=wF(t,l,k,_,i,a,y,c);(z.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows))&&(v[b++]=z.row)}return v.length=b,v}var kp=/"/g;function CF(t,n,e,i,r,a,s,o){for(var l=!0,c=[],d="",h=xi(e),_=n.s.c;_<=n.e.c;++_)if(i[_]){var v=o.dense?(t[e]||[])[_]:t[i[_]+h];if(v==null)d="";else if(v.v!=null){l=!1,d=""+(o.rawNumbers&&v.t=="n"?v.v:xr(v,null,o));for(var b=0,m=0;b!==d.length;++b)if((m=d.charCodeAt(b))===r||m===a||m===34||o.forceQuotes){d='"'+d.replace(kp,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(l=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(kp,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(s)}function m0(t,n){var e=[],i=n??{};if(t==null||t["!ref"]==null)return"";var r=Pt(t["!ref"]),a=i.FS!==void 0?i.FS:",",s=a.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),d="",h=[];i.dense=Array.isArray(t);for(var _=i.skipHidden&&t["!cols"]||[],v=i.skipHidden&&t["!rows"]||[],b=r.s.c;b<=r.e.c;++b)(_[b]||{}).hidden||(h[b]=ci(b));for(var m=0,y=r.s.r;y<=r.e.r;++y)(v[y]||{}).hidden||(d=CF(t,r,y,h,s,l,a,i),d!=null&&(i.strip&&(d=d.replace(c,"")),(d||i.blankrows!==!1)&&e.push((m++?o:"")+d)));return delete i.dense,e.join("")}function Mf(t,n){n||(n={}),n.FS="	",n.RS=`
`;var e=m0(t,n);if(typeof Ht>"u"||n.type=="string")return e;var i=Ht.utils.encode(1200,e,"str");return"\xFF\xFE"+i}function TF(t){var n="",e,i="";if(t==null||t["!ref"]==null)return[];var r=Pt(t["!ref"]),a="",s=[],o,l=[],c=Array.isArray(t);for(o=r.s.c;o<=r.e.c;++o)s[o]=ci(o);for(var d=r.s.r;d<=r.e.r;++d)for(a=xi(d),o=r.s.c;o<=r.e.c;++o)if(n=s[o]+a,e=c?(t[d]||[])[o]:t[n],i="",e!==void 0){if(e.F!=null){if(n=e.F,!e.f)continue;i=e.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}l[l.length]=n+"="+i}return l}function Of(t,n,e){var i=e||{},r=+!i.skipHeader,a=t||{},s=0,o=0;if(a&&i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var l=typeof i.origin=="string"?di(i.origin):i.origin;s=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:s+n.length-1+r}};if(a["!ref"]){var h=Pt(a["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),s==-1&&(s=h.e.r+1,d.e.r=s+n.length-1+r)}else s==-1&&(s=0,d.e.r=n.length-1+r);var _=i.header||[],v=0;n.forEach(function(m,y){hi(m).forEach(function(k){(v=_.indexOf(k))==-1&&(_[v=_.length]=k);var F=m[k],T="z",W="",X=dt({c:o+v,r:s+y+r});c=Xs(a,X),F&&typeof F=="object"&&!(F instanceof Date)?a[X]=F:(typeof F=="number"?T="n":typeof F=="boolean"?T="b":typeof F=="string"?T="s":F instanceof Date?(T="d",i.cellDates||(T="n",F=Oi(F)),W=i.dateNF||lt[14]):F===null&&i.nullError&&(T="e",F=0),c?(c.t=T,c.v=F,delete c.w,delete c.R,W&&(c.z=W)):a[X]=c={t:T,v:F},W&&(c.z=W))})}),d.e.c=Math.max(d.e.c,o+_.length-1);var b=xi(s);if(r)for(v=0;v<_.length;++v)a[ci(v+o)+b]={t:"s",v:_[v]};return a["!ref"]=yt(d),a}function SF(t,n){return Of(null,t,n)}function Xs(t,n,e){if(typeof n=="string"){if(Array.isArray(t)){var i=di(n);return t[i.r]||(t[i.r]=[]),t[i.r][i.c]||(t[i.r][i.c]={t:"z"})}return t[n]||(t[n]={t:"z"})}return typeof n!="number"?Xs(t,dt(n)):Xs(t,dt({r:n,c:e||0}))}function IF(t,n){if(typeof n=="number"){if(n>=0&&t.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var e=t.SheetNames.indexOf(n);if(e>-1)return e;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function _0(){return{SheetNames:[],Sheets:{}}}function g0(t,n,e,i){var r=1;if(!e)for(;r<=65535&&t.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&t.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var s=a&&a[1]||e;for(++r;r<=65535&&t.SheetNames.indexOf(e=s+r)!=-1;++r);}if(hf(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=n,e}function kF(t,n,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var i=IF(t,n);switch(t.Workbook.Sheets[i]||(t.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[i].Hidden=e}function EF(t,n){return t.z=n,t}function Af(t,n,e){return n?(t.l={Target:n},e&&(t.l.Tooltip=e)):delete t.l,t}function FF(t,n,e){return Af(t,"#"+n,e)}function DF(t,n,e){t.c||(t.c=[]),t.c.push({t:n,a:e||"SheetJS"})}function MF(t,n,e,i){for(var r=typeof n!="string"?n:Pt(n),a=typeof n=="string"?n:yt(n),s=r.s.r;s<=r.e.r;++s)for(var o=r.s.c;o<=r.e.c;++o){var l=Xs(t,s,o);l.t="n",l.F=a,delete l.v,s==r.s.r&&o==r.s.c&&(l.f=e,i&&(l.D=!0))}return t}var ll={encode_col:ci,encode_row:xi,encode_cell:dt,encode_range:yt,decode_col:Gc,decode_row:Kc,split_cell:zT,decode_cell:di,decode_range:fn,format_cell:xr,sheet_add_aoa:ru,sheet_add_json:Of,sheet_add_dom:wf,aoa_to_sheet:cs,json_to_sheet:SF,table_to_sheet:Cf,table_to_book:B9,sheet_to_csv:m0,sheet_to_txt:Mf,sheet_to_json:Zo,sheet_to_html:yf,sheet_to_formulae:TF,sheet_to_row_object_array:Zo,sheet_get_cell:Xs,book_new:_0,book_append_sheet:g0,book_set_sheet_visibility:kF,cell_set_number_format:EF,cell_set_hyperlink:Af,cell_set_internal_link:FF,cell_add_comment:DF,sheet_set_array_formula:MF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var KN=Vs.version;var Hn=class t{localStorageKey="auditTrail";auditRecordsSubject=new C0([]);auditRecords$=this.auditRecordsSubject.asObservable();constructor(){this.loadAuditTrailFromLocalStorage()}loadAuditTrailFromLocalStorage(){let n=localStorage.getItem(this.localStorageKey),e=n?JSON.parse(n):[];this.auditRecordsSubject.next(e)}saveAuditTrailToLocalStorage(){let n=this.auditRecordsSubject.getValue();localStorage.setItem(this.localStorageKey,JSON.stringify(n))}addAuditRecord(n){let i=[...this.auditRecordsSubject.getValue(),n];return this.auditRecordsSubject.next(i),this.saveAuditTrailToLocalStorage(),_l(n)}getAuditRecords(){return this.auditRecords$}clearAuditTrail(){return this.auditRecordsSubject.next([]),localStorage.removeItem(this.localStorageKey),_l(!0)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=so({token:t,factory:t.\u0275fac,providedIn:"root"})};var OF=()=>({width:"450px"}),Rf=()=>({width:"400px"});function AF(t,n){if(t&1){let e=le();g(0,"button",19),ae(1,"translate"),G("click",function(){S(e);let r=f(2);return I(r.openNew())}),x()}t&2&&u("label",se(1,1,"create"))}function LF(t,n){if(t&1){let e=le();g(0,"button",20),ae(1,"translate"),G("click",function(){S(e);let r=f(2);return I(r.deleteSelectedUsers())}),x()}if(t&2){let e=f(2);u("label",se(1,2,"delete"))("disabled",!e.selectedUsers||!e.selectedUsers.length)}}function RF(t,n){if(t&1){let e=le();g(0,"div",15)(1,"p-fileUpload",16,0),ae(3,"translate"),G("onSelect",function(r){S(e);let a=vt(2),s=f();return I(s.importUsers(r,a))}),x(),w(4,AF,2,3,"button",17)(5,LF,2,4,"button",18),x()}if(t&2){let e=f();p(),u("chooseLabel",se(3,3,"importExcel")),p(3),u("ngIf",e.isAdmin),p(),u("ngIf",e.isAdmin)}}function VF(t,n){t&1&&(g(0,"h2"),Y(1),ae(2,"translate"),x()),t&2&&(p(),be(se(2,1,"userList")))}function PF(t,n){t&1&&(g(0,"small",44),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"invalidPhoneNumberMsg")," "))}function BF(t,n){t&1&&(g(0,"small",44),Y(1),ae(2,"translate"),x()),t&2&&(p(),be(se(2,1,"roleRequiredMsg")))}function NF(t,n){if(t&1&&(g(0,"div",45),N(1,"img",46),x()),t&2){let e=f(2);p(),u("src",e.user.profilePicture,ya)}}function UF(t,n){if(t&1){let e=le();g(0,"div",21)(1,"label",22),Y(2),ae(3,"translate"),x(),g(4,"input",23),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.firstName,r)||(a.user.firstName=r),I(r)}),x()(),g(5,"div",21)(6,"label",24),Y(7),ae(8,"translate"),x(),g(9,"input",25),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.lastName,r)||(a.user.lastName=r),I(r)}),x()(),g(10,"div",21)(11,"label",26),Y(12),ae(13,"translate"),x(),g(14,"textarea",27),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.email,r)||(a.user.email=r),I(r)}),x()(),g(15,"div",21)(16,"label",28),Y(17),ae(18,"translate"),x(),g(19,"div",29)(20,"span"),Y(21,"+996"),x(),g(22,"input",30),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.phoneNumber,r)||(a.user.phoneNumber=r),I(r)}),G("ngModelChange",function(r){S(e);let a=f();return I(a.formatPhoneNumber(r))}),x()(),w(23,PF,3,3,"small",31),x(),g(24,"div",21)(25,"label",32),Y(26),ae(27,"translate"),x(),g(28,"input",33),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.age,r)||(a.user.age=r),I(r)}),x()(),g(29,"div",21)(30,"label",34),Y(31),ae(32,"translate"),x(),g(33,"p-dropdown",35),ae(34,"translate"),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.gender,r)||(a.user.gender=r),I(r)}),x()(),g(35,"div",21)(36,"label",36),Y(37),ae(38,"translate"),x(),g(39,"textarea",37),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.address,r)||(a.user.address=r),I(r)}),x()(),g(40,"div",21)(41,"label",38),Y(42),ae(43,"translate"),x(),g(44,"p-calendar",39),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.dateOfBirth,r)||(a.user.dateOfBirth=r),I(r)}),x()(),g(45,"div",21)(46,"label",40),Y(47),ae(48,"translate"),x(),g(49,"p-dropdown",35),ae(50,"translate"),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.role,r)||(a.user.role=r),I(r)}),x()(),w(51,BF,3,3,"small",31),g(52,"div",21)(53,"label",41),Y(54),ae(55,"translate"),x(),g(56,"input",42),ae(57,"translate"),nt("ngModelChange",function(r){S(e);let a=f();return it(a.user.profilePicture,r)||(a.user.profilePicture=r),I(r)}),x()(),w(58,NF,2,1,"div",43)}if(t&2){let e=f();p(2),be(se(3,28,"userFirstName")),p(2),tt("ngModel",e.user.firstName),p(3),be(se(8,30,"userLastName")),p(2),tt("ngModel",e.user.lastName),p(3),be(se(13,32,"email")),p(2),tt("ngModel",e.user.email),p(3),be(se(18,34,"phoneNumber")),p(5),tt("ngModel",e.user.phoneNumber),p(),u("ngIf",!e.isValidPhoneNumber(e.user.phoneNumber||"")),p(3),be(se(27,36,"age")),p(2),tt("ngModel",e.user.age),p(3),be(se(32,38,"gender")),p(2),tt("ngModel",e.user.gender),u("options",e.genderOptions)("placeholder",se(34,40,"selectGender")),p(4),be(se(38,42,"address")),p(2),tt("ngModel",e.user.address),p(3),be(se(43,44,"birthDate")),p(2),tt("ngModel",e.user.dateOfBirth),p(3),be(se(48,46,"role")),p(2),tt("ngModel",e.user.role),u("options",e.roleOptions)("placeholder",se(50,48,"selectRole")),p(2),u("ngIf",e.submitted&&!e.user.role),p(3),be(se(55,50,"profilePicture")),p(2),tt("ngModel",e.user.profilePicture),u("placeholder",se(57,52,"imageUrl")),p(2),u("ngIf",e.user.profilePicture)}}function HF(t,n){if(t&1){let e=le();g(0,"button",47),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.hideDialog())}),x(),g(2,"button",48),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.saveUser())}),x()}t&2&&(u("label",se(1,2,"cancel")),p(2),u("label",se(3,4,"save")))}function zF(t,n){if(t&1&&(g(0,"span"),Y(1),ae(2,"translate"),g(3,"b"),Y(4),x(),Y(5,"? "),x()),t&2){let e=f();p(),He(" ",se(2,2,"confirmDelete")," "),p(3),be(e.selectedUsers[0]==null?null:e.selectedUsers[0].firstName)}}function WF(t,n){t&1&&(g(0,"span"),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"confirmDeleteSelectedUsers")," "))}function jF(t,n){if(t&1){let e=le();g(0,"button",47),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.deleteUsersDialog=!1)}),x(),g(2,"button",48),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.confirmDeleteSelected())}),x()}t&2&&(u("label",se(1,2,"cancel")),p(2),u("label",se(3,4,"yes")))}function KF(t,n){if(t&1&&(g(0,"span"),Y(1),ae(2,"translate"),g(3,"b"),Y(4),x(),Y(5,"?"),x()),t&2){let e=f();p(),He("",se(2,2,"confirmDeleteUser")," "),p(3),be(e.user.firstName)}}function GF(t,n){if(t&1){let e=le();g(0,"button",47),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.deleteUserDialog=!1)}),x(),g(2,"button",48),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.confirmDelete(r.user))}),x()}t&2&&(u("label",se(1,2,"no")),p(2),u("label",se(3,4,"yes")))}function $F(t,n){if(t&1&&(g(0,"p")(1,"strong"),Y(2),ae(3,"translate"),x(),Y(4),ae(5,"date"),x()),t&2){let e=f(2);p(2),He("",se(3,2,"birthDateShort"),":"),p(2),He(" ",wa(5,4,e.selectedUser.dateOfBirth,"yyyy-MM-dd"),"")}}function YF(t,n){t&1&&(g(0,"p")(1,"strong"),Y(2),ae(3,"translate"),x(),Y(4),ae(5,"translate"),x()),t&2&&(p(2),He("",se(3,2,"birthDateShort"),":"),p(2),He(" ",se(5,4,"notSpecified"),""))}function XF(t,n){if(t&1&&(g(0,"div"),N(1,"img",49),g(2,"p")(3,"strong"),Y(4),ae(5,"translate"),x(),Y(6),x(),g(7,"p")(8,"strong"),Y(9),ae(10,"translate"),x(),Y(11),x(),g(12,"p")(13,"strong"),Y(14),ae(15,"translate"),x(),Y(16),ae(17,"phoneNumberFormat"),x(),g(18,"p")(19,"strong"),Y(20),ae(21,"translate"),x(),Y(22),x(),g(23,"p")(24,"strong"),Y(25),ae(26,"translate"),x(),Y(27),x(),g(28,"p")(29,"strong"),Y(30),ae(31,"translate"),x(),Y(32),x(),w(33,$F,6,7,"p",12)(34,YF,6,6,"p",12),g(35,"p")(36,"strong"),Y(37),ae(38,"translate"),x(),Y(39),x()()),t&2){let e=f();p(),u("src",e.selectedUser.profilePicture,ya),p(3),He("",se(5,18,"firstName"),":"),p(2),dr(" ",e.selectedUser.firstName," ",e.selectedUser.lastName,""),p(3),He("",se(10,20,"emailShort"),":"),p(2),He(" ",e.selectedUser.email,""),p(3),He("",se(15,22,"phoneShort"),":"),p(2),He(" ",se(17,24,e.selectedUser.phoneNumber),""),p(4),He("",se(21,26,"roleShort"),":"),p(2),He(" ",e.selectedUser.role==="admin"?"\u0410\u0434\u043C\u0438\u043D":"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",""),p(3),He("",se(26,28,"ageShort"),":"),p(2),He(" ",e.selectedUser.age,""),p(3),He("",se(31,30,"genderShort"),":"),p(2),He(" ",e.selectedUser.gender,""),p(),u("ngIf",e.selectedUser.dateOfBirth),p(),u("ngIf",!e.selectedUser.dateOfBirth),p(3),He("",se(38,32,"address"),":"),p(2),He(" ",e.selectedUser.address,"")}}var cl=class t{constructor(n,e,i,r,a){this.translate=n;this.authService=e;this.auditTrailService=i;this.messageService=r;this.sharedStateService=a;this.initializeTranslations(),this.translate.onLangChange.subscribe(()=>{this.initializeTranslations()})}isAdmin=!1;cols=[];users=[];userDialog=!1;deleteUserDialog=!1;deleteUsersDialog=!1;submitted=!1;user={};selectedUsers=[];userEmail="";displayModal=!1;genderOptions=[];roleOptions=[];selectedUser=null;initializeTranslations(){this.translate.get(["firstName","email","phoneNumber","role","male","female","other","admin","user"]).subscribe(n=>{this.cols=[{field:"firstName",header:n.firstName},{field:"email",header:n.email},{field:"phoneNumber",header:n.phoneNumber},{field:"role",header:n.role}],this.genderOptions=[{label:n.male,value:"male"},{label:n.female,value:"female"},{label:n.other,value:"other"}],this.roleOptions=[{label:n.admin,value:"admin"},{label:n.user,value:"user"}]})}ngOnInit(){let n=localStorage.getItem("userEmail");n?this.authService.isAdmin(n).subscribe(e=>{this.isAdmin=e}):console.error("Email \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0432 localStorage!"),this.loadUsers(),this.sharedStateService.users$.subscribe(e=>{this.users=e})}loadUsers(){this.sharedStateService.getUsers().subscribe({next:n=>{this.users=n},error:n=>{this.translate.get(["error","userDataLoadFailed"]).subscribe(e=>{this.messageService.add({severity:"error",summary:e.error,detail:e.userDataLoadFailed,life:3e3})})}})}openNew(){this.user={},this.submitted=!1,this.userDialog=!0}deleteSelectedUsers(){!this.selectedUsers||!this.selectedUsers.length||(this.deleteUsersDialog=!0)}editUser(n){this.user=Tt({},n),this.userDialog=!0}deleteUser(n){this.deleteUserDialog=!0,this.user=Tt({},n)}hideDialog(){this.userDialog=!1,this.submitted=!1}confirmDeleteSelected(){if(!this.selectedUsers||!this.selectedUsers.length)return;let n=this.selectedUsers.filter(e=>e.id).map(e=>this.sharedStateService.deleteUserWithTodos(e.id));n.length>0&&va(n).subscribe({next:()=>{let e=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E";this.selectedUsers.forEach(a=>{a.id&&this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435",entity:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",entityId:a.id,performedBy:e,details:`\u0423\u0434\u0430\u043B\u0435\u043D \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C: ${a.firstName||"undefined"} ${a.lastName||"undefined"}`})});let i=this.selectedUsers.map(a=>a.id),r=this.sharedStateService.usersSubject.getValue().filter(a=>!i.includes(a.id));this.sharedStateService.setUsers(r),this.translate.get(["success","selectedUsersAndTasksDeleted"]).subscribe(a=>{this.messageService.add({severity:"success",summary:a.success,detail:a.selectedUsersAndTasksDeleted,life:3e3})}),this.selectedUsers=[],this.deleteUsersDialog=!1},error:e=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0438 \u0438\u0445 \u0437\u0430\u0434\u0430\u0447:",e),this.translate.get(["error","someUsersAndTasksNotDeleted"]).subscribe(i=>{this.messageService.add({severity:"error",summary:i.error,detail:i.someUsersAndTasksNotDeleted,life:3e3})})}})}viewUserDetails(n){this.selectedUser=n,this.displayModal=!0}confirmDelete(n){this.deleteUserDialog=!1,n.id&&this.sharedStateService.deleteUserWithTodos(n.id).subscribe({next:()=>{this.users=this.users.filter(i=>i.id!==n.id);let e=localStorage.getItem("userEmail");this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435",entity:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",entityId:n.id,performedBy:e||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E",details:`\u0423\u0434\u0430\u043B\u0435\u043D \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C: ${n.firstName||"undefined"} ${n.lastName||"undefined"}`}),this.translate.get(["success","userAndTasksDeleted"]).subscribe(i=>{this.messageService.add({severity:"success",summary:i.success,detail:i.userAndTasksDeleted,life:3e3})})},error:e=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F \u0438 \u0435\u0433\u043E \u0437\u0430\u0434\u0430\u0447:",e),this.translate.get(["error","userAndTasksNotDeleted"]).subscribe(i=>{this.messageService.add({severity:"error",summary:i.error,detail:i.userAndTasksNotDeleted,life:3e3})})}})}getRoleDisplayName(n){switch(n){case"admin":return"\u0410\u0434\u043C\u0438\u043D";case"user":return"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C";default:return n}}formatPhoneNumber(n){this.user||(this.user={});let e=n.replace(/\D/g,"");e.length>9&&(e=e.substring(0,9)),e.length>=3&&e.length<=5?e=`${e.substring(0,3)} ${e.substring(3)}`:e.length>5&&(e=`${e.substring(0,3)} ${e.substring(3,5)} ${e.substring(5)}`),this.user.phoneNumber=e}importUsers(n,e){let i=n.files[0];if(!i){this.messageService.add({severity:"error",summary:"\u041E\u0448\u0438\u0431\u043A\u0430",detail:"\u0424\u0430\u0439\u043B \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D"});return}let r=new FileReader;r.onload=a=>{let s=a.target.result,o=qo(s,{type:"binary"}),l=o.SheetNames[0],c=ll.sheet_to_json(o.Sheets[l]);console.log("\u0418\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435:",c),this.validateAndSaveUsers(c),e.clear()},r.onerror=()=>{this.messageService.add({severity:"error",summary:"\u041E\u0448\u0438\u0431\u043A\u0430",detail:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u0440\u043E\u0447\u0438\u0442\u0430\u0442\u044C \u0444\u0430\u0439\u043B"})},r.readAsBinaryString(i)}validateAndSaveUsers(n){let e=n.map(s=>_n(Tt({},s),{id:z0(),code:Math.floor(1e3+Math.random()*9e3),dateAdded:new Date().toISOString().split("T")[0],phoneNumber:s.phoneNumber?s.phoneNumber.toString():""})),i=e.filter(s=>!s.email||!this.isValidEmail(s.email)||!s.firstName||!s.lastName);if(i.length>0){this.messageService.add({severity:"error",summary:"\u041E\u0448\u0438\u0431\u043A\u0430",detail:`\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u0443 ${i.length} \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439`}),console.warn("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438:",i);return}let a=[...this.sharedStateService.usersSubject.getValue(),...e];this.sharedStateService.setUsers(a),this.messageService.add({severity:"success",summary:"\u0423\u0441\u043F\u0435\u0448\u043D\u043E",detail:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438 \u0438\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u044B"}),this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u0418\u043C\u043F\u043E\u0440\u0442",entity:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438",entityId:`\u0418\u043C\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043E ${e.length} \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439`,performedBy:localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439",details:`${e.length} \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0443.`}).subscribe(()=>{console.log("\u0417\u0430\u043F\u0438\u0441\u044C \u0430\u0443\u0434\u0438\u0442\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430.")})}isValidEmail(n){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)}saveUser(){if(this.submitted=!0,!this.user?.firstName?.trim()){console.warn("\u0418\u043C\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E!");return}if(!this.user?.phoneNumber||!this.isValidPhoneNumber(this.user.phoneNumber)){console.warn("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430!");return}this.user.phoneNumber=this.user.phoneNumber.replace(/\D/g,"");let n=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E";this.user.id?this.sharedStateService.updateUser(this.user.id,this.user).subscribe({next:()=>{this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435",entity:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",entityId:this.user.id,performedBy:n,details:`\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C: ${this.user.firstName} ${this.user.lastName}`}),this.translate.get(["success","userUpdated"]).subscribe(r=>{this.messageService.add({severity:"success",summary:r.success,detail:r.userUpdated,life:3e3})});let i=this.sharedStateService.usersSubject.getValue().map(r=>r.id===this.user.id?Tt(Tt({},r),this.user):r);this.sharedStateService.setUsers(i)},error:e=>console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F:",e)}):this.sharedStateService.addUser(this.user).subscribe({next:e=>{this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435",entity:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",entityId:e.id,performedBy:n,details:`\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D \u043D\u043E\u0432\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C: ${e.firstName} ${e.lastName}`});let i=this.sharedStateService.usersSubject.getValue();this.sharedStateService.setUsers([...i,e]),this.translate.get(["success","userCreated"]).subscribe(r=>{this.messageService.add({severity:"success",summary:r.success,detail:r.userCreated,life:3e3})})},error:e=>console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F:",e)}),this.userDialog=!1,this.user={}}isValidPhoneNumber(n){let e=n.replace(/\D/g,"");return e.length===9&&e[0]!=="0"}static \u0275fac=function(e){return new(e||t)(Z(Dn),Z(Da),Z(Hn),Z(Ki),Z(Dr))};static \u0275cmp=he({type:t,selectors:[["app-users"]],standalone:!0,features:[Ue],decls:29,vars:46,consts:[["fileUpload",""],[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","right"],["pTemplate","left"],[3,"selectedItemsChange","viewDetails","edit","delete","data","columns","rows","isAdmin","selectedItems","transformColumn","showViewButton"],[3,"visibleChange","visible","header","modal"],["pTemplate","content",1,"creat-edit-modal"],["pTemplate","footer"],[3,"visibleChange","visible","header","modal","closable"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[3,"visibleChange","visible","modal","header","closable"],["pButton","","icon","pi pi-times",3,"click","label"],[1,"my-2","buttons","buttons-users"],["mode","basic","name","file","accept",".xlsx",3,"onSelect","chooseLabel"],["pButton","","pRipple","","icon","pi pi-plus","class","p-button-success mr-2",3,"label","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash","class","p-button-danger ml-5 delete-selected",3,"label","disabled","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click","label"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-danger","ml-5","delete-selected",3,"click","label","disabled"],[1,"field"],["for","name"],["type","text","id","name","pInputText","","required","",3,"ngModelChange","ngModel"],["for","lastName"],["type","text","id","lastName","pInputText","","required","",3,"ngModelChange","ngModel"],["for","email"],["id","email","pInputTextarea","","required","","rows","3",3,"ngModelChange","ngModel"],["for","phoneNumber"],[1,"phone-input"],["type","text","id","phoneNumber","pInputText","","maxlength","12","required","",3,"ngModelChange","ngModel"],["class","p-error",4,"ngIf"],["for","age"],["type","number","id","age","pInputText","","required","",3,"ngModelChange","ngModel"],["for","gender"],["optionLabel","label","optionValue","value","required","",3,"ngModelChange","ngModel","options","placeholder"],["for","address"],["id","address","pInputTextarea","","required","","rows","3",3,"ngModelChange","ngModel"],["for","dateOfBirth"],["dateFormat","yy-mm-dd","showIcon","",3,"ngModelChange","ngModel"],["for","role"],["for","profilePicture"],["type","text","id","profilePicture","pInputText","",3,"ngModelChange","ngModel","placeholder"],["class","profile-picture-preview",4,"ngIf"],[1,"p-error"],[1,"profile-picture-preview"],["alt","Profile Picture",2,"width","100px","height","100px","border-radius","50%",3,"src"],["pButton","","pRipple","","icon","pi pi-times",1,"p-button-text",3,"click","label"],["pButton","","pRipple","","icon","pi pi-check",1,"p-button-text",3,"click","label"],["alt","Profile Picture",2,"width","100px","border-radius","50%",3,"src"]],template:function(e,i){e&1&&(g(0,"div",1),N(1,"p-toast"),g(2,"p-toolbar",2),w(3,RF,6,5,"ng-template",3)(4,VF,3,3,"ng-template",4),x(),g(5,"app-shared-table",5),nt("selectedItemsChange",function(a){return it(i.selectedUsers,a)||(i.selectedUsers=a),a}),G("viewDetails",function(a){return i.viewUserDetails(a)})("edit",function(a){return i.editUser(a)})("delete",function(a){return i.deleteUser(a)}),x()(),g(6,"p-dialog",6),ae(7,"translate"),nt("visibleChange",function(a){return it(i.userDialog,a)||(i.userDialog=a),a}),w(8,UF,59,54,"ng-template",7)(9,HF,4,6,"ng-template",8),x(),g(10,"p-dialog",9),ae(11,"translate"),nt("visibleChange",function(a){return it(i.deleteUsersDialog,a)||(i.deleteUsersDialog=a),a}),g(12,"div",10),N(13,"i",11),w(14,zF,6,4,"span",12)(15,WF,3,3,"span",12),x(),w(16,jF,4,6,"ng-template",8),x(),g(17,"p-dialog",9),ae(18,"translate"),nt("visibleChange",function(a){return it(i.deleteUserDialog,a)||(i.deleteUserDialog=a),a}),g(19,"div",10),N(20,"i",11),w(21,KF,6,4,"span",12),x(),w(22,GF,4,6,"ng-template",8),x(),g(23,"p-dialog",13),ae(24,"translate"),nt("visibleChange",function(a){return it(i.displayModal,a)||(i.displayModal=a),a}),w(25,XF,40,34,"div",12),g(26,"footer")(27,"button",14),ae(28,"translate"),G("click",function(){return i.displayModal=!1}),x()()()),e&2&&(p(5),u("data",i.users)("columns",i.cols)("rows",5)("isAdmin",i.isAdmin),tt("selectedItems",i.selectedUsers),u("transformColumn",i.getRoleDisplayName)("showViewButton",!0),p(),Ai(Ot(43,OF)),tt("visible",i.userDialog),u("header",se(7,33,"userDetails"))("modal",!0),p(4),Ai(Ot(44,Rf)),tt("visible",i.deleteUsersDialog),u("header",se(11,35,"confirmation"))("modal",!0)("closable",!1),p(4),u("ngIf",i.selectedUsers.length===1),p(),u("ngIf",i.selectedUsers.length>1),p(2),Ai(Ot(45,Rf)),tt("visible",i.deleteUserDialog),u("header",se(18,37,"confirmation"))("modal",!0)("closable",!1),p(4),u("ngIf",i.user),p(2),tt("visible",i.displayModal),u("modal",!0)("header",se(24,39,"userInformation"))("closable",!0),p(2),u("ngIf",i.selectedUser),p(2),u("label",se(28,41,"close")))},dependencies:[Nr,si,Mr,La,Ze,Rr,za,At,Lr,Pr,Vr,gn,kr,R0,kn,Er,P0,dn,Gi,Fr,xn,Wn,rt,Br,Wa,Or,Tl,ja,Ca,Mn,ko,vd]})};var qF=()=>({width:"450px"}),Pf=()=>({width:"400px"}),ZF=t=>({"ng-invalid ng-dirty":t}),QF=(t,n)=>({"status-true":t,"status-false":n});function JF(t,n){if(t&1){let e=le();g(0,"div",12)(1,"button",13),ae(2,"translate"),G("click",function(){S(e);let r=f();return I(r.openNew())}),x(),g(3,"button",14),ae(4,"translate"),G("click",function(){S(e);let r=f();return I(r.deleteSelectedTodos())}),x()()}if(t&2){let e=f();p(),u("label",se(2,3,"create")),p(2),u("label",se(4,5,"delete"))("disabled",!e.selectedTodos||!e.selectedTodos.length)}}function eD(t,n){t&1&&(g(0,"h2"),Y(1),ae(2,"translate"),x()),t&2&&(p(),be(se(2,1,"writeAndFinish")))}function tD(t,n){if(t&1&&N(0,"span",23),t&2){let e=f(2);u("ngClass",pt(1,QF,e.todo.status,!e.todo.status))}}function iD(t,n){t&1&&(g(0,"small",24),Y(1),ae(2,"translate"),x()),t&2&&(p(),He("\u0421",se(2,1,"statusRequired"),""))}function nD(t,n){if(t&1){let e=le();g(0,"div",15)(1,"label",16),Y(2),ae(3,"translate"),x(),g(4,"input",17),nt("ngModelChange",function(r){S(e);let a=f();return it(a.todo.name,r)||(a.todo.name=r),I(r)}),x()(),g(5,"div",15)(6,"label",18),Y(7),ae(8,"translate"),x(),g(9,"textarea",19),nt("ngModelChange",function(r){S(e);let a=f();return it(a.todo.description,r)||(a.todo.description=r),I(r)}),x()(),g(10,"p-dropdown",20),ae(11,"translate"),nt("ngModelChange",function(r){S(e);let a=f();return it(a.todo.status,r)||(a.todo.status=r),I(r)}),x(),w(12,tD,1,4,"span",21)(13,iD,3,3,"small",22)}if(t&2){let e=f();p(2),be(se(3,10,"title")),p(2),tt("ngModel",e.todo.name),p(3),be(se(8,12,"description")),p(2),tt("ngModel",e.todo.description),p(),tt("ngModel",e.todo.status),u("options",e.statusOptions)("placeholder",se(11,14,"selectStatus"))("ngClass",Le(16,ZF,e.submitted&&!e.todo.status)),p(2),u("ngIf",e.todo.status!==void 0),p(),u("ngIf",e.submitted&&!e.todo.status)}}function rD(t,n){if(t&1){let e=le();g(0,"button",25),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.hideDialog())}),x(),g(2,"button",26),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.saveTodo())}),x()}t&2&&(u("label",se(1,2,"cancel")),p(2),u("label",se(3,4,"save")))}function aD(t,n){if(t&1&&(g(0,"span"),Y(1),ae(2,"translate"),g(3,"b"),Y(4),x(),Y(5,"? "),x()),t&2){let e=f();p(),He(" ",se(2,2,"confirmDelete")," "),p(3),He(" ",e.selectedTodos[0].name," ")}}function sD(t,n){t&1&&(g(0,"span"),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"confirmDeleteSelectedTasks")," "))}function oD(t,n){if(t&1){let e=le();g(0,"button",25),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.deleteTodosDialog=!1)}),x(),g(2,"button",26),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.confirmDeleteSelected())}),x()}t&2&&(u("label",se(1,2,"no")),p(2),u("label",se(3,4,"yes")))}function lD(t,n){if(t&1&&(g(0,"span"),Y(1),ae(2,"translate"),g(3,"b"),Y(4),x(),Y(5,"?"),x()),t&2){let e=f();p(),He("",se(2,2,"confirmDeleteTask")," "),p(3),be(e.todo.name)}}function cD(t,n){if(t&1){let e=le();g(0,"button",25),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.deleteTodoDialog=!1)}),x(),g(2,"button",26),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.confirmDelete())}),x()}t&2&&(u("label",se(1,2,"no")),p(2),u("label",se(3,4,"yes")))}var dl=class t{constructor(n,e,i,r,a){this.translate=n;this.auditTrailService=e;this.sharedStateService=i;this.messageService=r;this.router=a;this.initializeColumns(),this.translate.onLangChange.subscribe(()=>{this.initializeColumns()})}todoDialog=!1;deleteTodoDialog=!1;deleteTodosDialog=!1;currentUser=null;todos=[];userTodos=[];todo={};selectedTodos=[];userEmail="";submitted=!1;cols=[];isAdmin=!0;statusOptions=[];initializeColumns(){this.translate.get(["title","description","status","completed","notCompleted"]).subscribe(n=>{this.cols=[{field:"name",header:n.title},{field:"description",header:n.description},{field:"status",header:n.status}],this.statusOptions=[{label:n.completed,value:!0},{label:n.notCompleted,value:!1}]})}ngOnInit(){let n=localStorage.getItem("userEmail");n&&this.loadCurrentUser(n)}loadCurrentUser(n){this.sharedStateService.getUsers().subscribe(e=>{this.currentUser=e.find(i=>i.email===n),this.currentUser?this.loadUserTodos():console.error("\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D!")})}loadUserTodos(){this.sharedStateService.getTodos().subscribe(n=>{this.todos=n,this.userTodos=n.filter(e=>e.userId===this.currentUser.id)})}openNew(){this.todo={},this.submitted=!1,this.todoDialog=!0}deleteSelectedTodos(){this.selectedTodos.length&&(this.deleteTodosDialog=!0)}editTodo(n){this.todo=Tt({},n),this.todoDialog=!0}deleteTodo(n){this.todo=Tt({},n),this.deleteTodoDialog=!0}confirmDeleteSelected(){let n=this.selectedTodos.map(e=>this.sharedStateService.deleteTodo(e.id));va(n).subscribe({next:()=>{let e=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E";this.sharedStateService.getUsers().subscribe(i=>{this.selectedTodos.forEach(r=>{let a=i.find(s=>s.id===r.userId);this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435",entity:"\u0417\u0430\u0434\u0430\u0447\u0430",entityId:r.id,performedBy:e,details:`\u0423\u0434\u0430\u043B\u0435\u043D\u0430 \u0437\u0430\u0434\u0430\u0447\u0430: ${r.name||"\u0411\u0435\u0437 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044F"}, \u043F\u0440\u0438\u043D\u0430\u0434\u043B\u0435\u0436\u0430\u0432\u0448\u0430\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044E: ${a?`${a.firstName} ${a.lastName}`:"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"}`})}),this.selectedTodos.forEach(r=>{this.userTodos=this.userTodos.filter(a=>a.id!==r.id)}),this.selectedTodos=[],this.deleteTodosDialog=!1,this.translate.get(["success","selectedTasksDeleted"]).subscribe(r=>{this.messageService.add({severity:"success",summary:r.success,detail:r.selectedTasksDeleted,life:3e3})})})},error:e=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u0434\u0430\u0447:",e),this.translate.get(["error","selectedTasksNotDeleted"]).subscribe(i=>{this.messageService.add({severity:"error",summary:i.error,detail:i.selectedTasksNotDeleted,life:3e3})})}})}confirmDelete(){let n=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E";this.sharedStateService.deleteTodo(this.todo.id).subscribe({next:()=>{this.sharedStateService.getUsers().subscribe(e=>{let i=e.find(r=>r.id===this.todo.userId);this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435",entity:"\u0417\u0430\u0434\u0430\u0447\u0430",entityId:this.todo.id,performedBy:n,details:`\u0423\u0434\u0430\u043B\u0435\u043D\u0430 \u0437\u0430\u0434\u0430\u0447\u0430: ${this.todo.name||"\u0411\u0435\u0437 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044F"}, \u043F\u0440\u0438\u043D\u0430\u0434\u043B\u0435\u0436\u0430\u0432\u0448\u0430\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044E: ${i?`${i.firstName} ${i.lastName}`:"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"}`}),this.userTodos=this.userTodos.filter(r=>r.id!==this.todo.id),this.todos=this.todos.filter(r=>r.id!==this.todo.id),this.translate.get(["success","taskDeleted"]).subscribe(r=>{this.messageService.add({severity:"success",summary:r.success,detail:r.taskDeleted,life:3e3})}),this.deleteTodoDialog=!1,this.todo={}})},error:e=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u0434\u0430\u0447\u0438:",e),this.translate.get(["error","taskDeleteFailed"]).subscribe(i=>{this.messageService.add({severity:"error",summary:i.error,detail:i.taskDeleteFailed,life:3e3})})}})}hideDialog(){this.todoDialog=!1,this.submitted=!1}saveTodo(){if(this.submitted=!0,this.todo.name?.trim()){let n=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E";console.log("\u0422\u0435\u043A\u0443\u0449\u0438\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C (email):",n),this.sharedStateService.getUsers().subscribe(e=>{console.log("\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438:",e);let i=e.find(s=>s.email===n);if(!i){console.error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0438\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0435\u0433\u043E \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F"),this.translate.get(["error","currentUserNotDetermined"]).subscribe(s=>{this.messageService.add({severity:"error",summary:s.error,detail:s.currentUserNotDetermined,life:3e3})});return}this.todo.id||(this.todo.userId=i.id);let r=!!this.todo.id;(r?this.sharedStateService.updateTodo(this.todo.id,this.todo):this.sharedStateService.addTodo(this.todo)).subscribe({next:s=>{this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:r?"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435":"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435",entity:"\u0417\u0430\u0434\u0430\u0447\u0430",entityId:s.id,performedBy:n,details:r?`\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0430 \u0437\u0430\u0434\u0430\u0447\u0430: ${this.todo.name} \u0434\u043B\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F: ${i.firstName} ${i.lastName}`:`\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u043E\u0432\u0430\u044F \u0437\u0430\u0434\u0430\u0447\u0430: ${this.todo.name} \u0434\u043B\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F: ${i.firstName} ${i.lastName}`}),this.loadUserTodos(),this.translate.get(["success","taskUpdated","taskCreated"]).subscribe(o=>{this.messageService.add({severity:"success",summary:o.success,detail:r?o.taskUpdated:o.taskCreated,life:3e3})})},error:s=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u0434\u0430\u0447\u0438:",s),this.translate.get(["error","taskSaveFailed"]).subscribe(o=>{this.messageService.add({severity:"error",summary:o.error,detail:o.taskSaveFailed,life:3e3})})},complete:()=>{this.todoDialog=!1,this.todo={}}})})}}static \u0275fac=function(e){return new(e||t)(Z(Dn),Z(Hn),Z(Dr),Z(Ki),Z(Ta))};static \u0275cmp=he({type:t,selectors:[["app-todos"]],standalone:!0,features:[Ue],decls:23,vars:34,consts:[[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","right"],["pTemplate","left"],[3,"selectedItemsChange","edit","delete","data","columns","rows","isAdmin","selectedItems"],[1,"todos",3,"visibleChange","visible","header","modal"],["pTemplate","content",1,"creat-edit-modal"],["pTemplate","footer"],[3,"visibleChange","visible","header","modal","closable"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[1,"my-2","buttons"],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click","label"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-danger","ml-5","delete-selected",3,"click","label","disabled"],[1,"field"],["for","name"],["type","text","id","name","pInputText","","required","",3,"ngModelChange","ngModel"],["for","description"],["id","description","pInputTextarea","","required","","rows","3",3,"ngModelChange","ngModel"],["optionLabel","label","optionValue","value","required","",3,"ngModelChange","ngModel","options","placeholder","ngClass"],["class","status-badge",3,"ngClass",4,"ngIf"],["class","p-error",4,"ngIf"],[1,"status-badge",3,"ngClass"],[1,"p-error"],["pButton","","pRipple","","icon","pi pi-times",1,"p-button-text",3,"click","label"],["pButton","","pRipple","","icon","pi pi-check",1,"p-button-text",3,"click","label"]],template:function(e,i){e&1&&(g(0,"div",0),N(1,"p-toast"),g(2,"p-toolbar",1),w(3,JF,5,7,"ng-template",2)(4,eD,3,3,"ng-template",3),x(),g(5,"app-shared-table",4),nt("selectedItemsChange",function(a){return it(i.selectedTodos,a)||(i.selectedTodos=a),a}),G("edit",function(a){return i.editTodo(a)})("delete",function(a){return i.deleteTodo(a)}),x()(),g(6,"p-dialog",5),ae(7,"translate"),nt("visibleChange",function(a){return it(i.todoDialog,a)||(i.todoDialog=a),a}),w(8,nD,14,18,"ng-template",6)(9,rD,4,6,"ng-template",7),x(),g(10,"p-dialog",8),ae(11,"translate"),nt("visibleChange",function(a){return it(i.deleteTodosDialog,a)||(i.deleteTodosDialog=a),a}),g(12,"div",9),N(13,"i",10),w(14,aD,6,4,"span",11)(15,sD,3,3,"span",11),x(),w(16,oD,4,6,"ng-template",7),x(),g(17,"p-dialog",8),ae(18,"translate"),nt("visibleChange",function(a){return it(i.deleteTodoDialog,a)||(i.deleteTodoDialog=a),a}),g(19,"div",9),N(20,"i",10),w(21,lD,6,4,"span",11),x(),w(22,cD,4,6,"ng-template",7),x()),e&2&&(p(5),u("data",i.userTodos)("columns",i.cols)("rows",5)("isAdmin",i.isAdmin),tt("selectedItems",i.selectedTodos),p(),Ai(Ot(31,qF)),tt("visible",i.todoDialog),u("header",se(7,25,"taskDetails"))("modal",!0),p(4),Ai(Ot(32,Pf)),tt("visible",i.deleteTodosDialog),u("header",se(11,27,"confirmation"))("modal",!0)("closable",!1),p(4),u("ngIf",i.selectedTodos.length===1),p(),u("ngIf",i.selectedTodos.length>1),p(2),Ai(Ot(33,Pf)),tt("visible",i.deleteTodoDialog),u("header",se(18,29,"confirmation"))("modal",!0)("closable",!1),p(4),u("ngIf",i.todo))},dependencies:[si,Pr,Vr,Ze,xn,Wn,Gi,Fr,Br,Wa,rt,fo,kr,kn,Er,At,Nr,Mr,La,Rr,za,gn,dn,at,Mn]})};var dD=()=>({width:"450px"}),Nf=()=>({width:"400px"}),pD=t=>({"ng-invalid ng-dirty":t}),uD=(t,n)=>({"status-true":t,"status-false":n});function fD(t,n){if(t&1){let e=le();g(0,"button",15),ae(1,"translate"),G("click",function(){S(e);let r=f(2);return I(r.openNew())}),x()}t&2&&u("label",se(1,1,"create"))}function hD(t,n){if(t&1){let e=le();g(0,"button",16),ae(1,"translate"),G("click",function(){S(e);let r=f(2);return I(r.deleteSelectedTodos())}),x()}if(t&2){let e=f(2);u("label",se(1,2,"delete"))("disabled",!e.selectedTodos||!e.selectedTodos.length)}}function mD(t,n){if(t&1&&(g(0,"div",12),w(1,fD,2,3,"button",13)(2,hD,2,4,"button",14),x()),t&2){let e=f();p(),u("ngIf",e.isAdmin),p(),u("ngIf",e.isAdmin)}}function _D(t,n){t&1&&(g(0,"h2"),Y(1),ae(2,"translate"),x()),t&2&&(p(),be(se(2,1,"tasksUsers")))}function gD(t,n){t&1&&(g(0,"small",27),Y(1),ae(2,"translate"),x()),t&2&&(p(),be(se(2,1,"userRequired")))}function xD(t,n){if(t&1&&N(0,"span",28),t&2){let e=f(2);u("ngClass",pt(1,uD,e.todo.status,!e.todo.status))}}function vD(t,n){t&1&&(g(0,"small",27),Y(1),ae(2,"translate"),x()),t&2&&(p(),be(se(2,1,"statusRequired")))}function bD(t,n){if(t&1){let e=le();g(0,"div",17)(1,"label",18),Y(2),ae(3,"translate"),x(),g(4,"input",19),nt("ngModelChange",function(r){S(e);let a=f();return it(a.todo.name,r)||(a.todo.name=r),I(r)}),x()(),g(5,"div",17)(6,"label",20),Y(7),ae(8,"translate"),x(),g(9,"textarea",21),nt("ngModelChange",function(r){S(e);let a=f();return it(a.todo.description,r)||(a.todo.description=r),I(r)}),x()(),g(10,"div",17)(11,"label",22),Y(12),ae(13,"translate"),x(),g(14,"p-dropdown",23),ae(15,"translate"),nt("ngModelChange",function(r){S(e);let a=f();return it(a.todo.userId,r)||(a.todo.userId=r),I(r)}),x(),w(16,gD,3,3,"small",24),x(),g(17,"p-dropdown",25),ae(18,"translate"),nt("ngModelChange",function(r){S(e);let a=f();return it(a.todo.status,r)||(a.todo.status=r),I(r)}),x(),w(19,xD,1,4,"span",26)(20,vD,3,3,"small",24)}if(t&2){let e=f();p(2),be(se(3,15,"title")),p(2),tt("ngModel",e.todo.name),p(3),be(se(8,17,"description")),p(2),tt("ngModel",e.todo.description),p(3),be(se(13,19,"user")),p(2),tt("ngModel",e.todo.userId),u("options",e.userOptions)("placeholder",se(15,21,"selectUser")),p(2),u("ngIf",e.submitted&&!e.todo.userId),p(),tt("ngModel",e.todo.status),u("options",e.statusOptions)("placeholder",se(18,23,"selectStatus"))("ngClass",Le(25,pD,e.submitted&&!e.todo.status)),p(2),u("ngIf",e.todo.status!==void 0),p(),u("ngIf",e.submitted&&!e.todo.status)}}function yD(t,n){if(t&1){let e=le();g(0,"button",29),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.hideDialog())}),x(),g(2,"button",30),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.saveTodo())}),x()}t&2&&(u("label",se(1,2,"cancel")),p(2),u("label",se(3,4,"save")))}function wD(t,n){if(t&1&&(g(0,"span"),Y(1),ae(2,"translate"),g(3,"b"),Y(4),x(),Y(5,"? "),x()),t&2){let e=f();p(),He(" ",se(2,2,"confirmDelete")," "),p(3),be(e.selectedTodos[0]==null?null:e.selectedTodos[0].name)}}function CD(t,n){t&1&&(g(0,"span"),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"confirmDeleteSelectedTasks")," "))}function TD(t,n){if(t&1){let e=le();g(0,"button",29),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.deleteTodosDialog=!1)}),x(),g(2,"button",30),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.confirmDeleteSelected())}),x()}t&2&&(u("label",se(1,2,"no")),p(2),u("label",se(3,4,"yes")))}function SD(t,n){if(t&1&&(g(0,"span"),Y(1),ae(2,"translate"),g(3,"b"),Y(4),x(),Y(5,"?"),x()),t&2){let e=f();p(),He("",se(2,2,"confirmDeleteTask")," "),p(3),be(e.todo.name)}}function ID(t,n){if(t&1){let e=le();g(0,"button",29),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.deleteTodoDialog=!1)}),x(),g(2,"button",30),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.confirmDelete())}),x()}t&2&&(u("label",se(1,2,"no")),p(2),u("label",se(3,4,"yes")))}var pl=class t{constructor(n,e,i,r,a,s){this.translate=n;this.auditTrailService=e;this.messageService=i;this.authService=r;this.router=a;this.sharedStateService=s;this.initializeColumns(),this.translate.onLangChange.subscribe(()=>{this.initializeColumns()})}todoDialog=!1;deleteTodoDialog=!1;deleteTodosDialog=!1;userOptions=[];todosWithUsers=[];todos=[];todo={};selectedTodos=[];userEmail="";submitted=!1;cols=[];statusOptions=[];isAdmin=!1;initializeColumns(){this.translate.get(["title","description","firstName","status","completed","notCompleted"]).subscribe(n=>{this.cols=[{field:"name",header:n.title},{field:"description",header:n.description},{field:"userName",header:n.firstName},{field:"status",header:n.status}],this.statusOptions=[{label:n.completed,value:!0},{label:n.notCompleted,value:!1}]})}ngOnInit(){this.initUserPermissions(),this.initDataStreams(),this.setupColumns()}initUserPermissions(){let n=localStorage.getItem("userEmail");n?this.authService.isAdmin(n).subscribe(e=>{this.isAdmin=e}):console.error("Email \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0432 localStorage!"),this.sharedStateService.users$.subscribe(e=>{this.userOptions=e.map(i=>({label:`${i.firstName} ${i.lastName}`,value:i.id}))})}initDataStreams(){this.sharedStateService.userOptions$.subscribe(n=>{this.userOptions=n}),this.sharedStateService.todos$.subscribe(()=>{this.loadTodosWithUsers()}),this.loadTodosWithUsers()}setupColumns(){this.initializeColumns()}loadUsers(){this.sharedStateService.getUsers().subscribe({next:n=>{this.userOptions=n.map(e=>({label:`${e.firstName} ${e.lastName}`,value:e.id})),console.log("userOptions:",this.userOptions)},error:n=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439:",n)}}),console.log(this.userOptions)}loadTodosWithUsers(){va({users:this.sharedStateService.getUsers(),todos:this.sharedStateService.getTodos()}).subscribe(({users:n,todos:e})=>{this.todosWithUsers=e.map(i=>{let r=n.find(a=>a.id===i.userId);return _n(Tt({},i),{userName:r?`${r.firstName} ${r.lastName}`:"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"})})})}openNew(){this.todo={},this.submitted=!1,this.todoDialog=!0}deleteSelectedTodos(){!this.selectedTodos||!this.selectedTodos.length||(this.deleteTodosDialog=!0)}editTodo(n){this.todo=Tt({},n),this.todoDialog=!0}deleteTodo(n){this.deleteTodoDialog=!0,this.todo=Tt({},n)}confirmDelete(){this.deleteTodoDialog=!1;let n=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E";if(this.todo.id&&this.todo.userId){this.userOptions.length===0&&this.loadUsers();let e=this.userOptions.find(i=>i.value===this.todo.userId);this.sharedStateService.deleteTodo(this.todo.id).subscribe({next:()=>{this.todosWithUsers=this.todosWithUsers.filter(i=>i.id!==this.todo.id),this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435",entity:"\u0417\u0430\u0434\u0430\u0447\u0430",entityId:this.todo.id,performedBy:n,details:`\u0423\u0434\u0430\u043B\u0435\u043D\u0430 \u0437\u0430\u0434\u0430\u0447\u0430: ${this.todo.name}, \u043F\u0440\u0438\u043D\u0430\u0434\u043B\u0435\u0436\u0430\u0449\u0430\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044E: ${e?`${e.label}`:"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"}`}),this.translate.get(["success","taskDeleted"]).subscribe(i=>{this.messageService.add({severity:"success",summary:i.success,detail:i.taskDeleted,life:3e3})}),this.todo={}},error:i=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u0434\u0430\u0447\u0438:",i),this.translate.get(["error","taskDeleteFailed"]).subscribe(r=>{this.messageService.add({severity:"error",summary:r.error,detail:r.taskDeleteFailed,life:3e3})})}})}}confirmDeleteSelected(){if(!this.selectedTodos||!this.selectedTodos.length)return;let n=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E",e=this.selectedTodos.map(i=>this.sharedStateService.deleteTodo(i.id).toPromise());Promise.all(e).then(()=>{let i=this.selectedTodos.map(r=>r.id);this.todosWithUsers=this.todosWithUsers.filter(r=>!i.includes(r.id)),this.selectedTodos.forEach(r=>{let a=this.userOptions.find(s=>s.value===r.userId);console.log(a),this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:"\u041C\u043D\u043E\u0436\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435",entity:"\u0417\u0430\u0434\u0430\u0447\u0430",entityId:r.id,performedBy:n,details:`\u0423\u0434\u0430\u043B\u0435\u043D\u0430 \u0437\u0430\u0434\u0430\u0447\u0430: ${r.name}, \u043F\u0440\u0438\u043D\u0430\u0434\u043B\u0435\u0436\u0430\u0449\u0430\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044E: ${a?`${a.label}`:"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"}`})}),this.selectedTodos=[],this.deleteTodosDialog=!1,this.translate.get(["success","selectedTasksDeleted"]).subscribe(r=>{this.messageService.add({severity:"success",summary:r.success,detail:r.selectedTasksDeleted,life:3e3})})}).catch(i=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u0434\u0430\u0447:",i),this.translate.get(["error","someTasksNotDeleted"]).subscribe(r=>{this.messageService.add({severity:"error",summary:r.error,detail:r.someTasksNotDeleted,life:3e3})})})}hideDialog(){this.todoDialog=!1,this.submitted=!1}saveTodo(){if(this.submitted=!0,this.todo.name?.trim()){let n=!!this.todo.id,e=localStorage.getItem("userEmail")||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E",i=this.userOptions.find(s=>s.value===this.todo.userId),r=i?`${i.label}`:"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C";(n?this.sharedStateService.updateTodo(this.todo.id,this.todo):this.sharedStateService.addTodo(this.todo)).subscribe({next:()=>{this.auditTrailService.addAuditRecord({id:this.sharedStateService.generateId(),timestamp:new Date,action:n?"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435":"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435",entity:"\u0417\u0430\u0434\u0430\u0447\u0430",entityId:this.todo.id||"",performedBy:e,details:n?`\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0430 \u0437\u0430\u0434\u0430\u0447\u0430: ${this.todo.name}, \u043F\u0440\u0438\u043D\u0430\u0434\u043B\u0435\u0436\u0438\u0442: ${r}`:`\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u043E\u0432\u0430\u044F \u0437\u0430\u0434\u0430\u0447\u0430: ${this.todo.name}, \u043F\u0440\u0438\u043D\u0430\u0434\u043B\u0435\u0436\u0438\u0442: ${r}`}),this.translate.get(["success","taskUpdated","taskAdded"]).subscribe(s=>{this.messageService.add({severity:"success",summary:s.success,detail:n?s.taskUpdated:s.taskAdded,life:3e3})}),this.todoDialog=!1,this.todo={}},error:s=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u0434\u0430\u0447\u0438:",s),this.translate.get(["error","taskSaveFailed"]).subscribe(o=>{this.messageService.add({severity:"error",summary:o.error,detail:o.taskSaveFailed,life:3e3})})}})}}static \u0275fac=function(e){return new(e||t)(Z(Dn),Z(Hn),Z(Ki),Z(Da),Z(Ta),Z(Dr))};static \u0275cmp=he({type:t,selectors:[["app-users-tasks"]],standalone:!0,features:[Ue],decls:23,vars:34,consts:[[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","right"],["pTemplate","left"],[3,"selectedItemsChange","edit","delete","data","columns","rows","isAdmin","selectedItems"],[1,"todos",3,"visibleChange","visible","header","modal"],["pTemplate","content",1,"creat-edit-modal"],["pTemplate","footer"],[3,"visibleChange","visible","header","modal","closable"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[1,"my-2","buttons"],["pButton","","pRipple","","icon","pi pi-plus","class","p-button-success mr-2",3,"label","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash","class","p-button-danger ml-5 delete-selected",3,"label","disabled","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click","label"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-danger","ml-5","delete-selected",3,"click","label","disabled"],[1,"field"],["for","name"],["type","text","id","name","pInputText","","required","",3,"ngModelChange","ngModel"],["for","description"],["id","description","pInputTextarea","","required","","rows","3",3,"ngModelChange","ngModel"],["for","user"],["id","user","required","",3,"ngModelChange","ngModel","options","placeholder"],["class","p-error",4,"ngIf"],["required","",3,"ngModelChange","ngModel","options","placeholder","ngClass"],["class","status-badge",3,"ngClass",4,"ngIf"],[1,"p-error"],[1,"status-badge",3,"ngClass"],["pButton","","pRipple","","icon","pi pi-times",1,"p-button-text",3,"click","label"],["pButton","","pRipple","","icon","pi pi-check",1,"p-button-text",3,"click","label"]],template:function(e,i){e&1&&(g(0,"div",0),N(1,"p-toast"),g(2,"p-toolbar",1),w(3,mD,3,2,"ng-template",2)(4,_D,3,3,"ng-template",3),x(),g(5,"app-shared-table",4),nt("selectedItemsChange",function(a){return it(i.selectedTodos,a)||(i.selectedTodos=a),a}),G("edit",function(a){return i.editTodo(a)})("delete",function(a){return i.deleteTodo(a)}),x()(),g(6,"p-dialog",5),ae(7,"translate"),nt("visibleChange",function(a){return it(i.todoDialog,a)||(i.todoDialog=a),a}),w(8,bD,21,27,"ng-template",6)(9,yD,4,6,"ng-template",7),x(),g(10,"p-dialog",8),ae(11,"translate"),nt("visibleChange",function(a){return it(i.deleteTodosDialog,a)||(i.deleteTodosDialog=a),a}),g(12,"div",9),N(13,"i",10),w(14,wD,6,4,"span",11)(15,CD,3,3,"span",11),x(),w(16,TD,4,6,"ng-template",7),x(),g(17,"p-dialog",8),ae(18,"translate"),nt("visibleChange",function(a){return it(i.deleteTodoDialog,a)||(i.deleteTodoDialog=a),a}),g(19,"div",9),N(20,"i",10),w(21,SD,6,4,"span",11),x(),w(22,ID,4,6,"ng-template",7),x()),e&2&&(p(5),u("data",i.todosWithUsers)("columns",i.cols)("rows",5)("isAdmin",i.isAdmin),tt("selectedItems",i.selectedTodos),p(),Ai(Ot(31,dD)),tt("visible",i.todoDialog),u("header",se(7,25,"taskDetails"))("modal",!0),p(4),Ai(Ot(32,Nf)),tt("visible",i.deleteTodosDialog),u("header",se(11,27,"confirmation"))("modal",!0)("closable",!1),p(4),u("ngIf",i.selectedTodos.length===1),p(),u("ngIf",i.selectedTodos.length>1),p(2),Ai(Ot(33,Nf)),tt("visible",i.deleteTodoDialog),u("header",se(18,29,"confirmation"))("modal",!0)("closable",!1),p(4),u("ngIf",i.todo))},dependencies:[si,rt,Ze,At,Mr,La,Rr,za,Pr,Vr,xn,Wn,Gi,Fr,Br,Wa,wo,kr,kn,Er,dn,Nr,at,Mn]})};var kD=["*"],ED=(t,n,e,i,r,a)=>({"p-sidebar":!0,"p-sidebar-active":t,"p-sidebar-left":n,"p-sidebar-right":e,"p-sidebar-top":i,"p-sidebar-bottom":r,"p-sidebar-full":a}),FD=(t,n)=>({transform:t,transition:n}),DD=t=>({value:"visible",params:t});function MD(t,n){t&1&&ye(0)}function OD(t,n){if(t&1&&(_e(0),w(1,MD,1,0,"ng-container",5),ge()),t&2){let e=f(2);p(),u("ngTemplateOutlet",e.headlessTemplate)}}function AD(t,n){t&1&&ye(0)}function LD(t,n){t&1&&N(0,"TimesIcon",13),t&2&&(u("styleClass","p-sidebar-close-icon"),V("data-pc-section","closeicon"))}function RD(t,n){}function VD(t,n){t&1&&w(0,RD,0,0,"ng-template")}function PD(t,n){if(t&1&&(g(0,"span",14),w(1,VD,1,0,null,5),x()),t&2){let e=f(4);V("data-pc-section","closeicon"),p(),u("ngTemplateOutlet",e.closeIconTemplate)}}function BD(t,n){if(t&1){let e=le();g(0,"button",10),G("click",function(r){S(e);let a=f(3);return I(a.close(r))})("keydown.enter",function(r){S(e);let a=f(3);return I(a.close(r))}),w(1,LD,1,2,"TimesIcon",11)(2,PD,2,2,"span",12),x()}if(t&2){let e=f(3);V("aria-label",e.ariaCloseLabel)("data-pc-section","closebutton")("data-pc-group-section","iconcontainer"),p(),u("ngIf",!e.closeIconTemplate),p(),u("ngIf",e.closeIconTemplate)}}function ND(t,n){t&1&&ye(0)}function UD(t,n){t&1&&ye(0)}function HD(t,n){if(t&1&&(_e(0),g(1,"div",15),w(2,UD,1,0,"ng-container",5),x(),ge()),t&2){let e=f(3);p(),V("data-pc-section","footer"),p(),u("ngTemplateOutlet",e.footerTemplate)}}function zD(t,n){if(t&1&&(g(0,"div",6),w(1,AD,1,0,"ng-container",5)(2,BD,3,5,"button",7),x(),g(3,"div",8),wi(4),w(5,ND,1,0,"ng-container",5),x(),w(6,HD,3,2,"ng-container",9)),t&2){let e=f(2);V("data-pc-section","header"),p(),u("ngTemplateOutlet",e.headerTemplate),p(),u("ngIf",e.showCloseIcon),p(),V("data-pc-section","content"),p(2),u("ngTemplateOutlet",e.contentTemplate),p(),u("ngIf",e.footerTemplate)}}function WD(t,n){if(t&1){let e=le();g(0,"div",3,0),G("@panelState.start",function(r){S(e);let a=f();return I(a.onAnimationStart(r))})("@panelState.done",function(r){S(e);let a=f();return I(a.onAnimationEnd(r))})("keydown",function(r){S(e);let a=f();return I(a.onKeyDown(r))}),w(2,OD,2,1,"ng-container",4)(3,zD,7,6,"ng-template",null,1,$t),x()}if(t&2){let e=vt(4),i=f();ue(i.styleClass),u("ngClass",ur(9,ED,i.visible,i.position==="left"&&!i.fullScreen,i.position==="right"&&!i.fullScreen,i.position==="top"&&!i.fullScreen,i.position==="bottom"&&!i.fullScreen,i.fullScreen))("@panelState",Le(19,DD,pt(16,FD,i.transformOptions,i.transitionOptions)))("ngStyle",i.style),V("data-pc-name","sidebar")("data-pc-section","root"),p(2),u("ngIf",i.headlessTemplate)("ngIfElse",e)}}var jD=En([qt({transform:"{{transform}}",opacity:0}),li("{{transition}}")]),KD=En([li("{{transition}}",qt({transform:"{{transform}}",opacity:0}))]),Uf=(()=>{class t{document;el;renderer;cd;config;appendTo;blockScroll=!1;style;styleClass;ariaCloseLabel;autoZIndex=!0;baseZIndex=0;modal=!0;dismissible=!0;showCloseIcon=!0;closeOnEscape=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";get visible(){return this._visible}set visible(e){this._visible=e}get position(){return this._position}set position(e){switch(this._position=e,e){case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break}}get fullScreen(){return this._fullScreen}set fullScreen(e){this._fullScreen=e,e&&(this.transformOptions="none")}templates;onShow=new fe;onHide=new fe;visibleChange=new fe;initialized;_visible;_position="left";_fullScreen=!1;container;transformOptions="translate3d(-100%, 0px, 0px)";mask;maskClickListener;documentEscapeListener;animationEndListener;contentTemplate;headerTemplate;footerTemplate;closeIconTemplate;headlessTemplate;constructor(e,i,r,a,s){this.document=e,this.el=i,this.renderer=r,this.cd=a,this.config=s}ngAfterViewInit(){this.initialized=!0}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"closeicon":this.closeIconTemplate=e.template;break;case"headless":this.headlessTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}onKeyDown(e){e.code==="Escape"&&this.hide(!1)}show(){this.autoZIndex&&Ut.set("modal",this.container,this.baseZIndex||this.config.zIndex.modal),this.modal&&this.enableModality(),this.onShow.emit({}),this.visibleChange.emit(!0)}hide(e=!0){e&&this.onHide.emit({}),this.modal&&this.disableModality()}close(e){this.hide(!1),this.visibleChange.emit(!1),e.preventDefault()}enableModality(){let e=this.document.querySelectorAll(".p-sidebar-active"),r=e.length==1?String(parseInt(this.container.style.zIndex)-1):String(parseInt(e[0].style.zIndex)-1);this.mask||(this.mask=this.renderer.createElement("div"),this.renderer.setStyle(this.mask,"zIndex",r),R.addMultipleClasses(this.mask,"p-component-overlay p-sidebar-mask p-component-overlay p-component-overlay-enter"),this.dismissible&&(this.maskClickListener=this.renderer.listen(this.mask,"click",a=>{this.dismissible&&this.close(a)})),this.renderer.appendChild(this.document.body,this.mask),this.blockScroll&&R.blockBodyScroll())}disableModality(){this.mask&&(R.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.renderer.listen(this.mask,"animationend",this.destroyModal.bind(this)))}destroyModal(){this.unbindMaskClickListener(),this.mask&&this.renderer.removeChild(this.document.body,this.mask),this.blockScroll&&R.unblockBodyScroll(),this.unbindAnimationEndListener(),this.mask=null}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.appendContainer(),this.show(),this.closeOnEscape&&this.bindDocumentEscapeListener();break}}onAnimationEnd(e){switch(e.toState){case"void":this.hide(!0),Ut.clear(this.container),this.unbindGlobalListeners();break}}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):R.appendChild(this.container,this.appendTo))}bindDocumentEscapeListener(){let e=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentEscapeListener=this.renderer.listen(e,"keydown",i=>{i.which==27&&parseInt(this.container.style.zIndex)===Ut.get(this.container)&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindGlobalListeners(){this.unbindMaskClickListener(),this.unbindDocumentEscapeListener()}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}ngOnDestroy(){this.initialized=!1,this.visible&&this.modal&&this.destroyModal(),this.appendTo&&this.container&&this.renderer.appendChild(this.el.nativeElement,this.container),this.container&&this.autoZIndex&&Ut.clear(this.container),this.container=null,this.unbindGlobalListeners(),this.unbindAnimationEndListener()}static \u0275fac=function(i){return new(i||t)(Z(oi),Z(Lt),Z(Qt),Z(St),Z(Nt))};static \u0275cmp=he({type:t,selectors:[["p-sidebar"]],contentQueries:function(i,r,a){if(i&1&&xt(a,Ze,4),i&2){let s;Ee(s=Fe())&&(r.templates=s)}},hostAttrs:[1,"p-element"],inputs:{appendTo:"appendTo",blockScroll:[2,"blockScroll","blockScroll",Q],style:"style",styleClass:"styleClass",ariaCloseLabel:"ariaCloseLabel",autoZIndex:[2,"autoZIndex","autoZIndex",Q],baseZIndex:[2,"baseZIndex","baseZIndex",We],modal:[2,"modal","modal",Q],dismissible:[2,"dismissible","dismissible",Q],showCloseIcon:[2,"showCloseIcon","showCloseIcon",Q],closeOnEscape:[2,"closeOnEscape","closeOnEscape",Q],transitionOptions:"transitionOptions",visible:"visible",position:"position",fullScreen:"fullScreen"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange"},features:[_t],ngContentSelectors:kD,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["role","complementary",3,"ngClass","ngStyle","class","keydown",4,"ngIf"],["role","complementary",3,"keydown","ngClass","ngStyle"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],[1,"p-sidebar-header"],["type","button","class","p-sidebar-close p-sidebar-icon p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[1,"p-sidebar-content"],[4,"ngIf"],["type","button","pRipple","",1,"p-sidebar-close","p-sidebar-icon","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],["class","p-sidebar-close-icon",4,"ngIf"],[3,"styleClass"],[1,"p-sidebar-close-icon"],[1,"p-sidebar-footer"]],template:function(i,r){i&1&&(Ni(),w(0,WD,5,21,"div",2)),i&2&&u("ngIf",r.visible)},dependencies:()=>[at,rt,bt,It,At,Rt],styles:[`@layer primeng{.p-sidebar{position:fixed;transition:transform .3s;display:flex;flex-direction:column}.p-sidebar-content{position:relative;overflow-y:auto;flex-grow:1}.p-sidebar-header{display:flex;align-items:center}.p-sidebar-footer{margin-top:auto}.p-sidebar-icon{display:flex;align-items:center;justify-content:center;margin-left:auto}.p-sidebar-left{top:0;left:0;width:20rem;height:100%}.p-sidebar-right{top:0;right:0;width:20rem;height:100%}.p-sidebar-top{top:0;left:0;width:100%;height:10rem}.p-sidebar-bottom{bottom:0;left:0;width:100%;height:10rem}.p-sidebar-full{width:100%;height:100%;top:0;left:0;-webkit-transition:none;transition:none}.p-sidebar-left.p-sidebar-sm,.p-sidebar-right.p-sidebar-sm{width:20rem}.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-md{width:40rem}.p-sidebar-left.p-sidebar-lg,.p-sidebar-right.p-sidebar-lg{width:60rem}.p-sidebar-top.p-sidebar-sm,.p-sidebar-bottom.p-sidebar-sm{height:10rem}.p-sidebar-top.p-sidebar-md,.p-sidebar-bottom.p-sidebar-md{height:20rem}.p-sidebar-top.p-sidebar-lg,.p-sidebar-bottom.p-sidebar-lg{height:30rem}@media screen and (max-width: 64em){.p-sidebar-left.p-sidebar-lg,.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-lg,.p-sidebar-right.p-sidebar-md{width:20rem}}}
`],encapsulation:2,data:{animation:[rn("panelState",[ri("void => visible",[Fn(jD)]),ri("visible => void",[Fn(KD)])])]},changeDetection:0})}return t})(),Hf=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,ai,ct,Rt,ct]})}return t})();var $D=["content"],YD=[[["p-footer"]]],XD=["p-footer"],qD=t=>({"p-dialog p-confirm-dialog p-component":!0,"p-dialog-rtl":t}),ZD=(t,n)=>({transform:t,transition:n}),QD=t=>({value:"visible",params:t}),zf=t=>({$implicit:t}),JD=()=>({"p-dialog-header-icon p-dialog-header-close p-link":!0});function eM(t,n){t&1&&ye(0)}function tM(t,n){if(t&1&&(_e(0),w(1,eM,1,0,"ng-container",7),ge()),t&2){let e=f(3);p(),u("ngTemplateOutlet",e.headlessTemplate)("ngTemplateOutletContext",Le(2,zf,e.confirmation))}}function iM(t,n){t&1&&ye(0)}function nM(t,n){if(t&1&&(g(0,"div",14),w(1,iM,1,0,"ng-container",15),x()),t&2){let e=f(4);p(),u("ngTemplateOutlet",e.headerTemplate)}}function rM(t,n){if(t&1&&(g(0,"span",19),Y(1),x()),t&2){let e=f(5);u("id",e.ariaLabelledBy),p(),be(e.option("header"))}}function aM(t,n){if(t&1){let e=le();g(0,"button",20),G("click",function(r){S(e);let a=f(5);return I(a.close(r))})("keydown.enter",function(r){S(e);let a=f(5);return I(a.close(r))}),N(1,"TimesIcon"),x()}if(t&2){let e=f(5);u("ngClass",Ot(2,JD)),V("aria-label",e.closeAriaLabel)}}function sM(t,n){if(t&1&&(g(0,"div",14),w(1,rM,2,2,"span",16),g(2,"div",17),w(3,aM,2,3,"button",18),x()()),t&2){let e=f(4);p(),u("ngIf",e.option("header")),p(2),u("ngIf",e.closable)}}function oM(t,n){if(t&1&&N(0,"i",3),t&2){let e=f(4);ue(e.option("icon")),u("ngClass","p-confirm-dialog-icon")}}function lM(t,n){}function cM(t,n){t&1&&w(0,lM,0,0,"ng-template")}function dM(t,n){if(t&1&&(_e(0),w(1,cM,1,0,null,15),ge()),t&2){let e=f(4);p(),u("ngTemplateOutlet",e.iconTemplate)}}function pM(t,n){if(t&1&&N(0,"span",21),t&2){let e=f(4);u("innerHTML",e.option("message"),ba)}}function uM(t,n){}function fM(t,n){t&1&&w(0,uM,0,0,"ng-template")}function hM(t,n){if(t&1&&(_e(0),w(1,fM,1,0,null,7),ge()),t&2){let e=f(4);p(),u("ngTemplateOutlet",e.messageTemplate)("ngTemplateOutletContext",Le(2,zf,e.confirmation))}}function mM(t,n){t&1&&ye(0)}function _M(t,n){if(t&1&&(g(0,"div",22),wi(1),w(2,mM,1,0,"ng-container",15),x()),t&2){let e=f(4);p(2),u("ngTemplateOutlet",e.footerTemplate)}}function gM(t,n){if(t&1&&N(0,"i"),t&2){let e=f(7);ue(e.option("rejectIcon"))}}function xM(t,n){t&1&&N(0,"TimesIcon",28),t&2&&u("styleClass","p-button-icon-left")}function vM(t,n){if(t&1&&(_e(0),w(1,gM,1,2,"i",26)(2,xM,1,1,"TimesIcon",27),ge()),t&2){let e=f(6);p(),u("ngIf",e.option("rejectIcon")),p(),u("ngIf",!e.option("rejectIcon"))}}function bM(t,n){}function yM(t,n){t&1&&w(0,bM,0,0,"ng-template")}function wM(t,n){if(t&1&&(g(0,"span",29),w(1,yM,1,0,null,15),x()),t&2){let e=f(6);p(),u("ngTemplateOutlet",e.rejectIconTemplate)}}function CM(t,n){if(t&1){let e=le();g(0,"button",24),G("click",function(){S(e);let r=f(5);return I(r.reject())}),w(1,vM,3,2,"ng-container",11)(2,wM,2,1,"span",25),x()}if(t&2){let e=f(5);ue(e.option("rejectButtonStyleClass")),u("label",e.rejectButtonLabel)("ngClass","p-confirm-dialog-reject"),V("aria-label",e.rejectAriaLabel),p(),u("ngIf",!e.rejectIconTemplate),p(),u("ngIf",e.rejectIconTemplate)}}function TM(t,n){if(t&1&&N(0,"i"),t&2){let e=f(7);ue(e.option("acceptIcon"))}}function SM(t,n){t&1&&N(0,"CheckIcon",28),t&2&&u("styleClass","p-button-icon-left")}function IM(t,n){if(t&1&&(_e(0),w(1,TM,1,2,"i",26)(2,SM,1,1,"CheckIcon",27),ge()),t&2){let e=f(6);p(),u("ngIf",e.option("acceptIcon")),p(),u("ngIf",!e.option("acceptIcon"))}}function kM(t,n){}function EM(t,n){t&1&&w(0,kM,0,0,"ng-template")}function FM(t,n){if(t&1&&(g(0,"span",29),w(1,EM,1,0,null,15),x()),t&2){let e=f(6);p(),u("ngTemplateOutlet",e.acceptIconTemplate)}}function DM(t,n){if(t&1){let e=le();g(0,"button",24),G("click",function(){S(e);let r=f(5);return I(r.accept())}),w(1,IM,3,2,"ng-container",11)(2,FM,2,1,"span",25),x()}if(t&2){let e=f(5);ue(e.option("acceptButtonStyleClass")),u("label",e.acceptButtonLabel)("ngClass","p-confirm-dialog-accept"),V("aria-label",e.acceptAriaLabel),p(),u("ngIf",!e.acceptIconTemplate),p(),u("ngIf",e.acceptIconTemplate)}}function MM(t,n){if(t&1&&(g(0,"div",22),w(1,CM,3,7,"button",23)(2,DM,3,7,"button",23),x()),t&2){let e=f(4);p(),u("ngIf",e.option("rejectVisible")),p(),u("ngIf",e.option("acceptVisible"))}}function OM(t,n){if(t&1&&(w(0,nM,2,1,"div",8)(1,sM,4,2,"div",8),g(2,"div",9,1),w(4,oM,1,3,"i",10)(5,dM,2,1,"ng-container",11)(6,pM,1,1,"span",12)(7,hM,2,4,"ng-container",11),x(),w(8,_M,3,1,"div",13)(9,MM,3,2,"div",13)),t&2){let e=f(3);u("ngIf",e.headerTemplate),p(),u("ngIf",!e.headerTemplate),p(3),u("ngIf",!e.iconTemplate&&e.option("icon")),p(),u("ngIf",e.iconTemplate),p(),u("ngIf",!e.messageTemplate),p(),u("ngIf",e.messageTemplate),p(),u("ngIf",e.footer||e.footerTemplate),p(),u("ngIf",!e.footer&&!e.footerTemplate)}}function AM(t,n){if(t&1){let e=le();g(0,"div",5),G("@animation.start",function(r){S(e);let a=f(2);return I(a.onAnimationStart(r))})("@animation.done",function(r){S(e);let a=f(2);return I(a.onAnimationEnd(r))}),w(1,tM,2,4,"ng-container",6)(2,OM,10,8,"ng-template",null,0,$t),x()}if(t&2){let e=vt(3),i=f(2);ue(i.styleClass),u("ngClass",Le(9,qD,i.rtl))("ngStyle",i.style)("@animation",Le(14,QD,pt(11,ZD,i.transformOptions,i.transitionOptions))),V("aria-labelledby",i.ariaLabelledBy)("aria-modal",!0),p(),u("ngIf",i.headlessTemplate)("ngIfElse",e)}}function LM(t,n){if(t&1&&(g(0,"div",3),w(1,AM,4,16,"div",4),x()),t&2){let e=f();ue(e.maskStyleClass),u("ngClass",e.getMaskClass()),p(),u("ngIf",e.visible)}}var RM=En([qt({transform:"{{transform}}",opacity:0}),li("{{transition}}",qt({transform:"none",opacity:1}))]),VM=En([li("{{transition}}",qt({transform:"{{transform}}",opacity:0}))]),Wf=(()=>{class t{el;renderer;confirmationService;zone;cd;config;document;header;icon;message;get style(){return this._style}set style(e){this._style=e,this.cd.markForCheck()}styleClass;maskStyleClass;acceptIcon;acceptLabel;closeAriaLabel;acceptAriaLabel;acceptVisible=!0;rejectIcon;rejectLabel;rejectAriaLabel;rejectVisible=!0;acceptButtonStyleClass;rejectButtonStyleClass;closeOnEscape=!0;dismissableMask;blockScroll=!0;rtl=!1;closable=!0;appendTo;key;autoZIndex=!0;baseZIndex=0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";focusTrap=!0;defaultFocus="accept";breakpoints;get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(e){switch(this._position=e,e){case"top-left":case"bottom-left":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"top-right":case"bottom-right":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)";break}}onHide=new fe;footer;contentViewChild;templates;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"message":this.messageTemplate=e.template;break;case"icon":this.iconTemplate=e.template;break;case"rejecticon":this.rejectIconTemplate=e.template;break;case"accepticon":this.acceptIconTemplate=e.template;break;case"headless":this.headlessTemplate=e.template;break}})}headerTemplate;footerTemplate;rejectIconTemplate;acceptIconTemplate;messageTemplate;iconTemplate;headlessTemplate;confirmation;_visible;_style;maskVisible;documentEscapeListener;container;wrapper;contentContainer;subscription;maskClickListener;preWidth;_position="center";transformOptions="scale(0.7)";styleElement;id=ot();ariaLabelledBy=this.getAriaLabelledBy();confirmationOptions;translationSubscription;constructor(e,i,r,a,s,o,l){this.el=e,this.renderer=i,this.confirmationService=r,this.zone=a,this.cd=s,this.config=o,this.document=l,this.subscription=this.confirmationService.requireConfirmation$.subscribe(c=>{if(!c){this.hide();return}c.key===this.key&&(this.confirmation=c,this.confirmationOptions={message:this.confirmation.message||this.message,icon:this.confirmation.icon||this.icon,header:this.confirmation.header||this.header,rejectVisible:this.confirmation.rejectVisible==null?this.rejectVisible:this.confirmation.rejectVisible,acceptVisible:this.confirmation.acceptVisible==null?this.acceptVisible:this.confirmation.acceptVisible,acceptLabel:this.confirmation.acceptLabel||this.acceptLabel,rejectLabel:this.confirmation.rejectLabel||this.rejectLabel,acceptIcon:this.confirmation.acceptIcon||this.acceptIcon,rejectIcon:this.confirmation.rejectIcon||this.rejectIcon,acceptButtonStyleClass:this.confirmation.acceptButtonStyleClass||this.acceptButtonStyleClass,rejectButtonStyleClass:this.confirmation.rejectButtonStyleClass||this.rejectButtonStyleClass,defaultFocus:this.confirmation.defaultFocus||this.defaultFocus,blockScroll:this.confirmation.blockScroll===!1||this.confirmation.blockScroll===!0?this.confirmation.blockScroll:this.blockScroll,closeOnEscape:this.confirmation.closeOnEscape===!1||this.confirmation.closeOnEscape===!0?this.confirmation.closeOnEscape:this.closeOnEscape,dismissableMask:this.confirmation.dismissableMask===!1||this.confirmation.dismissableMask===!0?this.confirmation.dismissableMask:this.dismissableMask},this.confirmation.accept&&(this.confirmation.acceptEvent=new fe,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new fe,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0)})}ngOnInit(){this.breakpoints&&this.createStyle(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.visible&&this.cd.markForCheck()})}getAriaLabelledBy(){return this.header!==null?ot()+"_header":null}option(e){let i=this.confirmationOptions||this;if(i.hasOwnProperty(e))return i[e]}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.wrapper=this.container?.parentElement,this.contentContainer=R.findSingle(this.container,".p-dialog-content"),this.container?.setAttribute(this.id,""),this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.enableModality();let i=this.getElementToFocus();i&&i.focus();break}}onAnimationEnd(e){switch(e.toState){case"void":this.onOverlayHide();break}}getElementToFocus(){switch(this.option("defaultFocus")){case"accept":return R.findSingle(this.container,".p-confirm-dialog-accept");case"reject":return R.findSingle(this.container,".p-confirm-dialog-reject");case"close":return R.findSingle(this.container,".p-dialog-header-close");case"none":return null;default:return R.findSingle(this.container,".p-confirm-dialog-accept")}}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.document.body.appendChild(this.wrapper):R.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.wrapper&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}enableModality(){this.option("blockScroll")&&R.addClass(this.document.body,"p-overflow-hidden"),this.option("dismissableMask")&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)}))}disableModality(){this.maskVisible=!1,this.option("blockScroll")&&R.removeClass(this.document.body,"p-overflow-hidden"),this.dismissableMask&&this.unbindMaskClickListener(),this.container&&!this.cd.destroyed&&this.cd.detectChanges()}createStyle(){if(!this.styleElement){this.styleElement=this.document.createElement("style"),this.styleElement.type="text/css",R.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce),this.document.head.appendChild(this.styleElement);let e="";for(let i in this.breakpoints)e+=`
                    @media screen and (max-width: ${i}) {
                        .p-dialog[${this.id}] {
                            width: ${this.breakpoints[i]} !important;
                        }
                    }
                `;this.styleElement.innerHTML=e}}close(e){this.confirmation?.rejectEvent&&this.confirmation.rejectEvent.emit(Sa.CANCEL),this.hide(Sa.CANCEL),e.preventDefault()}hide(e){this.onHide.emit(e),this.visible=!1,this.confirmation=null,this.confirmationOptions=null}moveOnTop(){this.autoZIndex&&(Ut.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}getMaskClass(){let e={"p-dialog-mask p-component-overlay":!0,"p-dialog-mask-scrollblocker":this.blockScroll};return e[this.getPositionClass().toString()]=!0,e}getPositionClass(){let i=["left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find(r=>r===this.position);return i?`p-dialog-${i}`:""}bindGlobalListeners(){if(this.option("closeOnEscape")&&this.closable||this.focusTrap&&!this.documentEscapeListener){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentEscapeListener=this.renderer.listen(e,"keydown",i=>{if(i.which==27&&this.option("closeOnEscape")&&this.closable&&parseInt(this.container.style.zIndex)===Ut.get(this.container)&&this.visible&&this.close(i),i.which===9&&this.focusTrap){i.preventDefault();let r=R.getFocusableElements(this.container);if(r&&r.length>0)if(!r[0].ownerDocument.activeElement)r[0].focus();else{let a=r.indexOf(r[0].ownerDocument.activeElement);i.shiftKey?a==-1||a===0?r[r.length-1].focus():r[a-1].focus():a==-1||a===r.length-1?r[0].focus():r[a+1].focus()}}})}}unbindGlobalListeners(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}onOverlayHide(){this.container&&this.autoZIndex&&Ut.clear(this.container),this.disableModality(),this.unbindGlobalListeners(),this.container=null}destroyStyle(){this.styleElement&&(this.document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.restoreAppend(),this.onOverlayHide(),this.subscription.unsubscribe(),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.destroyStyle()}accept(){this.confirmation&&this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide(Sa.ACCEPT)}reject(){this.confirmation&&this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(Sa.REJECT),this.hide(Sa.REJECT)}get acceptButtonLabel(){return this.option("acceptLabel")||this.config.getTranslation(Yt.ACCEPT)}get rejectButtonLabel(){return this.option("rejectLabel")||this.config.getTranslation(Yt.REJECT)}static \u0275fac=function(i){return new(i||t)(Z(Lt),Z(Qt),Z(Ia),Z(yi),Z(St),Z(Nt),Z(oi))};static \u0275cmp=he({type:t,selectors:[["p-confirmDialog"]],contentQueries:function(i,r,a){if(i&1&&(xt(a,mo,5),xt(a,Ze,4)),i&2){let s;Ee(s=Fe())&&(r.footer=s.first),Ee(s=Fe())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&Je($D,5),i&2){let a;Ee(a=Fe())&&(r.contentViewChild=a.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",icon:"icon",message:"message",style:"style",styleClass:"styleClass",maskStyleClass:"maskStyleClass",acceptIcon:"acceptIcon",acceptLabel:"acceptLabel",closeAriaLabel:"closeAriaLabel",acceptAriaLabel:"acceptAriaLabel",acceptVisible:[2,"acceptVisible","acceptVisible",Q],rejectIcon:"rejectIcon",rejectLabel:"rejectLabel",rejectAriaLabel:"rejectAriaLabel",rejectVisible:[2,"rejectVisible","rejectVisible",Q],acceptButtonStyleClass:"acceptButtonStyleClass",rejectButtonStyleClass:"rejectButtonStyleClass",closeOnEscape:[2,"closeOnEscape","closeOnEscape",Q],dismissableMask:[2,"dismissableMask","dismissableMask",Q],blockScroll:[2,"blockScroll","blockScroll",Q],rtl:[2,"rtl","rtl",Q],closable:[2,"closable","closable",Q],appendTo:"appendTo",key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",Q],baseZIndex:[2,"baseZIndex","baseZIndex",We],transitionOptions:"transitionOptions",focusTrap:[2,"focusTrap","focusTrap",Q],defaultFocus:"defaultFocus",breakpoints:"breakpoints",visible:"visible",position:"position"},outputs:{onHide:"onHide"},features:[_t],ngContentSelectors:XD,decls:1,vars:1,consts:[["notHeadless",""],["content",""],[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["role","alertdialog",3,"ngClass","ngStyle","class",4,"ngIf"],["role","alertdialog",3,"ngClass","ngStyle"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-dialog-header",4,"ngIf"],[1,"p-dialog-content"],[3,"ngClass","class",4,"ngIf"],[4,"ngIf"],["class","p-confirm-dialog-message",3,"innerHTML",4,"ngIf"],["class","p-dialog-footer",4,"ngIf"],[1,"p-dialog-header"],[4,"ngTemplateOutlet"],["class","p-dialog-title",3,"id",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button","role","button",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title",3,"id"],["type","button","role","button",3,"click","keydown.enter","ngClass"],[1,"p-confirm-dialog-message",3,"innerHTML"],[1,"p-dialog-footer"],["type","button","pRipple","","pButton","",3,"label","ngClass","class","click",4,"ngIf"],["type","button","pRipple","","pButton","",3,"click","label","ngClass"],["class","p-button-icon-left",4,"ngIf"],[3,"class",4,"ngIf"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[1,"p-button-icon-left"]],template:function(i,r){i&1&&(Ni(YD),w(0,LM,2,4,"div",2)),i&2&&u("ngIf",r.maskVisible)},dependencies:()=>[at,rt,bt,It,si,At,Rt,Di],styles:[`@layer primeng{.p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{-webkit-transition:none;transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}}
`],encapsulation:2,data:{animation:[rn("animation",[ri("void => visible",[Fn(RM)]),ri("visible => void",[Fn(VM)])])]},changeDetection:0})}return t})(),jf=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,Fi,ai,Rt,Di,Fi,ct]})}return t})();var BM=()=>({"min-width":"50rem"});function NM(t,n){t&1&&(g(0,"tr")(1,"th",6),Y(2),ae(3,"translate"),N(4,"p-sortIcon",7),x(),g(5,"th",8),Y(6),ae(7,"translate"),N(8,"p-sortIcon",9),x(),g(9,"th",10),Y(10),ae(11,"translate"),N(12,"p-sortIcon",11),x(),g(13,"th"),Y(14),ae(15,"translate"),x(),g(16,"th",12),Y(17),ae(18,"translate"),N(19,"p-sortIcon",13),x()()),t&2&&(p(2),He("",se(3,5,"date")," "),p(4),He("",se(7,7,"action")," "),p(4),He("",se(11,9,"entity")," "),p(4),be(se(15,11,"details")),p(3),He("",se(18,13,"performedBy")," "))}function UM(t,n){if(t&1&&(g(0,"tr")(1,"td"),Y(2),ae(3,"date"),x(),g(4,"td"),Y(5),x(),g(6,"td"),Y(7),x(),g(8,"td"),Y(9),x(),g(10,"td"),Y(11),x()()),t&2){let e=n.$implicit;p(2),be(wa(3,5,e.timestamp,"short")),p(3),be(e.action),p(2),be(e.entity),p(2),be(e.details),p(2),be(e.performedBy)}}var ul=class t{constructor(n,e,i,r){this.auditTrailService=n;this.translate=e;this.messageService=i;this.confirmationService=r}auditRecords=[];filteredRecords=[];ngOnInit(){this.auditTrailService.auditRecords$.subscribe(n=>{this.auditRecords=n}),this.loadAuditRecords()}confirmClearAuditTrail(){this.translate.get(["areYouSureClearHistory","confirmation","yes","no"]).subscribe(n=>{this.confirmationService.confirm({message:n.areYouSureClearHistory,header:n.confirmation,icon:"pi pi-exclamation-triangle",acceptLabel:n.yes,rejectLabel:n.no,accept:()=>{this.clearAuditTrail()}})})}loadAuditRecords(){this.auditTrailService.getAuditRecords().subscribe(n=>{this.auditRecords=n,this.filteredRecords=[...this.auditRecords]})}clearAuditTrail(){this.auditTrailService.clearAuditTrail().subscribe(n=>{n&&console.log("\u0418\u0441\u0442\u043E\u0440\u0438\u044F \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0439 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0447\u0438\u0449\u0435\u043D\u0430.")})}static \u0275fac=function(e){return new(e||t)(Z(Hn),Z(Dn),Z(Ki),Z(Ia))};static \u0275cmp=he({type:t,selectors:[["app-audit-trail"]],standalone:!0,features:[ji([Ia,Ki]),Ue],decls:11,vars:11,consts:[[1,"card"],[1,"toolbar"],["pButton","","type","button","icon","pi pi-trash",1,"p-button-danger",3,"click","label"],[3,"value","tableStyle","paginator","rows"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","timestamp"],["field","timestamp"],["pSortableColumn","action"],["field","action"],["pSortableColumn","entity"],["field","entity"],["pSortableColumn","performedBy"],["field","performedBy"]],template:function(e,i){e&1&&(g(0,"div",0)(1,"h2"),Y(2),ae(3,"translate"),x(),g(4,"div",1)(5,"button",2),ae(6,"translate"),G("click",function(){return i.confirmClearAuditTrail()}),x()(),g(7,"p-table",3),w(8,NM,20,15,"ng-template",4)(9,UM,12,8,"ng-template",5),x(),N(10,"p-confirmDialog"),x()),e&2&&(p(2),be(se(3,6,"historyOfChanges")),p(3),u("label",se(6,8,"clearHistory")),p(2),u("value",i.auditRecords)("tableStyle",Ot(10,BM))("paginator",!0)("rows",10))},dependencies:[Ca,st,Lr,fr,Ze,To,So,Gi,si,jf,Wf,Mn]})};function HM(t,n){if(t&1&&(g(0,"div"),Y(1),x()),t&2){let e=n.$implicit;p(),be(e)}}function zM(t,n){if(t&1){let e=le();g(0,"div")(1,"div",14),ae(2,"translate"),G("click",function(){let r=S(e).$implicit,a=f();return I(a.selectDay(r))}),Y(3),x()()}if(t&2){let e=n.$implicit,i=f();p(),cn("selected",i.isSelectedDay(e))("has-event",i.isEventDay(e))("current-day",i.isCurrentDay(e)),u("pTooltip",i.isCurrentDay(e)?se(2,9,"today"):void 0)("ngClass","calendar-day"),p(2),He(" ",e," ")}}function WM(t,n){if(t&1){let e=le();g(0,"div",32),G("click",function(){let r=S(e).$implicit,a=f(2);return I(a.selectDay(r))}),Y(1),x()}if(t&2){let e=n.$implicit,i=f(2);cn("selected",i.isSelectedDay(e)),u("ngClass","calendar-day"),p(),He(" ",e," ")}}function jM(t,n){t&1&&(g(0,"div",33),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"titleRequired")," "))}function KM(t,n){t&1&&(g(0,"div",33),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"descriptionRequired")," "))}function GM(t,n){t&1&&(g(0,"div",33),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"startTimeRequired")," "))}function $M(t,n){t&1&&(g(0,"div",33),Y(1),ae(2,"translate"),x()),t&2&&(p(),He(" ",se(2,1,"endTimeRequired")," "))}function YM(t,n){if(t&1){let e=le();g(0,"div",15)(1,"div",16)(2,"h2"),Y(3),ae(4,"translate"),x(),g(5,"div",17)(6,"div",4)(7,"div",5)(8,"button",6),G("click",function(){S(e);let r=f();return I(r.changeMonth(-1))}),Y(9,"<"),x(),g(10,"h2"),Y(11),ae(12,"translate"),x(),g(13,"button",6),G("click",function(){S(e);let r=f();return I(r.changeMonth(1))}),Y(14,">"),x()(),g(15,"div",9),w(16,WM,2,4,"div",18),x()(),g(17,"form",19,0),G("ngSubmit",function(){S(e);let r=vt(18),a=f();return I(a.saveEvent(r))}),g(19,"div",20)(20,"label",21),Y(21),ae(22,"translate"),x(),g(23,"input",22,1),nt("ngModelChange",function(r){S(e);let a=f();return it(a.newEventTitle,r)||(a.newEventTitle=r),I(r)}),x(),w(25,jM,3,3,"div",23),x(),g(26,"div",20)(27,"label",21),Y(28),ae(29,"translate"),x(),g(30,"textarea",24,2),nt("ngModelChange",function(r){S(e);let a=f();return it(a.newEventDescription,r)||(a.newEventDescription=r),I(r)}),x(),w(32,KM,3,3,"div",23),x(),g(33,"div",20)(34,"label",25),Y(35),ae(36,"translate"),x(),g(37,"input",26),nt("ngModelChange",function(r){S(e);let a=f();return it(a.newEventStartTime,r)||(a.newEventStartTime=r),I(r)}),G("ngModelChange",function(){S(e);let r=f();return I(r.onStartTimeChange())}),x(),w(38,GM,3,3,"div",23),x(),g(39,"div",20)(40,"label",27),Y(41),ae(42,"translate"),x(),g(43,"input",28),nt("ngModelChange",function(r){S(e);let a=f();return it(a.newEventEndTime,r)||(a.newEventEndTime=r),I(r)}),G("ngModelChange",function(){S(e);let r=f();return I(r.onEndTimeChange())}),x(),w(44,$M,3,3,"div",23),x(),g(45,"div",29)(46,"button",30),Y(47),ae(48,"translate"),x(),g(49,"button",31),G("click",function(){S(e);let r=f();return I(r.closeModal())}),Y(50),ae(51,"translate"),x()()()()()()}if(t&2){let e=vt(18),i=vt(24),r=vt(31),a=f();p(3),dr("",se(4,23,"newEventFor")," ",a.getFormattedDate(a.selectedDay),""),p(8),be(se(12,25,a.getMonthAndYear(a.selectedMonth))),p(5),u("ngForOf",a.daysInMonth),p(4),u("for","title"+(a.selectedDay==null?null:a.selectedDay.getDate())),p(),be(se(22,27,"title")),p(2),u("id","title"+(a.selectedDay==null?null:a.selectedDay.getDate())),tt("ngModel",a.newEventTitle),p(2),u("ngIf",i.invalid&&i.touched),p(2),u("for","description"+(a.selectedDay==null?null:a.selectedDay.getDate())),p(),be(se(29,29,"description")),p(2),u("id","description"+(a.selectedDay==null?null:a.selectedDay.getDate())),tt("ngModel",a.newEventDescription),p(2),u("ngIf",r.invalid&&r.touched),p(3),be(se(36,31,"startTime")),p(2),tt("ngModel",a.newEventStartTime),p(),u("ngIf",a.newEventStartTime==="00:00"&&a.editingStartTime),p(3),be(se(42,33,"endTime")),p(2),tt("ngModel",a.newEventEndTime),p(),u("ngIf",a.newEventEndTime==="00:00"&&a.editingEndTime),p(2),u("disabled",e.invalid),p(),be(se(48,35,"addEvent")),p(3),be(se(51,37,"cancel"))}}function XM(t,n){if(t&1){let e=le();g(0,"div")(1,"div",34)(2,"div",35)(3,"p")(4,"strong"),Y(5),ae(6,"date"),x()(),g(7,"h3"),Y(8),x(),g(9,"p"),Y(10),x(),g(11,"p"),Y(12),x()(),g(13,"div",36)(14,"button",37),G("click",function(){let r=S(e).$implicit,a=f(2);return I(a.openEditModal(r))}),x(),g(15,"button",38),G("click",function(){let r=S(e).$implicit,a=f(2);return I(a.deleteEvent(r))}),x()()()()}if(t&2){let e=n.$implicit,i=f(2);p(5),be(wa(6,5,i.selectedDay,"dd/MM/yyyy")),p(3),be(e.title),p(2),be(e.description),p(2),dr("",e.startTime," - ",e.endTime,"")}}function qM(t,n){if(t&1&&(g(0,"div"),w(1,XM,16,8,"div",8),x()),t&2){let e=f();p(),u("ngForOf",e.selectedDayEvents)}}function ZM(t,n){t&1&&(g(0,"div")(1,"div",34)(2,"div",35)(3,"p"),Y(4),ae(5,"translate"),x()()()()),t&2&&(p(4),be(se(5,1,"noEvents")))}function QM(t,n){if(t&1){let e=le();g(0,"div",39)(1,"div",16)(2,"h2"),Y(3),ae(4,"translate"),x(),g(5,"form",19),G("ngSubmit",function(){S(e);let r=f();return I(r.saveEditedEvent())}),g(6,"div",20)(7,"label",40),Y(8),ae(9,"translate"),x(),g(10,"input",41),nt("ngModelChange",function(r){S(e);let a=f();return it(a.editingEvent.title,r)||(a.editingEvent.title=r),I(r)}),x()(),g(11,"div",20)(12,"label",42),Y(13),ae(14,"translate"),x(),g(15,"input",43),nt("ngModelChange",function(r){S(e);let a=f();return it(a.editingEvent.description,r)||(a.editingEvent.description=r),I(r)}),x()(),g(16,"div",20)(17,"label",44),Y(18),ae(19,"translate"),x(),g(20,"input",45),nt("ngModelChange",function(r){S(e);let a=f();return it(a.editingEvent.startTime,r)||(a.editingEvent.startTime=r),I(r)}),x()(),g(21,"div",20)(22,"label",46),Y(23),ae(24,"translate"),x(),g(25,"input",47),nt("ngModelChange",function(r){S(e);let a=f();return it(a.editingEvent.endTime,r)||(a.editingEvent.endTime=r),I(r)}),x()(),g(26,"button",48),Y(27),ae(28,"translate"),x(),g(29,"button",31),G("click",function(){S(e);let r=f();return I(r.closeEditModal())}),Y(30),ae(31,"translate"),x()()()()}if(t&2){let e=f();p(3),be(se(4,11,"editEvent")),p(5),be(se(9,13,"title")),p(2),tt("ngModel",e.editingEvent.title),p(3),be(se(14,15,"description")),p(2),tt("ngModel",e.editingEvent.description),p(3),be(se(19,17,"startTime")),p(2),tt("ngModel",e.editingEvent.startTime),p(3),be(se(24,19,"endTime")),p(2),tt("ngModel",e.editingEvent.endTime),p(2),be(se(28,21,"saveChanges")),p(3),be(se(31,23,"cancel"))}}var fl=class t{constructor(n){this.translate=n;console.log(this.newEventStartTime)}events=[];newEventTitle="";newEventStartTime="00:00";newEventEndTime="00:00";newEventDescription="";editingStartTime=!1;editingEndTime=!1;editingEvent=null;isEditModalOpen=!1;selectedMonthInModal=new Date;selectedDayInModal=null;selectedDay=null;selectedMonth=new Date;selectedDaysWithEvents=new Set;daysInMonth=[];isModalOpen=!1;selectedDayEvents=[];weekDays=[];selectedStartHour="";selectedStartMinute="";selectedEndHour="";selectedEndMinute="";hours=[];minutes=[];getMonthAndYear(n){if(!n)return"";let e=n.toLocaleString(this.translate.currentLang,{month:"long"}),i=e.charAt(0).toUpperCase()+e.slice(1),r=n.getFullYear();return`${i} ${r}`}ngOnInit(){this.loadEvents(),this.updateDaysInMonth(),this.setToday(),this.loadWeekDays(),this.loadTimeOptions(),this.translate.onLangChange.subscribe(()=>{this.loadWeekDays()})}loadTimeOptions(){this.hours=Array.from({length:24},(n,e)=>e<10?"0"+e:""+e),this.minutes=Array.from({length:60},(n,e)=>e<10?"0"+e:""+e)}loadWeekDays(){this.translate.get(["weekDays.Mon","weekDays.Tue","weekDays.Wed","weekDays.Thu","weekDays.Fri","weekDays.Sat","weekDays.Sun"]).subscribe(n=>{this.weekDays=[n["weekDays.Sun"],n["weekDays.Mon"],n["weekDays.Tue"],n["weekDays.Wed"],n["weekDays.Thu"],n["weekDays.Fri"],n["weekDays.Sat"]]})}getFormattedDate(n){return n?n.toLocaleString(this.translate.currentLang,{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}setToday(){let n=new Date;this.selectedDay=n,this.selectedDayEvents=this.events.filter(e=>new Date(e.date).toDateString()===n.toDateString())}openAddEventModal(){this.isModalOpen=!0,this.newEventStartTime="00:00",this.newEventEndTime="00:00"}closeModal(){this.isModalOpen=!1,this.newEventTitle="",this.newEventDescription="",this.newEventStartTime="00:00",this.newEventEndTime="00:00",this.selectedDay=null,this.selectedStartHour="",this.selectedStartMinute="",this.selectedEndHour="",this.selectedEndMinute="",this.editingStartTime=!1,this.editingEndTime=!1}loadEvents(){let n=localStorage.getItem("events");n&&(this.events=JSON.parse(n),this.updateSelectedDaysWithEvents())}updateDaysInMonth(){let n=[],e=new Date(this.selectedMonth.getFullYear(),this.selectedMonth.getMonth(),1),r=new Date(this.selectedMonth.getFullYear(),this.selectedMonth.getMonth()+1,0).getDate();for(let a=1;a<=r;a++)n.push(a);this.daysInMonth=n}changeMonth(n){let e=this.selectedMonth.getMonth(),i=new Date(this.selectedMonth);i.setMonth(e+n),this.selectedMonth=i,this.selectedDay=null,this.selectedDayEvents=[],this.updateDaysInMonth()}selectDay(n){this.selectedDay=new Date(this.selectedMonth.getFullYear(),this.selectedMonth.getMonth(),n),this.selectedDayEvents=this.events.filter(e=>new Date(e.date).toDateString()===this.selectedDay?.toDateString())}saveEvent(n){if(n.valid&&this.selectedDay&&this.newEventStartTime!=="00:00"&&this.newEventEndTime!=="00:00"){console.log(n);let e=new Date(this.selectedDay);e.setHours(0,0,0,0);let i={title:this.newEventTitle,description:this.newEventDescription,date:e.toISOString(),startTime:this.newEventStartTime,endTime:this.newEventEndTime},r=`${this.selectedStartHour}:${this.selectedStartMinute}`,a=`${this.selectedEndHour}:${this.selectedEndMinute}`;this.events=[...this.events,i],this.closeModal(),this.updateLocalStorage(),this.selectedDayEvents=this.events.filter(s=>new Date(s.date).toDateString()===this.selectedDay?.toDateString()),this.newEventTitle="",this.newEventStartTime="",this.newEventEndTime="",this.selectedDay=null}else alert("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0440\u0435\u043C\u044F")}onStartTimeChange(){this.editingStartTime=!0}onEndTimeChange(){this.editingEndTime=!0}saveEditedEvent(){if(this.editingEvent){let n=this.events.findIndex(e=>e.date===this.editingEvent.date&&e.title===this.editingEvent.title);n!==-1&&(this.events[n]=Tt({},this.editingEvent),this.events=[...this.events],this.updateLocalStorage(),this.closeEditModal(),this.selectedDayEvents=this.events.filter(e=>new Date(e.date).toDateString()===this.selectedDay?.toDateString()))}}openEditModal(n){this.editingEvent=Tt({},n),this.isEditModalOpen=!0}closeEditModal(){this.isEditModalOpen=!1,this.editingEvent=null}deleteEvent(n){this.events=this.events.filter(e=>e!==n),this.updateLocalStorage(),this.selectedDayEvents=this.events.filter(e=>new Date(e.date).toDateString()===this.selectedDay?.toDateString())}updateLocalStorage(){localStorage.setItem("events",JSON.stringify(this.events))}updateSelectedDaysWithEvents(){this.selectedDaysWithEvents.clear(),this.events.forEach(n=>{let e=new Date(n.date).getDate();this.selectedDaysWithEvents.add(e)})}isSelectedDay(n){return this.selectedDay&&this.selectedDay.getDate()===n}isCurrentDay(n){let e=new Date;return e.getDate()===n&&this.selectedMonth.getMonth()===e.getMonth()&&this.selectedMonth.getFullYear()===e.getFullYear()}isEventDay(n){let e=new Date(this.selectedMonth.getFullYear(),this.selectedMonth.getMonth(),n);return this.events.some(i=>new Date(i.date).toDateString()===e.toDateString())}static \u0275fac=function(e){return new(e||t)(Z(Dn))};static \u0275cmp=he({type:t,selectors:[["app-calendar"]],standalone:!0,features:[Ue],decls:22,vars:12,consts:[["eventForm","ngForm"],["title","ngModel"],["description","ngModel"],[1,"calendar-events"],[1,"calendar-container"],[1,"calendar-header"],[3,"click"],[1,"calendar-weekdays"],[4,"ngFor","ngForOf"],[1,"calendar-days"],[1,"add-new-event",3,"click"],["class","modal-overlay add-event",4,"ngIf"],[4,"ngIf"],["class","modal-overlay",4,"ngIf"],[3,"click","pTooltip","ngClass"],[1,"modal-overlay","add-event"],[1,"modal-content"],[1,"modal-content-flex"],[3,"selected","ngClass","click",4,"ngFor","ngForOf"],[3,"ngSubmit"],[1,"form-group"],[3,"for"],["name","title","required","","minlength","3",3,"ngModelChange","id","ngModel"],["class","error-message",4,"ngIf"],["name","description","required","","rows","3",3,"ngModelChange","id","ngModel"],["for","startTimeAdd"],["id","startTimeAdd","name","startTime","type","time",3,"ngModelChange","ngModel"],["for","endTimeAdd"],["id","endTimeAdd","name","endTime","type","time",3,"ngModelChange","ngModel"],[1,"actions"],["type","submit",3,"disabled"],["type","button",3,"click"],[3,"click","ngClass"],[1,"error-message"],[1,"event-details-container"],[1,"event-details-content"],[1,"event-actions"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],[1,"modal-overlay"],["for","title"],["id","title","name","title","required","",3,"ngModelChange","ngModel"],["for","description"],["id","description","name","description","required","",3,"ngModelChange","ngModel"],["for","startTime"],["id","startTime","name","startTime","type","time","required","",3,"ngModelChange","ngModel"],["for","endTime"],["id","endTime","name","endTime","type","time","required","",3,"ngModelChange","ngModel"],["type","submit"]],template:function(e,i){e&1&&(g(0,"div",3)(1,"div",4)(2,"div",5)(3,"button",6),G("click",function(){return i.changeMonth(-1)}),Y(4,"<"),x(),g(5,"h2"),Y(6),ae(7,"translate"),x(),g(8,"button",6),G("click",function(){return i.changeMonth(1)}),Y(9,">"),x()(),g(10,"div",7),w(11,HM,2,1,"div",8),x(),g(12,"div",9),w(13,zM,4,11,"div",8),x()(),N(14,"br"),g(15,"p-button",10),G("click",function(){return i.openAddEventModal()}),Y(16),ae(17,"translate"),x(),w(18,YM,52,39,"div",11)(19,qM,2,1,"div",12)(20,ZM,6,3,"div",12)(21,QM,32,25,"div",13),x()),e&2&&(p(6),be(se(7,8,i.getMonthAndYear(i.selectedMonth))),p(5),u("ngForOf",i.weekDays),p(2),u("ngForOf",i.daysInMonth),p(3),He(" ",se(17,10,"addNewEvent")," "),p(2),u("ngIf",i.isModalOpen),p(),u("ngIf",i.selectedDayEvents.length>0),p(),u("ngIf",i.selectedDayEvents.length===0),p(),u("ngIf",i.isEditModalOpen))},dependencies:[Or,si,Fa,rt,Ca,gn,L0,kr,kn,O0,Er,V0,dn,A0,ii,At,zn,Ar,at,Mn,Gi,Fi,st]})};var Kf=(()=>{class t{styleClass;style;strokeWidth="2";fill="none";animationDuration="2s";ariaLabel;static \u0275fac=function(i){return new(i||t)};static \u0275cmp=he({type:t,selectors:[["p-progressSpinner"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration",ariaLabel:"ariaLabel"},decls:3,vars:11,consts:[["role","progressbar",1,"p-progress-spinner",3,"ngStyle","ngClass"],["viewBox","25 25 50 50",1,"p-progress-spinner-svg"],["cx","50","cy","50","r","20","stroke-miterlimit","10",1,"p-progress-spinner-circle"]],template:function(i,r){i&1&&(g(0,"div",0),$e(),g(1,"svg",1),N(2,"circle",2),x()()),i&2&&(u("ngStyle",r.style)("ngClass",r.styleClass),V("aria-label",r.ariaLabel)("aria-busy",!0)("data-pc-name","progressspinner")("data-pc-section","root"),p(),Jr("animation-duration",r.animationDuration),V("data-pc-section","root"),p(),V("fill",r.fill)("stroke-width",r.strokeWidth))},dependencies:[at,It],styles:[`@layer primeng{.p-progress-spinner{position:relative;margin:0 auto;width:100px;height:100px;display:inline-block}.p-progress-spinner:before{content:"";display:block;padding-top:100%}.p-progress-spinner-svg{animation:p-progress-spinner-rotate 2s linear infinite;height:100%;transform-origin:center center;width:100%;position:absolute;inset:0;margin:auto}.p-progress-spinner-circle{stroke-dasharray:89,200;stroke-dashoffset:0;stroke:#d62d20;animation:p-progress-spinner-dash 1.5s ease-in-out infinite,p-progress-spinner-color 6s ease-in-out infinite;stroke-linecap:round}}@keyframes p-progress-spinner-rotate{to{transform:rotate(360deg)}}@keyframes p-progress-spinner-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}@keyframes p-progress-spinner-color{to,0%{stroke:#d62d20}40%{stroke:#0057e7}66%{stroke:#008744}80%,90%{stroke:#ffa700}}
`],encapsulation:2,changeDetection:0})}return t})(),Gf=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st]})}return t})();var $f=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=ht({type:t});static \u0275inj=ft({imports:[st,xl,ai,zn,ct,xl,zn,ct]})}return t})();var eO=()=>({width:"300px"});function tO(t,n){t&1&&N(0,"p-progressSpinner",23)}function iO(t,n){if(t&1){let e=le();g(0,"div",24)(1,"p-button",25),G("click",function(){S(e);let r=f();return I(r.showMenu())}),x()()}}function nO(t,n){if(t&1){let e=le();g(0,"div",7)(1,"div",26)(2,"p-dropdown",27),nt("ngModelChange",function(r){S(e);let a=f();return it(a.selectedLanguage,r)||(a.selectedLanguage=r),I(r)}),G("onChange",function(r){S(e);let a=f();return I(a.onLanguageChange(r.value))}),x()(),g(3,"p-button",28),ae(4,"translate"),G("click",function(){S(e);let r=f();return I(r.toggleTheme())}),x(),g(5,"p-button",29),ae(6,"translate"),G("click",function(){S(e);let r=f();return I(r.exportToExcel())}),x(),g(7,"p-button",30),ae(8,"translate"),G("click",function(){S(e);let r=f();return I(r.onLogout())}),x(),g(9,"p-button",31),G("onClick",function(){S(e);let r=f();return I(r.sidebarVisible2=!0)}),x()()}if(t&2){let e=f();p(2),u("options",e.languages),tt("ngModel",e.selectedLanguage),p(),ms("pTooltip",se(4,5,"switchTheme")),p(2),ms("pTooltip",se(6,7,"exportToExcel")),p(2),ms("pTooltip",se(8,9,"logOut"))}}function rO(t,n){if(t&1){let e=le();g(0,"button",32),ae(1,"translate"),G("click",function(){S(e);let r=f();return I(r.displayModal=!1)}),x(),g(2,"button",33),ae(3,"translate"),G("click",function(){S(e);let r=f();return I(r.performLogout())}),x()}t&2&&(u("label",se(1,2,"no")),p(2),u("label",se(3,4,"yes")))}var Yf=class t{constructor(n,e,i,r,a,s){this.translate=n;this.sharedStateService=e;this.messageService=i;this.authService=r;this.auditTrailService=a;this.router=s}isMobile=!1;isMenuVisible=!1;userEmail="";displayModal=!1;currentUser="";userName="";sidebarVisible2=!1;selectedFile=null;isDarkTheme=!1;languages=[];selectedLanguage=null;isLoading=!1;items;ngOnInit(){let n=localStorage.getItem("userEmail"),e=localStorage.getItem("theme");n?this.loadUserName(n):console.error("Email \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0432 localStorage!"),e==="dark"?this.isDarkTheme=!0:this.isDarkTheme=!1,this.applyTheme(),this.initializeLanguages(),this.checkScreenSize(),window.addEventListener("resize",this.checkScreenSize.bind(this))}checkScreenSize(){this.isMobile=window.innerWidth<=680}showMenu(){this.isMenuVisible=!0}initializeLanguages(){this.languages=[{label:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",code:"ru"},{label:"\u041A\u044B\u0440\u0433\u044B\u0437 \u0442\u0438\u043B\u0438",code:"ky"},{label:"English",code:"en"}];let n=localStorage.getItem("language")||"ru";this.translate.addLangs(this.languages.map(e=>e.code)),this.translate.setDefaultLang(n),this.translate.use(n),this.selectedLanguage=this.languages.find(e=>e.code===n)||null}onLanguageChange(n){let e=n.code;this.translate.use(e),localStorage.setItem("language",e)}toggleTheme(){this.isDarkTheme=!this.isDarkTheme,this.applyTheme(),localStorage.setItem("theme",this.isDarkTheme?"dark":"light")}applyTheme(){this.isDarkTheme?(document.body.classList.add("dark-theme"),document.body.classList.remove("light-theme"),console.log("dark-theme")):(document.body.classList.add("light-theme"),document.body.classList.remove("dark-theme"))}loadUserName(n){this.isLoading=!0,this.sharedStateService.getUsers().subscribe(e=>{let i=e.find(r=>r.email===n);i?this.userName=i.firstName??"\u0413\u043E\u0441\u0442\u044C":this.userName="\u0413\u043E\u0441\u0442\u044C"},e=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F:",e),this.userName="\u0413\u043E\u0441\u0442\u044C"},()=>{this.isLoading=!1})}onLogout(){this.currentUser=this.authService.getCurrentUser(),console.log(this.currentUser),this.currentUser?(this.userEmail=this.currentUser.email,this.displayModal=!0):this.performLogout()}performLogout(){this.authService.logout().then(()=>{this.router.navigate(["/login"]).then(()=>{window.location.reload()})}).catch(n=>alert("Error signing out: "+n.message))}exportToExcel(){let e=this.sharedStateService.usersSubject.getValue().map(a=>({\u0418\u043C\u044F:`${a.firstName} ${a.lastName}`,Email:a.email,\u0420\u043E\u043B\u044C:a.role,\u0412\u043E\u0437\u0440\u0430\u0441\u0442:a.age,"\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430":a.phoneNumber,\u041F\u043E\u043B:a.gender,"\u0414\u0430\u0442\u0430 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u0435":a.dateOfBirth,\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435:a.profilePicture})),r={Sheets:{Users:ll.json_to_sheet(e)},SheetNames:["Users"]};Df(r,"users.xlsx")}static \u0275fac=function(e){return new(e||t)(Z(Dn),Z(Dr),Z(Ki),Z(Da),Z(Hn),Z(Ta))};static \u0275cmp=he({type:t,selectors:[["app-main"]],standalone:!0,features:[Ue],decls:53,vars:53,consts:[[1,"container"],["styleClass","spinner",4,"ngIf"],[1,"p-field"],[1,"grid"],[1,"col-12"],[1,"header-content"],[1,"main-title"],[1,"buttons"],["class","mobile-menu",4,"ngIf"],[1,"menu-dialog"],[3,"visibleChange","visible","modal","closable"],[1,"menu-content"],[1,"language-selection"],["optionLabel","label",3,"ngModelChange","onChange","options","ngModel","placeholder"],["icon","pi pi-moon",1,"p-button-text",3,"click","label"],["icon","pi pi-file-excel",1,"p-button-text",3,"click","label"],["icon","pi pi-arrow-left",1,"p-button-text",3,"onClick","label"],["icon","pi pi-sign-out",1,"p-button-text",3,"click","label"],["class","buttons",4,"ngIf"],["position","right",3,"visibleChange","visible"],[3,"visibleChange","visible","modal","closable","header"],["pTemplate","footer"],[3,"header"],["styleClass","spinner"],[1,"mobile-menu"],["icon","pi pi-bars",1,"burger-menu",3,"click"],[1,"custom-dropdown"],["optionLabel","label","placeholder","\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u044F\u0437\u044B\u043A",3,"ngModelChange","onChange","options","ngModel"],["icon","pi pi-moon","tooltipPosition","bottom",3,"click","pTooltip"],["icon","pi pi-file-excel","tooltipPosition","bottom",3,"click","pTooltip"],["icon","pi pi-sign-out","tooltipPosition","bottom",1,"logout-button",3,"click","pTooltip"],["type","button","icon","pi pi-arrow-left",1,"sidebar",3,"onClick"],["pButton","","pRipple","","icon","pi pi-times",1,"p-button-text",3,"click","label"],["pButton","","pRipple","","icon","pi pi-check",1,"p-button-text",3,"click","label"]],template:function(e,i){e&1&&(g(0,"div",0),w(1,tO,1,0,"p-progressSpinner",1),g(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h1"),Y(7),ae(8,"translate"),g(9,"span",6),Y(10),x(),Y(11,"!"),x(),g(12,"div",7),w(13,iO,2,0,"div",8),g(14,"div",9)(15,"p-dialog",10),nt("visibleChange",function(a){return it(i.isMenuVisible,a)||(i.isMenuVisible=a),a}),g(16,"div",11)(17,"div",12)(18,"p-dropdown",13),ae(19,"translate"),nt("ngModelChange",function(a){return it(i.selectedLanguage,a)||(i.selectedLanguage=a),a}),G("onChange",function(a){return i.onLanguageChange(a.value)}),x()(),g(20,"p-button",14),ae(21,"translate"),G("click",function(){return i.toggleTheme()}),x(),g(22,"p-button",15),ae(23,"translate"),G("click",function(){return i.exportToExcel()}),x(),g(24,"p-button",16),ae(25,"translate"),G("onClick",function(){return i.sidebarVisible2=!0}),x(),g(26,"p-button",17),ae(27,"translate"),G("click",function(){return i.onLogout()}),x()()()(),w(28,nO,10,11,"div",18),x()(),g(29,"p-sidebar",19),nt("visibleChange",function(a){return it(i.sidebarVisible2,a)||(i.sidebarVisible2=a),a}),N(30,"app-audit-trail"),x(),g(31,"p-dialog",20),ae(32,"translate"),nt("visibleChange",function(a){return it(i.displayModal,a)||(i.displayModal=a),a}),g(33,"p"),Y(34),ae(35,"translate"),g(36,"b"),Y(37),x(),Y(38,"?"),x(),w(39,rO,4,6,"ng-template",21),x(),g(40,"p-tabView")(41,"p-tabPanel",22),ae(42,"translate"),N(43,"app-todos"),x(),g(44,"p-tabPanel",22),ae(45,"translate"),N(46,"app-users"),x(),g(47,"p-tabPanel",22),ae(48,"translate"),N(49,"app-users-tasks"),x(),g(50,"p-tabPanel",22),ae(51,"translate"),N(52,"app-calendar"),x()()()()()()),e&2&&(p(),u("ngIf",i.isLoading),p(6),be(se(8,28,"greeting")),p(3),He(", ",i.userName,""),p(3),u("ngIf",i.isMobile),p(2),Ai(Ot(52,eO)),tt("visible",i.isMenuVisible),u("modal",!0)("closable",!0),p(3),ms("placeholder",se(19,30,"chooseLanguage")),u("options",i.languages),tt("ngModel",i.selectedLanguage),p(2),u("label",se(21,32,"switchTheme")),p(2),u("label",se(23,34,"exportToExcel")),p(2),u("label",se(25,36,"historyOfChange")),p(2),u("label",se(27,38,"logOut")),p(2),u("ngIf",!i.isMobile),p(),tt("visible",i.sidebarVisible2),p(2),tt("visible",i.displayModal),u("modal",!0)("closable",!0)("header",se(32,40,"exitConfirmation")),p(3),He("",se(35,42,"wantToLogOut"),", "),p(3),be(i.userEmail),p(4),u("header",se(42,44,"myTasks")),p(3),u("header",se(45,46,"users")),p(3),u("header",se(48,48,"tasksUsers")),p(3),u("header",se(51,50,"eventsCalendar")))},dependencies:[Fi,si,Fa,Ze,zn,Ar,Mr,Rr,At,Lr,Pr,Vr,gn,kn,dn,Gi,xn,Wn,rt,Br,_d,Zl,ql,cl,dl,pl,Hf,Uf,ul,ko,Mn,Or,fo,fl,Gf,Kf,$f]})};export{Yf as MainComponent};
